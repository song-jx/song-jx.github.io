{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/css/noscript.styl","path":"css/noscript.styl","modified":1,"renderable":1},{"_id":"themes/next/source/images/android-chrome-192x192.png","path":"images/android-chrome-192x192.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/android-chrome-384x384.png","path":"images/android-chrome-384x384.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon.png","path":"images/apple-touch-icon.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.png","path":"images/avatar.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16.png","path":"images/favicon-16x16.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32.png","path":"images/favicon-32x32.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo-algolia-nebula-blue-full.svg","path":"images/logo-algolia-nebula-blue-full.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/manifest.json","path":"images/manifest.json","modified":1,"renderable":1},{"_id":"themes/next/source/images/safari-pinned-tab.svg","path":"images/safari-pinned-tab.svg","modified":1,"renderable":1},{"_id":"themes/next/source/js/bookmark.js","path":"js/bookmark.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/comments-buttons.js","path":"js/comments-buttons.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/config.js","path":"js/config.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/comments.js","path":"js/comments.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/motion.js","path":"js/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/next-boot.js","path":"js/next-boot.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/pjax.js","path":"js/pjax.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/schedule.js","path":"js/schedule.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/utils.js","path":"js/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/fancybox.js","path":"js/third-party/fancybox.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/quicklink.js","path":"js/third-party/quicklink.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/rating.js","path":"js/third-party/rating.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/analytics/google-analytics.js","path":"js/third-party/analytics/google-analytics.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/analytics/baidu-analytics.js","path":"js/third-party/analytics/baidu-analytics.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/analytics/growingio.js","path":"js/third-party/analytics/growingio.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/chat/gitter.js","path":"js/third-party/chat/gitter.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/chat/chatra.js","path":"js/third-party/chat/chatra.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/chat/tidio.js","path":"js/third-party/chat/tidio.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/changyan.js","path":"js/third-party/comments/changyan.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/disqusjs.js","path":"js/third-party/comments/disqusjs.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/disqus.js","path":"js/third-party/comments/disqus.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/gitalk.js","path":"js/third-party/comments/gitalk.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/livere.js","path":"js/third-party/comments/livere.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/isso.js","path":"js/third-party/comments/isso.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/comments/utterances.js","path":"js/third-party/comments/utterances.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/math/katex.js","path":"js/third-party/math/katex.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/math/mathjax.js","path":"js/third-party/math/mathjax.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/search/local-search.js","path":"js/third-party/search/local-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/search/algolia-search.js","path":"js/third-party/search/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/statistics/firestore.js","path":"js/third-party/statistics/firestore.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/statistics/lean-analytics.js","path":"js/third-party/statistics/lean-analytics.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/tags/mermaid.js","path":"js/third-party/tags/mermaid.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/third-party/tags/pdf.js","path":"js/third-party/tags/pdf.js","modified":1,"renderable":1}],"Cache":[{"_id":"source/_posts/51nod1847.md","hash":"679782dcdafbd194fe3e2a82a9aa6eab359110cc","modified":1631368874735},{"_id":"source/_posts/BZ2238.md","hash":"4a0fb90892b3b2cecfbe527d7cfae264a3355799","modified":1631368874736},{"_id":"source/_posts/CF1144G.md","hash":"f3efe35311b8f87c4ba6e6275d45913cd9a8577b","modified":1631368874736},{"_id":"source/_posts/CF1430F.md","hash":"4fa88387414b66f742fc0ab051696de0eef38969","modified":1631368874736},{"_id":"source/_posts/CF1305G.md","hash":"e6683f63a322dbb9a969b7eb056e367bf02694d3","modified":1631368874736},{"_id":"source/_posts/CF1498D.md","hash":"737a73f65cdf97b911721663ea7587f16c0f55ca","modified":1631368874736},{"_id":"source/_posts/CF1498E.md","hash":"663749da5c0ca17e1a243df9e4aac34a0985597a","modified":1631368874736},{"_id":"source/_posts/CF1498F.md","hash":"56e10a3897823e8f7a524722b12e8a3e95a374c3","modified":1631368874736},{"_id":"source/_posts/CF1508C.md","hash":"0e5d99029ec6d4449f6bea7af932e2087bc1b907","modified":1631368874736},{"_id":"source/_posts/CF1515E.md","hash":"15ffcf5f4e4ff2ee6ebf449421029584ca50dd60","modified":1631368874736},{"_id":"source/_posts/CF1515F.md","hash":"cc179a7858390db299f99aa498154f01698b6e38","modified":1631368874736},{"_id":"source/_posts/CF1515G.md","hash":"5cae1738a9d090e87989be0061099d9782bfa221","modified":1631365533839},{"_id":"source/_posts/CF1519E.md","hash":"ddde01500c4f66d7a7d88c2683436b2439579017","modified":1631368874736},{"_id":"source/_posts/CF493E.md","hash":"541faa4b5f60e5b21922f8c11bb1034c8857dbfe","modified":1631368874735},{"_id":"source/_posts/CF521E.md","hash":"a8fc26391d80c4ea506394bdcadcd8c91142b4b7","modified":1631368874736},{"_id":"source/_posts/CF549F.md","hash":"ee21a80ea7e4b12c06cd89b0628775d93c21814e","modified":1631368874735},{"_id":"source/_posts/CF845F.md","hash":"9e12eaf2503f78ec2934f0cc98bdd69b0a0b1180","modified":1631368874736},{"_id":"source/_posts/CF555E.md","hash":"d7ff3eba851383111599f8d751e6b2ddc1446cbe","modified":1631368874736},{"_id":"source/_posts/CF868E.md","hash":"7be9020c2756e3e95a53122e42a0ec186270c364","modified":1631368874736},{"_id":"source/_posts/CF908G.md","hash":"0a9bcf617631826210e36daa59af7e4919baee30","modified":1631368874736},{"_id":"source/_posts/Gym100958B.md","hash":"b148bd8dbad8f825936cb787f94983bd58fa35d5","modified":1631368874735},{"_id":"source/_posts/Hello-world.md","hash":"3c5461ee0c7c4abad21c17104d2d5be104bb6841","modified":1631367138819},{"_id":"source/_posts/IOI2009.md","hash":"1b3a43a44710a34579db9e3662b4a7120e0f07f7","modified":1631368874735},{"_id":"source/_posts/JOI2021D1T3.md","hash":"eac24d9f38c4b5939cb6e1e7dc304b6374ad8cb5","modified":1631368874735},{"_id":"source/_posts/JOISC2021D1T3.md","hash":"eac24d9f38c4b5939cb6e1e7dc304b6374ad8cb5","modified":1631368874735},{"_id":"source/_posts/JOISC2021D3T3.md","hash":"38d09a29ecafe93552681e12b62d89c3ac6d373e","modified":1631368874735},{"_id":"source/_posts/UVa12212.md","hash":"b9536530a8c3a97848d40aa951b0f6ffbd7d9174","modified":1631368874735},{"_id":"source/_posts/TC11351.md","hash":"1efea43a7bfc2ca7621851f9d1c96237280c9906","modified":1631368874735},{"_id":"source/_posts/abc140f.md","hash":"a12da75f0e73c2977d901ca6ebe66573dcbc3452","modified":1631368874736},{"_id":"source/_posts/cerc2009.md","hash":"c586ac8617b981380192831c6fd8f0882e170642","modified":1631368874736},{"_id":"source/_posts/cong-c11-dao-c17.md","hash":"88932b63a5fffb7b6c477b754668db7a38b1d8f4","modified":1631367786158},{"_id":"source/_posts/gridea-c-gao-liang-dai-ma-kuai-zhe-die.md","hash":"6b49b3ca2aea75dab4e63b2408c65b20e1cbfcfd","modified":1631365616862},{"_id":"source/_posts/du-jiao-shai-and-min-25-shai-and-powerful-number-shai.md","hash":"8101eff9719c568087255b5997ce678fce81ac87","modified":1631367609338},{"_id":"source/_posts/guan-yu-xi-bao-zi-dong-ji-kang-wei-sheng-ming-you-xi.md","hash":"b94ba2b4a021dcd14161789988d4f8cbb3cb1d88","modified":1631367212487},{"_id":"source/_posts/ji-yu-stdstreambuf-de-fast-io-mo-ban.md","hash":"4f895bbb86030b319811eeaac12da9119ae6e9c0","modified":1631367855793},{"_id":"source/_posts/jing-zhun-yu-ce-or-jsoi2019.md","hash":"80fd31577e605f3f8e2091db941bf9634ea8cd7a","modified":1631368874735},{"_id":"source/_posts/luogu7481.md","hash":"12a9e365bbc3d6a89f3adf59cbbfc3d7884db3ba","modified":1631368874735},{"_id":"source/_posts/luogu7482.md","hash":"855c69d40e3597f7426051aa247dea187b387f48","modified":1631368874735},{"_id":"source/_posts/nim-you-xi-and-sg-ding-li.md","hash":"c6b4394056c890711df49f0da2f6f6f26944c557","modified":1631367769206},{"_id":"source/_posts/problem.md","hash":"7bd66d11f4358ffdddc8a2178305cf4f663f17f2","modified":1631368874735},{"_id":"source/_posts/problem1.md","hash":"c11b02b54ccb5508c0eca455a36dc04189688def","modified":1631368874735},{"_id":"source/_posts/problem2.md","hash":"aab727d195ead9b0f938559fcb944434e977d121","modified":1631367980471},{"_id":"source/_posts/problem3.md","hash":"40149e220c215a5875232fd3986adfef2dc58eeb","modified":1631368874735},{"_id":"source/_posts/problem4.md","hash":"ae33db2ee0efe13b62f8343ad0837bc7f9f16172","modified":1631368874735},{"_id":"source/_posts/ren-yi-mo-shu-ntt.md","hash":"dc843709fd5f801cee4a68287216dfde0a62bfc7","modified":1631368874735},{"_id":"source/_posts/template.md","hash":"9639be9cfe9a6402353137237e6491c327974623","modified":1631368874735},{"_id":"source/_posts/za-xiang.md","hash":"b8ef6876fbfe335b943c34e0360785cec4276102","modified":1631368274387},{"_id":"source/_posts/zi-ran-shu-deng-mi-qiu-he.md","hash":"313620b2acade5cec4479cb8c598e361f204a2d9","modified":1631367741133},{"_id":"source/categories/index.md","hash":"9f2dc0cface7cfecdc2811984b7fe2e4a98c399c","modified":1631272541000},{"_id":"source/links/index.md","hash":"073ed4075a23aff49de2e9a0cfc4a8b00b8c846d","modified":1631282765000},{"_id":"source/tags/index.md","hash":"e0bd8be3030af799767a2f3349f5d9e0d38cb15b","modified":1631281186000},{"_id":"source/_posts/problems.md","hash":"efd652e8c7fa42f8fd4abb2efe0429e78ec99b91","modified":1631368874735},{"_id":"source/_posts/yi-yan.md","hash":"77a95b06db5a4ab25468d10457e12c1d07cf1fff","modified":1631367919945},{"_id":"themes/next/.editorconfig","hash":"8570735a8d8d034a3a175afd1dd40b39140b3e6a","modified":1631193230000},{"_id":"themes/next/.eslintrc.json","hash":"9c0762486f24a8c5e60f8b6c875e4c4728942649","modified":1631193230000},{"_id":"themes/next/.gitattributes","hash":"ec43734985e1cafd53d88ded3020103f7416123c","modified":1631193230000},{"_id":"themes/next/.gitignore","hash":"68d2f59b79fbc9edf358295ac38515c4b32126c1","modified":1631193230000},{"_id":"themes/next/.stylintrc","hash":"2cf4d637b56d8eb423f59656a11f6403aa90f550","modified":1631193230000},{"_id":"themes/next/LICENSE.md","hash":"68fc9a03d50fd4b5ea97092b05967d1819dea2c4","modified":1631193230000},{"_id":"themes/next/README.md","hash":"fab15a85d9d8d90ecd8879525b9b74fb1c197978","modified":1631193230000},{"_id":"themes/next/_vendors.yml","hash":"afdebdb0be4158c0bf0a408109a5aa42c496dffd","modified":1631193230000},{"_id":"themes/next/_config.yml","hash":"3dfd450b4c7163442427f0de8bb8235361ec36fe","modified":1631368634901},{"_id":"themes/next/crowdin.yml","hash":"e026078448c77dcdd9ef50256bb6635a8f83dca6","modified":1631193230000},{"_id":"themes/next/package.json","hash":"f41a8858849f4ac9384cb4469c5c00ad192e79d9","modified":1631193230000},{"_id":"themes/next/renovate.json","hash":"cb29cc16e61b0b8a6dac34657d76822ae29ad5aa","modified":1631193230000},{"_id":"themes/next/.githooks/pre-commit","hash":"f473eac1aaaa96c947d67988bbed140bbab1a821","modified":1631193230000},{"_id":"themes/next/.githooks/install.js","hash":"4d77dbddf2eac1f3fc78f151d12ed22208ed655b","modified":1631193230000},{"_id":"themes/next/.github/CODE_OF_CONDUCT.md","hash":"21cbff565a0445d3a880fff1ee417e309740a9ab","modified":1631193230000},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"330656d93b6c03df9fb1f2f0e3534c971969473b","modified":1631193230000},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"3e9fbb78e3dee0ca1dc886d0c28b0148ba0ca499","modified":1631193230000},{"_id":"themes/next/.github/issue_label_bot.yaml","hash":"fca600ddef6f80c5e61aeed21722d191e5606e5b","modified":1631193230000},{"_id":"themes/next/.github/config.yml","hash":"7984e665e9de481a0e0e51fca5668337713f810b","modified":1631193230000},{"_id":"themes/next/.github/release-drafter.yml","hash":"dedc56fdcd58c58fe81728754abc531691106b0c","modified":1631193230000},{"_id":"themes/next/.github/label-commenter-config.yml","hash":"1097fc47beeacfc1edb0248c27b17bf64bde3565","modified":1631193230000},{"_id":"themes/next/.github/labeler.yml","hash":"5c4bc2bd561e6d9b33ee118cc12218c5de46f72d","modified":1631193230000},{"_id":"themes/next/docs/AGPL3.md","hash":"0d2b8c5fa8a614723be0767cc3bca39c49578036","modified":1631193231000},{"_id":"themes/next/docs/LICENSE.txt","hash":"f5b14f791b7cfa1d16da981d929152e088a5d1b8","modified":1631193231000},{"_id":"themes/next/docs/AUTHORS.md","hash":"a648823121563c34a177ae91f5a774b5e29f01a0","modified":1631193231000},{"_id":"themes/next/languages/README.md","hash":"b2567e32805dda79601157351a07e5ca9fe01315","modified":1631193231000},{"_id":"themes/next/languages/ar.yml","hash":"bca66db21c015dbd32970d8708b898518a773e1e","modified":1631193231000},{"_id":"themes/next/languages/de.yml","hash":"4be7b8b76c81bf1853eb36d2e874b17546a0e792","modified":1631193231000},{"_id":"themes/next/languages/default.yml","hash":"ea5e6aee4cb14510793ac4593a3bddffe23e530c","modified":1631193231000},{"_id":"themes/next/languages/en.yml","hash":"814d81c27fed736055ee300e0a6505b26ff4313c","modified":1631193231000},{"_id":"themes/next/languages/es.yml","hash":"651e3b33d86a7cdb9fd7895ca28279f8b1a24faa","modified":1631193231000},{"_id":"themes/next/languages/fa.yml","hash":"6456d40dd42f44101d9d6e7054e9884e9163f948","modified":1631193231000},{"_id":"themes/next/languages/fr.yml","hash":"b15dc05afdc94de02e5d3fee4f8d3dc5594dd37e","modified":1631193231000},{"_id":"themes/next/languages/id.yml","hash":"14e794db4eca36b257994d81eb513e61d1edcbd6","modified":1631193231000},{"_id":"themes/next/languages/it.yml","hash":"c1eeab4992c76bfd436bb205ce58b1cfeef55ee6","modified":1631193231000},{"_id":"themes/next/languages/ja.yml","hash":"d48c4157e0e02e847aac7b513580d3364c81948c","modified":1631193231000},{"_id":"themes/next/languages/ko.yml","hash":"6387357ac2dd498e8b8d630d27050a59180d7e8f","modified":1631193231000},{"_id":"themes/next/languages/nl.yml","hash":"ecb8e39c6225f3c068a5fdd569ee7dafd5c41a1f","modified":1631193231000},{"_id":"themes/next/languages/pt-BR.yml","hash":"a1f27b3a592fc58f17d247f5563ff4a90a3da5f2","modified":1631193231000},{"_id":"themes/next/languages/pt.yml","hash":"63a3e1e728ba5e6e22150de7331bb8a654f34960","modified":1631193231000},{"_id":"themes/next/languages/ru.yml","hash":"e9af1afe529ca747a04b801401d394b2ad696fde","modified":1631193231000},{"_id":"themes/next/languages/si.yml","hash":"615d18d044f44df476d6bfbf73f7b0edc2632168","modified":1631193232000},{"_id":"themes/next/languages/tr.yml","hash":"0bebba73d6f06c7dad61f80c0d7ad5f6f1791a01","modified":1631193232000},{"_id":"themes/next/languages/uk.yml","hash":"7dd24580c0865c5a7bc4d391855045366a598936","modified":1631193232000},{"_id":"themes/next/languages/vi.yml","hash":"c669c34da544a563ceae3e196addc9df6a78e024","modified":1631193232000},{"_id":"themes/next/languages/zh-CN.yml","hash":"fca412bd903e1b59a99dbb5f50165285897bddcc","modified":1631365909473},{"_id":"themes/next/languages/zh-HK.yml","hash":"f195bb0502ffe66e850077a1af1033455ea65f93","modified":1631193232000},{"_id":"themes/next/languages/zh-TW.yml","hash":"92256b90028de9a1e79c6bc0e5885b93e7fb4b17","modified":1631193232000},{"_id":"themes/next/layout/_layout.njk","hash":"20e4160cd0deb4fa272cc3aed0f43520b3cf4a9c","modified":1631193232000},{"_id":"themes/next/layout/archive.njk","hash":"d759f4d2cf5ddc6875ea250113a00662c1caf6d1","modified":1631193232000},{"_id":"themes/next/layout/category.njk","hash":"0a590e87af50e57b15fc37695c9a3bf4a97c3d92","modified":1631193232000},{"_id":"themes/next/layout/index.njk","hash":"37ec3d1bcd20b8ac1d18e0d68f990450890b46cd","modified":1631193232000},{"_id":"themes/next/layout/page.njk","hash":"9cd3eca2c468bb46c7c5bf391bea4b025af178f6","modified":1631193232000},{"_id":"themes/next/layout/post.njk","hash":"6abeb85fb3e4c382ed4bb6049b12a807e6226e67","modified":1631193232000},{"_id":"themes/next/layout/tag.njk","hash":"6cd707f846bfd6becbcfb060c26958bb4015c31f","modified":1631193232000},{"_id":"themes/next/test/index.js","hash":"6bf0289846538be3e9a63809af98f00e1fbdd90b","modified":1631193238000},{"_id":"themes/next/.github/ISSUE_TEMPLATE/bug-report.md","hash":"fc4dce84ed9a5d21d3a8833ff6d776c46f876115","modified":1631193231000},{"_id":"themes/next/.github/ISSUE_TEMPLATE/config.yml","hash":"c40ae7903b6cc99f94c9d45ac7ba8c2850bb1309","modified":1631193231000},{"_id":"themes/next/.github/ISSUE_TEMPLATE/feature-request.md","hash":"4ecac91716eac59d7c2bc53cf6e95612d44da97b","modified":1631193231000},{"_id":"themes/next/.github/ISSUE_TEMPLATE/other.md","hash":"8cc5b5c116f6a052865a324512362f145d699202","modified":1631193231000},{"_id":"themes/next/.github/workflows/label-commenter.yml","hash":"44405477660289d4ed9beba1d054b15bb67bba06","modified":1631193231000},{"_id":"themes/next/.github/workflows/labeler.yml","hash":"8b73c439dc796be141d521a4546bcfb7a5485534","modified":1631193231000},{"_id":"themes/next/.github/workflows/linter.yml","hash":"276a91c7179926f410c784c99fa635dc0a016c2d","modified":1631193231000},{"_id":"themes/next/.github/workflows/lock.yml","hash":"70bd0be3f33774e4b0ada3a59c901f8f9cff1013","modified":1631193231000},{"_id":"themes/next/.github/workflows/release-drafter.yml","hash":"4f3af81009cb922be91f718a67425377515ea69d","modified":1631193231000},{"_id":"themes/next/.github/workflows/stale.yml","hash":"0feb3e1afd1b2dca9dbc7811ce4cf5520e2d186c","modified":1631193231000},{"_id":"themes/next/.github/workflows/tester.yml","hash":"22aaaa3eba1a7ebcf0f78417fd9a7113ee7b6c6c","modified":1631193231000},{"_id":"themes/next/docs/ru/README.md","hash":"87edab5a3eb7577a409c01df3f1631de40f8956f","modified":1631193231000},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"7a06d443f374bd1e84294067a0ac796afd9fbe60","modified":1631193231000},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"a089f7a8368ab0b7d7b9b7ec0ac3767a453435df","modified":1631193231000},{"_id":"themes/next/docs/zh-CN/README.md","hash":"02bafc6ee86263790603861e356596f0c916e392","modified":1631193231000},{"_id":"themes/next/layout/_macro/post-collapse.njk","hash":"1a30d751871dabfa80940042ddb1f77d07d830b9","modified":1631193232000},{"_id":"themes/next/layout/_macro/post.njk","hash":"b106599106285ecd4c0c1e0ed11c46a36b5a69d5","modified":1631193232000},{"_id":"themes/next/layout/_macro/sidebar.njk","hash":"a20ed899d6a797de0b35c46bfd03722023649187","modified":1631193232000},{"_id":"themes/next/layout/_partials/comments.njk","hash":"c12f8a7497596441503f2541d2f746f2ee7dd594","modified":1631193232000},{"_id":"themes/next/layout/_partials/footer.njk","hash":"19713f472972caac33ae5fbcfe9105da61257de4","modified":1631193232000},{"_id":"themes/next/layout/_partials/languages.njk","hash":"e43f22198cccb5f6e306b1ce0d28d12a4fb891f8","modified":1631193232000},{"_id":"themes/next/layout/_partials/pagination.njk","hash":"9876dbfc15713c7a47d4bcaa301f4757bd978269","modified":1631193232000},{"_id":"themes/next/layout/_partials/widgets.njk","hash":"852a750524decf1efa587cd52b09e387ed8315de","modified":1631193232000},{"_id":"themes/next/layout/_scripts/index.njk","hash":"6668878a0f9a1166c6a879755f54a08d942da870","modified":1631193233000},{"_id":"themes/next/layout/_scripts/vendors.njk","hash":"be80b9fe415a9a09d74c28e230995fd292dfc123","modified":1631193233000},{"_id":"themes/next/layout/_third-party/index.njk","hash":"3221ebcb2f308659ed1a86d1d53978aa62576958","modified":1631193233000},{"_id":"themes/next/layout/_third-party/fancybox.njk","hash":"844559f46e2ff1c8be234d5763703106e2072a7b","modified":1631193233000},{"_id":"themes/next/layout/_third-party/quicklink.njk","hash":"0efed71ed530447718c4ea5bbd5fc8695b0b0d5f","modified":1631193233000},{"_id":"themes/next/layout/_third-party/rating.njk","hash":"1bcdbc7fde26d6d9ef4e7fa43ffcff5a9506b20e","modified":1631193233000},{"_id":"themes/next/scripts/events/index.js","hash":"89091bc943cd8b8c63b8af3d26fb0a027048e9ba","modified":1631193233000},{"_id":"themes/next/scripts/filters/default-injects.js","hash":"872f01cb10e422a648ea505436532e776e92926b","modified":1631193234000},{"_id":"themes/next/scripts/filters/locals.js","hash":"0cd7da6755459d60779f0a7ccf311e26e184d55d","modified":1631193234000},{"_id":"themes/next/scripts/filters/minify.js","hash":"7dc9e9366a19dc3c7be7ff482fbd19c88e620bf5","modified":1631193234000},{"_id":"themes/next/scripts/filters/post.js","hash":"42a9b81c5449afa9d67770604478168333c93804","modified":1631193234000},{"_id":"themes/next/scripts/helpers/font.js","hash":"3394185a7f0393c16ce52c8028f90da3e9239c55","modified":1631193234000},{"_id":"themes/next/scripts/helpers/engine.js","hash":"b9785bc737470e9b8e910e7da9e8c45c2ead58fa","modified":1631193234000},{"_id":"themes/next/scripts/helpers/next-config.js","hash":"3850424dbb23ca0791b35695e24804492d89f925","modified":1631193234000},{"_id":"themes/next/scripts/helpers/next-url.js","hash":"a11b71ba0c5012e2cdcab31c15439156b215563e","modified":1631193234000},{"_id":"themes/next/scripts/helpers/next-vendors.js","hash":"afdd6a188a74c188f0dd154fac70efd4080ca262","modified":1631193234000},{"_id":"themes/next/scripts/tags/button.js","hash":"c6ad2ed544fbb25ecb5d820c36e76302504271b7","modified":1631193234000},{"_id":"themes/next/scripts/tags/caniuse.js","hash":"935a311142a409c1896b3ae3f01fe7a9e2db1134","modified":1631193234000},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"79102d9e9bccff6224e77a77c4d2d363094ae3df","modified":1631193234000},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"92c19d796bdb3320df9caea59bf52df7a95d9da9","modified":1631193234000},{"_id":"themes/next/scripts/tags/index.js","hash":"17f9451ce1f10f78437f52218757d38d4e1591b0","modified":1631193234000},{"_id":"themes/next/scripts/tags/link-grid.js","hash":"18a483c2d5afd701f6080ffdddf2d1321370336c","modified":1631193234000},{"_id":"themes/next/scripts/tags/label.js","hash":"8a73348186113bae0a51ea2f891c1bb882fab05a","modified":1631193234000},{"_id":"themes/next/scripts/tags/mermaid.js","hash":"4fb01ca650fa8b256b8d48f50dc1b18350bd3d6d","modified":1631193234000},{"_id":"themes/next/scripts/tags/pdf.js","hash":"344636b6fd7e27e8831c1e194039afc0d61931cd","modified":1631193234000},{"_id":"themes/next/scripts/tags/note.js","hash":"7b94ddb46b7d4b0fe815f2fbe4bd375f07f55363","modified":1631193234000},{"_id":"themes/next/scripts/tags/tabs.js","hash":"0eabe51da40b4b13e16419c8fe02452d9a4fef73","modified":1631193234000},{"_id":"themes/next/scripts/tags/video.js","hash":"2ee926448583be8f95af1f2884ae2c9c4830151d","modified":1631193234000},{"_id":"themes/next/source/css/_colors.styl","hash":"b37f9847d2f95632e911df670b51921a7d748068","modified":1631193234000},{"_id":"themes/next/source/css/_mixins.styl","hash":"acef5acc728f24cb657be8d7010d836b4d556b0e","modified":1631193234000},{"_id":"themes/next/source/css/main.styl","hash":"78ce791cc4ac95386cf6839ca72f5f7b51f86ee9","modified":1631193235000},{"_id":"themes/next/source/css/noscript.styl","hash":"76bba5d7916e9930e68215a0fce3a7d81c44510f","modified":1631193235000},{"_id":"themes/next/source/images/android-chrome-192x192.png","hash":"70f5e754238a5e6e43737a246e245645e449866d","modified":1631262602000},{"_id":"themes/next/source/images/apple-touch-icon.png","hash":"41e20d1bcc0b024c4febb4a167c0b3bae786533d","modified":1631262547000},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1631193237000},{"_id":"themes/next/source/images/avatar.gif","hash":"2dbc3e2f2d624b2ca1afe6edc2ca17307f1950c8","modified":1631193237000},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1631193237000},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1631193237000},{"_id":"themes/next/source/images/favicon-16x16.png","hash":"402e199ec5e50b4946915763cedd17b87caa3942","modified":1631262547000},{"_id":"themes/next/source/images/favicon-32x32.png","hash":"6214cb02754f6c94fcb79bb9e936d3231320d1e9","modified":1631262547000},{"_id":"themes/next/source/images/logo-algolia-nebula-blue-full.svg","hash":"b85e274207b1392782476a0430feac98db1e7da0","modified":1631193237000},{"_id":"themes/next/source/images/logo.svg","hash":"2cb74fd3ea2635e015eabc58a8d488aed6cf6417","modified":1631193237000},{"_id":"themes/next/source/images/manifest.json","hash":"e1723dd9813b4f2df2da91f834ff644578649cc1","modified":1631262547000},{"_id":"themes/next/source/images/safari-pinned-tab.svg","hash":"caac31677d5a20d151b2e19906b3ce440aac7bfd","modified":1631262547000},{"_id":"themes/next/source/js/bookmark.js","hash":"0f563ffbf05fad30e854e413ab17ff7164ab5a53","modified":1631193237000},{"_id":"themes/next/source/js/comments-buttons.js","hash":"1a7344440321713426a0b2ab17e276b5bdf85ade","modified":1631193237000},{"_id":"themes/next/source/js/config.js","hash":"4c4ebbe3b3f3841a26f9d5af6d0ba8bc6da01c54","modified":1631193237000},{"_id":"themes/next/source/js/comments.js","hash":"66ae2e26ea36a41b72c638ea8b220296638ae952","modified":1631193237000},{"_id":"themes/next/source/js/motion.js","hash":"6d4bd07a6f8e1b4083119dca0acb5b289533b619","modified":1631193237000},{"_id":"themes/next/source/js/next-boot.js","hash":"b1d24dc9ebc2a3b4a4c5a4f737de2f8ef126cfa9","modified":1631193237000},{"_id":"themes/next/source/js/pjax.js","hash":"5bfc1cea214bd31847adc356f37df8e0b6a449df","modified":1631193237000},{"_id":"themes/next/source/js/schedule.js","hash":"71d62fc3584c47ff2d4cc945226e412264399be9","modified":1631193237000},{"_id":"themes/next/source/js/utils.js","hash":"a4d42422119a0dacad426f033ea3aaf4e3cf339b","modified":1631193237000},{"_id":"themes/next/test/helpers/font.js","hash":"342ef3c6fd2dcca2a8802a516ed6d7f389fd2ca2","modified":1631193238000},{"_id":"themes/next/test/helpers/index.js","hash":"63ba28afed697f7b3574436b1133b8ecc9c0c357","modified":1631193238000},{"_id":"themes/next/test/helpers/next-url.js","hash":"a91d880cb75e0a8e65a7be4c7362b2c8ebfb7c4f","modified":1631193238000},{"_id":"themes/next/test/tags/button.js","hash":"48f2aa4c513e9e24bd6a811410520b74cd7ea88b","modified":1631193238000},{"_id":"themes/next/test/tags/caniuse.js","hash":"aa5e728445caeaf7c2ccd0f3fcb2cad0c93ca6d1","modified":1631193238000},{"_id":"themes/next/test/tags/center-quote.js","hash":"7667342fd1a1417eaf6a254012b84ae40e8d13dd","modified":1631193238000},{"_id":"themes/next/test/tags/group-pictures.js","hash":"f41640e5d0f552c0b0c4ac8876a2edb0fcf54e56","modified":1631193238000},{"_id":"themes/next/test/tags/index.js","hash":"e8779e54f0979b221858f8bb74dd081bb503b910","modified":1631193238000},{"_id":"themes/next/test/tags/label.js","hash":"4ebf3698c258ca978b997acbdd0dece44069c09d","modified":1631193238000},{"_id":"themes/next/test/tags/link-grid.js","hash":"43d298fafb7c45a874b766d443843bd26346e689","modified":1631193238000},{"_id":"themes/next/test/tags/mermaid.js","hash":"ab77be5f3c6d9a57c7b9dda6decf1906a736fef9","modified":1631193238000},{"_id":"themes/next/test/tags/pdf.js","hash":"fd6ea5123560a90f7e7c1eface23dbe1455db25f","modified":1631193238000},{"_id":"themes/next/test/tags/note.js","hash":"3dcfcd65bf9f326972ea7571fdb1444200f5d07e","modified":1631193238000},{"_id":"themes/next/test/tags/tabs.js","hash":"d63722919f9da2e44d6b952801e10a2915ea9c12","modified":1631193238000},{"_id":"themes/next/test/tags/video.js","hash":"b796fc4dceb20a30e730c322bb5474c0162464cc","modified":1631193238000},{"_id":"themes/next/test/validate/index.js","hash":"5a95ccc8598667535bd022e988055c0e019f3670","modified":1631193238000},{"_id":"themes/next/layout/_partials/head/head-unique.njk","hash":"49aa8de07918a11399131dfd703418af3f0a1a19","modified":1631193232000},{"_id":"themes/next/layout/_partials/head/head.njk","hash":"8ed5ab7ec63f9fd5438d1c497cc5f50ae11fcfdf","modified":1631193232000},{"_id":"themes/next/layout/_partials/header/brand.njk","hash":"ffb6c69a9c90793cbe9bf0544b55f7a41c016d8f","modified":1631193232000},{"_id":"themes/next/layout/_partials/header/index.njk","hash":"53895b3af95667edc5bf5d7356f8a2b4fe091447","modified":1631193232000},{"_id":"themes/next/layout/_partials/header/menu-item.njk","hash":"b46f412c0b4f775fd329d50357f722f5d7c1a3ba","modified":1631193232000},{"_id":"themes/next/layout/_partials/header/menu.njk","hash":"c9390824b57f23b7c8a5c23a9834514123673766","modified":1631193232000},{"_id":"themes/next/layout/_partials/header/sub-menu.njk","hash":"75a158a5b54a3a76ee6590f5e0e2dd4a9f0be869","modified":1631193232000},{"_id":"themes/next/layout/_partials/page/breadcrumb.njk","hash":"edb3bb6d644b7407673c5ef3a426a244e98fcf89","modified":1631193232000},{"_id":"themes/next/layout/_partials/page/categories.njk","hash":"17156d99941f28a225951ffdcfa9a115e20dc2d2","modified":1631193232000},{"_id":"themes/next/layout/_partials/page/page-header.njk","hash":"7ed4f102a1825195cff8d7995bf9219f323a9034","modified":1631193232000},{"_id":"themes/next/layout/_partials/page/tags.njk","hash":"a18d1598e36cc72f2b0b24c3cc3c5990dfaa3254","modified":1631193232000},{"_id":"themes/next/layout/_partials/page/schedule.njk","hash":"ca2ccf3cf1874c45712f192ad45dea96fbd9920d","modified":1631193232000},{"_id":"themes/next/layout/_partials/search/algolia-search.njk","hash":"efb2b6f19df02ba5ae623a1f274fff52aed21e6f","modified":1631193233000},{"_id":"themes/next/layout/_partials/search/index.njk","hash":"8f6f256ab3b351ffc80f1f3f1d9834e9a7cfac31","modified":1631193233000},{"_id":"themes/next/layout/_partials/search/localsearch.njk","hash":"661f7acae43f0be694266323320f977d84119abe","modified":1631193233000},{"_id":"themes/next/layout/_partials/post/post-copyright.njk","hash":"133942922e34abae9e4de7ea5591d77c0caa4b37","modified":1631193232000},{"_id":"themes/next/layout/_partials/post/post-followme.njk","hash":"154df0bb323c332d8c25343f258ee865e5553423","modified":1631193232000},{"_id":"themes/next/layout/_partials/post/post-footer.njk","hash":"8f14f3f8a1b2998d5114cc56b680fb5c419a6b07","modified":1631193232000},{"_id":"themes/next/layout/_partials/post/post-meta.njk","hash":"471dcbe22d0dbe043dcf25a1a1c17ca76aa9a548","modified":1631193232000},{"_id":"themes/next/layout/_partials/post/post-related.njk","hash":"7384e6390067ef2a84e7310d6adb3f6104ed62e2","modified":1631193233000},{"_id":"themes/next/layout/_partials/post/post-reward.njk","hash":"002b51d0cae3f2e2e008bdc58be90c728282de5b","modified":1631193233000},{"_id":"themes/next/layout/_partials/sidebar/site-overview.njk","hash":"5c01e380ba843f8016d8fa4593432430f5bd3584","modified":1631193233000},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.njk","hash":"6215309aee028dcb734452beec448c5afb6c63fc","modified":1631193233000},{"_id":"themes/next/layout/_third-party/analytics/cloudflare.njk","hash":"c978e9efd472c4825f93b83524b11f1c4f7efaab","modified":1631193233000},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.njk","hash":"d89066ff53879693f023e540d59c86137172c529","modified":1631193233000},{"_id":"themes/next/layout/_third-party/analytics/growingio.njk","hash":"8afaa772c390bd9d53a5cff9645ac3168334eb98","modified":1631193233000},{"_id":"themes/next/layout/_third-party/analytics/index.njk","hash":"2d36a481a70d5f450f1f166dc556ac1218b18537","modified":1631193233000},{"_id":"themes/next/layout/_third-party/comments/changyan.njk","hash":"d1c950f8fbdf85e7a3eae5463767a89e858e8220","modified":1631193233000},{"_id":"themes/next/layout/_third-party/comments/disqus.njk","hash":"9375b19a89b7fa9474e558d085af5448d4c5c50c","modified":1631193233000},{"_id":"themes/next/layout/_third-party/comments/disqusjs.njk","hash":"0749cb6902baecdfd01f779a2a2513f6d2f6a823","modified":1631193233000},{"_id":"themes/next/layout/_third-party/comments/gitalk.njk","hash":"b63b7e2ede0d3e66e732fa1a06bda9b19e1e85d4","modified":1631193233000},{"_id":"themes/next/layout/_third-party/comments/isso.njk","hash":"64cc3bdaf644fd32c0d0a247f29f5b6904da9af3","modified":1631193233000},{"_id":"themes/next/layout/_third-party/comments/utterances.njk","hash":"5a94032bc3512a10ad4328fc19ec07b819a1d687","modified":1631193233000},{"_id":"themes/next/layout/_third-party/comments/livere.njk","hash":"3b13b09fba84ec6000886890a6710736a2b8fafe","modified":1631193233000},{"_id":"themes/next/layout/_third-party/chat/chatra.njk","hash":"d7263fca16d0278ccf1f6aa1c6df6902a6344a09","modified":1631193233000},{"_id":"themes/next/layout/_third-party/chat/gitter.njk","hash":"f8cc14b7aa949999a1faaeb7855e2f20b59a386d","modified":1631193233000},{"_id":"themes/next/layout/_third-party/chat/tidio.njk","hash":"02aab857c27fc103216029be991688b12a73a525","modified":1631193233000},{"_id":"themes/next/layout/_third-party/math/index.njk","hash":"abf37fc55aa86702118e8fdf5bf2d389dd589aa0","modified":1631193233000},{"_id":"themes/next/layout/_third-party/math/katex.njk","hash":"d82c24136bbd3443b85f07f5579845833b594684","modified":1631193233000},{"_id":"themes/next/layout/_third-party/math/mathjax.njk","hash":"3677017fd4572b158311f5f5d870590ab25184e0","modified":1631193233000},{"_id":"themes/next/layout/_third-party/search/algolia-search.njk","hash":"24ed76e0c72a25ac152820c750a05826a706b6f4","modified":1631193233000},{"_id":"themes/next/layout/_third-party/search/localsearch.njk","hash":"3fc91aba5b17a5ae60b8e04707a7da87db4d0340","modified":1631193233000},{"_id":"themes/next/layout/_third-party/tags/mermaid.njk","hash":"099e031f52fb8e47b3af5b2684737efc9e643ee7","modified":1631193233000},{"_id":"themes/next/layout/_third-party/tags/pdf.njk","hash":"2c81984cc4f5123103460442f6e046f5b6c97127","modified":1631193233000},{"_id":"themes/next/layout/_third-party/statistics/busuanzi-counter.njk","hash":"a4bc501da0f22f7e420f0ca47e83988ce90b1368","modified":1631193233000},{"_id":"themes/next/layout/_third-party/statistics/firestore.njk","hash":"d32ebe94560fa95824478ebbff531bffc47b194d","modified":1631193233000},{"_id":"themes/next/layout/_third-party/statistics/index.njk","hash":"568ddf7955d11d93fb5e842b403a7ac8b1b7fdb1","modified":1631193233000},{"_id":"themes/next/layout/_third-party/statistics/lean-analytics.njk","hash":"2446e748cdc102c78492216319ac02148db7daf6","modified":1631193233000},{"_id":"themes/next/scripts/events/lib/config.js","hash":"92ab6bb3c3122980699f0613dac27a7cabfedecc","modified":1631193234000},{"_id":"themes/next/scripts/events/lib/highlight.js","hash":"6aec7b2c38c50989a23bfaa0d560e75c7f553e12","modified":1631193234000},{"_id":"themes/next/scripts/events/lib/injects.js","hash":"d987709267a1bc6e5014411e9983d7c49c102c16","modified":1631193234000},{"_id":"themes/next/scripts/events/lib/utils.js","hash":"b281be775b693f9bf32766c8f6ef703c72ac9b00","modified":1631193234000},{"_id":"themes/next/scripts/events/lib/vendors.js","hash":"08dac57e15c9f06c7cf54884b045f2362595f9d2","modified":1631193234000},{"_id":"themes/next/scripts/filters/comment/changyan.js","hash":"aa05e6b3d613a756178b8ba06832ad27499d4c14","modified":1631193234000},{"_id":"themes/next/scripts/filters/comment/common.js","hash":"2486f3e0150c753e5f3af1a3665d074704b8ee2c","modified":1631193234000},{"_id":"themes/next/scripts/filters/comment/default-config.js","hash":"93ee5f9109dad885dc38c49bcee630c10f9dce6e","modified":1631193234000},{"_id":"themes/next/scripts/filters/comment/disqus.js","hash":"7f71d6b271ba65ff333d5682e7575711d368c0d2","modified":1631193234000},{"_id":"themes/next/scripts/filters/comment/disqusjs.js","hash":"135b87d151055eefdbc711d9e704b112b3214a84","modified":1631193234000},{"_id":"themes/next/scripts/filters/comment/gitalk.js","hash":"7bb7dafdd7f6bca8464b54e17e552ce7f1714195","modified":1631193234000},{"_id":"themes/next/scripts/filters/comment/isso.js","hash":"ff8b5b5145220a17d0ecd9508ba9bd2d3b2da47d","modified":1631193234000},{"_id":"themes/next/scripts/filters/comment/livere.js","hash":"5a07d8bb52bc1d51a624ca8db54be144566c306b","modified":1631193234000},{"_id":"themes/next/scripts/filters/comment/utterances.js","hash":"d3bded697bc32dace689d2a6dfb6eb7514169d15","modified":1631193234000},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"96e0a7c2a65ce68215e17e369085b2ea2f1334f2","modified":1631193237000},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"e1fbf169b9b6a194b518240cbd06ec3c48b83d61","modified":1631193237000},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"e3be898f5ebcf435a26542653a9297ff2c71aeb0","modified":1631193237000},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"c65536a128b9bc9dbe2fbb1b235a3cded2891002","modified":1631193237000},{"_id":"themes/next/source/css/_variables/base.styl","hash":"32a1b73944561655087d80f025208a84e012b3cf","modified":1631193237000},{"_id":"themes/next/source/js/schemes/muse.js","hash":"62f4638674c92dfb72454fee38751d0227d3d225","modified":1631193237000},{"_id":"themes/next/source/js/third-party/fancybox.js","hash":"c098d14e65dd170537134358d4b8359ad0539c2c","modified":1631193237000},{"_id":"themes/next/source/js/third-party/quicklink.js","hash":"6f58cd7aa8f6f1ab92d5a96551add293f4e55312","modified":1631193237000},{"_id":"themes/next/source/js/third-party/rating.js","hash":"4e92c2d107ba47b47826829f9668030d5ea9bfb8","modified":1631193237000},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"d4809783ded05625675b1b4bbd9e99d7f5f7d7f9","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"ece860218125bdb2578f373ed4f5040c9670e4b1","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/index.styl","hash":"3c7ae405dd30b9b46494a6b9a6cb1b7ec6138ba9","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/reading-progress.styl","hash":"2a29bf3692f42f84e8f29314e0fb349f86fc727a","modified":1631193235000},{"_id":"themes/next/source/css/_common/outline/index.styl","hash":"0c9f72ad98807521cbdcee7b5bbe2e884311db39","modified":1631193235000},{"_id":"themes/next/source/css/_common/outline/mobile.styl","hash":"aafbb3c5c20f525a92716d89ff216c3081d7b4da","modified":1631193235000},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"2e58cb90a77d3dd16e02b8949808b4b16453828c","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/buttons.styl","hash":"a042571d85ff7265f799004239a45f36b716b8a6","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/comments.styl","hash":"e4fecc889ba3317a64e9abba5842c79dff9b7827","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/index.styl","hash":"523fb7b653b87ae37fc91fc8813e4ffad87b0d7e","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"b56367ea676ea8e8783ea89cd4ab150c7da7a060","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/pagination.styl","hash":"41cba8c4c5637a6b8f1b62e67673b33676f5d734","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"e840b23d33023e6d45e018f6e84b683dd56efd8d","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/toggles.styl","hash":"572a41499391677d84b16d8dbd6a996a3d5ce041","modified":1631193236000},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"fd49b521d67eaccc629f77b4e095cb7310327565","modified":1631193236000},{"_id":"themes/next/source/css/_schemes/Mist/_layout.styl","hash":"5604ac1e161099a4d3e5657d53507268866dc717","modified":1631193236000},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"4817e77577896ab5c0da434549917ee703a3f4cf","modified":1631193236000},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"357b899ac0f0dfbbbebf1ea972030c7cefa463ce","modified":1631193236000},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expand.styl","hash":"b332868d76d9f1651efd65abfc0d3c9d699b1a45","modified":1631193236000},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"ab16a3dcdc0393b9b582ef59dcc13db9320e917c","modified":1631193236000},{"_id":"themes/next/source/css/_schemes/Muse/_header.styl","hash":"06080fd963c904d96c00eff098a284e337953013","modified":1631193236000},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"8a70d51d8f7cd113e5fbc9f0e70c46a072f282c8","modified":1631193236000},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"82a29572dd90451f75358a2ee2522b87304a0bb8","modified":1631193236000},{"_id":"themes/next/source/css/_schemes/Muse/_sidebar.styl","hash":"944364893bd7160d954c10ba931af641c91515a4","modified":1631193236000},{"_id":"themes/next/source/css/_schemes/Muse/_sub-menu.styl","hash":"c48ccd8d6651fe1a01faff8f01179456d39ba9b1","modified":1631193236000},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"6ad168288b213cec357e9b5a97674ff2ef3a910c","modified":1631193237000},{"_id":"themes/next/source/css/_schemes/Pisces/_header.styl","hash":"be5c46b983df08b9dbac1b4749b1a101b54b6b50","modified":1631193237000},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"6eee86c8f0175d6c09e434053516cd8556f78d44","modified":1631193237000},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"72dc825c50357402c342d62ab60fc0c478ab6bc1","modified":1631193237000},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"d9141e6e14a56b5952488101e9a8388c2170e270","modified":1631193237000},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"778ed2ad5643b93970c95626b325defeb586733f","modified":1631193237000},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"8000075b227749a7495eaf417cac6ccfbe441580","modified":1631193237000},{"_id":"themes/next/source/js/third-party/analytics/google-analytics.js","hash":"59684383385059dc4f8a1ff85dbbeb703bcdbcb5","modified":1631193237000},{"_id":"themes/next/source/js/third-party/analytics/baidu-analytics.js","hash":"f629acc46ff40c071ffd31b77d5c7616f0fdd778","modified":1631193237000},{"_id":"themes/next/source/js/third-party/analytics/growingio.js","hash":"78dd3cf04082b7dbe6246e404b2aa8e726922402","modified":1631193237000},{"_id":"themes/next/source/js/third-party/chat/gitter.js","hash":"cc38c94125f90dadde11b5ebac7d8bf99a1a08a2","modified":1631193237000},{"_id":"themes/next/source/js/third-party/chat/chatra.js","hash":"c32180522788c10e51df1803aa6842ef0432ddc9","modified":1631193237000},{"_id":"themes/next/source/js/third-party/chat/tidio.js","hash":"b0079f6a4601e06ca6fe46e83a2f5af553e9bc3c","modified":1631193237000},{"_id":"themes/next/source/js/third-party/comments/changyan.js","hash":"8c8ebec444c727b704ea41ad88b0b96ed2e4b8d4","modified":1631193238000},{"_id":"themes/next/source/js/third-party/comments/disqusjs.js","hash":"b6c58f098473b526d6a3cd35655caf34b77f7cff","modified":1631193238000},{"_id":"themes/next/source/js/third-party/comments/disqus.js","hash":"e1cc671b0d524864fd445e3ab4ade9ee6d07e565","modified":1631193238000},{"_id":"themes/next/source/js/third-party/comments/gitalk.js","hash":"0ec038cf83e8ec067534f16a54041e47a3c1e59a","modified":1631193238000},{"_id":"themes/next/source/js/third-party/comments/livere.js","hash":"2247d88c934c765c43013337860774aaa99f0b31","modified":1631193238000},{"_id":"themes/next/source/js/third-party/comments/isso.js","hash":"753a873b6f566aff5ba77ca23f91b78eb880ca64","modified":1631193238000},{"_id":"themes/next/source/js/third-party/comments/utterances.js","hash":"f67f90eb03e284c82da2b8cf2f1e31801813c16d","modified":1631193238000},{"_id":"themes/next/source/js/third-party/math/katex.js","hash":"83c54ee536e487a1031783443fe0cb63b1b4767e","modified":1631193238000},{"_id":"themes/next/source/js/third-party/math/mathjax.js","hash":"5c749b9c1c3bb738122d0516211ecff6496d4907","modified":1631193238000},{"_id":"themes/next/source/js/third-party/search/local-search.js","hash":"b37f1b14aef2402d0c2d88f999ff0ce5ef6823c1","modified":1631193238000},{"_id":"themes/next/source/js/third-party/search/algolia-search.js","hash":"ac401e3736d56a3c9cb85ab885744cce0b813c55","modified":1631193238000},{"_id":"themes/next/source/js/third-party/statistics/firestore.js","hash":"0960f16107ed61452fb0dffc6ed22dc143de34ef","modified":1631193238000},{"_id":"themes/next/source/js/third-party/statistics/lean-analytics.js","hash":"5a928990856b8e456f0663cf3b6b406733672e39","modified":1631193238000},{"_id":"themes/next/source/js/third-party/tags/mermaid.js","hash":"aafb764c64f6cd5a48ad194adf65ac77078242b1","modified":1631193238000},{"_id":"themes/next/source/js/third-party/tags/pdf.js","hash":"af78c22f0e61c8c8aa8794e585e0d632c6d4fcb8","modified":1631193238000},{"_id":"themes/next/source/css/_common/components/post/index.styl","hash":"b3fa752f72ca1413289b76c56fbd33a00e3d25d7","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"ec37a36e94ba791663607a5022f763915778578f","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/post/post-followme.styl","hash":"76d0dfb3a8b873a6180604ac6daecf38b6a963a2","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/post/post-body.styl","hash":"ea351936d71e0b6259febac3d7d56d1be6927bf9","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/post/post-footer.styl","hash":"1d284f3ea03ba9b4feb76b375e539a8e0bccf1c3","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"9ac6f477177264c26a46e8333b8456720a0444dc","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/post/post-header.styl","hash":"bef7791a2e67e79f02076f2a89e1c7f95a83048c","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"aa366d37389760c8595529b850f461569577a1c5","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"5b5649b9749e3fd8b63aef22ceeece0a6e1df605","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"07cff69f2d57e6321595f64c16d8b763dc88df6a","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"8afdc311c6b8db121758371f95cf1c5e77354f42","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"b6e2eb1550a7845cb2adf86081a4ab6c7bde1e68","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/pages/tag-cloud.styl","hash":"1a81d1a71fcf0699629ce6e72dfd0a15f3a2dd0a","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/pages/index.styl","hash":"7504dbc5c70262b048143b2c37d2b5aa2809afa2","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"6b816c2511242ee503fb5f34cd3e4dcdafc06b85","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/third-party/gitalk.styl","hash":"7102f8e819b62cf7d121fd063dc663fd068feaa6","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/third-party/index.styl","hash":"b457756758f0632767e8a560e3033059cbe4a67b","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/third-party/math.styl","hash":"83c6588c51cd418336f4945813410a100ddfe2a4","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/third-party/search.styl","hash":"2896840ab8ac8ab2a7f76d18df893f290ac31625","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/third-party/related-posts.styl","hash":"2c534d2b2dbc932ad65d335a720a7ba9612bac04","modified":1631193235000},{"_id":"themes/next/source/css/_common/components/third-party/utterances.styl","hash":"bf88d9c585d7b00463c46352402cfea415c29493","modified":1631193235000},{"_id":"themes/next/source/css/_common/outline/footer/index.styl","hash":"5a4e5ed613f3990378f3f632e8f16b33374e0095","modified":1631193235000},{"_id":"themes/next/source/css/_common/outline/header/bookmark.styl","hash":"d6d60f02b5e9f89dbfce180b3884030898022664","modified":1631193235000},{"_id":"themes/next/source/css/_common/outline/header/github-banner.styl","hash":"cf194bea1c9e67fde871a04de3bc81df72c54277","modified":1631193235000},{"_id":"themes/next/source/css/_common/outline/header/index.styl","hash":"f1778d2c56974b96dae429456d5c55be325c4946","modified":1631193235000},{"_id":"themes/next/source/css/_common/outline/header/menu.styl","hash":"392fd53a8dd4e3f33a853ebb24290a622300e0ff","modified":1631193235000},{"_id":"themes/next/source/css/_common/outline/header/site-meta.styl","hash":"9a47c9045e443b8d20932f9c564a3a05fa4c6b51","modified":1631193235000},{"_id":"themes/next/source/css/_common/outline/header/site-nav.styl","hash":"bf3ad8b4268f763a1e26377681644887694bc009","modified":1631193235000},{"_id":"themes/next/source/css/_common/outline/sidebar/index.styl","hash":"eae7b83f1c711ad2ab3a41d89f517445856ffec8","modified":1631193235000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author-links.styl","hash":"52fc98b1435129eb3edb9293ced9e507741f1350","modified":1631193236000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author.styl","hash":"5b38ac4a0f1ade0e681aff0e3366c481d9cf3dcd","modified":1631193236000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-blogroll.styl","hash":"9950c3188a28e1c63b5498b7bdcd14b12ace3e28","modified":1631193236000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-button.styl","hash":"b926e368f702f8686aaa2eb98d3d2e533418958c","modified":1631193236000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-nav.styl","hash":"f7ff85fe6c4efb8ff036fab2c3277b7d8bed69a8","modified":1631193236000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-dimmer.styl","hash":"fbdb63c6a8887d19b7137325ba7d6806f728139c","modified":1631193236000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toggle.styl","hash":"432e73bc4f99322af6af1852e0ea6e674919c31a","modified":1631193236000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toc.styl","hash":"6394340c28a21f6aa90e786f3bfe24fb26595653","modified":1631193236000},{"_id":"themes/next/source/css/_common/outline/sidebar/site-state.styl","hash":"69eb1c282a8fd5dbab606cc09c34c5dc8e44e753","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/highlight/copy-code.styl","hash":"83ee4993710fc8daa1c8dbfccd5d5091fd244c30","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/tags/blockquote-center.styl","hash":"15a5e273a8137550c93c8d2a60f9fcf86e04a89e","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/tags/index.styl","hash":"cef4e779473daa3761709958243c6b8a57bbd814","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/tags/group-pictures.styl","hash":"393ff96234e4196b569d4b11496774eb78e147de","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/highlight/index.styl","hash":"08e79881d58d01afab6dbed37ab4f52356564d7e","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/tags/label.styl","hash":"debee14539272fbe3835a7d3853af2230baa3501","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/tags/link-grid.styl","hash":"2421500e447822ef1b6826403a3e1df3345641d7","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/tags/mermaid.styl","hash":"3c029a003e9bf747e1b9cc7c0c127f6028374876","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/tags/note.styl","hash":"f53e6c12bd4805888f696386d00668f23cd335e7","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/tags/tabs.styl","hash":"50b00218e854200c4ec0573a841e226d49c45cba","modified":1631193236000},{"_id":"themes/next/source/css/_common/scaffolding/tags/pdf.styl","hash":"b49c64f8e9a6ca1c45c0ba98febf1974fdd03616","modified":1631193236000},{"_id":"themes/next/source/images/avatar.png","hash":"cdbd12c9229c8bda65254daf50d47240c08b469f","modified":1615631935000},{"_id":"themes/next/source/images/android-chrome-384x384.png","hash":"f4b6028e2a30ef95bd2d628d6daab0a919d9349e","modified":1631262602000},{"_id":"source/_posts/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1631368953159},{"_id":"source/_posts/.git/config","hash":"80de82dfd57795eed1fcbc83b7a9a318eb9e3b20","modified":1631368953170},{"_id":"source/_posts/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1631368953142},{"_id":"source/_posts/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1631368953144},{"_id":"source/_posts/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1631368953145},{"_id":"source/_posts/.git/hooks/fsmonitor-watchman.sample","hash":"118ff5509f187039734d04456bf01e44c933ac19","modified":1631368953146},{"_id":"source/_posts/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1631368953147},{"_id":"source/_posts/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1631368953148},{"_id":"source/_posts/.git/hooks/pre-commit.sample","hash":"a79d057388ee2c2fe6561d7697f1f5efcff96f23","modified":1631368953148},{"_id":"source/_posts/.git/hooks/pre-merge-commit.sample","hash":"04c64e58bc25c149482ed45dbd79e40effb89eb7","modified":1631368953149},{"_id":"source/_posts/.git/hooks/pre-push.sample","hash":"a599b773b930ca83dbc3a5c7c13059ac4a6eaedc","modified":1631368953150},{"_id":"source/_posts/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1631368953151},{"_id":"source/_posts/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1631368953152},{"_id":"source/_posts/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1631368953151},{"_id":"source/_posts/.git/hooks/push-to-checkout.sample","hash":"508240328c8b55f8157c93c43bf5e291e5d2fbcb","modified":1631368953153},{"_id":"source/_posts/.git/hooks/update.sample","hash":"730e6bd5225478bab6147b7a62a6e2ae21d40507","modified":1631368953154},{"_id":"source/_posts/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1631368953154}],"Category":[{"name":"51nod","_id":"cktfuxgzd0004ootnbvejgzkw"},{"name":"Codeforces","_id":"cktfuxgzi000aootn0hdt5hpc"},{"name":"BZOJ","_id":"cktfuxgzo000kootnhijj3257"},{"name":"JOISC","_id":"cktfuxh04001zootnfod93aor"},{"name":"UVa","_id":"cktfuxh0i002nootnfeus43na"},{"name":"TopCoder","_id":"cktfuxh0l002tootn5ze3g1yp"},{"name":"ABC","_id":"cktfuxh0n002zootnbvqq5e9h"},{"name":"Cerc","_id":"cktfuxh0r0035ootngti891de"},{"name":"","_id":"cktfuxh0u003cootn49unguzf"},{"name":"","_id":"cktfuxh0w003iootnh8t6aqd0"},{"name":"","_id":"cktfuxh0y003nootnc698djm6"},{"name":"","_id":"cktfuxh110041ootn77mkbnvr"}],"Data":[],"Page":[{"title":"categories","date":"2021-09-10T09:12:50.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2021-09-10 17:12:50\ntype: categories\n---\n","updated":"2021-09-10T11:15:41.000Z","path":"categories/index.html","comments":1,"layout":"page","_id":"cktfuxgz40000ootng7m93nvu","content":"\r\n","site":{"data":{}},"length":0,"excerpt":"","more":"\r\n"},{"title":"","date":"2021-09-10T09:09:59.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: \ndate: 2021-09-10 17:09:59\ntype: tags\n---\n","updated":"2021-09-10T13:39:46.000Z","path":"tags/index.html","comments":1,"layout":"page","_id":"cktfuxgzb0002ootn6llubwif","content":"\r\n","site":{"data":{}},"length":0,"excerpt":"","more":"\r\n"},{"title":"","date":"2021-09-10T11:13:33.000Z","type":"links","_content":"- [yyh](https://yijan.co/)\n- [cjz](https://www.cnblogs.com/Juanzhang/)\n- [zjk](https://4182543731.github.io/)\n- [lsj](https://0x131cc05.github.io/)\n- [zzh](https://orzzh.icu/)\n- [wkm](https://blog.blackwhitetony.com/links.html)\n- [gjh](https://www.cnblogs.com/KevinTalent)","source":"links/index.md","raw":"---\ntitle: \ndate: 2021-09-10 19:13:33\ntype: links\n---\n- [yyh](https://yijan.co/)\n- [cjz](https://www.cnblogs.com/Juanzhang/)\n- [zjk](https://4182543731.github.io/)\n- [lsj](https://0x131cc05.github.io/)\n- [zzh](https://orzzh.icu/)\n- [wkm](https://blog.blackwhitetony.com/links.html)\n- [gjh](https://www.cnblogs.com/KevinTalent)","updated":"2021-09-10T14:06:05.000Z","path":"links/index.html","comments":1,"layout":"page","_id":"cktfuxgzf0006ootn6jeuaudv","content":"<ul>\r\n<li><a href=\"https://yijan.co/\">yyh</a></li>\r\n<li><a href=\"https://www.cnblogs.com/Juanzhang/\">cjz</a></li>\r\n<li><a href=\"https://4182543731.github.io/\">zjk</a></li>\r\n<li><a href=\"https://0x131cc05.github.io/\">lsj</a></li>\r\n<li><a href=\"https://orzzh.icu/\">zzh</a></li>\r\n<li><a href=\"https://blog.blackwhitetony.com/links.html\">wkm</a></li>\r\n<li><a href=\"https://www.cnblogs.com/KevinTalent\">gjh</a></li>\r\n</ul>\r\n","site":{"data":{}},"length":21,"excerpt":"","more":"<ul>\r\n<li><a href=\"https://yijan.co/\">yyh</a></li>\r\n<li><a href=\"https://www.cnblogs.com/Juanzhang/\">cjz</a></li>\r\n<li><a href=\"https://4182543731.github.io/\">zjk</a></li>\r\n<li><a href=\"https://0x131cc05.github.io/\">lsj</a></li>\r\n<li><a href=\"https://orzzh.icu/\">zzh</a></li>\r\n<li><a href=\"https://blog.blackwhitetony.com/links.html\">wkm</a></li>\r\n<li><a href=\"https://www.cnblogs.com/KevinTalent\">gjh</a></li>\r\n</ul>\r\n"}],"Post":[{"title":" | 51nod1847","date":"2021-05-03T10:13:25.000Z","updated":"2021-05-03T10:13:25.000Z","_content":"> [](https://www.51nod.com/Challenge/Problem.html#problemId=1847)\n>\n>  $n,k$ $\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n\\text{sgcd}(i,j)^k$\n>\n>  $\\text{sgcd}(i,j)$  $i,j$  $\\text{gcd}(i,j)=1$ $\\text{sgcd}(i,j)=0$\n>\n>  $2^{32}$ \n>\n> $n \\le 10^9,k \\le 50$\n\n$p_i$  $i$ $d_i$  $i$ \n\n $\\text{sgcd}(i,j)=\\dfrac{\\gcd(i,j)}{d_{\\gcd(i,j)}}$\n\n $\\gcd$\n$$\n\\begin{aligned}\n&\\sum_{i=1}^n\\sum_{j=1}^n\\text{sgcd}(i,j)^k\\\\\n&=\\sum_{c=2}^n(\\frac c{d_c})^k\\sum_{i=1}^{\\lfloor\\frac nc\\rfloor}\\sum_{j=1}^{\\lfloor\\frac nc\\rfloor}[gcd(i,j)=1]\\\\\n&=\\sum_{c=2}^n(\\frac c{d_c})^k(2\\sum_{i=1}^{\\lfloor\\frac nc\\rfloor}\\varphi(i)-1)\n\\end{aligned}\n$$\n $(\\frac x{d_x})^k$  $\\varphi(x)$  $\\lfloor \\frac nc \\rfloor$ [](http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/du-jiao-shai-and-min-25-shai-and-powerful-number-shai/#%E6%9D%9C%E6%95%99%E7%AD%9B)\n\n $d_x$  [Min-25 ](http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/du-jiao-shai-and-min-25-shai-and-powerful-number-shai/#min-25-%E7%AD%9B)\n\n\n$$\ng(n,i) = \\sum_{j=2}^n [j \\in P \\lor d_j > p_i]j^k\\\\\nf(n,i) = \\sum_{j=2}^n [j \\not\\in P \\land d_j \\le p_i](\\frac j{d_j})^k\\\\\nh(h,i) = \\sum_{j=2}^n [j \\in P \\lor d_j > p_i]\n$$\n\n$$\ng(n, i) = g(n, i - 1) - p_i^k(g(\\lfloor\\frac n {p_i} \\rfloor, i - 1) - g(p_i-1,i))\\\\\nf(n,i) = f(n,i-1)+g(\\lfloor\\frac n {p_i} \\rfloor,i-1) - g(p_i-1,i)\\\\\nh(n,i)=h(n,i-1)-h(\\lfloor\\frac n {p_i} \\rfloor, i - 1) + h(p_i-1,i)\n$$\n\n$$\ng(n,0)=\\sum_{i=2}^ni^k\\\\\nf(n,0)=0\\\\\nh(n,0)=n-1\n$$\n[](http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/zi-ran-shu-deng-mi-qiu-he/)\n\n $n < p_i^2$  Min-25 \n\n $O(\\frac {n^{\\frac 34}}{\\log n}+n^{\\frac 23})$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\ntypedef unsigned int U;\n\nint n, K;\nnamespace Sum {\n    U S[55][55];\n    void pre() {\n        S[0][0] = 1;\n        rep(i, 1, K) rep(j, 1, i) S[i][j] = S[i - 1][j - 1] + (U)j * S[i - 1][j];\n    }\n    U qry(int n, U re = 0) {\n        rep(i, 1, K) {\n            U t = 1;\n            rep(j, n + 1 - i, n + 1) if(j % (i + 1)) t *= j;\n            else t *= j / (i + 1);\n            re += t * S[K][i];\n        }\n        return re - 1u;\n    }\n};\nnamespace Du {\n    int m, pid, prm[100000];\n    U phi[1000005], S[1005];\n    void pre() {\n        m = pow(n, 2. / 3);\n        phi[1] = 1;\n        rep(i, 2, m) {\n            if(!phi[i]) phi[i] = i - 1, prm[++pid] = i;\n            for(int j = 1; i * prm[j] <= m; j++)\n            if(i % prm[j]) phi[i * prm[j]] = phi[i] * phi[prm[j]];\n            else { phi[i * prm[j]] = phi[i] * prm[j]; break; }\n        }\n        rep(i, 1, m) phi[i] += phi[i - 1];\n    }\n    U qry(int i) {\n        if(i <= m) return phi[i];\n        if(S[n / i]) return S[n / i];\n        U res = i * (i + 1ll) / 2;\n        for(int l = 2, r; l <= i; l = r + 1) {\n            r = i / (i / l);\n            res -= qry(i / l) * (r - l + 1);\n        }\n        return S[n / i] = res;\n    }\n};\nnamespace M25 {\n    constexpr int N = sqrt(1e9) + 5;\n    int m;\n    U g1[N], g2[N], f1[N], f2[N], h1[N], h2[N];\n    void pre() {\n        m = sqrt(n);\n        rep(i, 1, m) {\n            g1[i] = Sum::qry(i), g2[i] = Sum::qry(n / i);\n            h1[i] = i - 1, h2[i] = n / i - 1;\n        }\n        rep(p, 2, m) if(h1[p] ^ h1[p - 1]) {\n            int w1 = m / p, w3 = p * p, w2 = min(m, n / w3);\n            int j, d = n / p;\n            U x = 1, gx = g1[p - 1], hx = h1[p - 1];\n            rep(i, 1, K) x *= p;\n            rep(i, 1, w1) {\n                j = i * p, h2[i] -= h2[j] - hx;\n                f2[i] += g2[j] - gx, g2[i] -= x * (g2[j] - gx);\n            }\n            rep(i, w1 + 1, w2) {\n                j = d / i, h2[i] -= h1[j] - hx;\n                f2[i] += g1[j] - gx, g2[i] -= x * (g1[j] - gx);\n            }\n            per(i, m, w3) {\n                j = i / p, h1[i] -= h1[j] - hx;\n                f1[i] += g1[j] - gx, g1[i] -= x * (g1[j] - gx);\n            }\n        }\n    }\n    U qry(int i) {return i <= m ? f1[i] + h1[i] : f2[n / i] + h2[n / i]; }\n};\nint main() {\n    cin >> n >> K;\n    Sum::pre(), Du::pre(), M25::pre();\n    U as = 0;\n    for(int l = 2, r; l <= n; l = r + 1) {\n        r = n / (n / l);\n        as += (2u * Du::qry(n / l) - 1u) * (M25::qry(r) - M25::qry(l - 1));\n    }\n    cout << as;\n    return 0;\n}\n```","source":"_posts/51nod1847.md","raw":"---\ntitle:  | 51nod1847\ndate: 2021-05-03 18:13:25\nupdated: 2021-05-03 18:13:25\ntags: [,,Min-25 ,]\ncategories: 51nod\n---\n> [](https://www.51nod.com/Challenge/Problem.html#problemId=1847)\n>\n>  $n,k$ $\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n\\text{sgcd}(i,j)^k$\n>\n>  $\\text{sgcd}(i,j)$  $i,j$  $\\text{gcd}(i,j)=1$ $\\text{sgcd}(i,j)=0$\n>\n>  $2^{32}$ \n>\n> $n \\le 10^9,k \\le 50$\n\n$p_i$  $i$ $d_i$  $i$ \n\n $\\text{sgcd}(i,j)=\\dfrac{\\gcd(i,j)}{d_{\\gcd(i,j)}}$\n\n $\\gcd$\n$$\n\\begin{aligned}\n&\\sum_{i=1}^n\\sum_{j=1}^n\\text{sgcd}(i,j)^k\\\\\n&=\\sum_{c=2}^n(\\frac c{d_c})^k\\sum_{i=1}^{\\lfloor\\frac nc\\rfloor}\\sum_{j=1}^{\\lfloor\\frac nc\\rfloor}[gcd(i,j)=1]\\\\\n&=\\sum_{c=2}^n(\\frac c{d_c})^k(2\\sum_{i=1}^{\\lfloor\\frac nc\\rfloor}\\varphi(i)-1)\n\\end{aligned}\n$$\n $(\\frac x{d_x})^k$  $\\varphi(x)$  $\\lfloor \\frac nc \\rfloor$ [](http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/du-jiao-shai-and-min-25-shai-and-powerful-number-shai/#%E6%9D%9C%E6%95%99%E7%AD%9B)\n\n $d_x$  [Min-25 ](http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/du-jiao-shai-and-min-25-shai-and-powerful-number-shai/#min-25-%E7%AD%9B)\n\n\n$$\ng(n,i) = \\sum_{j=2}^n [j \\in P \\lor d_j > p_i]j^k\\\\\nf(n,i) = \\sum_{j=2}^n [j \\not\\in P \\land d_j \\le p_i](\\frac j{d_j})^k\\\\\nh(h,i) = \\sum_{j=2}^n [j \\in P \\lor d_j > p_i]\n$$\n\n$$\ng(n, i) = g(n, i - 1) - p_i^k(g(\\lfloor\\frac n {p_i} \\rfloor, i - 1) - g(p_i-1,i))\\\\\nf(n,i) = f(n,i-1)+g(\\lfloor\\frac n {p_i} \\rfloor,i-1) - g(p_i-1,i)\\\\\nh(n,i)=h(n,i-1)-h(\\lfloor\\frac n {p_i} \\rfloor, i - 1) + h(p_i-1,i)\n$$\n\n$$\ng(n,0)=\\sum_{i=2}^ni^k\\\\\nf(n,0)=0\\\\\nh(n,0)=n-1\n$$\n[](http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/zi-ran-shu-deng-mi-qiu-he/)\n\n $n < p_i^2$  Min-25 \n\n $O(\\frac {n^{\\frac 34}}{\\log n}+n^{\\frac 23})$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\ntypedef unsigned int U;\n\nint n, K;\nnamespace Sum {\n    U S[55][55];\n    void pre() {\n        S[0][0] = 1;\n        rep(i, 1, K) rep(j, 1, i) S[i][j] = S[i - 1][j - 1] + (U)j * S[i - 1][j];\n    }\n    U qry(int n, U re = 0) {\n        rep(i, 1, K) {\n            U t = 1;\n            rep(j, n + 1 - i, n + 1) if(j % (i + 1)) t *= j;\n            else t *= j / (i + 1);\n            re += t * S[K][i];\n        }\n        return re - 1u;\n    }\n};\nnamespace Du {\n    int m, pid, prm[100000];\n    U phi[1000005], S[1005];\n    void pre() {\n        m = pow(n, 2. / 3);\n        phi[1] = 1;\n        rep(i, 2, m) {\n            if(!phi[i]) phi[i] = i - 1, prm[++pid] = i;\n            for(int j = 1; i * prm[j] <= m; j++)\n            if(i % prm[j]) phi[i * prm[j]] = phi[i] * phi[prm[j]];\n            else { phi[i * prm[j]] = phi[i] * prm[j]; break; }\n        }\n        rep(i, 1, m) phi[i] += phi[i - 1];\n    }\n    U qry(int i) {\n        if(i <= m) return phi[i];\n        if(S[n / i]) return S[n / i];\n        U res = i * (i + 1ll) / 2;\n        for(int l = 2, r; l <= i; l = r + 1) {\n            r = i / (i / l);\n            res -= qry(i / l) * (r - l + 1);\n        }\n        return S[n / i] = res;\n    }\n};\nnamespace M25 {\n    constexpr int N = sqrt(1e9) + 5;\n    int m;\n    U g1[N], g2[N], f1[N], f2[N], h1[N], h2[N];\n    void pre() {\n        m = sqrt(n);\n        rep(i, 1, m) {\n            g1[i] = Sum::qry(i), g2[i] = Sum::qry(n / i);\n            h1[i] = i - 1, h2[i] = n / i - 1;\n        }\n        rep(p, 2, m) if(h1[p] ^ h1[p - 1]) {\n            int w1 = m / p, w3 = p * p, w2 = min(m, n / w3);\n            int j, d = n / p;\n            U x = 1, gx = g1[p - 1], hx = h1[p - 1];\n            rep(i, 1, K) x *= p;\n            rep(i, 1, w1) {\n                j = i * p, h2[i] -= h2[j] - hx;\n                f2[i] += g2[j] - gx, g2[i] -= x * (g2[j] - gx);\n            }\n            rep(i, w1 + 1, w2) {\n                j = d / i, h2[i] -= h1[j] - hx;\n                f2[i] += g1[j] - gx, g2[i] -= x * (g1[j] - gx);\n            }\n            per(i, m, w3) {\n                j = i / p, h1[i] -= h1[j] - hx;\n                f1[i] += g1[j] - gx, g1[i] -= x * (g1[j] - gx);\n            }\n        }\n    }\n    U qry(int i) {return i <= m ? f1[i] + h1[i] : f2[n / i] + h2[n / i]; }\n};\nint main() {\n    cin >> n >> K;\n    Sum::pre(), Du::pre(), M25::pre();\n    U as = 0;\n    for(int l = 2, r; l <= n; l = r + 1) {\n        r = n / (n / l);\n        as += (2u * Du::qry(n / l) - 1u) * (M25::qry(r) - M25::qry(l - 1));\n    }\n    cout << as;\n    return 0;\n}\n```","slug":"51nod1847","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgz80001ootnd14262cw","content":"<blockquote>\r\n<p><a href=\"https://www.51nod.com/Challenge/Problem.html#problemId=1847\"></a></p>\r\n<p> <span class=\"math inline\">\\(n,k\\)</span> <span class=\"math inline\">\\(\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n\\text{sgcd}(i,j)^k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\text{sgcd}(i,j)\\)</span>  <span class=\"math inline\">\\(i,j\\)</span>  <span class=\"math inline\">\\(\\text{gcd}(i,j)=1\\)</span> <span class=\"math inline\">\\(\\text{sgcd}(i,j)=0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(2^{32}\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 10^9,k \\le 50\\)</span></p>\r\n</blockquote>\r\n<p><span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(d_i\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\text{sgcd}(i,j)=\\dfrac{\\gcd(i,j)}{d_{\\gcd(i,j)}}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\gcd\\)</span> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;\\sum_{i=1}^n\\sum_{j=1}^n\\text{sgcd}(i,j)^k\\\\\r\n&amp;=\\sum_{c=2}^n(\\frac c{d_c})^k\\sum_{i=1}^{\\lfloor\\frac nc\\rfloor}\\sum_{j=1}^{\\lfloor\\frac nc\\rfloor}[gcd(i,j)=1]\\\\\r\n&amp;=\\sum_{c=2}^n(\\frac c{d_c})^k(2\\sum_{i=1}^{\\lfloor\\frac nc\\rfloor}\\varphi(i)-1)\r\n\\end{aligned}\r\n\\]</span>  <span class=\"math inline\">\\((\\frac x{d_x})^k\\)</span>  <span class=\"math inline\">\\(\\varphi(x)\\)</span>  <span class=\"math inline\">\\(\\lfloor \\frac nc \\rfloor\\)</span> <a href=\"http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/du-jiao-shai-and-min-25-shai-and-powerful-number-shai/#%E6%9D%9C%E6%95%99%E7%AD%9B\"></a></p>\r\n<p> <span class=\"math inline\">\\(d_x\\)</span>  <a href=\"http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/du-jiao-shai-and-min-25-shai-and-powerful-number-shai/#min-25-%E7%AD%9B\">Min-25 </a></p>\r\n<p> <span class=\"math display\">\\[\r\ng(n,i) = \\sum_{j=2}^n [j \\in P \\lor d_j &gt; p_i]j^k\\\\\r\nf(n,i) = \\sum_{j=2}^n [j \\not\\in P \\land d_j \\le p_i](\\frac j{d_j})^k\\\\\r\nh(h,i) = \\sum_{j=2}^n [j \\in P \\lor d_j &gt; p_i]\r\n\\]</span>  <span class=\"math display\">\\[\r\ng(n, i) = g(n, i - 1) - p_i^k(g(\\lfloor\\frac n {p_i} \\rfloor, i - 1) - g(p_i-1,i))\\\\\r\nf(n,i) = f(n,i-1)+g(\\lfloor\\frac n {p_i} \\rfloor,i-1) - g(p_i-1,i)\\\\\r\nh(n,i)=h(n,i-1)-h(\\lfloor\\frac n {p_i} \\rfloor, i - 1) + h(p_i-1,i)\r\n\\]</span>  <span class=\"math display\">\\[\r\ng(n,0)=\\sum_{i=2}^ni^k\\\\\r\nf(n,0)=0\\\\\r\nh(n,0)=n-1\r\n\\]</span> <a href=\"http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/zi-ran-shu-deng-mi-qiu-he/\"></a></p>\r\n<p> <span class=\"math inline\">\\(n &lt; p_i^2\\)</span>  Min-25 </p>\r\n<p> <span class=\"math inline\">\\(O(\\frac {n^{\\frac 34}}{\\log n}+n^{\\frac 23})\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span> U;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, K;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Sum &#123;</span><br><span class=\"line\">    U S[<span class=\"number\">55</span>][<span class=\"number\">55</span>];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pre</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        S[<span class=\"number\">0</span>][<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, K) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, i) S[i][j] = S[i - <span class=\"number\">1</span>][j - <span class=\"number\">1</span>] + (U)j * S[i - <span class=\"number\">1</span>][j];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">U <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> n, U re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, K) &#123;</span><br><span class=\"line\">            U t = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(j, n + <span class=\"number\">1</span> - i, n + <span class=\"number\">1</span>) <span class=\"keyword\">if</span>(j % (i + <span class=\"number\">1</span>)) t *= j;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> t *= j / (i + <span class=\"number\">1</span>);</span><br><span class=\"line\">            re += t * S[K][i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> re - <span class=\"number\">1u</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Du &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> m, pid, prm[<span class=\"number\">100000</span>];</span><br><span class=\"line\">    U phi[<span class=\"number\">1000005</span>], S[<span class=\"number\">1005</span>];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pre</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        m = <span class=\"built_in\">pow</span>(n, <span class=\"number\">2.</span> / <span class=\"number\">3</span>);</span><br><span class=\"line\">        phi[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, m) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!phi[i]) phi[i] = i - <span class=\"number\">1</span>, prm[++pid] = i;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">1</span>; i * prm[j] &lt;= m; j++)</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(i % prm[j]) phi[i * prm[j]] = phi[i] * phi[prm[j]];</span><br><span class=\"line\">            <span class=\"keyword\">else</span> &#123; phi[i * prm[j]] = phi[i] * prm[j]; <span class=\"keyword\">break</span>; &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) phi[i] += phi[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">U <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i &lt;= m) <span class=\"keyword\">return</span> phi[i];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(S[n / i]) <span class=\"keyword\">return</span> S[n / i];</span><br><span class=\"line\">        U res = i * (i + <span class=\"number\">1ll</span>) / <span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> l = <span class=\"number\">2</span>, r; l &lt;= i; l = r + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            r = i / (i / l);</span><br><span class=\"line\">            res -= <span class=\"built_in\">qry</span>(i / l) * (r - l + <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> S[n / i] = res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> M25 &#123;</span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> <span class=\"keyword\">int</span> N = <span class=\"built_in\">sqrt</span>(<span class=\"number\">1e9</span>) + <span class=\"number\">5</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> m;</span><br><span class=\"line\">    U g1[N], g2[N], f1[N], f2[N], h1[N], h2[N];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pre</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        m = <span class=\"built_in\">sqrt</span>(n);</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">            g1[i] = Sum::<span class=\"built_in\">qry</span>(i), g2[i] = Sum::<span class=\"built_in\">qry</span>(n / i);</span><br><span class=\"line\">            h1[i] = i - <span class=\"number\">1</span>, h2[i] = n / i - <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(p, <span class=\"number\">2</span>, m) <span class=\"keyword\">if</span>(h1[p] ^ h1[p - <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> w1 = m / p, w3 = p * p, w2 = <span class=\"built_in\">min</span>(m, n / w3);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> j, d = n / p;</span><br><span class=\"line\">            U x = <span class=\"number\">1</span>, gx = g1[p - <span class=\"number\">1</span>], hx = h1[p - <span class=\"number\">1</span>];</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, K) x *= p;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, w1) &#123;</span><br><span class=\"line\">                j = i * p, h2[i] -= h2[j] - hx;</span><br><span class=\"line\">                f2[i] += g2[j] - gx, g2[i] -= x * (g2[j] - gx);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, w1 + <span class=\"number\">1</span>, w2) &#123;</span><br><span class=\"line\">                j = d / i, h2[i] -= h1[j] - hx;</span><br><span class=\"line\">                f2[i] += g1[j] - gx, g2[i] -= x * (g1[j] - gx);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"built_in\">per</span>(i, m, w3) &#123;</span><br><span class=\"line\">                j = i / p, h1[i] -= h1[j] - hx;</span><br><span class=\"line\">                f1[i] += g1[j] - gx, g1[i] -= x * (g1[j] - gx);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">U <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;<span class=\"keyword\">return</span> i &lt;= m ? f1[i] + h1[i] : f2[n / i] + h2[n / i]; &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; K;</span><br><span class=\"line\">    Sum::<span class=\"built_in\">pre</span>(), Du::<span class=\"built_in\">pre</span>(), M25::<span class=\"built_in\">pre</span>();</span><br><span class=\"line\">    U as = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> l = <span class=\"number\">2</span>, r; l &lt;= n; l = r + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        r = n / (n / l);</span><br><span class=\"line\">        as += (<span class=\"number\">2u</span> * Du::<span class=\"built_in\">qry</span>(n / l) - <span class=\"number\">1u</span>) * (M25::<span class=\"built_in\">qry</span>(r) - M25::<span class=\"built_in\">qry</span>(l - <span class=\"number\">1</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; as;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":3233,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://www.51nod.com/Challenge/Problem.html#problemId=1847\"></a></p>\r\n<p> <span class=\"math inline\">\\(n,k\\)</span> <span class=\"math inline\">\\(\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n\\text{sgcd}(i,j)^k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\text{sgcd}(i,j)\\)</span>  <span class=\"math inline\">\\(i,j\\)</span>  <span class=\"math inline\">\\(\\text{gcd}(i,j)=1\\)</span> <span class=\"math inline\">\\(\\text{sgcd}(i,j)=0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(2^{32}\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 10^9,k \\le 50\\)</span></p>\r\n</blockquote>\r\n<p><span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(d_i\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\text{sgcd}(i,j)=\\dfrac{\\gcd(i,j)}{d_{\\gcd(i,j)}}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\gcd\\)</span> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;\\sum_{i=1}^n\\sum_{j=1}^n\\text{sgcd}(i,j)^k\\\\\r\n&amp;=\\sum_{c=2}^n(\\frac c{d_c})^k\\sum_{i=1}^{\\lfloor\\frac nc\\rfloor}\\sum_{j=1}^{\\lfloor\\frac nc\\rfloor}[gcd(i,j)=1]\\\\\r\n&amp;=\\sum_{c=2}^n(\\frac c{d_c})^k(2\\sum_{i=1}^{\\lfloor\\frac nc\\rfloor}\\varphi(i)-1)\r\n\\end{aligned}\r\n\\]</span>  <span class=\"math inline\">\\((\\frac x{d_x})^k\\)</span>  <span class=\"math inline\">\\(\\varphi(x)\\)</span>  <span class=\"math inline\">\\(\\lfloor \\frac nc \\rfloor\\)</span> <a href=\"http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/du-jiao-shai-and-min-25-shai-and-powerful-number-shai/#%E6%9D%9C%E6%95%99%E7%AD%9B\"></a></p>\r\n<p> <span class=\"math inline\">\\(d_x\\)</span>  <a href=\"http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/du-jiao-shai-and-min-25-shai-and-powerful-number-shai/#min-25-%E7%AD%9B\">Min-25 </a></p>\r\n<p> <span class=\"math display\">\\[\r\ng(n,i) = \\sum_{j=2}^n [j \\in P \\lor d_j &gt; p_i]j^k\\\\\r\nf(n,i) = \\sum_{j=2}^n [j \\not\\in P \\land d_j \\le p_i](\\frac j{d_j})^k\\\\\r\nh(h,i) = \\sum_{j=2}^n [j \\in P \\lor d_j &gt; p_i]\r\n\\]</span>  <span class=\"math display\">\\[\r\ng(n, i) = g(n, i - 1) - p_i^k(g(\\lfloor\\frac n {p_i} \\rfloor, i - 1) - g(p_i-1,i))\\\\\r\nf(n,i) = f(n,i-1)+g(\\lfloor\\frac n {p_i} \\rfloor,i-1) - g(p_i-1,i)\\\\\r\nh(n,i)=h(n,i-1)-h(\\lfloor\\frac n {p_i} \\rfloor, i - 1) + h(p_i-1,i)\r\n\\]</span>  <span class=\"math display\">\\[\r\ng(n,0)=\\sum_{i=2}^ni^k\\\\\r\nf(n,0)=0\\\\\r\nh(n,0)=n-1\r\n\\]</span> <a href=\"http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/zi-ran-shu-deng-mi-qiu-he/\"></a></p>\r\n<p> <span class=\"math inline\">\\(n &lt; p_i^2\\)</span>  Min-25 </p>\r\n<p> <span class=\"math inline\">\\(O(\\frac {n^{\\frac 34}}{\\log n}+n^{\\frac 23})\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span> U;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, K;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Sum &#123;</span><br><span class=\"line\">    U S[<span class=\"number\">55</span>][<span class=\"number\">55</span>];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pre</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        S[<span class=\"number\">0</span>][<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, K) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, i) S[i][j] = S[i - <span class=\"number\">1</span>][j - <span class=\"number\">1</span>] + (U)j * S[i - <span class=\"number\">1</span>][j];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">U <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> n, U re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, K) &#123;</span><br><span class=\"line\">            U t = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(j, n + <span class=\"number\">1</span> - i, n + <span class=\"number\">1</span>) <span class=\"keyword\">if</span>(j % (i + <span class=\"number\">1</span>)) t *= j;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> t *= j / (i + <span class=\"number\">1</span>);</span><br><span class=\"line\">            re += t * S[K][i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> re - <span class=\"number\">1u</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Du &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> m, pid, prm[<span class=\"number\">100000</span>];</span><br><span class=\"line\">    U phi[<span class=\"number\">1000005</span>], S[<span class=\"number\">1005</span>];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pre</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        m = <span class=\"built_in\">pow</span>(n, <span class=\"number\">2.</span> / <span class=\"number\">3</span>);</span><br><span class=\"line\">        phi[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, m) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!phi[i]) phi[i] = i - <span class=\"number\">1</span>, prm[++pid] = i;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">1</span>; i * prm[j] &lt;= m; j++)</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(i % prm[j]) phi[i * prm[j]] = phi[i] * phi[prm[j]];</span><br><span class=\"line\">            <span class=\"keyword\">else</span> &#123; phi[i * prm[j]] = phi[i] * prm[j]; <span class=\"keyword\">break</span>; &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) phi[i] += phi[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">U <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i &lt;= m) <span class=\"keyword\">return</span> phi[i];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(S[n / i]) <span class=\"keyword\">return</span> S[n / i];</span><br><span class=\"line\">        U res = i * (i + <span class=\"number\">1ll</span>) / <span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> l = <span class=\"number\">2</span>, r; l &lt;= i; l = r + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            r = i / (i / l);</span><br><span class=\"line\">            res -= <span class=\"built_in\">qry</span>(i / l) * (r - l + <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> S[n / i] = res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> M25 &#123;</span><br><span class=\"line\">    <span class=\"keyword\">constexpr</span> <span class=\"keyword\">int</span> N = <span class=\"built_in\">sqrt</span>(<span class=\"number\">1e9</span>) + <span class=\"number\">5</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> m;</span><br><span class=\"line\">    U g1[N], g2[N], f1[N], f2[N], h1[N], h2[N];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pre</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        m = <span class=\"built_in\">sqrt</span>(n);</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">            g1[i] = Sum::<span class=\"built_in\">qry</span>(i), g2[i] = Sum::<span class=\"built_in\">qry</span>(n / i);</span><br><span class=\"line\">            h1[i] = i - <span class=\"number\">1</span>, h2[i] = n / i - <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(p, <span class=\"number\">2</span>, m) <span class=\"keyword\">if</span>(h1[p] ^ h1[p - <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> w1 = m / p, w3 = p * p, w2 = <span class=\"built_in\">min</span>(m, n / w3);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> j, d = n / p;</span><br><span class=\"line\">            U x = <span class=\"number\">1</span>, gx = g1[p - <span class=\"number\">1</span>], hx = h1[p - <span class=\"number\">1</span>];</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, K) x *= p;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, w1) &#123;</span><br><span class=\"line\">                j = i * p, h2[i] -= h2[j] - hx;</span><br><span class=\"line\">                f2[i] += g2[j] - gx, g2[i] -= x * (g2[j] - gx);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, w1 + <span class=\"number\">1</span>, w2) &#123;</span><br><span class=\"line\">                j = d / i, h2[i] -= h1[j] - hx;</span><br><span class=\"line\">                f2[i] += g1[j] - gx, g2[i] -= x * (g1[j] - gx);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"built_in\">per</span>(i, m, w3) &#123;</span><br><span class=\"line\">                j = i / p, h1[i] -= h1[j] - hx;</span><br><span class=\"line\">                f1[i] += g1[j] - gx, g1[i] -= x * (g1[j] - gx);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">U <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;<span class=\"keyword\">return</span> i &lt;= m ? f1[i] + h1[i] : f2[n / i] + h2[n / i]; &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; K;</span><br><span class=\"line\">    Sum::<span class=\"built_in\">pre</span>(), Du::<span class=\"built_in\">pre</span>(), M25::<span class=\"built_in\">pre</span>();</span><br><span class=\"line\">    U as = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> l = <span class=\"number\">2</span>, r; l &lt;= n; l = r + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        r = n / (n / l);</span><br><span class=\"line\">        as += (<span class=\"number\">2u</span> * Du::<span class=\"built_in\">qry</span>(n / l) - <span class=\"number\">1u</span>) * (M25::<span class=\"built_in\">qry</span>(r) - M25::<span class=\"built_in\">qry</span>(l - <span class=\"number\">1</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; as;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Two Merged Sequences | Codeforces 1144G","date":"2021-03-26T07:56:27.000Z","updated":"2021-03-26T07:56:27.000Z","_content":"> [](https://codeforces.com/problemset/problem/1144/G)\n>\n>  $n$  $A$\n>\n> \n>\n> $n \\le 2 \\cdot 10^5$\n\n $f_{i,0}$  $i$  $A_i$ $f_{i,1}$  $A_i$ \n\n\n\n- $A_{i-1},A_i$  $A_{i-1} < A_i$ $f_{i-1,0} \\rightarrow f_{i,0}$ \n- $A_{i-1},A_i$ \n- $A_{i-1}$ $A_i$  $f_{i-1,1} < A_i$ $A_{i-1} \\rightarrow f_{i,0}$\n- $A_{i-1}$ $A_i$ \n\n $g_{i,0}$  $A_{i-1}$ $g_{i,1}$ \n\n ```pair <int, int>```  ```f```  ```g``` \n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define fi first\n#define se second\n#define mp make_pair\n\nusing namespace std;\nconst int N = 2e5 + 5;\nint n, A[N], in[N];\npair <int, int> f[N][2], ans;\nint main() {\n    cin >> n;\n    rep(i, 1, n) scanf(\"%d\", &A[i]);\n    f[1][0].fi = N, f[1][1].fi = -1;\n    rep(i, 2, n) {\n        f[i][0].fi = -1, f[i][1].fi = N;\n        if(A[i - 1] < A[i]) f[i][0] = {f[i - 1][0].fi, 0};\n        if(A[i - 1] > A[i]) f[i][1] = {f[i - 1][1].fi, 1};\n        if(f[i - 1][1].fi < A[i]) f[i][0] = max(f[i][0], mp(A[i - 1], 1));\n        if(f[i - 1][0].fi > A[i]) f[i][1] = min(f[i][1], mp(A[i - 1], 0));\n    }\n    if(~f[n][0].fi || f[n][1].fi < N) {\n        puts(\"YES\");\n        in[n] = ~f[n][0].fi ? 0 : 1;\n        per(i, n, 2) in[i - 1] = f[i][in[i]].se;\n        rep(i, 1, n) printf(\"%d \", in[i]);\n    } else puts(\"NO\");\n    return 0;\n}\n```","source":"_posts/CF1144G.md","raw":"---\ntitle: Two Merged Sequences | Codeforces 1144G\ndate: 2021-03-26 15:56:27\nupdated: 2021-03-26 15:56:27\ntags: []\ncategories: Codeforces\n---\n> [](https://codeforces.com/problemset/problem/1144/G)\n>\n>  $n$  $A$\n>\n> \n>\n> $n \\le 2 \\cdot 10^5$\n\n $f_{i,0}$  $i$  $A_i$ $f_{i,1}$  $A_i$ \n\n\n\n- $A_{i-1},A_i$  $A_{i-1} < A_i$ $f_{i-1,0} \\rightarrow f_{i,0}$ \n- $A_{i-1},A_i$ \n- $A_{i-1}$ $A_i$  $f_{i-1,1} < A_i$ $A_{i-1} \\rightarrow f_{i,0}$\n- $A_{i-1}$ $A_i$ \n\n $g_{i,0}$  $A_{i-1}$ $g_{i,1}$ \n\n ```pair <int, int>```  ```f```  ```g``` \n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define fi first\n#define se second\n#define mp make_pair\n\nusing namespace std;\nconst int N = 2e5 + 5;\nint n, A[N], in[N];\npair <int, int> f[N][2], ans;\nint main() {\n    cin >> n;\n    rep(i, 1, n) scanf(\"%d\", &A[i]);\n    f[1][0].fi = N, f[1][1].fi = -1;\n    rep(i, 2, n) {\n        f[i][0].fi = -1, f[i][1].fi = N;\n        if(A[i - 1] < A[i]) f[i][0] = {f[i - 1][0].fi, 0};\n        if(A[i - 1] > A[i]) f[i][1] = {f[i - 1][1].fi, 1};\n        if(f[i - 1][1].fi < A[i]) f[i][0] = max(f[i][0], mp(A[i - 1], 1));\n        if(f[i - 1][0].fi > A[i]) f[i][1] = min(f[i][1], mp(A[i - 1], 0));\n    }\n    if(~f[n][0].fi || f[n][1].fi < N) {\n        puts(\"YES\");\n        in[n] = ~f[n][0].fi ? 0 : 1;\n        per(i, n, 2) in[i - 1] = f[i][in[i]].se;\n        rep(i, 1, n) printf(\"%d \", in[i]);\n    } else puts(\"NO\");\n    return 0;\n}\n```","slug":"CF1144G","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzc0003ootnay514bwf","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/problemset/problem/1144/G\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span></p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n \\le 2 \\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(f_{i,0}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(f_{i,1}\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> </p>\r\n<p></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(A_{i-1},A_i\\)</span>  <span class=\"math inline\">\\(A_{i-1} &lt; A_i\\)</span> <span class=\"math inline\">\\(f_{i-1,0} \\rightarrow f_{i,0}\\)</span> </li>\r\n<li><span class=\"math inline\">\\(A_{i-1},A_i\\)</span> </li>\r\n<li><span class=\"math inline\">\\(A_{i-1}\\)</span> <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(f_{i-1,1} &lt; A_i\\)</span> <span class=\"math inline\">\\(A_{i-1} \\rightarrow f_{i,0}\\)</span></li>\r\n<li><span class=\"math inline\">\\(A_{i-1}\\)</span> <span class=\"math inline\">\\(A_i\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(g_{i,0}\\)</span>  <span class=\"math inline\">\\(A_{i-1}\\)</span> <span class=\"math inline\">\\(g_{i,1}\\)</span> </p>\r\n<p> <code>pair &lt;int, int&gt;</code>  <code>f</code>  <code>g</code> </p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> fi first</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> se second</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mp make_pair</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, A[N], in[N];</span><br><span class=\"line\">pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt; f[N][<span class=\"number\">2</span>], ans;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;A[i]);</span><br><span class=\"line\">    f[<span class=\"number\">1</span>][<span class=\"number\">0</span>].fi = N, f[<span class=\"number\">1</span>][<span class=\"number\">1</span>].fi = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) &#123;</span><br><span class=\"line\">        f[i][<span class=\"number\">0</span>].fi = <span class=\"number\">-1</span>, f[i][<span class=\"number\">1</span>].fi = N;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(A[i - <span class=\"number\">1</span>] &lt; A[i]) f[i][<span class=\"number\">0</span>] = &#123;f[i - <span class=\"number\">1</span>][<span class=\"number\">0</span>].fi, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(A[i - <span class=\"number\">1</span>] &gt; A[i]) f[i][<span class=\"number\">1</span>] = &#123;f[i - <span class=\"number\">1</span>][<span class=\"number\">1</span>].fi, <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(f[i - <span class=\"number\">1</span>][<span class=\"number\">1</span>].fi &lt; A[i]) f[i][<span class=\"number\">0</span>] = <span class=\"built_in\">max</span>(f[i][<span class=\"number\">0</span>], <span class=\"built_in\">mp</span>(A[i - <span class=\"number\">1</span>], <span class=\"number\">1</span>));</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(f[i - <span class=\"number\">1</span>][<span class=\"number\">0</span>].fi &gt; A[i]) f[i][<span class=\"number\">1</span>] = <span class=\"built_in\">min</span>(f[i][<span class=\"number\">1</span>], <span class=\"built_in\">mp</span>(A[i - <span class=\"number\">1</span>], <span class=\"number\">0</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(~f[n][<span class=\"number\">0</span>].fi || f[n][<span class=\"number\">1</span>].fi &lt; N) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;YES&quot;</span>);</span><br><span class=\"line\">        in[n] = ~f[n][<span class=\"number\">0</span>].fi ? <span class=\"number\">0</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(i, n, <span class=\"number\">2</span>) in[i - <span class=\"number\">1</span>] = f[i][in[i]].se;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, in[i]);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;NO&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":1488,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/problemset/problem/1144/G\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span></p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n \\le 2 \\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(f_{i,0}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(f_{i,1}\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> </p>\r\n<p></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(A_{i-1},A_i\\)</span>  <span class=\"math inline\">\\(A_{i-1} &lt; A_i\\)</span> <span class=\"math inline\">\\(f_{i-1,0} \\rightarrow f_{i,0}\\)</span> </li>\r\n<li><span class=\"math inline\">\\(A_{i-1},A_i\\)</span> </li>\r\n<li><span class=\"math inline\">\\(A_{i-1}\\)</span> <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(f_{i-1,1} &lt; A_i\\)</span> <span class=\"math inline\">\\(A_{i-1} \\rightarrow f_{i,0}\\)</span></li>\r\n<li><span class=\"math inline\">\\(A_{i-1}\\)</span> <span class=\"math inline\">\\(A_i\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(g_{i,0}\\)</span>  <span class=\"math inline\">\\(A_{i-1}\\)</span> <span class=\"math inline\">\\(g_{i,1}\\)</span> </p>\r\n<p> <code>pair &lt;int, int&gt;</code>  <code>f</code>  <code>g</code> </p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> fi first</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> se second</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mp make_pair</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, A[N], in[N];</span><br><span class=\"line\">pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt; f[N][<span class=\"number\">2</span>], ans;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;A[i]);</span><br><span class=\"line\">    f[<span class=\"number\">1</span>][<span class=\"number\">0</span>].fi = N, f[<span class=\"number\">1</span>][<span class=\"number\">1</span>].fi = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) &#123;</span><br><span class=\"line\">        f[i][<span class=\"number\">0</span>].fi = <span class=\"number\">-1</span>, f[i][<span class=\"number\">1</span>].fi = N;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(A[i - <span class=\"number\">1</span>] &lt; A[i]) f[i][<span class=\"number\">0</span>] = &#123;f[i - <span class=\"number\">1</span>][<span class=\"number\">0</span>].fi, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(A[i - <span class=\"number\">1</span>] &gt; A[i]) f[i][<span class=\"number\">1</span>] = &#123;f[i - <span class=\"number\">1</span>][<span class=\"number\">1</span>].fi, <span class=\"number\">1</span>&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(f[i - <span class=\"number\">1</span>][<span class=\"number\">1</span>].fi &lt; A[i]) f[i][<span class=\"number\">0</span>] = <span class=\"built_in\">max</span>(f[i][<span class=\"number\">0</span>], <span class=\"built_in\">mp</span>(A[i - <span class=\"number\">1</span>], <span class=\"number\">1</span>));</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(f[i - <span class=\"number\">1</span>][<span class=\"number\">0</span>].fi &gt; A[i]) f[i][<span class=\"number\">1</span>] = <span class=\"built_in\">min</span>(f[i][<span class=\"number\">1</span>], <span class=\"built_in\">mp</span>(A[i - <span class=\"number\">1</span>], <span class=\"number\">0</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(~f[n][<span class=\"number\">0</span>].fi || f[n][<span class=\"number\">1</span>].fi &lt; N) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;YES&quot;</span>);</span><br><span class=\"line\">        in[n] = ~f[n][<span class=\"number\">0</span>].fi ? <span class=\"number\">0</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(i, n, <span class=\"number\">2</span>) in[i - <span class=\"number\">1</span>] = f[i][in[i]].se;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, in[i]);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;NO&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Realistic Gameplay | Codefoces 1430F","date":"2021-03-19T06:20:57.000Z","updated":"2021-03-19T06:20:57.000Z","_content":"> [](https://codeforces.com/problemset/problem/1430/F)\n>\n>  $k$ \n>\n>  $n$  $i$  $[l_i,r_i]$  $a_i$  $(r_i \\le l_{i+1})$ 1 \n>\n> \n>\n> $n \\le 2000,k \\le 10^9, l_i \\le r_i \\le 10^9,a_i \\le 10^9$\n\n \n\n\n\n $f_i$  $i$  $i$   \n $i + 1$   \n $r_j$  $j$  $j$  $f_j$  \n ```ans```\n\n $O(n^2)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define upd(a, b) (a = min(a, b))\n\nusing namespace std;\nconst int N = 2005;\ntypedef long long ll;\nint n, K;\nint l[N], r[N], a[N];\nll f[N];\nint main() {\n    mem(f, 63), f[0] = 0;\n    cin >> n >> K;\n    rep(i, 1, n) scanf(\"%d%d%d\", &l[i], &r[i], &a[i]);\n    rep(i, 0, n - 1) {\n        int nw = K;\n        rep(j, i + 1, n) {\n            int t = (a[j] - nw + K - 1) / K;\n            if(t > r[j] - l[j]) break;\n            nw += t * K - a[j];\n            f[i] += a[j];\n            if(j == n) upd(f[j], f[i]);\n            else if(t < l[j + 1] - l[j]) upd(f[j], f[i] + nw);\n        }\n    }\n    if(f[n] < 0x3f3f3f3f3f3f3f3f) cout << f[n];\n    else puts(\"-1\");\n    return 0;\n}\n```\n\n","source":"_posts/CF1430F.md","raw":"---\ntitle: Realistic Gameplay | Codefoces 1430F\ndate: 2021-03-19 14:20:57\nupdated: 2021-03-19 14:20:57\ntags: [,]\ncategories: Codeforces\n---\n> [](https://codeforces.com/problemset/problem/1430/F)\n>\n>  $k$ \n>\n>  $n$  $i$  $[l_i,r_i]$  $a_i$  $(r_i \\le l_{i+1})$ 1 \n>\n> \n>\n> $n \\le 2000,k \\le 10^9, l_i \\le r_i \\le 10^9,a_i \\le 10^9$\n\n \n\n\n\n $f_i$  $i$  $i$   \n $i + 1$   \n $r_j$  $j$  $j$  $f_j$  \n ```ans```\n\n $O(n^2)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define upd(a, b) (a = min(a, b))\n\nusing namespace std;\nconst int N = 2005;\ntypedef long long ll;\nint n, K;\nint l[N], r[N], a[N];\nll f[N];\nint main() {\n    mem(f, 63), f[0] = 0;\n    cin >> n >> K;\n    rep(i, 1, n) scanf(\"%d%d%d\", &l[i], &r[i], &a[i]);\n    rep(i, 0, n - 1) {\n        int nw = K;\n        rep(j, i + 1, n) {\n            int t = (a[j] - nw + K - 1) / K;\n            if(t > r[j] - l[j]) break;\n            nw += t * K - a[j];\n            f[i] += a[j];\n            if(j == n) upd(f[j], f[i]);\n            else if(t < l[j + 1] - l[j]) upd(f[j], f[i] + nw);\n        }\n    }\n    if(f[n] < 0x3f3f3f3f3f3f3f3f) cout << f[n];\n    else puts(\"-1\");\n    return 0;\n}\n```\n\n","slug":"CF1430F","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzf0007ootn8uajb5sj","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/problemset/problem/1430/F\"></a></p>\r\n<p> <span class=\"math inline\">\\(k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\([l_i,r_i]\\)</span>  <span class=\"math inline\">\\(a_i\\)</span>  <span class=\"math inline\">\\((r_i \\le l_{i+1})\\)</span> 1 </p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n \\le 2000,k \\le 10^9, l_i \\le r_i \\le 10^9,a_i \\le 10^9\\)</span></p>\r\n</blockquote>\r\n<p> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(f_i\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i\\)</span> <br />\r\n <span class=\"math inline\">\\(i + 1\\)</span> <br />\r\n <span class=\"math inline\">\\(r_j\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(f_j\\)</span><br />\r\n <code>ans</code></p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> upd(a, b) (a = min(a, b))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2005</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, K;</span><br><span class=\"line\"><span class=\"keyword\">int</span> l[N], r[N], a[N];</span><br><span class=\"line\">ll f[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(f, <span class=\"number\">63</span>), f[<span class=\"number\">0</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; K;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;l[i], &amp;r[i], &amp;a[i]);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> nw = K;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, i + <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> t = (a[j] - nw + K - <span class=\"number\">1</span>) / K;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(t &gt; r[j] - l[j]) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            nw += t * K - a[j];</span><br><span class=\"line\">            f[i] += a[j];</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(j == n) <span class=\"built_in\">upd</span>(f[j], f[i]);</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(t &lt; l[j + <span class=\"number\">1</span>] - l[j]) <span class=\"built_in\">upd</span>(f[j], f[i] + nw);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(f[n] &lt; <span class=\"number\">0x3f3f3f3f3f3f3f3f</span>) cout &lt;&lt; f[n];</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;-1&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":1232,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/problemset/problem/1430/F\"></a></p>\r\n<p> <span class=\"math inline\">\\(k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\([l_i,r_i]\\)</span>  <span class=\"math inline\">\\(a_i\\)</span>  <span class=\"math inline\">\\((r_i \\le l_{i+1})\\)</span> 1 </p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n \\le 2000,k \\le 10^9, l_i \\le r_i \\le 10^9,a_i \\le 10^9\\)</span></p>\r\n</blockquote>\r\n<p> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(f_i\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i\\)</span> <br />\r\n <span class=\"math inline\">\\(i + 1\\)</span> <br />\r\n <span class=\"math inline\">\\(r_j\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(f_j\\)</span><br />\r\n <code>ans</code></p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> upd(a, b) (a = min(a, b))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2005</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, K;</span><br><span class=\"line\"><span class=\"keyword\">int</span> l[N], r[N], a[N];</span><br><span class=\"line\">ll f[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(f, <span class=\"number\">63</span>), f[<span class=\"number\">0</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; K;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;l[i], &amp;r[i], &amp;a[i]);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> nw = K;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, i + <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> t = (a[j] - nw + K - <span class=\"number\">1</span>) / K;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(t &gt; r[j] - l[j]) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            nw += t * K - a[j];</span><br><span class=\"line\">            f[i] += a[j];</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(j == n) <span class=\"built_in\">upd</span>(f[j], f[i]);</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(t &lt; l[j + <span class=\"number\">1</span>] - l[j]) <span class=\"built_in\">upd</span>(f[j], f[i] + nw);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(f[n] &lt; <span class=\"number\">0x3f3f3f3f3f3f3f3f</span>) cout &lt;&lt; f[n];</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;-1&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Mst | BZOJ 2238","date":"2021-03-13T13:26:51.000Z","updated":"2021-03-13T13:26:51.000Z","_content":"> [](https://darkbzoj.tk/problem/2238)  \n>  $n$ $m$ $q$  $\\text{MST}$   \n>     $n \\leq 5 \\times 10^4, m \\leq 10^5$\n\n $\\text{MST} = (E_{\\text{MST}}, V_{\\text{MST}})$\n\n $e(u, v, w) \\not \\in E_{\\text{MST}}$\n\n $e(u, v, w) \\in E_{\\text{MST}}$ $u, v$  $e'(u', v', w')$  $(u', v')$ $\\text{MST}$  $(u, v)$\n\n $\\text{MST}$ \n\n $f_e$ $e$  $e$  $f_e = +\\infty$ $e'(u', v', w')$ $e \\in E'$ $E'$  $(u', v')$  $\\text{MST}$  $f_e \\leftarrow \\min(f_e, w')$\n\n\n\n $O(n \\log^2 n)$ \n\n $O(n \\log n)$ \n\n $\\text{fa}(u, k)$  $u$  $2^k$ \n\n $\\text{tag}(u, k)$  $u$  $2^k$  $\\text{tag}(u, 0)$\n\n LCA  $u', v'$ \n\n \n\n$$\\text{tag}(u, i - 1) \\leftarrow \\min(\\text{tag}(u, i - 1), \\text{tag(u, i)})\\\\ $$\n$$\\text{tag}(\\text{fa}(u, i - 1), i - 1) \\leftarrow \\min(\\text{tag}(\\text{fa}(u, i - 1), i - 1), \\text{tag}(u, i))$$\n\n $u$  $\\text{fa}(u, i)$ \n\n $e(u, v, w)$:\n\n$$\n\\text{MST}_w - w + \\text{tag}(u, 0)\n$$\n\n $u$  $\\text{MST}$ \n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define upd(a, b) a = min(a, b)\n\nusing namespace std;\nconst int N = 5e4 + 5, MI = 1e6;\nconst char* Nc = \"Not connected\";\nint n, m, q, cnt, mst, head[N], d[N], fa[N][16], tag[N][16], dwn[N*2], pr[N], w[N*2];\nstruct Edge {\n    int u, v, w, id;\n    bool operator <(const Edge& b)const { return w < b.w; }\n} E[N*2];\nstruct edge { int v, nxt, id; } e[N*2];\n\nint find(int x) { return x == pr[x] ? x : pr[x] = find(pr[x]); }\nvoid add(int u, int v, int id) {\n    e[++cnt] = (edge){ v, head[u], id };\n    head[u] = cnt;\n}\nvoid dfs(int u) { //  d, fa, dwn , dwn[i]  i  \n    d[u] = d[fa[u][0]] + 1;\n    rep(i, 1, 15) fa[u][i] = fa[fa[u][i-1]][i-1];\n    for(int i = head[u]; i; i = e[i].nxt) {\n        int v = e[i].v;\n        if(v == fa[u][0]) continue;\n        fa[dwn[e[i].id] = v][0] = u;\n        dfs(v);\n    }\n}\nvoid update(int u, int v, int w) { //  \n    if(d[u] < d[v]) swap(u, v);\n    per(j, 15, 0) if(d[u] - (1 << j) >= d[v])\n        upd(tag[u][j], w), u = fa[u][j];\n    if(u == v) return;\n    per(j, 15, 0) if(fa[u][j] != fa[v][j]) {\n        upd(tag[u][j], w), upd(tag[v][j], w);\n        u = fa[u][j], v = fa[v][j];\n    }\n    upd(tag[u][0], w); upd(tag[v][0], w);\n}\n\nint main() {\n    scanf(\"%d%d\", &n, &m);\n    rep(i, 1, m) {\n        int u, v; scanf(\"%d%d%d\", &u, &v, &w[i]);\n        E[i] = (Edge){ u, v, w[i], i };\n    }\n    sort(E + 1, E + m + 1);\n    rep(i, 1, n) pr[i] = i;\n    rep(i, 1, m) {\n        int f1 = find(E[i].u), f2 = find(E[i].v);\n        if(f1 == f2) continue;\n        pr[f2] = f1; mst += E[i].w; \n        add(E[i].u, E[i].v, E[i].id); add(E[i].v, E[i].u, E[i].id);\n    }\n    scanf(\"%d\", &q);\n    if(cnt / 2 < n - 1) { while(q--) puts(Nc); return 0; }\n    dfs(1);\n    memset(tag, 0x3f, sizeof tag);\n    rep(i, 1, m) if(!dwn[E[i].id]) update(E[i].u, E[i].v, E[i].w);\n    per(i, 15, 1) rep(j, 1, n) { //  \n        upd(tag[j][i-1], tag[j][i]);\n        upd(tag[fa[j][i-1]][i-1], tag[j][i]);\n    }\n    while(q--) {\n        int T; scanf(\"%d\", &T);\n        if(!dwn[T]) printf(\"%d\\n\", mst);\n        else {\n            int ans = tag[dwn[T]][0];\n            if(ans == 0x3f3f3f3f) puts(Nc);\n            else printf(\"%d\\n\", mst + ans - w[T]);\n        }\n    }\n    return 0;\n}\n```","source":"_posts/BZ2238.md","raw":"---\ntitle: Mst | BZOJ 2238\ndate: 2021-03-13 21:26:51\nupdated: 2021-03-13 21:26:51\ntags: [,,]\ncategories: BZOJ\n---\n> [](https://darkbzoj.tk/problem/2238)  \n>  $n$ $m$ $q$  $\\text{MST}$   \n>     $n \\leq 5 \\times 10^4, m \\leq 10^5$\n\n $\\text{MST} = (E_{\\text{MST}}, V_{\\text{MST}})$\n\n $e(u, v, w) \\not \\in E_{\\text{MST}}$\n\n $e(u, v, w) \\in E_{\\text{MST}}$ $u, v$  $e'(u', v', w')$  $(u', v')$ $\\text{MST}$  $(u, v)$\n\n $\\text{MST}$ \n\n $f_e$ $e$  $e$  $f_e = +\\infty$ $e'(u', v', w')$ $e \\in E'$ $E'$  $(u', v')$  $\\text{MST}$  $f_e \\leftarrow \\min(f_e, w')$\n\n\n\n $O(n \\log^2 n)$ \n\n $O(n \\log n)$ \n\n $\\text{fa}(u, k)$  $u$  $2^k$ \n\n $\\text{tag}(u, k)$  $u$  $2^k$  $\\text{tag}(u, 0)$\n\n LCA  $u', v'$ \n\n \n\n$$\\text{tag}(u, i - 1) \\leftarrow \\min(\\text{tag}(u, i - 1), \\text{tag(u, i)})\\\\ $$\n$$\\text{tag}(\\text{fa}(u, i - 1), i - 1) \\leftarrow \\min(\\text{tag}(\\text{fa}(u, i - 1), i - 1), \\text{tag}(u, i))$$\n\n $u$  $\\text{fa}(u, i)$ \n\n $e(u, v, w)$:\n\n$$\n\\text{MST}_w - w + \\text{tag}(u, 0)\n$$\n\n $u$  $\\text{MST}$ \n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define upd(a, b) a = min(a, b)\n\nusing namespace std;\nconst int N = 5e4 + 5, MI = 1e6;\nconst char* Nc = \"Not connected\";\nint n, m, q, cnt, mst, head[N], d[N], fa[N][16], tag[N][16], dwn[N*2], pr[N], w[N*2];\nstruct Edge {\n    int u, v, w, id;\n    bool operator <(const Edge& b)const { return w < b.w; }\n} E[N*2];\nstruct edge { int v, nxt, id; } e[N*2];\n\nint find(int x) { return x == pr[x] ? x : pr[x] = find(pr[x]); }\nvoid add(int u, int v, int id) {\n    e[++cnt] = (edge){ v, head[u], id };\n    head[u] = cnt;\n}\nvoid dfs(int u) { //  d, fa, dwn , dwn[i]  i  \n    d[u] = d[fa[u][0]] + 1;\n    rep(i, 1, 15) fa[u][i] = fa[fa[u][i-1]][i-1];\n    for(int i = head[u]; i; i = e[i].nxt) {\n        int v = e[i].v;\n        if(v == fa[u][0]) continue;\n        fa[dwn[e[i].id] = v][0] = u;\n        dfs(v);\n    }\n}\nvoid update(int u, int v, int w) { //  \n    if(d[u] < d[v]) swap(u, v);\n    per(j, 15, 0) if(d[u] - (1 << j) >= d[v])\n        upd(tag[u][j], w), u = fa[u][j];\n    if(u == v) return;\n    per(j, 15, 0) if(fa[u][j] != fa[v][j]) {\n        upd(tag[u][j], w), upd(tag[v][j], w);\n        u = fa[u][j], v = fa[v][j];\n    }\n    upd(tag[u][0], w); upd(tag[v][0], w);\n}\n\nint main() {\n    scanf(\"%d%d\", &n, &m);\n    rep(i, 1, m) {\n        int u, v; scanf(\"%d%d%d\", &u, &v, &w[i]);\n        E[i] = (Edge){ u, v, w[i], i };\n    }\n    sort(E + 1, E + m + 1);\n    rep(i, 1, n) pr[i] = i;\n    rep(i, 1, m) {\n        int f1 = find(E[i].u), f2 = find(E[i].v);\n        if(f1 == f2) continue;\n        pr[f2] = f1; mst += E[i].w; \n        add(E[i].u, E[i].v, E[i].id); add(E[i].v, E[i].u, E[i].id);\n    }\n    scanf(\"%d\", &q);\n    if(cnt / 2 < n - 1) { while(q--) puts(Nc); return 0; }\n    dfs(1);\n    memset(tag, 0x3f, sizeof tag);\n    rep(i, 1, m) if(!dwn[E[i].id]) update(E[i].u, E[i].v, E[i].w);\n    per(i, 15, 1) rep(j, 1, n) { //  \n        upd(tag[j][i-1], tag[j][i]);\n        upd(tag[fa[j][i-1]][i-1], tag[j][i]);\n    }\n    while(q--) {\n        int T; scanf(\"%d\", &T);\n        if(!dwn[T]) printf(\"%d\\n\", mst);\n        else {\n            int ans = tag[dwn[T]][0];\n            if(ans == 0x3f3f3f3f) puts(Nc);\n            else printf(\"%d\\n\", mst + ans - w[T]);\n        }\n    }\n    return 0;\n}\n```","slug":"BZ2238","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzg0008ootn1ii8gnvn","content":"<blockquote>\r\n<p><a href=\"https://darkbzoj.tk/problem/2238\"></a><br />\r\n <span class=\"math inline\">\\(n\\)</span> <span class=\"math inline\">\\(m\\)</span> <span class=\"math inline\">\\(q\\)</span>  <span class=\"math inline\">\\(\\text{MST}\\)</span> <br />\r\n<span class=\"math inline\">\\(n \\leq 5 \\times 10^4, m \\leq 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(\\text{MST} = (E_{\\text{MST}}, V_{\\text{MST}})\\)</span></p>\r\n<p> <span class=\"math inline\">\\(e(u, v, w) \\not \\in E_{\\text{MST}}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(e(u, v, w) \\in E_{\\text{MST}}\\)</span> <span class=\"math inline\">\\(u, v\\)</span>  <span class=\"math inline\">\\(e&#39;(u&#39;, v&#39;, w&#39;)\\)</span>  <span class=\"math inline\">\\((u&#39;, v&#39;)\\)</span> <span class=\"math inline\">\\(\\text{MST}\\)</span>  <span class=\"math inline\">\\((u, v)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\text{MST}\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(f_e\\)</span> <span class=\"math inline\">\\(e\\)</span>  <span class=\"math inline\">\\(e\\)</span>  <span class=\"math inline\">\\(f_e = +\\infty\\)</span> <span class=\"math inline\">\\(e&#39;(u&#39;, v&#39;, w&#39;)\\)</span> <span class=\"math inline\">\\(e \\in E&#39;\\)</span> <span class=\"math inline\">\\(E&#39;\\)</span>  <span class=\"math inline\">\\((u&#39;, v&#39;)\\)</span>  <span class=\"math inline\">\\(\\text{MST}\\)</span>  <span class=\"math inline\">\\(f_e \\leftarrow \\min(f_e, w&#39;)\\)</span></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(O(n \\log^2 n)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n \\log n)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\text{fa}(u, k)\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(2^k\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\text{tag}(u, k)\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(2^k\\)</span>  <span class=\"math inline\">\\(\\text{tag}(u, 0)\\)</span></p>\r\n<p> LCA  <span class=\"math inline\">\\(u&#39;, v&#39;\\)</span> </p>\r\n<p></p>\r\n<p><span class=\"math display\">\\[\\text{tag}(u, i - 1) \\leftarrow \\min(\\text{tag}(u, i - 1), \\text{tag(u, i)})\\\\ \\]</span> <span class=\"math display\">\\[\\text{tag}(\\text{fa}(u, i - 1), i - 1) \\leftarrow \\min(\\text{tag}(\\text{fa}(u, i - 1), i - 1), \\text{tag}(u, i))\\]</span></p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(\\text{fa}(u, i)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(e(u, v, w)\\)</span>:</p>\r\n<p><span class=\"math display\">\\[\r\n\\text{MST}_w - w + \\text{tag}(u, 0)\r\n\\]</span></p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(\\text{MST}\\)</span> </p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> upd(a, b) a = min(a, b)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">5e4</span> + <span class=\"number\">5</span>, MI = <span class=\"number\">1e6</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">char</span>* Nc = <span class=\"string\">&quot;Not connected&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, q, cnt, mst, head[N], d[N], fa[N][<span class=\"number\">16</span>], tag[N][<span class=\"number\">16</span>], dwn[N*<span class=\"number\">2</span>], pr[N], w[N*<span class=\"number\">2</span>];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Edge</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v, w, id;</span><br><span class=\"line\">    <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span> &lt;(<span class=\"keyword\">const</span> Edge&amp; b)<span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> w &lt; b.w; &#125;</span><br><span class=\"line\">&#125; E[N*<span class=\"number\">2</span>];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">edge</span> &#123;</span> <span class=\"keyword\">int</span> v, nxt, id; &#125; e[N*<span class=\"number\">2</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">find</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123; <span class=\"keyword\">return</span> x == pr[x] ? x : pr[x] = <span class=\"built_in\">find</span>(pr[x]); &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> id)</span> </span>&#123;</span><br><span class=\"line\">    e[++cnt] = (edge)&#123; v, head[u], id &#125;;</span><br><span class=\"line\">    head[u] = cnt;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123; <span class=\"comment\">//  d, fa, dwn , dwn[i]  i  </span></span><br><span class=\"line\">    d[u] = d[fa[u][<span class=\"number\">0</span>]] + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">15</span>) fa[u][i] = fa[fa[u][i<span class=\"number\">-1</span>]][i<span class=\"number\">-1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = head[u]; i; i = e[i].nxt) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> v = e[i].v;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(v == fa[u][<span class=\"number\">0</span>]) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        fa[dwn[e[i].id] = v][<span class=\"number\">0</span>] = u;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(v);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> w)</span> </span>&#123; <span class=\"comment\">//  </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(d[u] &lt; d[v]) <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(j, <span class=\"number\">15</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(d[u] - (<span class=\"number\">1</span> &lt;&lt; j) &gt;= d[v])</span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(tag[u][j], w), u = fa[u][j];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u == v) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(j, <span class=\"number\">15</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(fa[u][j] != fa[v][j]) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(tag[u][j], w), <span class=\"built_in\">upd</span>(tag[v][j], w);</span><br><span class=\"line\">        u = fa[u][j], v = fa[v][j];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">upd</span>(tag[u][<span class=\"number\">0</span>], w); <span class=\"built_in\">upd</span>(tag[v][<span class=\"number\">0</span>], w);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> u, v; <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w[i]);</span><br><span class=\"line\">        E[i] = (Edge)&#123; u, v, w[i], i &#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(E + <span class=\"number\">1</span>, E + m + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) pr[i] = i;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> f1 = <span class=\"built_in\">find</span>(E[i].u), f2 = <span class=\"built_in\">find</span>(E[i].v);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(f1 == f2) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        pr[f2] = f1; mst += E[i].w; </span><br><span class=\"line\">        <span class=\"built_in\">add</span>(E[i].u, E[i].v, E[i].id); <span class=\"built_in\">add</span>(E[i].v, E[i].u, E[i].id);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;q);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(cnt / <span class=\"number\">2</span> &lt; n - <span class=\"number\">1</span>) &#123; <span class=\"keyword\">while</span>(q--) <span class=\"built_in\">puts</span>(Nc); <span class=\"keyword\">return</span> <span class=\"number\">0</span>; &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(tag, <span class=\"number\">0x3f</span>, <span class=\"keyword\">sizeof</span> tag);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) <span class=\"keyword\">if</span>(!dwn[E[i].id]) <span class=\"built_in\">update</span>(E[i].u, E[i].v, E[i].w);</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, <span class=\"number\">15</span>, <span class=\"number\">1</span>) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, n) &#123; <span class=\"comment\">//  </span></span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(tag[j][i<span class=\"number\">-1</span>], tag[j][i]);</span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(tag[fa[j][i<span class=\"number\">-1</span>]][i<span class=\"number\">-1</span>], tag[j][i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(q--) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> T; <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;T);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!dwn[T]) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, mst);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> ans = tag[dwn[T]][<span class=\"number\">0</span>];</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(ans == <span class=\"number\">0x3f3f3f3f</span>) <span class=\"built_in\">puts</span>(Nc);</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, mst + ans - w[T]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":3400,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://darkbzoj.tk/problem/2238\"></a><br />\r\n <span class=\"math inline\">\\(n\\)</span> <span class=\"math inline\">\\(m\\)</span> <span class=\"math inline\">\\(q\\)</span>  <span class=\"math inline\">\\(\\text{MST}\\)</span> <br />\r\n<span class=\"math inline\">\\(n \\leq 5 \\times 10^4, m \\leq 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(\\text{MST} = (E_{\\text{MST}}, V_{\\text{MST}})\\)</span></p>\r\n<p> <span class=\"math inline\">\\(e(u, v, w) \\not \\in E_{\\text{MST}}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(e(u, v, w) \\in E_{\\text{MST}}\\)</span> <span class=\"math inline\">\\(u, v\\)</span>  <span class=\"math inline\">\\(e&#39;(u&#39;, v&#39;, w&#39;)\\)</span>  <span class=\"math inline\">\\((u&#39;, v&#39;)\\)</span> <span class=\"math inline\">\\(\\text{MST}\\)</span>  <span class=\"math inline\">\\((u, v)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\text{MST}\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(f_e\\)</span> <span class=\"math inline\">\\(e\\)</span>  <span class=\"math inline\">\\(e\\)</span>  <span class=\"math inline\">\\(f_e = +\\infty\\)</span> <span class=\"math inline\">\\(e&#39;(u&#39;, v&#39;, w&#39;)\\)</span> <span class=\"math inline\">\\(e \\in E&#39;\\)</span> <span class=\"math inline\">\\(E&#39;\\)</span>  <span class=\"math inline\">\\((u&#39;, v&#39;)\\)</span>  <span class=\"math inline\">\\(\\text{MST}\\)</span>  <span class=\"math inline\">\\(f_e \\leftarrow \\min(f_e, w&#39;)\\)</span></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(O(n \\log^2 n)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n \\log n)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\text{fa}(u, k)\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(2^k\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\text{tag}(u, k)\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(2^k\\)</span>  <span class=\"math inline\">\\(\\text{tag}(u, 0)\\)</span></p>\r\n<p> LCA  <span class=\"math inline\">\\(u&#39;, v&#39;\\)</span> </p>\r\n<p></p>\r\n<p><span class=\"math display\">\\[\\text{tag}(u, i - 1) \\leftarrow \\min(\\text{tag}(u, i - 1), \\text{tag(u, i)})\\\\ \\]</span> <span class=\"math display\">\\[\\text{tag}(\\text{fa}(u, i - 1), i - 1) \\leftarrow \\min(\\text{tag}(\\text{fa}(u, i - 1), i - 1), \\text{tag}(u, i))\\]</span></p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(\\text{fa}(u, i)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(e(u, v, w)\\)</span>:</p>\r\n<p><span class=\"math display\">\\[\r\n\\text{MST}_w - w + \\text{tag}(u, 0)\r\n\\]</span></p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(\\text{MST}\\)</span> </p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> upd(a, b) a = min(a, b)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">5e4</span> + <span class=\"number\">5</span>, MI = <span class=\"number\">1e6</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">char</span>* Nc = <span class=\"string\">&quot;Not connected&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, q, cnt, mst, head[N], d[N], fa[N][<span class=\"number\">16</span>], tag[N][<span class=\"number\">16</span>], dwn[N*<span class=\"number\">2</span>], pr[N], w[N*<span class=\"number\">2</span>];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Edge</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v, w, id;</span><br><span class=\"line\">    <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span> &lt;(<span class=\"keyword\">const</span> Edge&amp; b)<span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> w &lt; b.w; &#125;</span><br><span class=\"line\">&#125; E[N*<span class=\"number\">2</span>];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">edge</span> &#123;</span> <span class=\"keyword\">int</span> v, nxt, id; &#125; e[N*<span class=\"number\">2</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">find</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123; <span class=\"keyword\">return</span> x == pr[x] ? x : pr[x] = <span class=\"built_in\">find</span>(pr[x]); &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> id)</span> </span>&#123;</span><br><span class=\"line\">    e[++cnt] = (edge)&#123; v, head[u], id &#125;;</span><br><span class=\"line\">    head[u] = cnt;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123; <span class=\"comment\">//  d, fa, dwn , dwn[i]  i  </span></span><br><span class=\"line\">    d[u] = d[fa[u][<span class=\"number\">0</span>]] + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">15</span>) fa[u][i] = fa[fa[u][i<span class=\"number\">-1</span>]][i<span class=\"number\">-1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = head[u]; i; i = e[i].nxt) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> v = e[i].v;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(v == fa[u][<span class=\"number\">0</span>]) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        fa[dwn[e[i].id] = v][<span class=\"number\">0</span>] = u;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(v);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> w)</span> </span>&#123; <span class=\"comment\">//  </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(d[u] &lt; d[v]) <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(j, <span class=\"number\">15</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(d[u] - (<span class=\"number\">1</span> &lt;&lt; j) &gt;= d[v])</span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(tag[u][j], w), u = fa[u][j];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u == v) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(j, <span class=\"number\">15</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(fa[u][j] != fa[v][j]) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(tag[u][j], w), <span class=\"built_in\">upd</span>(tag[v][j], w);</span><br><span class=\"line\">        u = fa[u][j], v = fa[v][j];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">upd</span>(tag[u][<span class=\"number\">0</span>], w); <span class=\"built_in\">upd</span>(tag[v][<span class=\"number\">0</span>], w);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> u, v; <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w[i]);</span><br><span class=\"line\">        E[i] = (Edge)&#123; u, v, w[i], i &#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(E + <span class=\"number\">1</span>, E + m + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) pr[i] = i;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> f1 = <span class=\"built_in\">find</span>(E[i].u), f2 = <span class=\"built_in\">find</span>(E[i].v);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(f1 == f2) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        pr[f2] = f1; mst += E[i].w; </span><br><span class=\"line\">        <span class=\"built_in\">add</span>(E[i].u, E[i].v, E[i].id); <span class=\"built_in\">add</span>(E[i].v, E[i].u, E[i].id);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;q);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(cnt / <span class=\"number\">2</span> &lt; n - <span class=\"number\">1</span>) &#123; <span class=\"keyword\">while</span>(q--) <span class=\"built_in\">puts</span>(Nc); <span class=\"keyword\">return</span> <span class=\"number\">0</span>; &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(tag, <span class=\"number\">0x3f</span>, <span class=\"keyword\">sizeof</span> tag);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) <span class=\"keyword\">if</span>(!dwn[E[i].id]) <span class=\"built_in\">update</span>(E[i].u, E[i].v, E[i].w);</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, <span class=\"number\">15</span>, <span class=\"number\">1</span>) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, n) &#123; <span class=\"comment\">//  </span></span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(tag[j][i<span class=\"number\">-1</span>], tag[j][i]);</span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(tag[fa[j][i<span class=\"number\">-1</span>]][i<span class=\"number\">-1</span>], tag[j][i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(q--) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> T; <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;T);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!dwn[T]) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, mst);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> ans = tag[dwn[T]][<span class=\"number\">0</span>];</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(ans == <span class=\"number\">0x3f3f3f3f</span>) <span class=\"built_in\">puts</span>(Nc);</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, mst + ans - w[T]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Kuroni and Antihype | Codeforces 1305G","date":"2021-04-06T06:23:35.000Z","updated":"2021-04-06T06:23:35.000Z","_content":"> [](https://codeforces.com/contest/1305/problem/G)\n>\n>  $n$  $a_i$\n>\n>  $u$  $v$  $a_u \\& a_v = 0$\n>\n>  $u$\n>\n> - \n> -  $u$  $v$ $u$ $a_v$\n>\n> \n>\n> $n \\le 2 \\cdot 10^5,a_i \\le 2 \\cdot 10^5$\n\n $0$ \n\n $u$  $v$  $0$ \n\n $u$  $degree_u$\n$$\n\\sum_{u \\in V}a_u(degree_u-1)=\\sum_{u \\in V}a_udegree_u-\\sum_{u \\in V}a_u = \\sum_{(u,v) \\in E}a_u + a_v - \\sum_{u \\in V}a_u\n$$\n $(u,v)$  $a_u + a_v$\n\n\n\n### \n\n $3^{18}$ $1.7 \\cdot 10^8$ \n\n ```Kruskal```  $\\alpha(n)$\n\n\n\n $u,v$  $a_u \\& a_v = 0$ $a_u + a_v$\n\n\n\n  ```Kruskal``` \n\n $O(3^{18}\\alpha(n))$\n\n### \n\n $a_u,a_v$ $a_u$  $u$ $u$  $U$$a_v$  $a_v$ $v$  $V$\n\n $U$  $V$ \n\n\n\n $U$  $u_0$ $v_0$$u_0$  $v_0$ $u_0$  $U$ $v_0$  $V$ \n\n $O(3^{18}\\alpha(n))$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define upd(a, b) (a = min(a, b))\n\nusing namespace std;\nconst int N = 1 << 18;\ntypedef long long ll;\nint n, a[N], fa[N], sz[N], vis[N];\nvector <int> nds[N];\nint find(int x) { return x == fa[x] ? x : fa[x] = find(fa[x]); }\nint main() {\n    cin >> n;\n    ll as = 0;\n    rep(i, 1, n) {\n        scanf(\"%d\", &a[i]), as -= a[i];\n        nds[a[i]].push_back(i);\n    }\n    nds[0].push_back(0);\n    rep(i, 0, n) fa[i] = i, sz[i] = 1;\n    per(S, N - 1, 1) for(int T = S; T > S / 2; --T &= S) {\n        if(nds[T].empty() || nds[S ^ T].empty()) continue;\n        auto mrg = [&](int u, int v) {\n            u = find(u), v = find(v);\n            if(u == v) return;\n            if(sz[u] < sz[v]) swap(u, v);\n            fa[v] = u, sz[u] += sz[v];\n            as += S;\n            if(sz[u] == n + 1) cout << as, exit(0);\n        };\n        mrg(nds[T][0], nds[S ^ T][0]);\n        if(!vis[T]) for(int u : nds[T]) mrg(u, nds[S ^ T][0]);\n        if(!vis[S ^ T]) for(int v : nds[S ^ T]) mrg(nds[T][0], v);\n        vis[T] = vis[S ^ T] = 1;\n    }\n    puts(\"0\");\n    return 0;\n}\n```","source":"_posts/CF1305G.md","raw":"---\ntitle: Kuroni and Antihype | Codeforces 1305G\ndate: 2021-04-06 14:23:35\nupdated: 2021-04-06 14:23:35\ntags: [,]\ncategories: Codeforces\n---\n> [](https://codeforces.com/contest/1305/problem/G)\n>\n>  $n$  $a_i$\n>\n>  $u$  $v$  $a_u \\& a_v = 0$\n>\n>  $u$\n>\n> - \n> -  $u$  $v$ $u$ $a_v$\n>\n> \n>\n> $n \\le 2 \\cdot 10^5,a_i \\le 2 \\cdot 10^5$\n\n $0$ \n\n $u$  $v$  $0$ \n\n $u$  $degree_u$\n$$\n\\sum_{u \\in V}a_u(degree_u-1)=\\sum_{u \\in V}a_udegree_u-\\sum_{u \\in V}a_u = \\sum_{(u,v) \\in E}a_u + a_v - \\sum_{u \\in V}a_u\n$$\n $(u,v)$  $a_u + a_v$\n\n\n\n### \n\n $3^{18}$ $1.7 \\cdot 10^8$ \n\n ```Kruskal```  $\\alpha(n)$\n\n\n\n $u,v$  $a_u \\& a_v = 0$ $a_u + a_v$\n\n\n\n  ```Kruskal``` \n\n $O(3^{18}\\alpha(n))$\n\n### \n\n $a_u,a_v$ $a_u$  $u$ $u$  $U$$a_v$  $a_v$ $v$  $V$\n\n $U$  $V$ \n\n\n\n $U$  $u_0$ $v_0$$u_0$  $v_0$ $u_0$  $U$ $v_0$  $V$ \n\n $O(3^{18}\\alpha(n))$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define upd(a, b) (a = min(a, b))\n\nusing namespace std;\nconst int N = 1 << 18;\ntypedef long long ll;\nint n, a[N], fa[N], sz[N], vis[N];\nvector <int> nds[N];\nint find(int x) { return x == fa[x] ? x : fa[x] = find(fa[x]); }\nint main() {\n    cin >> n;\n    ll as = 0;\n    rep(i, 1, n) {\n        scanf(\"%d\", &a[i]), as -= a[i];\n        nds[a[i]].push_back(i);\n    }\n    nds[0].push_back(0);\n    rep(i, 0, n) fa[i] = i, sz[i] = 1;\n    per(S, N - 1, 1) for(int T = S; T > S / 2; --T &= S) {\n        if(nds[T].empty() || nds[S ^ T].empty()) continue;\n        auto mrg = [&](int u, int v) {\n            u = find(u), v = find(v);\n            if(u == v) return;\n            if(sz[u] < sz[v]) swap(u, v);\n            fa[v] = u, sz[u] += sz[v];\n            as += S;\n            if(sz[u] == n + 1) cout << as, exit(0);\n        };\n        mrg(nds[T][0], nds[S ^ T][0]);\n        if(!vis[T]) for(int u : nds[T]) mrg(u, nds[S ^ T][0]);\n        if(!vis[S ^ T]) for(int v : nds[S ^ T]) mrg(nds[T][0], v);\n        vis[T] = vis[S ^ T] = 1;\n    }\n    puts(\"0\");\n    return 0;\n}\n```","slug":"CF1305G","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzh0009ootnbl32fj1d","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/1305/problem/G\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(a_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(a_u \\&amp; a_v = 0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(u\\)</span></p>\r\n<ul>\r\n<li></li>\r\n<li> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\(u\\)</span> <span class=\"math inline\">\\(a_v\\)</span></li>\r\n</ul>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n \\le 2 \\cdot 10^5,a_i \\le 2 \\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(0\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(0\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(degree_u\\)</span> <span class=\"math display\">\\[\r\n\\sum_{u \\in V}a_u(degree_u-1)=\\sum_{u \\in V}a_udegree_u-\\sum_{u \\in V}a_u = \\sum_{(u,v) \\in E}a_u + a_v - \\sum_{u \\in V}a_u\r\n\\]</span>  <span class=\"math inline\">\\((u,v)\\)</span>  <span class=\"math inline\">\\(a_u + a_v\\)</span></p>\r\n<p></p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(3^{18}\\)</span> <span class=\"math inline\">\\(1.7 \\cdot 10^8\\)</span> </p>\r\n<p> <code>Kruskal</code>  <span class=\"math inline\">\\(\\alpha(n)\\)</span></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(u,v\\)</span>  <span class=\"math inline\">\\(a_u \\&amp; a_v = 0\\)</span> <span class=\"math inline\">\\(a_u + a_v\\)</span></p>\r\n<p></p>\r\n<p> <code>Kruskal</code> </p>\r\n<p> <span class=\"math inline\">\\(O(3^{18}\\alpha(n))\\)</span></p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(a_u,a_v\\)</span> <span class=\"math inline\">\\(a_u\\)</span>  <span class=\"math inline\">\\(u\\)</span> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(U\\)</span><span class=\"math inline\">\\(a_v\\)</span>  <span class=\"math inline\">\\(a_v\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(V\\)</span></p>\r\n<p> <span class=\"math inline\">\\(U\\)</span>  <span class=\"math inline\">\\(V\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(U\\)</span>  <span class=\"math inline\">\\(u_0\\)</span> <span class=\"math inline\">\\(v_0\\)</span><span class=\"math inline\">\\(u_0\\)</span>  <span class=\"math inline\">\\(v_0\\)</span> <span class=\"math inline\">\\(u_0\\)</span>  <span class=\"math inline\">\\(U\\)</span> <span class=\"math inline\">\\(v_0\\)</span>  <span class=\"math inline\">\\(V\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(3^{18}\\alpha(n))\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> upd(a, b) (a = min(a, b))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1</span> &lt;&lt; <span class=\"number\">18</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, a[N], fa[N], sz[N], vis[N];</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; nds[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">find</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123; <span class=\"keyword\">return</span> x == fa[x] ? x : fa[x] = <span class=\"built_in\">find</span>(fa[x]); &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    ll as = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;a[i]), as -= a[i];</span><br><span class=\"line\">        nds[a[i]].<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    nds[<span class=\"number\">0</span>].<span class=\"built_in\">push_back</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) fa[i] = i, sz[i] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(S, N - <span class=\"number\">1</span>, <span class=\"number\">1</span>) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> T = S; T &gt; S / <span class=\"number\">2</span>; --T &amp;= S) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(nds[T].<span class=\"built_in\">empty</span>() || nds[S ^ T].<span class=\"built_in\">empty</span>()) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> mrg = [&amp;](<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v) &#123;</span><br><span class=\"line\">            u = <span class=\"built_in\">find</span>(u), v = <span class=\"built_in\">find</span>(v);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(u == v) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(sz[u] &lt; sz[v]) <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">            fa[v] = u, sz[u] += sz[v];</span><br><span class=\"line\">            as += S;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(sz[u] == n + <span class=\"number\">1</span>) cout &lt;&lt; as, <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"built_in\">mrg</span>(nds[T][<span class=\"number\">0</span>], nds[S ^ T][<span class=\"number\">0</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!vis[T]) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> u : nds[T]) <span class=\"built_in\">mrg</span>(u, nds[S ^ T][<span class=\"number\">0</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!vis[S ^ T]) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : nds[S ^ T]) <span class=\"built_in\">mrg</span>(nds[T][<span class=\"number\">0</span>], v);</span><br><span class=\"line\">        vis[T] = vis[S ^ T] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;0&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2114,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/1305/problem/G\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(a_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(a_u \\&amp; a_v = 0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(u\\)</span></p>\r\n<ul>\r\n<li></li>\r\n<li> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\(u\\)</span> <span class=\"math inline\">\\(a_v\\)</span></li>\r\n</ul>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n \\le 2 \\cdot 10^5,a_i \\le 2 \\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(0\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(0\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(degree_u\\)</span> <span class=\"math display\">\\[\r\n\\sum_{u \\in V}a_u(degree_u-1)=\\sum_{u \\in V}a_udegree_u-\\sum_{u \\in V}a_u = \\sum_{(u,v) \\in E}a_u + a_v - \\sum_{u \\in V}a_u\r\n\\]</span>  <span class=\"math inline\">\\((u,v)\\)</span>  <span class=\"math inline\">\\(a_u + a_v\\)</span></p>\r\n<p></p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(3^{18}\\)</span> <span class=\"math inline\">\\(1.7 \\cdot 10^8\\)</span> </p>\r\n<p> <code>Kruskal</code>  <span class=\"math inline\">\\(\\alpha(n)\\)</span></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(u,v\\)</span>  <span class=\"math inline\">\\(a_u \\&amp; a_v = 0\\)</span> <span class=\"math inline\">\\(a_u + a_v\\)</span></p>\r\n<p></p>\r\n<p> <code>Kruskal</code> </p>\r\n<p> <span class=\"math inline\">\\(O(3^{18}\\alpha(n))\\)</span></p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(a_u,a_v\\)</span> <span class=\"math inline\">\\(a_u\\)</span>  <span class=\"math inline\">\\(u\\)</span> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(U\\)</span><span class=\"math inline\">\\(a_v\\)</span>  <span class=\"math inline\">\\(a_v\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(V\\)</span></p>\r\n<p> <span class=\"math inline\">\\(U\\)</span>  <span class=\"math inline\">\\(V\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(U\\)</span>  <span class=\"math inline\">\\(u_0\\)</span> <span class=\"math inline\">\\(v_0\\)</span><span class=\"math inline\">\\(u_0\\)</span>  <span class=\"math inline\">\\(v_0\\)</span> <span class=\"math inline\">\\(u_0\\)</span>  <span class=\"math inline\">\\(U\\)</span> <span class=\"math inline\">\\(v_0\\)</span>  <span class=\"math inline\">\\(V\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(3^{18}\\alpha(n))\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> upd(a, b) (a = min(a, b))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1</span> &lt;&lt; <span class=\"number\">18</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, a[N], fa[N], sz[N], vis[N];</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; nds[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">find</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123; <span class=\"keyword\">return</span> x == fa[x] ? x : fa[x] = <span class=\"built_in\">find</span>(fa[x]); &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    ll as = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;a[i]), as -= a[i];</span><br><span class=\"line\">        nds[a[i]].<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    nds[<span class=\"number\">0</span>].<span class=\"built_in\">push_back</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) fa[i] = i, sz[i] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(S, N - <span class=\"number\">1</span>, <span class=\"number\">1</span>) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> T = S; T &gt; S / <span class=\"number\">2</span>; --T &amp;= S) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(nds[T].<span class=\"built_in\">empty</span>() || nds[S ^ T].<span class=\"built_in\">empty</span>()) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> mrg = [&amp;](<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v) &#123;</span><br><span class=\"line\">            u = <span class=\"built_in\">find</span>(u), v = <span class=\"built_in\">find</span>(v);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(u == v) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(sz[u] &lt; sz[v]) <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">            fa[v] = u, sz[u] += sz[v];</span><br><span class=\"line\">            as += S;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(sz[u] == n + <span class=\"number\">1</span>) cout &lt;&lt; as, <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"built_in\">mrg</span>(nds[T][<span class=\"number\">0</span>], nds[S ^ T][<span class=\"number\">0</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!vis[T]) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> u : nds[T]) <span class=\"built_in\">mrg</span>(u, nds[S ^ T][<span class=\"number\">0</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!vis[S ^ T]) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : nds[S ^ T]) <span class=\"built_in\">mrg</span>(nds[T][<span class=\"number\">0</span>], v);</span><br><span class=\"line\">        vis[T] = vis[S ^ T] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;0&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Bananas in a Microwave | Codeforces 1498D","date":"2021-03-31T01:03:29.000Z","updated":"2021-03-31T01:03:29.000Z","_content":"> [](https://codeforces.com/contest/1498/problem/D)\n>\n>  $k$  $0$\n>\n>  $i=1,2,3,\\cdots,n$ $t_i,x_i,y_i$\n>\n> -  $t_i=1$ $a \\in [0,y_i]$ $a$  $k=\\lceil k + x_i \\rceil$\n> -  $t_i=2$ $a \\in [0,y_i]$ $a$  $k=\\lceil k \\cdot x_i \\rceil$\n>\n>  $x_i$ ****\n>\n>  $j \\in [1,m]$ $k=j$\n>\n> $n \\le 200,y_i \\le m \\le 10^5$\n>\n>  $t_i=1$ $0 < x_i \\le m$ $t_i=2$ $1 < x_i \\le m$\n\n $i$ $ok_j$  $i$  $k=j$\n\n $next_j=\\begin{cases}\\lceil j + x_i \\rceil&(t_i=1)\\\\\\lceil j \\cdot x_i \\rceil&(t_i=2)\\end{cases}$\n\n $\\forall j \\ne k,next_j \\ne next_k$ $j \\rightarrow next_j$ \n\n $v_1,v_2,v_3,\\cdots,v_s$\n\n $v_j$ $\\exist k \\in [j-y_i,j)$ $ok_k=1$ $i$  $k$  $v_j$\n\n $i$  $k$ \n\n $O(nm)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define upd(a, b) (a = min(a, b))\n\nusing namespace std;\ntypedef long long ll;\nconst int N = 1e5, M = N + 5;\nint n, m, f[M], nxt[M], vis[M], ok[M];\nint main() {\n    mem(f, -1);\n    int t, y; ll x;\n    cin >> n >> m;\n    f[0] = 0;\n    rep(k, 1, n) {\n        scanf(\"%d%lld%d\", &t, &x, &y);\n        if(t == 1) {\n            x = (x + N - 1) / N;\n            rep(i, 0, m) nxt[i] = min(i + x, m + 1ll);\n        } else {\n            nxt[0] = m + 1;\n            rep(i, 1, m) nxt[i] = min((i * x + N - 1) / N, m + 1ll);\n        }\n        mem(vis, 0);\n        rep(i, 0, m) if(!vis[i]) {\n            vector <int> v;\n            for(int j = i; j <= m; j = nxt[j]) vis[j] = 1, v.push_back(j);\n            int cnt = 0;\n            For(j, 0, v.size()) {\n                if(cnt) ok[v[j]] = 1;\n                cnt += f[v[j]] != -1;\n                if(j >= y) cnt -= f[v[j - y]] != -1;\n            }\n        }\n        rep(i, 0, m) if(!~f[i] && ok[i]) f[i] = k;\n    }\n    rep(i, 1, m) printf(\"%d \", f[i]);\n    return 0;\n}\n```","source":"_posts/CF1498D.md","raw":"---\ntitle: Bananas in a Microwave | Codeforces 1498D\ndate: 2021-03-31 09:03:29\nupdated: 2021-03-31 09:03:29\ntags: []\ncategories: Codeforces\n---\n> [](https://codeforces.com/contest/1498/problem/D)\n>\n>  $k$  $0$\n>\n>  $i=1,2,3,\\cdots,n$ $t_i,x_i,y_i$\n>\n> -  $t_i=1$ $a \\in [0,y_i]$ $a$  $k=\\lceil k + x_i \\rceil$\n> -  $t_i=2$ $a \\in [0,y_i]$ $a$  $k=\\lceil k \\cdot x_i \\rceil$\n>\n>  $x_i$ ****\n>\n>  $j \\in [1,m]$ $k=j$\n>\n> $n \\le 200,y_i \\le m \\le 10^5$\n>\n>  $t_i=1$ $0 < x_i \\le m$ $t_i=2$ $1 < x_i \\le m$\n\n $i$ $ok_j$  $i$  $k=j$\n\n $next_j=\\begin{cases}\\lceil j + x_i \\rceil&(t_i=1)\\\\\\lceil j \\cdot x_i \\rceil&(t_i=2)\\end{cases}$\n\n $\\forall j \\ne k,next_j \\ne next_k$ $j \\rightarrow next_j$ \n\n $v_1,v_2,v_3,\\cdots,v_s$\n\n $v_j$ $\\exist k \\in [j-y_i,j)$ $ok_k=1$ $i$  $k$  $v_j$\n\n $i$  $k$ \n\n $O(nm)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define upd(a, b) (a = min(a, b))\n\nusing namespace std;\ntypedef long long ll;\nconst int N = 1e5, M = N + 5;\nint n, m, f[M], nxt[M], vis[M], ok[M];\nint main() {\n    mem(f, -1);\n    int t, y; ll x;\n    cin >> n >> m;\n    f[0] = 0;\n    rep(k, 1, n) {\n        scanf(\"%d%lld%d\", &t, &x, &y);\n        if(t == 1) {\n            x = (x + N - 1) / N;\n            rep(i, 0, m) nxt[i] = min(i + x, m + 1ll);\n        } else {\n            nxt[0] = m + 1;\n            rep(i, 1, m) nxt[i] = min((i * x + N - 1) / N, m + 1ll);\n        }\n        mem(vis, 0);\n        rep(i, 0, m) if(!vis[i]) {\n            vector <int> v;\n            for(int j = i; j <= m; j = nxt[j]) vis[j] = 1, v.push_back(j);\n            int cnt = 0;\n            For(j, 0, v.size()) {\n                if(cnt) ok[v[j]] = 1;\n                cnt += f[v[j]] != -1;\n                if(j >= y) cnt -= f[v[j - y]] != -1;\n            }\n        }\n        rep(i, 0, m) if(!~f[i] && ok[i]) f[i] = k;\n    }\n    rep(i, 1, m) printf(\"%d \", f[i]);\n    return 0;\n}\n```","slug":"CF1498D","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzj000cootnhd6igolb","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/1498/problem/D\"></a></p>\r\n<p> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i=1,2,3,\\cdots,n\\)</span> <span class=\"math inline\">\\(t_i,x_i,y_i\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(t_i=1\\)</span> <span class=\"math inline\">\\(a \\in [0,y_i]\\)</span> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(k=\\lceil k + x_i \\rceil\\)</span></li>\r\n<li> <span class=\"math inline\">\\(t_i=2\\)</span> <span class=\"math inline\">\\(a \\in [0,y_i]\\)</span> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(k=\\lceil k \\cdot x_i \\rceil\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(x_i\\)</span> <strong></strong></p>\r\n<p> <span class=\"math inline\">\\(j \\in [1,m]\\)</span> <span class=\"math inline\">\\(k=j\\)</span></p>\r\n<p><span class=\"math inline\">\\(n \\le 200,y_i \\le m \\le 10^5\\)</span></p>\r\n<p> <span class=\"math inline\">\\(t_i=1\\)</span> <span class=\"math inline\">\\(0 &lt; x_i \\le m\\)</span> <span class=\"math inline\">\\(t_i=2\\)</span> <span class=\"math inline\">\\(1 &lt; x_i \\le m\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(ok_j\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(k=j\\)</span></p>\r\n<p> <span class=\"math inline\">\\(next_j=\\begin{cases}\\lceil j + x_i \\rceil&amp;(t_i=1)\\\\\\lceil j \\cdot x_i \\rceil&amp;(t_i=2)\\end{cases}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\forall j \\ne k,next_j \\ne next_k\\)</span> <span class=\"math inline\">\\(j \\rightarrow next_j\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(v_1,v_2,v_3,\\cdots,v_s\\)</span></p>\r\n<p> <span class=\"math inline\">\\(v_j\\)</span> <span class=\"math inline\">\\(\\exist k \\in [j-y_i,j)\\)</span> <span class=\"math inline\">\\(ok_k=1\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(v_j\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(nm)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> upd(a, b) (a = min(a, b))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1e5</span>, M = N + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, f[M], nxt[M], vis[M], ok[M];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(f, <span class=\"number\">-1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> t, y; ll x;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    f[<span class=\"number\">0</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(k, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%lld%d&quot;</span>, &amp;t, &amp;x, &amp;y);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(t == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            x = (x + N - <span class=\"number\">1</span>) / N;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, m) nxt[i] = <span class=\"built_in\">min</span>(i + x, m + <span class=\"number\">1ll</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            nxt[<span class=\"number\">0</span>] = m + <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) nxt[i] = <span class=\"built_in\">min</span>((i * x + N - <span class=\"number\">1</span>) / N, m + <span class=\"number\">1ll</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">mem</span>(vis, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, m) <span class=\"keyword\">if</span>(!vis[i]) &#123;</span><br><span class=\"line\">            vector &lt;<span class=\"keyword\">int</span>&gt; v;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = i; j &lt;= m; j = nxt[j]) vis[j] = <span class=\"number\">1</span>, v.<span class=\"built_in\">push_back</span>(j);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"built_in\">For</span>(j, <span class=\"number\">0</span>, v.<span class=\"built_in\">size</span>()) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(cnt) ok[v[j]] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                cnt += f[v[j]] != <span class=\"number\">-1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(j &gt;= y) cnt -= f[v[j - y]] != <span class=\"number\">-1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, m) <span class=\"keyword\">if</span>(!~f[i] &amp;&amp; ok[i]) f[i] = k;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, f[i]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":1689,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/1498/problem/D\"></a></p>\r\n<p> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i=1,2,3,\\cdots,n\\)</span> <span class=\"math inline\">\\(t_i,x_i,y_i\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(t_i=1\\)</span> <span class=\"math inline\">\\(a \\in [0,y_i]\\)</span> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(k=\\lceil k + x_i \\rceil\\)</span></li>\r\n<li> <span class=\"math inline\">\\(t_i=2\\)</span> <span class=\"math inline\">\\(a \\in [0,y_i]\\)</span> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(k=\\lceil k \\cdot x_i \\rceil\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(x_i\\)</span> <strong></strong></p>\r\n<p> <span class=\"math inline\">\\(j \\in [1,m]\\)</span> <span class=\"math inline\">\\(k=j\\)</span></p>\r\n<p><span class=\"math inline\">\\(n \\le 200,y_i \\le m \\le 10^5\\)</span></p>\r\n<p> <span class=\"math inline\">\\(t_i=1\\)</span> <span class=\"math inline\">\\(0 &lt; x_i \\le m\\)</span> <span class=\"math inline\">\\(t_i=2\\)</span> <span class=\"math inline\">\\(1 &lt; x_i \\le m\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(ok_j\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(k=j\\)</span></p>\r\n<p> <span class=\"math inline\">\\(next_j=\\begin{cases}\\lceil j + x_i \\rceil&amp;(t_i=1)\\\\\\lceil j \\cdot x_i \\rceil&amp;(t_i=2)\\end{cases}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\forall j \\ne k,next_j \\ne next_k\\)</span> <span class=\"math inline\">\\(j \\rightarrow next_j\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(v_1,v_2,v_3,\\cdots,v_s\\)</span></p>\r\n<p> <span class=\"math inline\">\\(v_j\\)</span> <span class=\"math inline\">\\(\\exist k \\in [j-y_i,j)\\)</span> <span class=\"math inline\">\\(ok_k=1\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(v_j\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(nm)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> upd(a, b) (a = min(a, b))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1e5</span>, M = N + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, f[M], nxt[M], vis[M], ok[M];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(f, <span class=\"number\">-1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> t, y; ll x;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    f[<span class=\"number\">0</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(k, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%lld%d&quot;</span>, &amp;t, &amp;x, &amp;y);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(t == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            x = (x + N - <span class=\"number\">1</span>) / N;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, m) nxt[i] = <span class=\"built_in\">min</span>(i + x, m + <span class=\"number\">1ll</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            nxt[<span class=\"number\">0</span>] = m + <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) nxt[i] = <span class=\"built_in\">min</span>((i * x + N - <span class=\"number\">1</span>) / N, m + <span class=\"number\">1ll</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">mem</span>(vis, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, m) <span class=\"keyword\">if</span>(!vis[i]) &#123;</span><br><span class=\"line\">            vector &lt;<span class=\"keyword\">int</span>&gt; v;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = i; j &lt;= m; j = nxt[j]) vis[j] = <span class=\"number\">1</span>, v.<span class=\"built_in\">push_back</span>(j);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> cnt = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"built_in\">For</span>(j, <span class=\"number\">0</span>, v.<span class=\"built_in\">size</span>()) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(cnt) ok[v[j]] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                cnt += f[v[j]] != <span class=\"number\">-1</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(j &gt;= y) cnt -= f[v[j - y]] != <span class=\"number\">-1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, m) <span class=\"keyword\">if</span>(!~f[i] &amp;&amp; ok[i]) f[i] = k;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, f[i]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Two Houses | Codeforces 1498E","date":"2021-03-31T01:05:26.000Z","updated":"2021-03-21T01:05:26.000Z","_content":"> [](https://codeforces.com/contest/1498/problem/E)\n>\n>  $n$ \n>\n>  $k_i$\n>\n> **** $u$  $v$\n>\n>  $(u,v)$  $|k_u-k_v|$\n>\n> \n>\n> $n \\le 500$\n\n### \n\n $(u,v)$$u,v$  $u \\rightarrow v$\n\n $v$  $u$$\\exists S,u \\in S \\land \\forall x \\in S, y \\not \\in S,x \\rightarrow y$ $S$  $S$ \n\n$\\therefore k_v \\ge |S|,k_u < |S| \\Rightarrow k_u < k_v$\n\n\n\n\n\n\n\n $O(n^2)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\nconst int N = 1000;\nchar ch[N];\nstruct Qry {\n    int x, y, v;\n    bool operator <(const Qry& b)const { return v > b.v; }\n} q[N * N];\nvector <int> v[N];\nint n, idx, k[N];\nint main() {\n    scanf(\"%d\", &n);\n    rep(i, 1, n) scanf(\"%d\", &k[i]);\n    rep(i, 1, n) rep(j, i + 1, n)\n        q[++idx] = k[i] < k[j] ? (Qry){ j, i, k[j] - k[i] } : (Qry){ i, j, k[i] - k[j] };\n    sort(q + 1, q + idx + 1);\n    rep(i, 1, idx) {\n        printf(\"? %d %d\\n\", q[i].x, q[i].y);\n        fflush(stdout);\n        scanf(\"%s\", ch);\n        if(ch[0] == 'Y') printf(\"! %d %d\\n\", q[i].x, q[i].y), fflush(stdout), exit(0);\n    }\n    puts(\"! 0 0\"), fflush(stdout);\n    return 0;\n}\n```\n\n### \n\n**** $S$$S$  $S$  $S$  $\\binom {|S|}2$****\n\n $m$  $\\binom m2$ $m$ ****\n\n $O(n)$****\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define fi first\n#define se second\n#define mp make_pair\n\nusing namespace std;\nconst int N = 505;\ntypedef pair <int, int> P;\nint n; P a[N];\nint main() {\n    cin >> n;\n    rep(i, 1, n) scanf(\"%d\", &a[i].fi), a[i].se = i;\n    sort(a + 1, a + n + 1);\n    int su = 0; P mi(n, 0), ma(-1, 0);\n    pair <int, P> as;\n    rep(i, 1, n) {\n        su += a[i].fi;\n        mi = min(mi, a[i]), ma = max(ma, a[i]);\n        if(su == i * (i - 1) / 2) {\n            if(mi.se ^ ma.se) as = max(as, mp(ma.fi - mi.fi, mp(mi.se, ma.se)));\n            mi.fi = n, ma.fi = -1;\n        }\n    }\n    if(as.se.fi) printf(\"! %d %d\\n\", as.se.fi, as.se.se);\n    else puts(\"! 0 0\");\n    fflush(stdout);\n    return 0;\n}\n```","source":"_posts/CF1498E.md","raw":"---\ntitle: Two Houses | Codeforces 1498E\ndate: 2021-03-31 09:05:26\nupdated: 2021-03-21 09:05:26\ntags: [,]\ncategories: Codeforces\n---\n> [](https://codeforces.com/contest/1498/problem/E)\n>\n>  $n$ \n>\n>  $k_i$\n>\n> **** $u$  $v$\n>\n>  $(u,v)$  $|k_u-k_v|$\n>\n> \n>\n> $n \\le 500$\n\n### \n\n $(u,v)$$u,v$  $u \\rightarrow v$\n\n $v$  $u$$\\exists S,u \\in S \\land \\forall x \\in S, y \\not \\in S,x \\rightarrow y$ $S$  $S$ \n\n$\\therefore k_v \\ge |S|,k_u < |S| \\Rightarrow k_u < k_v$\n\n\n\n\n\n\n\n $O(n^2)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\nconst int N = 1000;\nchar ch[N];\nstruct Qry {\n    int x, y, v;\n    bool operator <(const Qry& b)const { return v > b.v; }\n} q[N * N];\nvector <int> v[N];\nint n, idx, k[N];\nint main() {\n    scanf(\"%d\", &n);\n    rep(i, 1, n) scanf(\"%d\", &k[i]);\n    rep(i, 1, n) rep(j, i + 1, n)\n        q[++idx] = k[i] < k[j] ? (Qry){ j, i, k[j] - k[i] } : (Qry){ i, j, k[i] - k[j] };\n    sort(q + 1, q + idx + 1);\n    rep(i, 1, idx) {\n        printf(\"? %d %d\\n\", q[i].x, q[i].y);\n        fflush(stdout);\n        scanf(\"%s\", ch);\n        if(ch[0] == 'Y') printf(\"! %d %d\\n\", q[i].x, q[i].y), fflush(stdout), exit(0);\n    }\n    puts(\"! 0 0\"), fflush(stdout);\n    return 0;\n}\n```\n\n### \n\n**** $S$$S$  $S$  $S$  $\\binom {|S|}2$****\n\n $m$  $\\binom m2$ $m$ ****\n\n $O(n)$****\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define fi first\n#define se second\n#define mp make_pair\n\nusing namespace std;\nconst int N = 505;\ntypedef pair <int, int> P;\nint n; P a[N];\nint main() {\n    cin >> n;\n    rep(i, 1, n) scanf(\"%d\", &a[i].fi), a[i].se = i;\n    sort(a + 1, a + n + 1);\n    int su = 0; P mi(n, 0), ma(-1, 0);\n    pair <int, P> as;\n    rep(i, 1, n) {\n        su += a[i].fi;\n        mi = min(mi, a[i]), ma = max(ma, a[i]);\n        if(su == i * (i - 1) / 2) {\n            if(mi.se ^ ma.se) as = max(as, mp(ma.fi - mi.fi, mp(mi.se, ma.se)));\n            mi.fi = n, ma.fi = -1;\n        }\n    }\n    if(as.se.fi) printf(\"! %d %d\\n\", as.se.fi, as.se.se);\n    else puts(\"! 0 0\");\n    fflush(stdout);\n    return 0;\n}\n```","slug":"CF1498E","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzk000dootnaq1fdrze","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/1498/problem/E\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(k_i\\)</span></p>\r\n<p><strong></strong> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span></p>\r\n<p> <span class=\"math inline\">\\((u,v)\\)</span>  <span class=\"math inline\">\\(|k_u-k_v|\\)</span></p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n \\le 500\\)</span></p>\r\n</blockquote>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\((u,v)\\)</span><span class=\"math inline\">\\(u,v\\)</span>  <span class=\"math inline\">\\(u \\rightarrow v\\)</span></p>\r\n<p> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(u\\)</span><span class=\"math inline\">\\(\\exists S,u \\in S \\land \\forall x \\in S, y \\not \\in S,x \\rightarrow y\\)</span> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S\\)</span> </p>\r\n<p><span class=\"math inline\">\\(\\therefore k_v \\ge |S|,k_u &lt; |S| \\Rightarrow k_u &lt; k_v\\)</span></p>\r\n<p></p>\r\n<p></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1000</span>;</span><br><span class=\"line\"><span class=\"keyword\">char</span> ch[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Qry</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> x, y, v;</span><br><span class=\"line\">    <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span> &lt;(<span class=\"keyword\">const</span> Qry&amp; b)<span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> v &gt; b.v; &#125;</span><br><span class=\"line\">&#125; q[N * N];</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; v[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, idx, k[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;n);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;k[i]);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">rep</span>(j, i + <span class=\"number\">1</span>, n)</span><br><span class=\"line\">        q[++idx] = k[i] &lt; k[j] ? (Qry)&#123; j, i, k[j] - k[i] &#125; : (Qry)&#123; i, j, k[i] - k[j] &#125;;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(q + <span class=\"number\">1</span>, q + idx + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, idx) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;? %d %d\\n&quot;</span>, q[i].x, q[i].y);</span><br><span class=\"line\">        <span class=\"built_in\">fflush</span>(stdout);</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%s&quot;</span>, ch);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(ch[<span class=\"number\">0</span>] == <span class=\"string\">&#x27;Y&#x27;</span>) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;! %d %d\\n&quot;</span>, q[i].x, q[i].y), <span class=\"built_in\">fflush</span>(stdout), <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;! 0 0&quot;</span>), <span class=\"built_in\">fflush</span>(stdout);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<p><strong></strong> <span class=\"math inline\">\\(S\\)</span><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(\\binom {|S|}2\\)</span><strong></strong></p>\r\n<p> <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(\\binom m2\\)</span> <span class=\"math inline\">\\(m\\)</span> <strong></strong></p>\r\n<p> <span class=\"math inline\">\\(O(n)\\)</span><strong></strong></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> fi first</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> se second</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mp make_pair</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">505</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt; P;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n; P a[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;a[i].fi), a[i].se = i;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(a + <span class=\"number\">1</span>, a + n + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> su = <span class=\"number\">0</span>; <span class=\"function\">P <span class=\"title\">mi</span><span class=\"params\">(n, <span class=\"number\">0</span>)</span>, <span class=\"title\">ma</span><span class=\"params\">(<span class=\"number\">-1</span>, <span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">    pair &lt;<span class=\"keyword\">int</span>, P&gt; as;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        su += a[i].fi;</span><br><span class=\"line\">        mi = <span class=\"built_in\">min</span>(mi, a[i]), ma = <span class=\"built_in\">max</span>(ma, a[i]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(su == i * (i - <span class=\"number\">1</span>) / <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(mi.se ^ ma.se) as = <span class=\"built_in\">max</span>(as, <span class=\"built_in\">mp</span>(ma.fi - mi.fi, <span class=\"built_in\">mp</span>(mi.se, ma.se)));</span><br><span class=\"line\">            mi.fi = n, ma.fi = <span class=\"number\">-1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(as.se.fi) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;! %d %d\\n&quot;</span>, as.se.fi, as.se.se);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;! 0 0&quot;</span>);</span><br><span class=\"line\">    <span class=\"built_in\">fflush</span>(stdout);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2427,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/1498/problem/E\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(k_i\\)</span></p>\r\n<p><strong></strong> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span></p>\r\n<p> <span class=\"math inline\">\\((u,v)\\)</span>  <span class=\"math inline\">\\(|k_u-k_v|\\)</span></p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n \\le 500\\)</span></p>\r\n</blockquote>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\((u,v)\\)</span><span class=\"math inline\">\\(u,v\\)</span>  <span class=\"math inline\">\\(u \\rightarrow v\\)</span></p>\r\n<p> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(u\\)</span><span class=\"math inline\">\\(\\exists S,u \\in S \\land \\forall x \\in S, y \\not \\in S,x \\rightarrow y\\)</span> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S\\)</span> </p>\r\n<p><span class=\"math inline\">\\(\\therefore k_v \\ge |S|,k_u &lt; |S| \\Rightarrow k_u &lt; k_v\\)</span></p>\r\n<p></p>\r\n<p></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1000</span>;</span><br><span class=\"line\"><span class=\"keyword\">char</span> ch[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Qry</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> x, y, v;</span><br><span class=\"line\">    <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span> &lt;(<span class=\"keyword\">const</span> Qry&amp; b)<span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> v &gt; b.v; &#125;</span><br><span class=\"line\">&#125; q[N * N];</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; v[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, idx, k[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;n);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;k[i]);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">rep</span>(j, i + <span class=\"number\">1</span>, n)</span><br><span class=\"line\">        q[++idx] = k[i] &lt; k[j] ? (Qry)&#123; j, i, k[j] - k[i] &#125; : (Qry)&#123; i, j, k[i] - k[j] &#125;;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(q + <span class=\"number\">1</span>, q + idx + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, idx) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;? %d %d\\n&quot;</span>, q[i].x, q[i].y);</span><br><span class=\"line\">        <span class=\"built_in\">fflush</span>(stdout);</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%s&quot;</span>, ch);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(ch[<span class=\"number\">0</span>] == <span class=\"string\">&#x27;Y&#x27;</span>) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;! %d %d\\n&quot;</span>, q[i].x, q[i].y), <span class=\"built_in\">fflush</span>(stdout), <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;! 0 0&quot;</span>), <span class=\"built_in\">fflush</span>(stdout);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<p><strong></strong> <span class=\"math inline\">\\(S\\)</span><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(\\binom {|S|}2\\)</span><strong></strong></p>\r\n<p> <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(\\binom m2\\)</span> <span class=\"math inline\">\\(m\\)</span> <strong></strong></p>\r\n<p> <span class=\"math inline\">\\(O(n)\\)</span><strong></strong></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> fi first</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> se second</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mp make_pair</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">505</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt; P;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n; P a[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;a[i].fi), a[i].se = i;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(a + <span class=\"number\">1</span>, a + n + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> su = <span class=\"number\">0</span>; <span class=\"function\">P <span class=\"title\">mi</span><span class=\"params\">(n, <span class=\"number\">0</span>)</span>, <span class=\"title\">ma</span><span class=\"params\">(<span class=\"number\">-1</span>, <span class=\"number\">0</span>)</span></span>;</span><br><span class=\"line\">    pair &lt;<span class=\"keyword\">int</span>, P&gt; as;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        su += a[i].fi;</span><br><span class=\"line\">        mi = <span class=\"built_in\">min</span>(mi, a[i]), ma = <span class=\"built_in\">max</span>(ma, a[i]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(su == i * (i - <span class=\"number\">1</span>) / <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(mi.se ^ ma.se) as = <span class=\"built_in\">max</span>(as, <span class=\"built_in\">mp</span>(ma.fi - mi.fi, <span class=\"built_in\">mp</span>(mi.se, ma.se)));</span><br><span class=\"line\">            mi.fi = n, ma.fi = <span class=\"number\">-1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(as.se.fi) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;! %d %d\\n&quot;</span>, as.se.fi, as.se.se);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;! 0 0&quot;</span>);</span><br><span class=\"line\">    <span class=\"built_in\">fflush</span>(stdout);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Complete the MST | Codeforces 1508C","date":"2021-04-17T07:05:41.000Z","updated":"2021-04-17T07:05:41.000Z","_content":"> [](https://codeforces.com/contest/1508/problem/C)\n>\n>  $n$  $m$ \n>\n> **** $0$\n>\n> \n>\n> $n \\le 2 \\cdot 10^5,m \\le \\min\\{2 \\cdot 10^5,\\binom n2-1\\}$\n\n**** $m$ ****```MST``` \n\n>  $0$ \n>\n>  $e_1,e_2$ $w_1,w_2$  $0$\n>\n> -  ```MST```  $e_1$  $0$$e_2$  $e_1$   ```MST``` \n> -  ```MST```  $e_1$  $0$$e_2$  $e_1$  $w_1 \\oplus w_2 \\le w_1 + w_2$  ```MST``` \n> -  ```MST```  $e_1$  ```MST```  $e_1$  $0$$e_2$  $e_1$   ```MST``` \n>\n>  $0$  $0$  ```MST``` \n\n**** $m$  $0$\n\n ```MST``` \n\n ```DFS```  ```set```  $O(m\\log n)$ \n\n ```MST```  ```MST```  $O(m\\log m)$\n\n $n$  $O(\\sqrt m)$  ```MST```  ```MST```  $O(m \\log m + nm\\alpha(n))$ $O(m\\log m + n^2\\alpha(n))=O(m\\log m)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nconst int N = 2e5 + 5;\ntypedef long long ll;\nint n, m, fa[N], xorsu, eid, tid;\nint find(int x) { return x ^ fa[x] ? fa[x] = find(fa[x]) : x; }\nint mrg(int u, int v) {\n    if((u = find(u)) ^ (v = find(v))) return fa[u] = v;\n    return 0;\n}\nvector <int> G[N];\nstruct edge {\n    int u, v, w;\n    bool operator <(const edge& b)const {\n        return w < b.w;\n    }\n} e[N], t[N];\nset <int> s;\nvoid dfs(int u) {\n    s.erase(u);\n    For(i, 0, G[u].size() - 1) {\n        int v = G[u][i], nxt = G[u][i + 1];\n        while(!s.empty() && *s.rbegin() > v) {\n            int vv = *s.upper_bound(v);\n            if(vv >= nxt) break;\n            t[++tid] = {u, vv}, dfs(vv);\n        }\n    }\n}\nint main() {\n    cin >> n >> m;\n    rep(i, 1, m) {\n        scanf(\"%d%d%d\", &e[i].u, &e[i].v, &e[i].w), xorsu ^= e[i].w;\n        G[e[i].u].pb(e[i].v), G[e[i].v].pb(e[i].u);\n    }\n    rep(i, 1, n) G[i].pb(0), G[i].pb(n + 1), sort(G[i].begin(), G[i].end()), s.insert(i);\n    while(!s.empty()) dfs(*s.begin());\n    sort(e + 1, e + m + 1);\n    rep(i, 1, n) fa[i] = i;\n    rep(i, 1, m) if(mrg(e[i].u, e[i].v)) e[++eid] = e[i];\n    if(tid < n * (n - 1ll) / 2 - m) {\n        rep(i, 1, n) fa[i] = i;\n        rep(i, 1, tid) mrg(t[i].u, t[i].v);\n        ll as = 0;\n        rep(i, 1, eid) if(mrg(e[i].u, e[i].v)) as += e[i].w;\n        cout << as;\n    } else {\n        ll as = 1e18;\n        rep(i, 0, tid) {\n            rep(j, 1, n) fa[j] = j;\n            rep(j, 1, tid) if(j ^ i) mrg(t[j].u, t[j].v);\n            ll su = i ? 0 : xorsu;\n            rep(j, 1, eid) if(mrg(e[j].u, e[j].v)) su += e[j].w;\n            as = min(as, su);\n        }\n        cout << as;\n    }\n    return 0;\n}\n```","source":"_posts/CF1508C.md","raw":"---\ntitle: Complete the MST | Codeforces 1508C\ndate: 2021-04-17 15:05:41\nupdated: 2021-04-17 15:05:41\ntags: [,]\ncategories: Codeforces\n---\n> [](https://codeforces.com/contest/1508/problem/C)\n>\n>  $n$  $m$ \n>\n> **** $0$\n>\n> \n>\n> $n \\le 2 \\cdot 10^5,m \\le \\min\\{2 \\cdot 10^5,\\binom n2-1\\}$\n\n**** $m$ ****```MST``` \n\n>  $0$ \n>\n>  $e_1,e_2$ $w_1,w_2$  $0$\n>\n> -  ```MST```  $e_1$  $0$$e_2$  $e_1$   ```MST``` \n> -  ```MST```  $e_1$  $0$$e_2$  $e_1$  $w_1 \\oplus w_2 \\le w_1 + w_2$  ```MST``` \n> -  ```MST```  $e_1$  ```MST```  $e_1$  $0$$e_2$  $e_1$   ```MST``` \n>\n>  $0$  $0$  ```MST``` \n\n**** $m$  $0$\n\n ```MST``` \n\n ```DFS```  ```set```  $O(m\\log n)$ \n\n ```MST```  ```MST```  $O(m\\log m)$\n\n $n$  $O(\\sqrt m)$  ```MST```  ```MST```  $O(m \\log m + nm\\alpha(n))$ $O(m\\log m + n^2\\alpha(n))=O(m\\log m)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nconst int N = 2e5 + 5;\ntypedef long long ll;\nint n, m, fa[N], xorsu, eid, tid;\nint find(int x) { return x ^ fa[x] ? fa[x] = find(fa[x]) : x; }\nint mrg(int u, int v) {\n    if((u = find(u)) ^ (v = find(v))) return fa[u] = v;\n    return 0;\n}\nvector <int> G[N];\nstruct edge {\n    int u, v, w;\n    bool operator <(const edge& b)const {\n        return w < b.w;\n    }\n} e[N], t[N];\nset <int> s;\nvoid dfs(int u) {\n    s.erase(u);\n    For(i, 0, G[u].size() - 1) {\n        int v = G[u][i], nxt = G[u][i + 1];\n        while(!s.empty() && *s.rbegin() > v) {\n            int vv = *s.upper_bound(v);\n            if(vv >= nxt) break;\n            t[++tid] = {u, vv}, dfs(vv);\n        }\n    }\n}\nint main() {\n    cin >> n >> m;\n    rep(i, 1, m) {\n        scanf(\"%d%d%d\", &e[i].u, &e[i].v, &e[i].w), xorsu ^= e[i].w;\n        G[e[i].u].pb(e[i].v), G[e[i].v].pb(e[i].u);\n    }\n    rep(i, 1, n) G[i].pb(0), G[i].pb(n + 1), sort(G[i].begin(), G[i].end()), s.insert(i);\n    while(!s.empty()) dfs(*s.begin());\n    sort(e + 1, e + m + 1);\n    rep(i, 1, n) fa[i] = i;\n    rep(i, 1, m) if(mrg(e[i].u, e[i].v)) e[++eid] = e[i];\n    if(tid < n * (n - 1ll) / 2 - m) {\n        rep(i, 1, n) fa[i] = i;\n        rep(i, 1, tid) mrg(t[i].u, t[i].v);\n        ll as = 0;\n        rep(i, 1, eid) if(mrg(e[i].u, e[i].v)) as += e[i].w;\n        cout << as;\n    } else {\n        ll as = 1e18;\n        rep(i, 0, tid) {\n            rep(j, 1, n) fa[j] = j;\n            rep(j, 1, tid) if(j ^ i) mrg(t[j].u, t[j].v);\n            ll su = i ? 0 : xorsu;\n            rep(j, 1, eid) if(mrg(e[j].u, e[j].v)) su += e[j].w;\n            as = min(as, su);\n        }\n        cout << as;\n    }\n    return 0;\n}\n```","slug":"CF1508C","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzm000hootn4b9l05sa","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/1508/problem/C\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span> </p>\r\n<p><strong></strong> <span class=\"math inline\">\\(0\\)</span></p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n \\le 2 \\cdot 10^5,m \\le \\min\\{2 \\cdot 10^5,\\binom n2-1\\}\\)</span></p>\r\n</blockquote>\r\n<p><strong></strong> <span class=\"math inline\">\\(m\\)</span> <strong></strong><code>MST</code> </p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(0\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(e_1,e_2\\)</span> <span class=\"math inline\">\\(w_1,w_2\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<ul>\r\n<li> <code>MST</code>  <span class=\"math inline\">\\(e_1\\)</span>  <span class=\"math inline\">\\(0\\)</span><span class=\"math inline\">\\(e_2\\)</span>  <span class=\"math inline\">\\(e_1\\)</span>  <code>MST</code> </li>\r\n<li> <code>MST</code>  <span class=\"math inline\">\\(e_1\\)</span>  <span class=\"math inline\">\\(0\\)</span><span class=\"math inline\">\\(e_2\\)</span>  <span class=\"math inline\">\\(e_1\\)</span>  <span class=\"math inline\">\\(w_1 \\oplus w_2 \\le w_1 + w_2\\)</span> <code>MST</code> </li>\r\n<li> <code>MST</code>  <span class=\"math inline\">\\(e_1\\)</span>  <code>MST</code>  <span class=\"math inline\">\\(e_1\\)</span>  <span class=\"math inline\">\\(0\\)</span><span class=\"math inline\">\\(e_2\\)</span>  <span class=\"math inline\">\\(e_1\\)</span>  <code>MST</code> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(0\\)</span> <code>MST</code> </p>\r\n</blockquote>\r\n<p><strong></strong> <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <code>MST</code> </p>\r\n<p> <code>DFS</code>  <code>set</code>  <span class=\"math inline\">\\(O(m\\log n)\\)</span> </p>\r\n<p> <code>MST</code>  <code>MST</code>  <span class=\"math inline\">\\(O(m\\log m)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(O(\\sqrt m)\\)</span>  <code>MST</code>  <code>MST</code>  <span class=\"math inline\">\\(O(m \\log m + nm\\alpha(n))\\)</span> <span class=\"math inline\">\\(O(m\\log m + n^2\\alpha(n))=O(m\\log m)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, fa[N], xorsu, eid, tid;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">find</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123; <span class=\"keyword\">return</span> x ^ fa[x] ? fa[x] = <span class=\"built_in\">find</span>(fa[x]) : x; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">mrg</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>((u = <span class=\"built_in\">find</span>(u)) ^ (v = <span class=\"built_in\">find</span>(v))) <span class=\"keyword\">return</span> fa[u] = v;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; G[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">edge</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v, w;</span><br><span class=\"line\">    <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span> &lt;(<span class=\"keyword\">const</span> edge&amp; b)<span class=\"keyword\">const</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> w &lt; b.w;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; e[N], t[N];</span><br><span class=\"line\">set &lt;<span class=\"keyword\">int</span>&gt; s;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    s.<span class=\"built_in\">erase</span>(u);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, G[u].<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> v = G[u][i], nxt = G[u][i + <span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>() &amp;&amp; *s.<span class=\"built_in\">rbegin</span>() &gt; v) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> vv = *s.<span class=\"built_in\">upper_bound</span>(v);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(vv &gt;= nxt) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            t[++tid] = &#123;u, vv&#125;, <span class=\"built_in\">dfs</span>(vv);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;e[i].u, &amp;e[i].v, &amp;e[i].w), xorsu ^= e[i].w;</span><br><span class=\"line\">        G[e[i].u].<span class=\"built_in\">pb</span>(e[i].v), G[e[i].v].<span class=\"built_in\">pb</span>(e[i].u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) G[i].<span class=\"built_in\">pb</span>(<span class=\"number\">0</span>), G[i].<span class=\"built_in\">pb</span>(n + <span class=\"number\">1</span>), <span class=\"built_in\">sort</span>(G[i].<span class=\"built_in\">begin</span>(), G[i].<span class=\"built_in\">end</span>()), s.<span class=\"built_in\">insert</span>(i);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>()) <span class=\"built_in\">dfs</span>(*s.<span class=\"built_in\">begin</span>());</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(e + <span class=\"number\">1</span>, e + m + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) fa[i] = i;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) <span class=\"keyword\">if</span>(<span class=\"built_in\">mrg</span>(e[i].u, e[i].v)) e[++eid] = e[i];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(tid &lt; n * (n - <span class=\"number\">1ll</span>) / <span class=\"number\">2</span> - m) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) fa[i] = i;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, tid) <span class=\"built_in\">mrg</span>(t[i].u, t[i].v);</span><br><span class=\"line\">        ll as = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, eid) <span class=\"keyword\">if</span>(<span class=\"built_in\">mrg</span>(e[i].u, e[i].v)) as += e[i].w;</span><br><span class=\"line\">        cout &lt;&lt; as;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        ll as = <span class=\"number\">1e18</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, tid) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, n) fa[j] = j;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, tid) <span class=\"keyword\">if</span>(j ^ i) <span class=\"built_in\">mrg</span>(t[j].u, t[j].v);</span><br><span class=\"line\">            ll su = i ? <span class=\"number\">0</span> : xorsu;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, eid) <span class=\"keyword\">if</span>(<span class=\"built_in\">mrg</span>(e[j].u, e[j].v)) su += e[j].w;</span><br><span class=\"line\">            as = <span class=\"built_in\">min</span>(as, su);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        cout &lt;&lt; as;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2579,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/1508/problem/C\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span> </p>\r\n<p><strong></strong> <span class=\"math inline\">\\(0\\)</span></p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n \\le 2 \\cdot 10^5,m \\le \\min\\{2 \\cdot 10^5,\\binom n2-1\\}\\)</span></p>\r\n</blockquote>\r\n<p><strong></strong> <span class=\"math inline\">\\(m\\)</span> <strong></strong><code>MST</code> </p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(0\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(e_1,e_2\\)</span> <span class=\"math inline\">\\(w_1,w_2\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<ul>\r\n<li> <code>MST</code>  <span class=\"math inline\">\\(e_1\\)</span>  <span class=\"math inline\">\\(0\\)</span><span class=\"math inline\">\\(e_2\\)</span>  <span class=\"math inline\">\\(e_1\\)</span>  <code>MST</code> </li>\r\n<li> <code>MST</code>  <span class=\"math inline\">\\(e_1\\)</span>  <span class=\"math inline\">\\(0\\)</span><span class=\"math inline\">\\(e_2\\)</span>  <span class=\"math inline\">\\(e_1\\)</span>  <span class=\"math inline\">\\(w_1 \\oplus w_2 \\le w_1 + w_2\\)</span> <code>MST</code> </li>\r\n<li> <code>MST</code>  <span class=\"math inline\">\\(e_1\\)</span>  <code>MST</code>  <span class=\"math inline\">\\(e_1\\)</span>  <span class=\"math inline\">\\(0\\)</span><span class=\"math inline\">\\(e_2\\)</span>  <span class=\"math inline\">\\(e_1\\)</span>  <code>MST</code> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(0\\)</span> <code>MST</code> </p>\r\n</blockquote>\r\n<p><strong></strong> <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <code>MST</code> </p>\r\n<p> <code>DFS</code>  <code>set</code>  <span class=\"math inline\">\\(O(m\\log n)\\)</span> </p>\r\n<p> <code>MST</code>  <code>MST</code>  <span class=\"math inline\">\\(O(m\\log m)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(O(\\sqrt m)\\)</span>  <code>MST</code>  <code>MST</code>  <span class=\"math inline\">\\(O(m \\log m + nm\\alpha(n))\\)</span> <span class=\"math inline\">\\(O(m\\log m + n^2\\alpha(n))=O(m\\log m)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, fa[N], xorsu, eid, tid;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">find</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123; <span class=\"keyword\">return</span> x ^ fa[x] ? fa[x] = <span class=\"built_in\">find</span>(fa[x]) : x; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">mrg</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>((u = <span class=\"built_in\">find</span>(u)) ^ (v = <span class=\"built_in\">find</span>(v))) <span class=\"keyword\">return</span> fa[u] = v;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; G[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">edge</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v, w;</span><br><span class=\"line\">    <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span> &lt;(<span class=\"keyword\">const</span> edge&amp; b)<span class=\"keyword\">const</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> w &lt; b.w;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; e[N], t[N];</span><br><span class=\"line\">set &lt;<span class=\"keyword\">int</span>&gt; s;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    s.<span class=\"built_in\">erase</span>(u);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, G[u].<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> v = G[u][i], nxt = G[u][i + <span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>() &amp;&amp; *s.<span class=\"built_in\">rbegin</span>() &gt; v) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> vv = *s.<span class=\"built_in\">upper_bound</span>(v);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(vv &gt;= nxt) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            t[++tid] = &#123;u, vv&#125;, <span class=\"built_in\">dfs</span>(vv);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;e[i].u, &amp;e[i].v, &amp;e[i].w), xorsu ^= e[i].w;</span><br><span class=\"line\">        G[e[i].u].<span class=\"built_in\">pb</span>(e[i].v), G[e[i].v].<span class=\"built_in\">pb</span>(e[i].u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) G[i].<span class=\"built_in\">pb</span>(<span class=\"number\">0</span>), G[i].<span class=\"built_in\">pb</span>(n + <span class=\"number\">1</span>), <span class=\"built_in\">sort</span>(G[i].<span class=\"built_in\">begin</span>(), G[i].<span class=\"built_in\">end</span>()), s.<span class=\"built_in\">insert</span>(i);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(!s.<span class=\"built_in\">empty</span>()) <span class=\"built_in\">dfs</span>(*s.<span class=\"built_in\">begin</span>());</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(e + <span class=\"number\">1</span>, e + m + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) fa[i] = i;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) <span class=\"keyword\">if</span>(<span class=\"built_in\">mrg</span>(e[i].u, e[i].v)) e[++eid] = e[i];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(tid &lt; n * (n - <span class=\"number\">1ll</span>) / <span class=\"number\">2</span> - m) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) fa[i] = i;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, tid) <span class=\"built_in\">mrg</span>(t[i].u, t[i].v);</span><br><span class=\"line\">        ll as = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, eid) <span class=\"keyword\">if</span>(<span class=\"built_in\">mrg</span>(e[i].u, e[i].v)) as += e[i].w;</span><br><span class=\"line\">        cout &lt;&lt; as;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        ll as = <span class=\"number\">1e18</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, tid) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, n) fa[j] = j;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, tid) <span class=\"keyword\">if</span>(j ^ i) <span class=\"built_in\">mrg</span>(t[j].u, t[j].v);</span><br><span class=\"line\">            ll su = i ? <span class=\"number\">0</span> : xorsu;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, eid) <span class=\"keyword\">if</span>(<span class=\"built_in\">mrg</span>(e[j].u, e[j].v)) su += e[j].w;</span><br><span class=\"line\">            as = <span class=\"built_in\">min</span>(as, su);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        cout &lt;&lt; as;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Christmas Game | Codeforces 1498F","date":"2021-03-31T03:27:23.000Z","updated":"2021-03-31T03:27:23.000Z","_content":"> [](https://codeforces.com/contest/1498/problem/F)\n>\n>  $n$  $k$ $a_i$ ```Alice```  ```Bob``` \n>\n>  $k$  $u$ $u$  $u$  $k$ \n>\n> \n>\n> \n>\n> $n \\le 10^5, k \\le 20,a_i \\le 10^9$\n\n $k=1$ [ ```NIM``` ](http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/nim-you-xi-and-sg-ding-li/)\n\n $0$ ```NIM```  ```NIM```  $a_i$  $0$\n\n\n$$\n\\bigoplus_{\\big\\lfloor \\frac {depth_u}k \\big\\rfloor }a_u \\ne 0\n$$\n $f_{u,i}$  $u$  $depth_v - depth_u \\equiv i \\pmod {2k}$  $v$ \n\n ```DP``` \n\n $O(nk)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\ntypedef long long ll;\nconst int N = 1e5 + 5;\nint n, K, a[N];\nll f[N][40], ans[N];\nvector <int> G[N];\nvoid add(int u, int v) {\n    For(i, 0, K) f[u][(i + 1) % K] ^= f[v][i];\n}\nvoid dfs(int u, int fa) {\n    f[u][0] = a[u];\n    for(int v : G[u]) if(v ^ fa) dfs(v, u), add(u, v);\n}\nvoid Dfs(int u, int fa) {\n    For(i, K / 2, K) ans[u] ^= f[u][i];\n    for(int v : G[u]) if(v ^ fa) add(u, v), add(v, u), Dfs(v, u), add(v, u), add(u, v);\n}\nint main() {\n    cin >> n >> K, K *= 2;\n    int u, v;\n    rep(i, 2, n) {\n        scanf(\"%d%d\", &u, &v);\n        G[u].push_back(v), G[v].push_back(u);\n    }\n    rep(i, 1, n) scanf(\"%d\", &a[i]);\n    dfs(1, 0), Dfs(1, 0);\n    rep(i, 1, n) printf(\"%d \", ans[i] != 0);\n    return 0;\n}\n```","source":"_posts/CF1498F.md","raw":"---\ntitle: Christmas Game | Codeforces 1498F\ndate: 2021-03-31 11:27:23\nupdated: 2021-03-31 11:27:23\ntags: [, NIM ,]\ncategories: Codeforces\n---\n> [](https://codeforces.com/contest/1498/problem/F)\n>\n>  $n$  $k$ $a_i$ ```Alice```  ```Bob``` \n>\n>  $k$  $u$ $u$  $u$  $k$ \n>\n> \n>\n> \n>\n> $n \\le 10^5, k \\le 20,a_i \\le 10^9$\n\n $k=1$ [ ```NIM``` ](http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/nim-you-xi-and-sg-ding-li/)\n\n $0$ ```NIM```  ```NIM```  $a_i$  $0$\n\n\n$$\n\\bigoplus_{\\big\\lfloor \\frac {depth_u}k \\big\\rfloor }a_u \\ne 0\n$$\n $f_{u,i}$  $u$  $depth_v - depth_u \\equiv i \\pmod {2k}$  $v$ \n\n ```DP``` \n\n $O(nk)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\ntypedef long long ll;\nconst int N = 1e5 + 5;\nint n, K, a[N];\nll f[N][40], ans[N];\nvector <int> G[N];\nvoid add(int u, int v) {\n    For(i, 0, K) f[u][(i + 1) % K] ^= f[v][i];\n}\nvoid dfs(int u, int fa) {\n    f[u][0] = a[u];\n    for(int v : G[u]) if(v ^ fa) dfs(v, u), add(u, v);\n}\nvoid Dfs(int u, int fa) {\n    For(i, K / 2, K) ans[u] ^= f[u][i];\n    for(int v : G[u]) if(v ^ fa) add(u, v), add(v, u), Dfs(v, u), add(v, u), add(u, v);\n}\nint main() {\n    cin >> n >> K, K *= 2;\n    int u, v;\n    rep(i, 2, n) {\n        scanf(\"%d%d\", &u, &v);\n        G[u].push_back(v), G[v].push_back(u);\n    }\n    rep(i, 1, n) scanf(\"%d\", &a[i]);\n    dfs(1, 0), Dfs(1, 0);\n    rep(i, 1, n) printf(\"%d \", ans[i] != 0);\n    return 0;\n}\n```","slug":"CF1498F","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzn000iootn8fks0s6f","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/1498/problem/F\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(k\\)</span> <span class=\"math inline\">\\(a_i\\)</span> <code>Alice</code>  <code>Bob</code> </p>\r\n<p> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(u\\)</span> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p></p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n \\le 10^5, k \\le 20,a_i \\le 10^9\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(k=1\\)</span> <a href=\"http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/nim-you-xi-and-sg-ding-li/\"> <code>NIM</code> </a></p>\r\n<p> <span class=\"math inline\">\\(0\\)</span> <code>NIM</code>  <code>NIM</code>  <span class=\"math inline\">\\(a_i\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\bigoplus_{\\big\\lfloor \\frac {depth_u}k \\big\\rfloor }a_u \\ne 0\r\n\\]</span>  <span class=\"math inline\">\\(f_{u,i}\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(depth_v - depth_u \\equiv i \\pmod {2k}\\)</span>  <span class=\"math inline\">\\(v\\)</span> </p>\r\n<p> <code>DP</code> </p>\r\n<p> <span class=\"math inline\">\\(O(nk)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, K, a[N];</span><br><span class=\"line\">ll f[N][<span class=\"number\">40</span>], ans[N];</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; G[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) f[u][(i + <span class=\"number\">1</span>) % K] ^= f[v][i];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> fa)</span> </span>&#123;</span><br><span class=\"line\">    f[u][<span class=\"number\">0</span>] = a[u];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(v ^ fa) <span class=\"built_in\">dfs</span>(v, u), <span class=\"built_in\">add</span>(u, v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> fa)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, K / <span class=\"number\">2</span>, K) ans[u] ^= f[u][i];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(v ^ fa) <span class=\"built_in\">add</span>(u, v), <span class=\"built_in\">add</span>(v, u), <span class=\"built_in\">Dfs</span>(v, u), <span class=\"built_in\">add</span>(v, u), <span class=\"built_in\">add</span>(u, v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; K, K *= <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class=\"line\">        G[u].<span class=\"built_in\">push_back</span>(v), G[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>), <span class=\"built_in\">Dfs</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, ans[i] != <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":1386,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/1498/problem/F\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(k\\)</span> <span class=\"math inline\">\\(a_i\\)</span> <code>Alice</code>  <code>Bob</code> </p>\r\n<p> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(u\\)</span> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p></p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n \\le 10^5, k \\le 20,a_i \\le 10^9\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(k=1\\)</span> <a href=\"http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/nim-you-xi-and-sg-ding-li/\"> <code>NIM</code> </a></p>\r\n<p> <span class=\"math inline\">\\(0\\)</span> <code>NIM</code>  <code>NIM</code>  <span class=\"math inline\">\\(a_i\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\bigoplus_{\\big\\lfloor \\frac {depth_u}k \\big\\rfloor }a_u \\ne 0\r\n\\]</span>  <span class=\"math inline\">\\(f_{u,i}\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(depth_v - depth_u \\equiv i \\pmod {2k}\\)</span>  <span class=\"math inline\">\\(v\\)</span> </p>\r\n<p> <code>DP</code> </p>\r\n<p> <span class=\"math inline\">\\(O(nk)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, K, a[N];</span><br><span class=\"line\">ll f[N][<span class=\"number\">40</span>], ans[N];</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; G[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) f[u][(i + <span class=\"number\">1</span>) % K] ^= f[v][i];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> fa)</span> </span>&#123;</span><br><span class=\"line\">    f[u][<span class=\"number\">0</span>] = a[u];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(v ^ fa) <span class=\"built_in\">dfs</span>(v, u), <span class=\"built_in\">add</span>(u, v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> fa)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, K / <span class=\"number\">2</span>, K) ans[u] ^= f[u][i];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(v ^ fa) <span class=\"built_in\">add</span>(u, v), <span class=\"built_in\">add</span>(v, u), <span class=\"built_in\">Dfs</span>(v, u), <span class=\"built_in\">add</span>(v, u), <span class=\"built_in\">add</span>(u, v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; K, K *= <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class=\"line\">        G[u].<span class=\"built_in\">push_back</span>(v), G[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>), <span class=\"built_in\">Dfs</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, ans[i] != <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Baby Ehab Plays with Permutations | Codeforces 1516E","date":"2021-05-02T12:35:00.000Z","updated":"2021-05-02T12:35:00.000Z","_content":">[](https://codeforces.com/problemset/problem/1516/E)\n>\n> $n,k$ $i \\in [1,k]$ $n$  $i$  $\\{1,2,\\cdots,n\\}$\n>\n> $10^9+7$ \n>\n>$n \\le 10^9,k \\le 200$\n\n $P$ $\\{1,2,\\cdots,n\\}$\n\n $P$  $i$  $i-1$ \n\n $P$  $x$ $n-x$\n\n****\n\n$i$  ${n \\brack n-i}+{n \\brack n-i+2}+{n \\brack n-i+4} + \\cdots$\n\n $n$ \n\n $i$  $2i$  $P$  $2i$  $j$  $j \\ne P_j$\n\n $j$  $j \\ne P_j$ $x$  $\\binom nxf_{x,x-i}$\n\n $f_{i,j}$  $i$ **** $j$\n$$\nf_{i,j}={i \\brack j}-\\sum_{k=1}^j\\binom ikf_{i-k,j-k}\n$$\n $O(k^3)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define pb push_back\n\nusing namespace std;\n\ntypedef long long ll;\nconst int N = 205;\nconst ll P = 1e9 + 7;\n\nint n, K, C[N * 2][N * 2];\nll f[N * 2][N], as[N];\n\nll Pow(ll a, int n, ll r = 1) {\n    for(; n; n /= 2, a = a * a % P)\n    if(n & 1) r = r * a % P;\n    return r;\n}\nll calc(int x) {\n    ll a = 1, b = 1;\n    while(x) b = b * x-- % P, a = a * (n - x) % P;\n    return a * Pow(b, P - 2) % P;\n}\nint main() {\n    cin >> n >> K;\n    f[0][0] = 1;\n    rep(i, 1, K * 2) rep(j, 1, K)\n        f[i][j] = (f[i - 1][j - 1] + (i - 1) * f[i - 1][j]) % P;\n    rep(i, 0, K * 2) {\n        C[i][0] = 1;\n        rep(j, 1, i) C[i][j] = (C[i - 1][j - 1] + C[i - 1][j]) % P;\n    }\n    rep(i, 1, K * 2) rep(j, 1, i) rep(k, 1, j)\n        (f[i][j] -= C[i][k] * f[i - k][j - k]) %= P;\n    rep(i, 0, K) {\n        rep(j, i, i * 2) (as[i] += f[j][j - i] * calc(j)) %= P;\n        if(i >= 2) (as[i] += as[i - 2]) %= P;\n        if(i) printf(\"%lld \", (as[i] + P) % P);\n    }\n    return 0;\n}\n```","source":"_posts/CF1515E.md","raw":"---\ntitle: Baby Ehab Plays with Permutations | Codeforces 1516E\ndate: 2021-05-02 20:35:00\nupdated: 2021-05-02 20:35:00\ntags: [,,,]\ncategories: Codeforces\n---\n>[](https://codeforces.com/problemset/problem/1516/E)\n>\n> $n,k$ $i \\in [1,k]$ $n$  $i$  $\\{1,2,\\cdots,n\\}$\n>\n> $10^9+7$ \n>\n>$n \\le 10^9,k \\le 200$\n\n $P$ $\\{1,2,\\cdots,n\\}$\n\n $P$  $i$  $i-1$ \n\n $P$  $x$ $n-x$\n\n****\n\n$i$  ${n \\brack n-i}+{n \\brack n-i+2}+{n \\brack n-i+4} + \\cdots$\n\n $n$ \n\n $i$  $2i$  $P$  $2i$  $j$  $j \\ne P_j$\n\n $j$  $j \\ne P_j$ $x$  $\\binom nxf_{x,x-i}$\n\n $f_{i,j}$  $i$ **** $j$\n$$\nf_{i,j}={i \\brack j}-\\sum_{k=1}^j\\binom ikf_{i-k,j-k}\n$$\n $O(k^3)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define pb push_back\n\nusing namespace std;\n\ntypedef long long ll;\nconst int N = 205;\nconst ll P = 1e9 + 7;\n\nint n, K, C[N * 2][N * 2];\nll f[N * 2][N], as[N];\n\nll Pow(ll a, int n, ll r = 1) {\n    for(; n; n /= 2, a = a * a % P)\n    if(n & 1) r = r * a % P;\n    return r;\n}\nll calc(int x) {\n    ll a = 1, b = 1;\n    while(x) b = b * x-- % P, a = a * (n - x) % P;\n    return a * Pow(b, P - 2) % P;\n}\nint main() {\n    cin >> n >> K;\n    f[0][0] = 1;\n    rep(i, 1, K * 2) rep(j, 1, K)\n        f[i][j] = (f[i - 1][j - 1] + (i - 1) * f[i - 1][j]) % P;\n    rep(i, 0, K * 2) {\n        C[i][0] = 1;\n        rep(j, 1, i) C[i][j] = (C[i - 1][j - 1] + C[i - 1][j]) % P;\n    }\n    rep(i, 1, K * 2) rep(j, 1, i) rep(k, 1, j)\n        (f[i][j] -= C[i][k] * f[i - k][j - k]) %= P;\n    rep(i, 0, K) {\n        rep(j, i, i * 2) (as[i] += f[j][j - i] * calc(j)) %= P;\n        if(i >= 2) (as[i] += as[i - 2]) %= P;\n        if(i) printf(\"%lld \", (as[i] + P) % P);\n    }\n    return 0;\n}\n```","slug":"CF1515E","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzp000mootnaem74fd7","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/problemset/problem/1516/E\"></a></p>\r\n<p> <span class=\"math inline\">\\(n,k\\)</span> <span class=\"math inline\">\\(i \\in [1,k]\\)</span> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(\\{1,2,\\cdots,n\\}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(10^9+7\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 10^9,k \\le 200\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(P\\)</span> <span class=\"math inline\">\\(\\{1,2,\\cdots,n\\}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(P\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i-1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(P\\)</span>  <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(n-x\\)</span></p>\r\n<p><strong></strong></p>\r\n<p><span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\({n \\brack n-i}+{n \\brack n-i+2}+{n \\brack n-i+4} + \\cdots\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(2i\\)</span>  <span class=\"math inline\">\\(P\\)</span>  <span class=\"math inline\">\\(2i\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(j \\ne P_j\\)</span></p>\r\n<p> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(j \\ne P_j\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(\\binom nxf_{x,x-i}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(f_{i,j}\\)</span>  <span class=\"math inline\">\\(i\\)</span> <strong></strong> <span class=\"math inline\">\\(j\\)</span> <span class=\"math display\">\\[\r\nf_{i,j}={i \\brack j}-\\sum_{k=1}^j\\binom ikf_{i-k,j-k}\r\n\\]</span>  <span class=\"math inline\">\\(O(k^3)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">205</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> ll P = <span class=\"number\">1e9</span> + <span class=\"number\">7</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, K, C[N * <span class=\"number\">2</span>][N * <span class=\"number\">2</span>];</span><br><span class=\"line\">ll f[N * <span class=\"number\">2</span>][N], as[N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">Pow</span><span class=\"params\">(ll a, <span class=\"keyword\">int</span> n, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a % P)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">calc</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    ll a = <span class=\"number\">1</span>, b = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(x) b = b * x-- % P, a = a * (n - x) % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a * <span class=\"built_in\">Pow</span>(b, P - <span class=\"number\">2</span>) % P;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; K;</span><br><span class=\"line\">    f[<span class=\"number\">0</span>][<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, K * <span class=\"number\">2</span>) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, K)</span><br><span class=\"line\">        f[i][j] = (f[i - <span class=\"number\">1</span>][j - <span class=\"number\">1</span>] + (i - <span class=\"number\">1</span>) * f[i - <span class=\"number\">1</span>][j]) % P;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, K * <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">        C[i][<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, i) C[i][j] = (C[i - <span class=\"number\">1</span>][j - <span class=\"number\">1</span>] + C[i - <span class=\"number\">1</span>][j]) % P;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, K * <span class=\"number\">2</span>) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, i) <span class=\"built_in\">rep</span>(k, <span class=\"number\">1</span>, j)</span><br><span class=\"line\">        (f[i][j] -= C[i][k] * f[i - k][j - k]) %= P;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, K) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, i, i * <span class=\"number\">2</span>) (as[i] += f[j][j - i] * <span class=\"built_in\">calc</span>(j)) %= P;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i &gt;= <span class=\"number\">2</span>) (as[i] += as[i - <span class=\"number\">2</span>]) %= P;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%lld &quot;</span>, (as[i] + P) % P);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":1555,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/problemset/problem/1516/E\"></a></p>\r\n<p> <span class=\"math inline\">\\(n,k\\)</span> <span class=\"math inline\">\\(i \\in [1,k]\\)</span> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(\\{1,2,\\cdots,n\\}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(10^9+7\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 10^9,k \\le 200\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(P\\)</span> <span class=\"math inline\">\\(\\{1,2,\\cdots,n\\}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(P\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i-1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(P\\)</span>  <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(n-x\\)</span></p>\r\n<p><strong></strong></p>\r\n<p><span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\({n \\brack n-i}+{n \\brack n-i+2}+{n \\brack n-i+4} + \\cdots\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(2i\\)</span>  <span class=\"math inline\">\\(P\\)</span>  <span class=\"math inline\">\\(2i\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(j \\ne P_j\\)</span></p>\r\n<p> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(j \\ne P_j\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(\\binom nxf_{x,x-i}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(f_{i,j}\\)</span>  <span class=\"math inline\">\\(i\\)</span> <strong></strong> <span class=\"math inline\">\\(j\\)</span> <span class=\"math display\">\\[\r\nf_{i,j}={i \\brack j}-\\sum_{k=1}^j\\binom ikf_{i-k,j-k}\r\n\\]</span>  <span class=\"math inline\">\\(O(k^3)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">205</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> ll P = <span class=\"number\">1e9</span> + <span class=\"number\">7</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, K, C[N * <span class=\"number\">2</span>][N * <span class=\"number\">2</span>];</span><br><span class=\"line\">ll f[N * <span class=\"number\">2</span>][N], as[N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">Pow</span><span class=\"params\">(ll a, <span class=\"keyword\">int</span> n, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a % P)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">calc</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    ll a = <span class=\"number\">1</span>, b = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(x) b = b * x-- % P, a = a * (n - x) % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a * <span class=\"built_in\">Pow</span>(b, P - <span class=\"number\">2</span>) % P;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; K;</span><br><span class=\"line\">    f[<span class=\"number\">0</span>][<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, K * <span class=\"number\">2</span>) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, K)</span><br><span class=\"line\">        f[i][j] = (f[i - <span class=\"number\">1</span>][j - <span class=\"number\">1</span>] + (i - <span class=\"number\">1</span>) * f[i - <span class=\"number\">1</span>][j]) % P;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, K * <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">        C[i][<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, i) C[i][j] = (C[i - <span class=\"number\">1</span>][j - <span class=\"number\">1</span>] + C[i - <span class=\"number\">1</span>][j]) % P;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, K * <span class=\"number\">2</span>) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, i) <span class=\"built_in\">rep</span>(k, <span class=\"number\">1</span>, j)</span><br><span class=\"line\">        (f[i][j] -= C[i][k] * f[i - k][j - k]) %= P;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, K) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, i, i * <span class=\"number\">2</span>) (as[i] += f[j][j - i] * <span class=\"built_in\">calc</span>(j)) %= P;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i &gt;= <span class=\"number\">2</span>) (as[i] += as[i - <span class=\"number\">2</span>]) %= P;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%lld &quot;</span>, (as[i] + P) % P);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Phoenix and Earthquake | Codeforces 1515F","date":"2021-05-03T07:35:26.000Z","updated":"2021-05-03T07:35:26.000Z","_content":"> [](https://codeforces.com/problemset/problem/1515/F)\n>\n>  $n$  $m$  $x$ $a_i$\n>\n>  $(u,v)$  $a_u+a_v \\ge x$ $u,v$  $a_u+a_v-x$\n>\n> \n>\n> $n,m \\le 3 \\cdot 10^5,x,a_i \\le 10^9$\n\n $x$ $a_u + a_v \\ge -x$ $a_u + a_v$\n\n>  $-x$\n\n $u$ \n\n $(u,v)$ $a_u+a_v<-x$\n\n $\\because a_v \\ge -x,\\therefore a_u < 0$\n\n $a_u$  $a_u+a_v \\ge \\sum a_i \\ge -x$\n\n\n\n\n\n\n\n\n\n ```DFS``` ```DFS``` \n\n $O(n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define eb emplace_back\n\nusing namespace std;\n\nconst int N = 3e5 + 5;\n\nint n, m, x, vis[N], as[N], L, R;\nlong long a[N], su;\nvector <pair <int, int>> G[N];\n\nvoid dfs(int u) {\n    vis[u] = 1;\n    for(auto [v, i] : G[u]) if(!vis[v])\n        dfs(v), a[v] >= 0 ? a[u] += a[v], as[L++] = i : as[R--] = i;\n}\nint main() {\n    cin >> n >> m >> x;\n    rep(i, 1, n) scanf(\"%lld\", &a[i]), su += a[i] -= x;\n    int u, v;\n    rep(i, 1, m) scanf(\"%d%d\", &u, &v), G[u].eb(v, i), G[v].eb(u, i);\n    if(su + x < 0) puts(\"NO\"), exit(0);\n    puts(\"YES\"), L = 2, R = n, dfs(1);\n    rep(i, 2, n) printf(\"%d\\n\", as[i]);\n    return 0;\n}\n```","source":"_posts/CF1515F.md","raw":"---\ntitle: Phoenix and Earthquake | Codeforces 1515F\ndate: 2021-05-03 15:35:26\nupdated: 2021-05-03 15:35:26\ntags: [,]\ncategories: Codeforces\n---\n> [](https://codeforces.com/problemset/problem/1515/F)\n>\n>  $n$  $m$  $x$ $a_i$\n>\n>  $(u,v)$  $a_u+a_v \\ge x$ $u,v$  $a_u+a_v-x$\n>\n> \n>\n> $n,m \\le 3 \\cdot 10^5,x,a_i \\le 10^9$\n\n $x$ $a_u + a_v \\ge -x$ $a_u + a_v$\n\n>  $-x$\n\n $u$ \n\n $(u,v)$ $a_u+a_v<-x$\n\n $\\because a_v \\ge -x,\\therefore a_u < 0$\n\n $a_u$  $a_u+a_v \\ge \\sum a_i \\ge -x$\n\n\n\n\n\n\n\n\n\n ```DFS``` ```DFS``` \n\n $O(n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define eb emplace_back\n\nusing namespace std;\n\nconst int N = 3e5 + 5;\n\nint n, m, x, vis[N], as[N], L, R;\nlong long a[N], su;\nvector <pair <int, int>> G[N];\n\nvoid dfs(int u) {\n    vis[u] = 1;\n    for(auto [v, i] : G[u]) if(!vis[v])\n        dfs(v), a[v] >= 0 ? a[u] += a[v], as[L++] = i : as[R--] = i;\n}\nint main() {\n    cin >> n >> m >> x;\n    rep(i, 1, n) scanf(\"%lld\", &a[i]), su += a[i] -= x;\n    int u, v;\n    rep(i, 1, m) scanf(\"%d%d\", &u, &v), G[u].eb(v, i), G[v].eb(u, i);\n    if(su + x < 0) puts(\"NO\"), exit(0);\n    puts(\"YES\"), L = 2, R = n, dfs(1);\n    rep(i, 2, n) printf(\"%d\\n\", as[i]);\n    return 0;\n}\n```","slug":"CF1515F","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzp000oootnh031bevk","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/problemset/problem/1515/F\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(a_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\((u,v)\\)</span>  <span class=\"math inline\">\\(a_u+a_v \\ge x\\)</span> <span class=\"math inline\">\\(u,v\\)</span>  <span class=\"math inline\">\\(a_u+a_v-x\\)</span></p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n,m \\le 3 \\cdot 10^5,x,a_i \\le 10^9\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(a_u + a_v \\ge -x\\)</span> <span class=\"math inline\">\\(a_u + a_v\\)</span></p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(-x\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\((u,v)\\)</span> <span class=\"math inline\">\\(a_u+a_v&lt;-x\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\because a_v \\ge -x,\\therefore a_u &lt; 0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a_u\\)</span>  <span class=\"math inline\">\\(a_u+a_v \\ge \\sum a_i \\ge -x\\)</span></p>\r\n<p></p>\r\n<p></p>\r\n<p></p>\r\n<p></p>\r\n<p> <code>DFS</code> <code>DFS</code> </p>\r\n<p> <span class=\"math inline\">\\(O(n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> eb emplace_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">3e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, x, vis[N], as[N], L, R;</span><br><span class=\"line\"><span class=\"keyword\">long</span> <span class=\"keyword\">long</span> a[N], su;</span><br><span class=\"line\">vector &lt;pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; G[N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    vis[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, i] : G[u]) <span class=\"keyword\">if</span>(!vis[v])</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(v), a[v] &gt;= <span class=\"number\">0</span> ? a[u] += a[v], as[L++] = i : as[R--] = i;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; x;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%lld&quot;</span>, &amp;a[i]), su += a[i] -= x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;u, &amp;v), G[u].<span class=\"built_in\">eb</span>(v, i), G[v].<span class=\"built_in\">eb</span>(u, i);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(su + x &lt; <span class=\"number\">0</span>) <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;NO&quot;</span>), <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;YES&quot;</span>), L = <span class=\"number\">2</span>, R = n, <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, as[i]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":1323,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/problemset/problem/1515/F\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(a_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\((u,v)\\)</span>  <span class=\"math inline\">\\(a_u+a_v \\ge x\\)</span> <span class=\"math inline\">\\(u,v\\)</span>  <span class=\"math inline\">\\(a_u+a_v-x\\)</span></p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n,m \\le 3 \\cdot 10^5,x,a_i \\le 10^9\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(a_u + a_v \\ge -x\\)</span> <span class=\"math inline\">\\(a_u + a_v\\)</span></p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(-x\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\((u,v)\\)</span> <span class=\"math inline\">\\(a_u+a_v&lt;-x\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\because a_v \\ge -x,\\therefore a_u &lt; 0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a_u\\)</span>  <span class=\"math inline\">\\(a_u+a_v \\ge \\sum a_i \\ge -x\\)</span></p>\r\n<p></p>\r\n<p></p>\r\n<p></p>\r\n<p></p>\r\n<p> <code>DFS</code> <code>DFS</code> </p>\r\n<p> <span class=\"math inline\">\\(O(n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> eb emplace_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">3e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, x, vis[N], as[N], L, R;</span><br><span class=\"line\"><span class=\"keyword\">long</span> <span class=\"keyword\">long</span> a[N], su;</span><br><span class=\"line\">vector &lt;pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; G[N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    vis[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, i] : G[u]) <span class=\"keyword\">if</span>(!vis[v])</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(v), a[v] &gt;= <span class=\"number\">0</span> ? a[u] += a[v], as[L++] = i : as[R--] = i;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; x;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%lld&quot;</span>, &amp;a[i]), su += a[i] -= x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;u, &amp;v), G[u].<span class=\"built_in\">eb</span>(v, i), G[v].<span class=\"built_in\">eb</span>(u, i);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(su + x &lt; <span class=\"number\">0</span>) <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;NO&quot;</span>), <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;YES&quot;</span>), L = <span class=\"number\">2</span>, R = n, <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, as[i]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Phoenix and Odometers | Codeforces 1515G","date":"2021-05-03T13:26:42.000Z","updated":"2021-05-03T13:26:42.000Z","_content":"> [](https://codeforces.com/problemset/problem/1515/G)\n>\n>  $n$  $m$ \n>\n>  $q$  $v,s,t$ $v$  $t | (s+l)$ $l$ \n>\n> $n, m,q \\le 2 \\cdot 10^5,s<t\\le 10^9$ $10^9$\n\n $v$ \n\n $t$ \n\n>  $u\\rightarrow v$  $l$  $v\\rightarrow u$  $-l$ \n\n $v\\rightarrow u$  $w$  $v\\rightarrow u$ $w$ $t-1$  $u\\rightarrow v\\rightarrow u$ $(t-1)(l+w)$ $-w$\n\n $w$  $u$  $u$ $\\gcd(w,t)$ $v\\rightarrow u$  $w$ $u\\rightarrow v$  $-w$  $v\\rightarrow u$ $u\\rightarrow v$ $\\gcd(w,t)$ \n\n $r$  `DFS`  $\\phi(u)$  $r$  $u$  $(u,v,w)$ $\\phi(u)+w-\\phi(v)$  $x=\\gcd_{(u,v,w)}\\phi(u)+w-\\phi(v)$ $0,x,2x,3x,\\cdots$ $r\\rightarrow u$  $\\equiv \\phi(u)\\pmod x$ $x|s$\n\n $O(n+m)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n#define upd(a, b) (a = min(a, b))\n\nusing namespace std;\n\ntypedef long long ll;\nconst int N = 2e5 + 5;\n\nint n, m, q;\nvector<pair<int, int>> G[N];\nint idx, dfn[N], scc[N], stk[N], tp, sid;\nll g[N], d[N], gg[N];\n\nint dfs(int u) {\n    int low = dfn[u] = ++idx; stk[++tp] = u;\n    for(auto [v, w] : G[u]) if(!dfn[v]) d[v] = d[u] + w, upd(low, dfs(v));\n    else if(!scc[v]) upd(low, dfn[v]), g[u] = gcd(g[u], d[u] - d[v] + w);\n    if(low == dfn[u]) for(int v = (sid++, 0); v ^ u;)\n        v = stk[tp--], scc[v] = sid, gg[sid] = gcd(gg[sid], g[v]);\n    return low;\n}\nint main() {\n    cin >> n >> m;\n    int u, v, w;\n    rep(i, 1, m) scanf(\"%d%d%d\", &u, &v, &w), G[u].emplace_back(v, w);\n    rep(i, 1, n) if(!dfn[i]) dfs(i);\n    for(cin >> q; q--; puts(v % gcd(gg[scc[u]], (ll)w) ? \"NO\" : \"YES\"))\n        scanf(\"%d%d%d\", &u, &v, &w);\n}\n```","source":"_posts/CF1515G.md","raw":"---\ntitle: Phoenix and Odometers | Codeforces 1515G\ndate: 2021-05-03 21:26:42\nupdated: 2021-05-03 21:26:42\ntags: [,,]\ncategories: Codeforces\n---\n> [](https://codeforces.com/problemset/problem/1515/G)\n>\n>  $n$  $m$ \n>\n>  $q$  $v,s,t$ $v$  $t | (s+l)$ $l$ \n>\n> $n, m,q \\le 2 \\cdot 10^5,s<t\\le 10^9$ $10^9$\n\n $v$ \n\n $t$ \n\n>  $u\\rightarrow v$  $l$  $v\\rightarrow u$  $-l$ \n\n $v\\rightarrow u$  $w$  $v\\rightarrow u$ $w$ $t-1$  $u\\rightarrow v\\rightarrow u$ $(t-1)(l+w)$ $-w$\n\n $w$  $u$  $u$ $\\gcd(w,t)$ $v\\rightarrow u$  $w$ $u\\rightarrow v$  $-w$  $v\\rightarrow u$ $u\\rightarrow v$ $\\gcd(w,t)$ \n\n $r$  `DFS`  $\\phi(u)$  $r$  $u$  $(u,v,w)$ $\\phi(u)+w-\\phi(v)$  $x=\\gcd_{(u,v,w)}\\phi(u)+w-\\phi(v)$ $0,x,2x,3x,\\cdots$ $r\\rightarrow u$  $\\equiv \\phi(u)\\pmod x$ $x|s$\n\n $O(n+m)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n#define upd(a, b) (a = min(a, b))\n\nusing namespace std;\n\ntypedef long long ll;\nconst int N = 2e5 + 5;\n\nint n, m, q;\nvector<pair<int, int>> G[N];\nint idx, dfn[N], scc[N], stk[N], tp, sid;\nll g[N], d[N], gg[N];\n\nint dfs(int u) {\n    int low = dfn[u] = ++idx; stk[++tp] = u;\n    for(auto [v, w] : G[u]) if(!dfn[v]) d[v] = d[u] + w, upd(low, dfs(v));\n    else if(!scc[v]) upd(low, dfn[v]), g[u] = gcd(g[u], d[u] - d[v] + w);\n    if(low == dfn[u]) for(int v = (sid++, 0); v ^ u;)\n        v = stk[tp--], scc[v] = sid, gg[sid] = gcd(gg[sid], g[v]);\n    return low;\n}\nint main() {\n    cin >> n >> m;\n    int u, v, w;\n    rep(i, 1, m) scanf(\"%d%d%d\", &u, &v, &w), G[u].emplace_back(v, w);\n    rep(i, 1, n) if(!dfn[i]) dfs(i);\n    for(cin >> q; q--; puts(v % gcd(gg[scc[u]], (ll)w) ? \"NO\" : \"YES\"))\n        scanf(\"%d%d%d\", &u, &v, &w);\n}\n```","slug":"CF1515G","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzr000sootn1ui68khy","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/problemset/problem/1515/G\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(q\\)</span>  <span class=\"math inline\">\\(v,s,t\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(t | (s+l)\\)</span> <span class=\"math inline\">\\(l\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n, m,q \\le 2 \\cdot 10^5,s&lt;t\\le 10^9\\)</span> <span class=\"math inline\">\\(10^9\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(v\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(t\\)</span> </p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(u\\rightarrow v\\)</span>  <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(v\\rightarrow u\\)</span>  <span class=\"math inline\">\\(-l\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(v\\rightarrow u\\)</span>  <span class=\"math inline\">\\(w\\)</span>  <span class=\"math inline\">\\(v\\rightarrow u\\)</span> <span class=\"math inline\">\\(w\\)</span> <span class=\"math inline\">\\(t-1\\)</span>  <span class=\"math inline\">\\(u\\rightarrow v\\rightarrow u\\)</span> <span class=\"math inline\">\\((t-1)(l+w)\\)</span> <span class=\"math inline\">\\(-w\\)</span></p>\r\n<p> <span class=\"math inline\">\\(w\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u\\)</span> <span class=\"math inline\">\\(\\gcd(w,t)\\)</span> <span class=\"math inline\">\\(v\\rightarrow u\\)</span>  <span class=\"math inline\">\\(w\\)</span> <span class=\"math inline\">\\(u\\rightarrow v\\)</span>  <span class=\"math inline\">\\(-w\\)</span>  <span class=\"math inline\">\\(v\\rightarrow u\\)</span> <span class=\"math inline\">\\(u\\rightarrow v\\)</span> <span class=\"math inline\">\\(\\gcd(w,t)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(r\\)</span>  <code>DFS</code>  <span class=\"math inline\">\\(\\phi(u)\\)</span>  <span class=\"math inline\">\\(r\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\((u,v,w)\\)</span> <span class=\"math inline\">\\(\\phi(u)+w-\\phi(v)\\)</span>  <span class=\"math inline\">\\(x=\\gcd_{(u,v,w)}\\phi(u)+w-\\phi(v)\\)</span> <span class=\"math inline\">\\(0,x,2x,3x,\\cdots\\)</span> <span class=\"math inline\">\\(r\\rightarrow u\\)</span>  <span class=\"math inline\">\\(\\equiv \\phi(u)\\pmod x\\)</span> <span class=\"math inline\">\\(x|s\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n+m)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> upd(a, b) (a = min(a, b))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, q;</span><br><span class=\"line\">vector&lt;pair&lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; G[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> idx, dfn[N], scc[N], stk[N], tp, sid;</span><br><span class=\"line\">ll g[N], d[N], gg[N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> low = dfn[u] = ++idx; stk[++tp] = u;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, w] : G[u]) <span class=\"keyword\">if</span>(!dfn[v]) d[v] = d[u] + w, <span class=\"built_in\">upd</span>(low, <span class=\"built_in\">dfs</span>(v));</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(!scc[v]) <span class=\"built_in\">upd</span>(low, dfn[v]), g[u] = <span class=\"built_in\">gcd</span>(g[u], d[u] - d[v] + w);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(low == dfn[u]) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v = (sid++, <span class=\"number\">0</span>); v ^ u;)</span><br><span class=\"line\">        v = stk[tp--], scc[v] = sid, gg[sid] = <span class=\"built_in\">gcd</span>(gg[sid], g[v]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> low;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v, w;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w), G[u].<span class=\"built_in\">emplace_back</span>(v, w);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(!dfn[i]) <span class=\"built_in\">dfs</span>(i);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(cin &gt;&gt; q; q--; <span class=\"built_in\">puts</span>(v % <span class=\"built_in\">gcd</span>(gg[scc[u]], (ll)w) ? <span class=\"string\">&quot;NO&quot;</span> : <span class=\"string\">&quot;YES&quot;</span>))</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":1948,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/problemset/problem/1515/G\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(q\\)</span>  <span class=\"math inline\">\\(v,s,t\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(t | (s+l)\\)</span> <span class=\"math inline\">\\(l\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n, m,q \\le 2 \\cdot 10^5,s&lt;t\\le 10^9\\)</span> <span class=\"math inline\">\\(10^9\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(v\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(t\\)</span> </p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(u\\rightarrow v\\)</span>  <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(v\\rightarrow u\\)</span>  <span class=\"math inline\">\\(-l\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(v\\rightarrow u\\)</span>  <span class=\"math inline\">\\(w\\)</span>  <span class=\"math inline\">\\(v\\rightarrow u\\)</span> <span class=\"math inline\">\\(w\\)</span> <span class=\"math inline\">\\(t-1\\)</span>  <span class=\"math inline\">\\(u\\rightarrow v\\rightarrow u\\)</span> <span class=\"math inline\">\\((t-1)(l+w)\\)</span> <span class=\"math inline\">\\(-w\\)</span></p>\r\n<p> <span class=\"math inline\">\\(w\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u\\)</span> <span class=\"math inline\">\\(\\gcd(w,t)\\)</span> <span class=\"math inline\">\\(v\\rightarrow u\\)</span>  <span class=\"math inline\">\\(w\\)</span> <span class=\"math inline\">\\(u\\rightarrow v\\)</span>  <span class=\"math inline\">\\(-w\\)</span>  <span class=\"math inline\">\\(v\\rightarrow u\\)</span> <span class=\"math inline\">\\(u\\rightarrow v\\)</span> <span class=\"math inline\">\\(\\gcd(w,t)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(r\\)</span>  <code>DFS</code>  <span class=\"math inline\">\\(\\phi(u)\\)</span>  <span class=\"math inline\">\\(r\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\((u,v,w)\\)</span> <span class=\"math inline\">\\(\\phi(u)+w-\\phi(v)\\)</span>  <span class=\"math inline\">\\(x=\\gcd_{(u,v,w)}\\phi(u)+w-\\phi(v)\\)</span> <span class=\"math inline\">\\(0,x,2x,3x,\\cdots\\)</span> <span class=\"math inline\">\\(r\\rightarrow u\\)</span>  <span class=\"math inline\">\\(\\equiv \\phi(u)\\pmod x\\)</span> <span class=\"math inline\">\\(x|s\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n+m)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> upd(a, b) (a = min(a, b))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, q;</span><br><span class=\"line\">vector&lt;pair&lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; G[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> idx, dfn[N], scc[N], stk[N], tp, sid;</span><br><span class=\"line\">ll g[N], d[N], gg[N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> low = dfn[u] = ++idx; stk[++tp] = u;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, w] : G[u]) <span class=\"keyword\">if</span>(!dfn[v]) d[v] = d[u] + w, <span class=\"built_in\">upd</span>(low, <span class=\"built_in\">dfs</span>(v));</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(!scc[v]) <span class=\"built_in\">upd</span>(low, dfn[v]), g[u] = <span class=\"built_in\">gcd</span>(g[u], d[u] - d[v] + w);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(low == dfn[u]) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v = (sid++, <span class=\"number\">0</span>); v ^ u;)</span><br><span class=\"line\">        v = stk[tp--], scc[v] = sid, gg[sid] = <span class=\"built_in\">gcd</span>(gg[sid], g[v]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> low;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v, w;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w), G[u].<span class=\"built_in\">emplace_back</span>(v, w);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(!dfn[i]) <span class=\"built_in\">dfs</span>(i);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(cin &gt;&gt; q; q--; <span class=\"built_in\">puts</span>(v % <span class=\"built_in\">gcd</span>(gg[scc[u]], (ll)w) ? <span class=\"string\">&quot;NO&quot;</span> : <span class=\"string\">&quot;YES&quot;</span>))</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Off by One | Codeforces 1519E","date":"2021-04-30T15:23:24.000Z","updated":"2021-04-30T15:23:24.000Z","_content":"> [](https://codeforces.com/problemset/problem/1519/E)\n>\n>  $n$  $(\\frac {a_i}{b_i},\\frac {c_i}{d_i})$ $(x,y)$ **** $(x+1,y)$  $(x,y+1)$\n>\n>  $A,B$  $A$  $B$ \n>\n> \n>\n> $n \\le 2 \\cdot 10^5,1 \\le a_i,b_i,c_i,d_i \\le 10^9$\n\n\n\n $(x,y)$ **** $\\frac {x+1}y$  $\\frac x{y+1}$\n\n $A,B$ \n\n****\n\n> ****\n>\n> \n>\n>  ```DFS```  $u$  $u$ \n\n $m$  $\\lfloor \\frac m2 \\rfloor$\n\n\n\n $10^{18}$ \n\n ```__int128``` \n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n#define eb emplace_back\n\nusing namespace std;\nconst int N = 4e5 + 5;\ntypedef long long ll;\nll K1[N], K2[N];\nint n, ord[N], id[N];\nvector <pair <int, int>> G[N];\nvector <pair <int, int>> as;\nint idx, dfn[N], sz[N];\nvoid add(int u, int v, int i) {\n    G[u].eb(v, i), G[v].eb(u, i);\n}\nvoid dfs(int u, int f) {\n    dfn[u] = ++idx;\n    int lst = 0;\n    auto ins = [&](int x) {\n        if(lst) as.eb(lst, x), lst = 0;\n        else lst = x;\n    };\n    for(auto [v, w] : G[u]) if(!dfn[v]) {\n        dfs(v, w), sz[u] += sz[v];\n        if(~sz[v] & 1) ins(w);\n    } else if(dfn[v] > dfn[u]) ins(w);\n    else sz[v]++;\n    if(lst && f) as.eb(lst, f);\n}\nint main() {\n    cin >> n;\n    int a, b, c, d;\n    rep(i, 1, n) {\n        scanf(\"%d%d%d%d\", &a, &b, &c, &d);\n        K1[i * 2 - 1] = ll(a + b) * d, K1[i * 2] = (ll)a * d;\n        K2[i * 2 - 1] = (ll)b * c, K2[i * 2] = b * ll(c + d);\n    }\n    n *= 2;\n    rep(i, 1, n) {\n        ord[i] = i;\n        ll g = __gcd(K1[i], K2[i]);\n        K1[i] /= g, K2[i] /= g;\n    }\n    auto cmp = [](int x, int y) {\n        return K1[x] ^ K1[y] ? K1[x] < K1[y] : K2[x] < K2[y];\n    };\n    sort(ord + 1, ord + n + 1, cmp);\n    rep(i, 1, n) id[i] = lower_bound(ord + 1, ord + n + 1, i, cmp) - ord;\n    rep(i, 1, n / 2) add(id[i * 2 - 1], id[i * 2], i);\n    rep(i, 1, n) dfs(i, 0);\n    cout << as.size() << endl;\n    for(auto [u, v] : as) printf(\"%d %d\\n\", u, v);\n    return 0;\n}\n```","source":"_posts/CF1519E.md","raw":"---\ntitle: Off by One | Codeforces 1519E\ndate: 2021-04-30 23:23:24\nupdated: 2021-04-30 23:23:24\ntags: [,]\ncategories: Codeforces\n---\n> [](https://codeforces.com/problemset/problem/1519/E)\n>\n>  $n$  $(\\frac {a_i}{b_i},\\frac {c_i}{d_i})$ $(x,y)$ **** $(x+1,y)$  $(x,y+1)$\n>\n>  $A,B$  $A$  $B$ \n>\n> \n>\n> $n \\le 2 \\cdot 10^5,1 \\le a_i,b_i,c_i,d_i \\le 10^9$\n\n\n\n $(x,y)$ **** $\\frac {x+1}y$  $\\frac x{y+1}$\n\n $A,B$ \n\n****\n\n> ****\n>\n> \n>\n>  ```DFS```  $u$  $u$ \n\n $m$  $\\lfloor \\frac m2 \\rfloor$\n\n\n\n $10^{18}$ \n\n ```__int128``` \n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n#define eb emplace_back\n\nusing namespace std;\nconst int N = 4e5 + 5;\ntypedef long long ll;\nll K1[N], K2[N];\nint n, ord[N], id[N];\nvector <pair <int, int>> G[N];\nvector <pair <int, int>> as;\nint idx, dfn[N], sz[N];\nvoid add(int u, int v, int i) {\n    G[u].eb(v, i), G[v].eb(u, i);\n}\nvoid dfs(int u, int f) {\n    dfn[u] = ++idx;\n    int lst = 0;\n    auto ins = [&](int x) {\n        if(lst) as.eb(lst, x), lst = 0;\n        else lst = x;\n    };\n    for(auto [v, w] : G[u]) if(!dfn[v]) {\n        dfs(v, w), sz[u] += sz[v];\n        if(~sz[v] & 1) ins(w);\n    } else if(dfn[v] > dfn[u]) ins(w);\n    else sz[v]++;\n    if(lst && f) as.eb(lst, f);\n}\nint main() {\n    cin >> n;\n    int a, b, c, d;\n    rep(i, 1, n) {\n        scanf(\"%d%d%d%d\", &a, &b, &c, &d);\n        K1[i * 2 - 1] = ll(a + b) * d, K1[i * 2] = (ll)a * d;\n        K2[i * 2 - 1] = (ll)b * c, K2[i * 2] = b * ll(c + d);\n    }\n    n *= 2;\n    rep(i, 1, n) {\n        ord[i] = i;\n        ll g = __gcd(K1[i], K2[i]);\n        K1[i] /= g, K2[i] /= g;\n    }\n    auto cmp = [](int x, int y) {\n        return K1[x] ^ K1[y] ? K1[x] < K1[y] : K2[x] < K2[y];\n    };\n    sort(ord + 1, ord + n + 1, cmp);\n    rep(i, 1, n) id[i] = lower_bound(ord + 1, ord + n + 1, i, cmp) - ord;\n    rep(i, 1, n / 2) add(id[i * 2 - 1], id[i * 2], i);\n    rep(i, 1, n) dfs(i, 0);\n    cout << as.size() << endl;\n    for(auto [u, v] : as) printf(\"%d %d\\n\", u, v);\n    return 0;\n}\n```","slug":"CF1519E","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzs000vootn7ij97f6n","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/problemset/problem/1519/E\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\((\\frac {a_i}{b_i},\\frac {c_i}{d_i})\\)</span> <span class=\"math inline\">\\((x,y)\\)</span> <strong></strong> <span class=\"math inline\">\\((x+1,y)\\)</span>  <span class=\"math inline\">\\((x,y+1)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(A,B\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(B\\)</span> </p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n \\le 2 \\cdot 10^5,1 \\le a_i,b_i,c_i,d_i \\le 10^9\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\((x,y)\\)</span> <strong></strong> <span class=\"math inline\">\\(\\frac {x+1}y\\)</span>  <span class=\"math inline\">\\(\\frac x{y+1}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(A,B\\)</span> </p>\r\n<p><strong></strong></p>\r\n<blockquote>\r\n<p><strong></strong></p>\r\n<p></p>\r\n<p> <code>DFS</code>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(\\lfloor \\frac m2 \\rfloor\\)</span></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(10^{18}\\)</span> </p>\r\n<p> <code>__int128</code> </p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> eb emplace_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">4e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\">ll K1[N], K2[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, ord[N], id[N];</span><br><span class=\"line\">vector &lt;pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; G[N];</span><br><span class=\"line\">vector &lt;pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; as;</span><br><span class=\"line\"><span class=\"keyword\">int</span> idx, dfn[N], sz[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    G[u].<span class=\"built_in\">eb</span>(v, i), G[v].<span class=\"built_in\">eb</span>(u, i);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> f)</span> </span>&#123;</span><br><span class=\"line\">    dfn[u] = ++idx;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> lst = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> ins = [&amp;](<span class=\"keyword\">int</span> x) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(lst) as.<span class=\"built_in\">eb</span>(lst, x), lst = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> lst = x;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, w] : G[u]) <span class=\"keyword\">if</span>(!dfn[v]) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(v, w), sz[u] += sz[v];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(~sz[v] &amp; <span class=\"number\">1</span>) <span class=\"built_in\">ins</span>(w);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(dfn[v] &gt; dfn[u]) <span class=\"built_in\">ins</span>(w);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> sz[v]++;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(lst &amp;&amp; f) as.<span class=\"built_in\">eb</span>(lst, f);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> a, b, c, d;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c, &amp;d);</span><br><span class=\"line\">        K1[i * <span class=\"number\">2</span> - <span class=\"number\">1</span>] = <span class=\"built_in\">ll</span>(a + b) * d, K1[i * <span class=\"number\">2</span>] = (ll)a * d;</span><br><span class=\"line\">        K2[i * <span class=\"number\">2</span> - <span class=\"number\">1</span>] = (ll)b * c, K2[i * <span class=\"number\">2</span>] = b * <span class=\"built_in\">ll</span>(c + d);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    n *= <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        ord[i] = i;</span><br><span class=\"line\">        ll g = __gcd(K1[i], K2[i]);</span><br><span class=\"line\">        K1[i] /= g, K2[i] /= g;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> cmp = [](<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> K1[x] ^ K1[y] ? K1[x] &lt; K1[y] : K2[x] &lt; K2[y];</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(ord + <span class=\"number\">1</span>, ord + n + <span class=\"number\">1</span>, cmp);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) id[i] = <span class=\"built_in\">lower_bound</span>(ord + <span class=\"number\">1</span>, ord + n + <span class=\"number\">1</span>, i, cmp) - ord;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n / <span class=\"number\">2</span>) <span class=\"built_in\">add</span>(id[i * <span class=\"number\">2</span> - <span class=\"number\">1</span>], id[i * <span class=\"number\">2</span>], i);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">dfs</span>(i, <span class=\"number\">0</span>);</span><br><span class=\"line\">    cout &lt;&lt; as.<span class=\"built_in\">size</span>() &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [u, v] : as) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d %d\\n&quot;</span>, u, v);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2177,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/problemset/problem/1519/E\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\((\\frac {a_i}{b_i},\\frac {c_i}{d_i})\\)</span> <span class=\"math inline\">\\((x,y)\\)</span> <strong></strong> <span class=\"math inline\">\\((x+1,y)\\)</span>  <span class=\"math inline\">\\((x,y+1)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(A,B\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(B\\)</span> </p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n \\le 2 \\cdot 10^5,1 \\le a_i,b_i,c_i,d_i \\le 10^9\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\((x,y)\\)</span> <strong></strong> <span class=\"math inline\">\\(\\frac {x+1}y\\)</span>  <span class=\"math inline\">\\(\\frac x{y+1}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(A,B\\)</span> </p>\r\n<p><strong></strong></p>\r\n<blockquote>\r\n<p><strong></strong></p>\r\n<p></p>\r\n<p> <code>DFS</code>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(\\lfloor \\frac m2 \\rfloor\\)</span></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(10^{18}\\)</span> </p>\r\n<p> <code>__int128</code> </p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> eb emplace_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">4e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\">ll K1[N], K2[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, ord[N], id[N];</span><br><span class=\"line\">vector &lt;pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; G[N];</span><br><span class=\"line\">vector &lt;pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; as;</span><br><span class=\"line\"><span class=\"keyword\">int</span> idx, dfn[N], sz[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    G[u].<span class=\"built_in\">eb</span>(v, i), G[v].<span class=\"built_in\">eb</span>(u, i);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> f)</span> </span>&#123;</span><br><span class=\"line\">    dfn[u] = ++idx;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> lst = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> ins = [&amp;](<span class=\"keyword\">int</span> x) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(lst) as.<span class=\"built_in\">eb</span>(lst, x), lst = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> lst = x;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, w] : G[u]) <span class=\"keyword\">if</span>(!dfn[v]) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(v, w), sz[u] += sz[v];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(~sz[v] &amp; <span class=\"number\">1</span>) <span class=\"built_in\">ins</span>(w);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(dfn[v] &gt; dfn[u]) <span class=\"built_in\">ins</span>(w);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> sz[v]++;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(lst &amp;&amp; f) as.<span class=\"built_in\">eb</span>(lst, f);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> a, b, c, d;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c, &amp;d);</span><br><span class=\"line\">        K1[i * <span class=\"number\">2</span> - <span class=\"number\">1</span>] = <span class=\"built_in\">ll</span>(a + b) * d, K1[i * <span class=\"number\">2</span>] = (ll)a * d;</span><br><span class=\"line\">        K2[i * <span class=\"number\">2</span> - <span class=\"number\">1</span>] = (ll)b * c, K2[i * <span class=\"number\">2</span>] = b * <span class=\"built_in\">ll</span>(c + d);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    n *= <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        ord[i] = i;</span><br><span class=\"line\">        ll g = __gcd(K1[i], K2[i]);</span><br><span class=\"line\">        K1[i] /= g, K2[i] /= g;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> cmp = [](<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> y) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> K1[x] ^ K1[y] ? K1[x] &lt; K1[y] : K2[x] &lt; K2[y];</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(ord + <span class=\"number\">1</span>, ord + n + <span class=\"number\">1</span>, cmp);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) id[i] = <span class=\"built_in\">lower_bound</span>(ord + <span class=\"number\">1</span>, ord + n + <span class=\"number\">1</span>, i, cmp) - ord;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n / <span class=\"number\">2</span>) <span class=\"built_in\">add</span>(id[i * <span class=\"number\">2</span> - <span class=\"number\">1</span>], id[i * <span class=\"number\">2</span>], i);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">dfs</span>(i, <span class=\"number\">0</span>);</span><br><span class=\"line\">    cout &lt;&lt; as.<span class=\"built_in\">size</span>() &lt;&lt; endl;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [u, v] : as) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d %d\\n&quot;</span>, u, v);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Vasya and Polynomial | Codeforeces 493E","date":"2021-03-13T14:27:00.000Z","updated":"2021-03-13T14:27:00.000Z","_content":"> [](https://codeforces.com/contest/493/problem/E)\n>\n>  $a$$b$$c$**** $F$,  $F(a)=b \\land F(b)=c$\n>\n> $1 \\le a, b, c \\le 10^{18}$\n\n $a=1,b=1$ \n\n**** $\\log$ \n\n**** $F$, \n$$\nF(a)=x \\land F(b)=y \\land x \\le b\n$$\n $F$  $V$\n\n $F(a)=x$  $F(b)=y$  $V \\le x, V \\equiv y\\ (mod\\ b)$\n\n\n\n1.  $x=b \\land b\\ |\\ y$  $V=0 \\lor V=x$\n\n    $V=x$ $F(a)=x$,  $F$  $F(x)=V$ $x \\ne y$ \n\n    $F(a)-V=x-V$ $a$  $x-V$\n\n    $G(x)=\\dfrac{F(x)-V}x$ $G(a)=\\dfrac{x-V}aG(b)=\\dfrac{y-V}b$\n\n    $\\dfrac{x-V}a \\le x \\le b$\n\n2.  $x < b \\lor b \\not |\\ y$  $V=y \\mod b$\n\n $xy=0$, $F(x)=0$ \n\n\n\n```c\ntypedef long long ll;\nll a, b, c; \nfind(ll x, ll y) {\n    if(!x || !y) return 0; ll v = y % b;\n    return ((x - v) % a ? 0 : find((x - v) / a, (y - v) / b)) + (x == y);\n}\nmain() {\n    scanf(\"%lld%lld%lld\", &a, &b, &c);\n    if(a == 1 && b == 1) puts(c > 1 ? \"0\" : \"inf\");\n    else printf(\"%d\", find(b, c));\n}\n```\n\n****\n\n****\n\n```c\ntypedef long long ll;\ncnt, ans; ll a, b, c, A[100];\nfind(ll x, ll y, int d) {\n    if(!x || !y) return;\n    ll v = A[d] = y % b;\n    if((x - v) % a == 0) find((x - v) / a, (y - v) / b, d + 1);\n    if(x == y) { if(!ans) A[cnt = d] = x; ans++; }\n}\nmain(T) {\n    for(scanf(\"%d\", &T); T--; puts(\"\")) {\n        scanf(\"%d%d%d\", &a, &b, &c);\n        if(a == 1 && b == 1) puts(c > 1 ? \"0\" : \"-1\");\n        else {\n            ans = 0, find(b, c, 0);\n            printf(\"%d\", ans);\n            if(ans) for(printf(\"\\n%d \", cnt); ~cnt; printf(\"%lld \", A[cnt--]));\n        }\n    }\n}\n```","source":"_posts/CF493E.md","raw":"---\ntitle: Vasya and Polynomial | Codeforeces 493E\ndate: 2021-03-13 22:27:00\nupdated: 2021-03-13 22:27:00\ntags: [,]\ncategories: Codeforces\n---\n> [](https://codeforces.com/contest/493/problem/E)\n>\n>  $a$$b$$c$**** $F$,  $F(a)=b \\land F(b)=c$\n>\n> $1 \\le a, b, c \\le 10^{18}$\n\n $a=1,b=1$ \n\n**** $\\log$ \n\n**** $F$, \n$$\nF(a)=x \\land F(b)=y \\land x \\le b\n$$\n $F$  $V$\n\n $F(a)=x$  $F(b)=y$  $V \\le x, V \\equiv y\\ (mod\\ b)$\n\n\n\n1.  $x=b \\land b\\ |\\ y$  $V=0 \\lor V=x$\n\n    $V=x$ $F(a)=x$,  $F$  $F(x)=V$ $x \\ne y$ \n\n    $F(a)-V=x-V$ $a$  $x-V$\n\n    $G(x)=\\dfrac{F(x)-V}x$ $G(a)=\\dfrac{x-V}aG(b)=\\dfrac{y-V}b$\n\n    $\\dfrac{x-V}a \\le x \\le b$\n\n2.  $x < b \\lor b \\not |\\ y$  $V=y \\mod b$\n\n $xy=0$, $F(x)=0$ \n\n\n\n```c\ntypedef long long ll;\nll a, b, c; \nfind(ll x, ll y) {\n    if(!x || !y) return 0; ll v = y % b;\n    return ((x - v) % a ? 0 : find((x - v) / a, (y - v) / b)) + (x == y);\n}\nmain() {\n    scanf(\"%lld%lld%lld\", &a, &b, &c);\n    if(a == 1 && b == 1) puts(c > 1 ? \"0\" : \"inf\");\n    else printf(\"%d\", find(b, c));\n}\n```\n\n****\n\n****\n\n```c\ntypedef long long ll;\ncnt, ans; ll a, b, c, A[100];\nfind(ll x, ll y, int d) {\n    if(!x || !y) return;\n    ll v = A[d] = y % b;\n    if((x - v) % a == 0) find((x - v) / a, (y - v) / b, d + 1);\n    if(x == y) { if(!ans) A[cnt = d] = x; ans++; }\n}\nmain(T) {\n    for(scanf(\"%d\", &T); T--; puts(\"\")) {\n        scanf(\"%d%d%d\", &a, &b, &c);\n        if(a == 1 && b == 1) puts(c > 1 ? \"0\" : \"-1\");\n        else {\n            ans = 0, find(b, c, 0);\n            printf(\"%d\", ans);\n            if(ans) for(printf(\"\\n%d \", cnt); ~cnt; printf(\"%lld \", A[cnt--]));\n        }\n    }\n}\n```","slug":"CF493E","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzt000yootn2z3oc7bs","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/493/problem/E\"></a></p>\r\n<p> <span class=\"math inline\">\\(a\\)</span><span class=\"math inline\">\\(b\\)</span><span class=\"math inline\">\\(c\\)</span><strong></strong> <span class=\"math inline\">\\(F\\)</span>,  <span class=\"math inline\">\\(F(a)=b \\land F(b)=c\\)</span></p>\r\n<p><span class=\"math inline\">\\(1 \\le a, b, c \\le 10^{18}\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(a=1,b=1\\)</span> </p>\r\n<p><strong></strong> <span class=\"math inline\">\\(\\log\\)</span> </p>\r\n<p><strong></strong> <span class=\"math inline\">\\(F\\)</span>,  <span class=\"math display\">\\[\r\nF(a)=x \\land F(b)=y \\land x \\le b\r\n\\]</span>  <span class=\"math inline\">\\(F\\)</span>  <span class=\"math inline\">\\(V\\)</span></p>\r\n<p> <span class=\"math inline\">\\(F(a)=x\\)</span>  <span class=\"math inline\">\\(F(b)=y\\)</span>  <span class=\"math inline\">\\(V \\le x, V \\equiv y\\ (mod\\ b)\\)</span></p>\r\n<p></p>\r\n<ol type=\"1\">\r\n<li><p> <span class=\"math inline\">\\(x=b \\land b\\ |\\ y\\)</span>  <span class=\"math inline\">\\(V=0 \\lor V=x\\)</span></p>\r\n<p> <span class=\"math inline\">\\(V=x\\)</span> <span class=\"math inline\">\\(F(a)=x\\)</span>,  <span class=\"math inline\">\\(F\\)</span>  <span class=\"math inline\">\\(F(x)=V\\)</span> <span class=\"math inline\">\\(x \\ne y\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(F(a)-V=x-V\\)</span> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(x-V\\)</span></p>\r\n<p> <span class=\"math inline\">\\(G(x)=\\dfrac{F(x)-V}x\\)</span> <span class=\"math inline\">\\(G(a)=\\dfrac{x-V}aG(b)=\\dfrac{y-V}b\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\dfrac{x-V}a \\le x \\le b\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\(x &lt; b \\lor b \\not |\\ y\\)</span>  <span class=\"math inline\">\\(V=y \\mod b\\)</span></p></li>\r\n</ol>\r\n<p> <span class=\"math inline\">\\(xy=0\\)</span>, <span class=\"math inline\">\\(F(x)=0\\)</span> </p>\r\n<p></p>\r\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\">ll a, b, c; </span><br><span class=\"line\">find(ll x, ll y) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!x || !y) <span class=\"keyword\">return</span> <span class=\"number\">0</span>; ll v = y % b;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ((x - v) % a ? <span class=\"number\">0</span> : find((x - v) / a, (y - v) / b)) + (x == y);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">main() &#123;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%lld%lld%lld&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(a == <span class=\"number\">1</span> &amp;&amp; b == <span class=\"number\">1</span>) <span class=\"built_in\">puts</span>(c &gt; <span class=\"number\">1</span> ? <span class=\"string\">&quot;0&quot;</span> : <span class=\"string\">&quot;inf&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d&quot;</span>, find(b, c));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><strong></strong></p>\r\n<p><strong></strong></p>\r\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\">cnt, ans; ll a, b, c, A[<span class=\"number\">100</span>];</span><br><span class=\"line\">find(ll x, ll y, <span class=\"keyword\">int</span> d) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!x || !y) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    ll v = A[d] = y % b;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>((x - v) % a == <span class=\"number\">0</span>) find((x - v) / a, (y - v) / b, d + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(x == y) &#123; <span class=\"keyword\">if</span>(!ans) A[cnt = d] = x; ans++; &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">main(T) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;T); T--; <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;&quot;</span>)) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(a == <span class=\"number\">1</span> &amp;&amp; b == <span class=\"number\">1</span>) <span class=\"built_in\">puts</span>(c &gt; <span class=\"number\">1</span> ? <span class=\"string\">&quot;0&quot;</span> : <span class=\"string\">&quot;-1&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            ans = <span class=\"number\">0</span>, find(b, c, <span class=\"number\">0</span>);</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d&quot;</span>, ans);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(ans) <span class=\"keyword\">for</span>(<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;\\n%d &quot;</span>, cnt); ~cnt; <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%lld &quot;</span>, A[cnt--]));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":1564,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/493/problem/E\"></a></p>\r\n<p> <span class=\"math inline\">\\(a\\)</span><span class=\"math inline\">\\(b\\)</span><span class=\"math inline\">\\(c\\)</span><strong></strong> <span class=\"math inline\">\\(F\\)</span>,  <span class=\"math inline\">\\(F(a)=b \\land F(b)=c\\)</span></p>\r\n<p><span class=\"math inline\">\\(1 \\le a, b, c \\le 10^{18}\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(a=1,b=1\\)</span> </p>\r\n<p><strong></strong> <span class=\"math inline\">\\(\\log\\)</span> </p>\r\n<p><strong></strong> <span class=\"math inline\">\\(F\\)</span>,  <span class=\"math display\">\\[\r\nF(a)=x \\land F(b)=y \\land x \\le b\r\n\\]</span>  <span class=\"math inline\">\\(F\\)</span>  <span class=\"math inline\">\\(V\\)</span></p>\r\n<p> <span class=\"math inline\">\\(F(a)=x\\)</span>  <span class=\"math inline\">\\(F(b)=y\\)</span>  <span class=\"math inline\">\\(V \\le x, V \\equiv y\\ (mod\\ b)\\)</span></p>\r\n<p></p>\r\n<ol type=\"1\">\r\n<li><p> <span class=\"math inline\">\\(x=b \\land b\\ |\\ y\\)</span>  <span class=\"math inline\">\\(V=0 \\lor V=x\\)</span></p>\r\n<p> <span class=\"math inline\">\\(V=x\\)</span> <span class=\"math inline\">\\(F(a)=x\\)</span>,  <span class=\"math inline\">\\(F\\)</span>  <span class=\"math inline\">\\(F(x)=V\\)</span> <span class=\"math inline\">\\(x \\ne y\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(F(a)-V=x-V\\)</span> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(x-V\\)</span></p>\r\n<p> <span class=\"math inline\">\\(G(x)=\\dfrac{F(x)-V}x\\)</span> <span class=\"math inline\">\\(G(a)=\\dfrac{x-V}aG(b)=\\dfrac{y-V}b\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\dfrac{x-V}a \\le x \\le b\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\(x &lt; b \\lor b \\not |\\ y\\)</span>  <span class=\"math inline\">\\(V=y \\mod b\\)</span></p></li>\r\n</ol>\r\n<p> <span class=\"math inline\">\\(xy=0\\)</span>, <span class=\"math inline\">\\(F(x)=0\\)</span> </p>\r\n<p></p>\r\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\">ll a, b, c; </span><br><span class=\"line\">find(ll x, ll y) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!x || !y) <span class=\"keyword\">return</span> <span class=\"number\">0</span>; ll v = y % b;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ((x - v) % a ? <span class=\"number\">0</span> : find((x - v) / a, (y - v) / b)) + (x == y);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">main() &#123;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%lld%lld%lld&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(a == <span class=\"number\">1</span> &amp;&amp; b == <span class=\"number\">1</span>) <span class=\"built_in\">puts</span>(c &gt; <span class=\"number\">1</span> ? <span class=\"string\">&quot;0&quot;</span> : <span class=\"string\">&quot;inf&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d&quot;</span>, find(b, c));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><strong></strong></p>\r\n<p><strong></strong></p>\r\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\">cnt, ans; ll a, b, c, A[<span class=\"number\">100</span>];</span><br><span class=\"line\">find(ll x, ll y, <span class=\"keyword\">int</span> d) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!x || !y) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    ll v = A[d] = y % b;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>((x - v) % a == <span class=\"number\">0</span>) find((x - v) / a, (y - v) / b, d + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(x == y) &#123; <span class=\"keyword\">if</span>(!ans) A[cnt = d] = x; ans++; &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">main(T) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;T); T--; <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;&quot;</span>)) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(a == <span class=\"number\">1</span> &amp;&amp; b == <span class=\"number\">1</span>) <span class=\"built_in\">puts</span>(c &gt; <span class=\"number\">1</span> ? <span class=\"string\">&quot;0&quot;</span> : <span class=\"string\">&quot;-1&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            ans = <span class=\"number\">0</span>, find(b, c, <span class=\"number\">0</span>);</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d&quot;</span>, ans);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(ans) <span class=\"keyword\">for</span>(<span class=\"built_in\">printf</span>(<span class=\"string\">&quot;\\n%d &quot;</span>, cnt); ~cnt; <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%lld &quot;</span>, A[cnt--]));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Cycling City | Codeforces 521E","date":"2021-04-03T14:09:35.000Z","updated":"2021-04-03T14:09:35.000Z","_content":"> [](https://codeforces.com/contest/521/problem/E)\n>\n>  $n$  $m$ \n>\n> \n>\n> $n,m \\le 2 \\cdot 10^5$ \n\n $u \\rightarrow v$ \n\n![](https://i.loli.net/2021/04/03/k3PV8WRYS4Uqmon.png)\n\n\n\n\n\n\n\n $low_u$  ```tarjan``` $Low_u$ \n\n $Low_u = dfn_u$\n\n $Low_u < dfn_u$  $u$ \n\n $lca(v,V)=u$ $u \\rightarrow Low$$u \\rightarrow v \\rightarrow low \\rightarrow Low$  $u \\rightarrow V \\rightarrow Low$ \n\n![](https://i.loli.net/2021/04/03/tQCALX5ah47RU9f.png)\n\n $u$  $u$  $Low_u < dfn_u$ $lca(v, V) = u$\n\n ```dfs```  $Low_u < dfn_u$  $u$ \n\n $O(n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nconst int N = 2e5 + 5;\ntypedef vector <int> vi;\nint n, m; vi G[N];\nint idx, dfn[N], fa[N], ma;\nstruct node {\n    int u, fa, U, Fa;\n    node(int uu) { u = fa = U = Fa = uu; }\n    void upd(int uu, int ffa) {\n        if(dfn[ffa] < dfn[fa]) U = u, Fa = fa, u = uu, fa = ffa;\n        else if(dfn[ffa] < dfn[Fa]) U = uu, Fa = ffa;\n    }\n} as(0);\nnode dfs(int u) {\n    dfn[u] = ++idx; node lowu(u);\n    for(int v : G[u]) if(!dfn[v]) {\n        fa[v] = u;\n        node lowv = dfs(v);\n        lowu.upd(lowv.u, lowv.fa), lowu.upd(lowv.U, lowv.Fa);\n    } else if(dfn[v] < dfn[u] && v ^ fa[u]) lowu.upd(u, v);\n    if(!ma && dfn[lowu.Fa] < dfn[u]) as = lowu, ma = u;\n    return lowu;\n}\nvi find(int s, int t) {\n    vi p;\n    while(s ^ t) p.pb(s), s = fa[s];\n    p.pb(t);\n    return p;\n}\nvi p;\nvoid print() {\n    printf(\"%llu \", p.size());\n    for(int u : p) printf(\"%d \", u);\n    puts(\"\");\n}\nint main() {\n    cin >> n >> m;\n    int u, v;\n    rep(i, 1, m) scanf(\"%d%d\", &u, &v), G[u].pb(v), G[v].pb(u);\n    rep(i, 1, n) if(!ma && !dfn[i]) dfs(i);\n    if(ma) {\n        puts(\"YES\");\n        p = find(ma, as.Fa), print();\n        p = find(as.U, ma), reverse(p.begin(), p.end());\n        p.pb(as.Fa), print();\n        p = find(as.Fa, as.fa); vi t = find(as.u, ma);\n        p.insert(p.end(), t.begin(), t.end());\n        reverse(p.begin(), p.end()), print();\n    } else puts(\"NO\");\n    return 0;\n}\n```","source":"_posts/CF521E.md","raw":"---\ntitle: Cycling City | Codeforces 521E\ndate: 2021-04-03 22:09:35\nupdated: 2021-04-03 22:09:35\ntags: [,]\ncategories: Codeforces\n---\n> [](https://codeforces.com/contest/521/problem/E)\n>\n>  $n$  $m$ \n>\n> \n>\n> $n,m \\le 2 \\cdot 10^5$ \n\n $u \\rightarrow v$ \n\n![](https://i.loli.net/2021/04/03/k3PV8WRYS4Uqmon.png)\n\n\n\n\n\n\n\n $low_u$  ```tarjan``` $Low_u$ \n\n $Low_u = dfn_u$\n\n $Low_u < dfn_u$  $u$ \n\n $lca(v,V)=u$ $u \\rightarrow Low$$u \\rightarrow v \\rightarrow low \\rightarrow Low$  $u \\rightarrow V \\rightarrow Low$ \n\n![](https://i.loli.net/2021/04/03/tQCALX5ah47RU9f.png)\n\n $u$  $u$  $Low_u < dfn_u$ $lca(v, V) = u$\n\n ```dfs```  $Low_u < dfn_u$  $u$ \n\n $O(n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nconst int N = 2e5 + 5;\ntypedef vector <int> vi;\nint n, m; vi G[N];\nint idx, dfn[N], fa[N], ma;\nstruct node {\n    int u, fa, U, Fa;\n    node(int uu) { u = fa = U = Fa = uu; }\n    void upd(int uu, int ffa) {\n        if(dfn[ffa] < dfn[fa]) U = u, Fa = fa, u = uu, fa = ffa;\n        else if(dfn[ffa] < dfn[Fa]) U = uu, Fa = ffa;\n    }\n} as(0);\nnode dfs(int u) {\n    dfn[u] = ++idx; node lowu(u);\n    for(int v : G[u]) if(!dfn[v]) {\n        fa[v] = u;\n        node lowv = dfs(v);\n        lowu.upd(lowv.u, lowv.fa), lowu.upd(lowv.U, lowv.Fa);\n    } else if(dfn[v] < dfn[u] && v ^ fa[u]) lowu.upd(u, v);\n    if(!ma && dfn[lowu.Fa] < dfn[u]) as = lowu, ma = u;\n    return lowu;\n}\nvi find(int s, int t) {\n    vi p;\n    while(s ^ t) p.pb(s), s = fa[s];\n    p.pb(t);\n    return p;\n}\nvi p;\nvoid print() {\n    printf(\"%llu \", p.size());\n    for(int u : p) printf(\"%d \", u);\n    puts(\"\");\n}\nint main() {\n    cin >> n >> m;\n    int u, v;\n    rep(i, 1, m) scanf(\"%d%d\", &u, &v), G[u].pb(v), G[v].pb(u);\n    rep(i, 1, n) if(!ma && !dfn[i]) dfs(i);\n    if(ma) {\n        puts(\"YES\");\n        p = find(ma, as.Fa), print();\n        p = find(as.U, ma), reverse(p.begin(), p.end());\n        p.pb(as.Fa), print();\n        p = find(as.Fa, as.fa); vi t = find(as.u, ma);\n        p.insert(p.end(), t.begin(), t.end());\n        reverse(p.begin(), p.end()), print();\n    } else puts(\"NO\");\n    return 0;\n}\n```","slug":"CF521E","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzu0012ootncu3t3xus","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/521/problem/E\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span> </p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n,m \\le 2 \\cdot 10^5\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(u \\rightarrow v\\)</span> </p>\r\n<p><img src=\"https://i.loli.net/2021/04/03/k3PV8WRYS4Uqmon.png\" /></p>\r\n<p></p>\r\n<p></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(low_u\\)</span>  <code>tarjan</code> <span class=\"math inline\">\\(Low_u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(Low_u = dfn_u\\)</span></p>\r\n<p> <span class=\"math inline\">\\(Low_u &lt; dfn_u\\)</span>  <span class=\"math inline\">\\(u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(lca(v,V)=u\\)</span> <span class=\"math inline\">\\(u \\rightarrow Low\\)</span><span class=\"math inline\">\\(u \\rightarrow v \\rightarrow low \\rightarrow Low\\)</span>  <span class=\"math inline\">\\(u \\rightarrow V \\rightarrow Low\\)</span> </p>\r\n<p><img src=\"https://i.loli.net/2021/04/03/tQCALX5ah47RU9f.png\" /></p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(Low_u &lt; dfn_u\\)</span> <span class=\"math inline\">\\(lca(v, V) = u\\)</span></p>\r\n<p> <code>dfs</code>  <span class=\"math inline\">\\(Low_u &lt; dfn_u\\)</span>  <span class=\"math inline\">\\(u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> vector &lt;<span class=\"keyword\">int</span>&gt; vi;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m; vi G[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> idx, dfn[N], fa[N], ma;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, fa, U, Fa;</span><br><span class=\"line\">    <span class=\"built_in\">node</span>(<span class=\"keyword\">int</span> uu) &#123; u = fa = U = Fa = uu; &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> uu, <span class=\"keyword\">int</span> ffa)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dfn[ffa] &lt; dfn[fa]) U = u, Fa = fa, u = uu, fa = ffa;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(dfn[ffa] &lt; dfn[Fa]) U = uu, Fa = ffa;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; <span class=\"built_in\">as</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"function\">node <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    dfn[u] = ++idx; <span class=\"function\">node <span class=\"title\">lowu</span><span class=\"params\">(u)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(!dfn[v]) &#123;</span><br><span class=\"line\">        fa[v] = u;</span><br><span class=\"line\">        node lowv = <span class=\"built_in\">dfs</span>(v);</span><br><span class=\"line\">        lowu.<span class=\"built_in\">upd</span>(lowv.u, lowv.fa), lowu.<span class=\"built_in\">upd</span>(lowv.U, lowv.Fa);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(dfn[v] &lt; dfn[u] &amp;&amp; v ^ fa[u]) lowu.<span class=\"built_in\">upd</span>(u, v);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!ma &amp;&amp; dfn[lowu.Fa] &lt; dfn[u]) as = lowu, ma = u;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> lowu;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">vi <span class=\"title\">find</span><span class=\"params\">(<span class=\"keyword\">int</span> s, <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    vi p;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(s ^ t) p.<span class=\"built_in\">pb</span>(s), s = fa[s];</span><br><span class=\"line\">    p.<span class=\"built_in\">pb</span>(t);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">vi p;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">print</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%llu &quot;</span>, p.<span class=\"built_in\">size</span>());</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> u : p) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, u);</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;u, &amp;v), G[u].<span class=\"built_in\">pb</span>(v), G[v].<span class=\"built_in\">pb</span>(u);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(!ma &amp;&amp; !dfn[i]) <span class=\"built_in\">dfs</span>(i);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(ma) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;YES&quot;</span>);</span><br><span class=\"line\">        p = <span class=\"built_in\">find</span>(ma, as.Fa), <span class=\"built_in\">print</span>();</span><br><span class=\"line\">        p = <span class=\"built_in\">find</span>(as.U, ma), <span class=\"built_in\">reverse</span>(p.<span class=\"built_in\">begin</span>(), p.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">        p.<span class=\"built_in\">pb</span>(as.Fa), <span class=\"built_in\">print</span>();</span><br><span class=\"line\">        p = <span class=\"built_in\">find</span>(as.Fa, as.fa); vi t = <span class=\"built_in\">find</span>(as.u, ma);</span><br><span class=\"line\">        p.<span class=\"built_in\">insert</span>(p.<span class=\"built_in\">end</span>(), t.<span class=\"built_in\">begin</span>(), t.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">        <span class=\"built_in\">reverse</span>(p.<span class=\"built_in\">begin</span>(), p.<span class=\"built_in\">end</span>()), <span class=\"built_in\">print</span>();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;NO&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2135,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/521/problem/E\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span> </p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(n,m \\le 2 \\cdot 10^5\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(u \\rightarrow v\\)</span> </p>\r\n<p><img src=\"https://i.loli.net/2021/04/03/k3PV8WRYS4Uqmon.png\" /></p>\r\n<p></p>\r\n<p></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(low_u\\)</span>  <code>tarjan</code> <span class=\"math inline\">\\(Low_u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(Low_u = dfn_u\\)</span></p>\r\n<p> <span class=\"math inline\">\\(Low_u &lt; dfn_u\\)</span>  <span class=\"math inline\">\\(u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(lca(v,V)=u\\)</span> <span class=\"math inline\">\\(u \\rightarrow Low\\)</span><span class=\"math inline\">\\(u \\rightarrow v \\rightarrow low \\rightarrow Low\\)</span>  <span class=\"math inline\">\\(u \\rightarrow V \\rightarrow Low\\)</span> </p>\r\n<p><img src=\"https://i.loli.net/2021/04/03/tQCALX5ah47RU9f.png\" /></p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(Low_u &lt; dfn_u\\)</span> <span class=\"math inline\">\\(lca(v, V) = u\\)</span></p>\r\n<p> <code>dfs</code>  <span class=\"math inline\">\\(Low_u &lt; dfn_u\\)</span>  <span class=\"math inline\">\\(u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> vector &lt;<span class=\"keyword\">int</span>&gt; vi;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m; vi G[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> idx, dfn[N], fa[N], ma;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, fa, U, Fa;</span><br><span class=\"line\">    <span class=\"built_in\">node</span>(<span class=\"keyword\">int</span> uu) &#123; u = fa = U = Fa = uu; &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> uu, <span class=\"keyword\">int</span> ffa)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dfn[ffa] &lt; dfn[fa]) U = u, Fa = fa, u = uu, fa = ffa;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(dfn[ffa] &lt; dfn[Fa]) U = uu, Fa = ffa;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; <span class=\"built_in\">as</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"function\">node <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    dfn[u] = ++idx; <span class=\"function\">node <span class=\"title\">lowu</span><span class=\"params\">(u)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(!dfn[v]) &#123;</span><br><span class=\"line\">        fa[v] = u;</span><br><span class=\"line\">        node lowv = <span class=\"built_in\">dfs</span>(v);</span><br><span class=\"line\">        lowu.<span class=\"built_in\">upd</span>(lowv.u, lowv.fa), lowu.<span class=\"built_in\">upd</span>(lowv.U, lowv.Fa);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(dfn[v] &lt; dfn[u] &amp;&amp; v ^ fa[u]) lowu.<span class=\"built_in\">upd</span>(u, v);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!ma &amp;&amp; dfn[lowu.Fa] &lt; dfn[u]) as = lowu, ma = u;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> lowu;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">vi <span class=\"title\">find</span><span class=\"params\">(<span class=\"keyword\">int</span> s, <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    vi p;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(s ^ t) p.<span class=\"built_in\">pb</span>(s), s = fa[s];</span><br><span class=\"line\">    p.<span class=\"built_in\">pb</span>(t);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">vi p;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">print</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%llu &quot;</span>, p.<span class=\"built_in\">size</span>());</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> u : p) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, u);</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;u, &amp;v), G[u].<span class=\"built_in\">pb</span>(v), G[v].<span class=\"built_in\">pb</span>(u);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(!ma &amp;&amp; !dfn[i]) <span class=\"built_in\">dfs</span>(i);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(ma) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;YES&quot;</span>);</span><br><span class=\"line\">        p = <span class=\"built_in\">find</span>(ma, as.Fa), <span class=\"built_in\">print</span>();</span><br><span class=\"line\">        p = <span class=\"built_in\">find</span>(as.U, ma), <span class=\"built_in\">reverse</span>(p.<span class=\"built_in\">begin</span>(), p.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">        p.<span class=\"built_in\">pb</span>(as.Fa), <span class=\"built_in\">print</span>();</span><br><span class=\"line\">        p = <span class=\"built_in\">find</span>(as.Fa, as.fa); vi t = <span class=\"built_in\">find</span>(as.u, ma);</span><br><span class=\"line\">        p.<span class=\"built_in\">insert</span>(p.<span class=\"built_in\">end</span>(), t.<span class=\"built_in\">begin</span>(), t.<span class=\"built_in\">end</span>());</span><br><span class=\"line\">        <span class=\"built_in\">reverse</span>(p.<span class=\"built_in\">begin</span>(), p.<span class=\"built_in\">end</span>()), <span class=\"built_in\">print</span>();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;NO&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Guards In The Storehouse | Codeforces 845F","date":"2021-03-26T06:52:36.000Z","updated":"2021-03-26T06:52:36.000Z","_content":"> [](http://codeforces.com/problemset/problem/845/F)\n>\n>  $n \\times m$ \n>\n> \n>\n>  $1$  $10^9+7$ \n>\n> $nm \\le 250$\n\n$\\land$ $\\lor$ \n\n $nm \\le 250 \\Rightarrow \\min\\{n,m\\} \\le 15$\n\n $n < m$ $m \\le 15$ \n\n\n\n\n\n $f_{i\\,a,b,S}$ **** $i=(x,y)$ $a$  $i$ $1$$0$ $i$ $b$ **** $S$  $x$  $y-1$  $x-1$  $m-y+1$ $1$$0$\n\n $a = 0, b = 1, S = \\{0,0,1,0,1\\}$\n\n![](https://i.loli.net/2021/03/26/3JZXsTfOdn2GyAe.png)\n\n\n\n-  $i$ \n  $$\n  a \\rightarrow 0,S \\rightarrow S \\setminus \\{y\\}\\\\\n  $$\n  ```f[i][a][b][S]```  ```f[nxt][0][b][~(~S | 1 << y)]```\n\n-  $i$  $i$ \n  $$\n  a \\rightarrow 1,S \\rightarrow S \\cup \\{y\\}\n  $$\n  ```f[i][a][b][S]```  ```f[nxt][1][b][S | 1 << y]```\n\n-  $i$  $i$  $i$ \n\n   $a=1 \\lor y \\in S$ $i$ $a,b$  $S$   $i$  $b$  0 $1$$a$  $S$ \n\n $i$  $a$  $0$\n\n $(n+1,1)$  ```f``` ****\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\ntypedef long long ll;\nconst ll P = 1e9 + 7;\nint n, m, f[255][2][2][1 << 15]; char s[255][255];\n\nint main() {\n    cin >> n >> m;\n    For(i, 0, n) scanf(\"%s\", s[i]);\n    if(n < m) {\n        For(i, 0, n) For(j, i + 1, m) swap(s[i][j], s[j][i]);\n        swap(n, m);\n    }\n    f[0][0][0][0] = 1;\n    For(i, 0, n) For(j, 0, m) rep(a, 0, 1) rep(b, 0, 1) For(S, 0, 1 << m) {\n        int x = f[i * m + j][a][b][S], nxt = i * m + j + 1;\n        if(!x) continue;\n        if(s[i][j] == 'x') (f[nxt][0][b][~(~S | 1 << j)] += x) %= P;\n        else {\n            (f[nxt][j < m - 1][b][S | 1 << j] += x) %= P;\n            if(a | (S >> j & 1)) (f[nxt][a & (j < m - 1)][b][S] += x) %= P;\n            else if(!b) (f[nxt][0][1][S] += x) %= P;\n        }\n    }\n    int as = 0;\n    rep(b, 0, 1) For(S, 0, 1 << m) (as += f[n * m][0][b][S]) %= P;\n    cout << as;\n    return 0;\n}\n```","source":"_posts/CF845F.md","raw":"---\ntitle: Guards In The Storehouse | Codeforces 845F\ndate: 2021-03-26 14:52:36\nupdated: 2021-03-26 14:52:36\ntags: [,]\ncategories: Codeforces\n---\n> [](http://codeforces.com/problemset/problem/845/F)\n>\n>  $n \\times m$ \n>\n> \n>\n>  $1$  $10^9+7$ \n>\n> $nm \\le 250$\n\n$\\land$ $\\lor$ \n\n $nm \\le 250 \\Rightarrow \\min\\{n,m\\} \\le 15$\n\n $n < m$ $m \\le 15$ \n\n\n\n\n\n $f_{i\\,a,b,S}$ **** $i=(x,y)$ $a$  $i$ $1$$0$ $i$ $b$ **** $S$  $x$  $y-1$  $x-1$  $m-y+1$ $1$$0$\n\n $a = 0, b = 1, S = \\{0,0,1,0,1\\}$\n\n![](https://i.loli.net/2021/03/26/3JZXsTfOdn2GyAe.png)\n\n\n\n-  $i$ \n  $$\n  a \\rightarrow 0,S \\rightarrow S \\setminus \\{y\\}\\\\\n  $$\n  ```f[i][a][b][S]```  ```f[nxt][0][b][~(~S | 1 << y)]```\n\n-  $i$  $i$ \n  $$\n  a \\rightarrow 1,S \\rightarrow S \\cup \\{y\\}\n  $$\n  ```f[i][a][b][S]```  ```f[nxt][1][b][S | 1 << y]```\n\n-  $i$  $i$  $i$ \n\n   $a=1 \\lor y \\in S$ $i$ $a,b$  $S$   $i$  $b$  0 $1$$a$  $S$ \n\n $i$  $a$  $0$\n\n $(n+1,1)$  ```f``` ****\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\ntypedef long long ll;\nconst ll P = 1e9 + 7;\nint n, m, f[255][2][2][1 << 15]; char s[255][255];\n\nint main() {\n    cin >> n >> m;\n    For(i, 0, n) scanf(\"%s\", s[i]);\n    if(n < m) {\n        For(i, 0, n) For(j, i + 1, m) swap(s[i][j], s[j][i]);\n        swap(n, m);\n    }\n    f[0][0][0][0] = 1;\n    For(i, 0, n) For(j, 0, m) rep(a, 0, 1) rep(b, 0, 1) For(S, 0, 1 << m) {\n        int x = f[i * m + j][a][b][S], nxt = i * m + j + 1;\n        if(!x) continue;\n        if(s[i][j] == 'x') (f[nxt][0][b][~(~S | 1 << j)] += x) %= P;\n        else {\n            (f[nxt][j < m - 1][b][S | 1 << j] += x) %= P;\n            if(a | (S >> j & 1)) (f[nxt][a & (j < m - 1)][b][S] += x) %= P;\n            else if(!b) (f[nxt][0][1][S] += x) %= P;\n        }\n    }\n    int as = 0;\n    rep(b, 0, 1) For(S, 0, 1 << m) (as += f[n * m][0][b][S]) %= P;\n    cout << as;\n    return 0;\n}\n```","slug":"CF845F","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzv0015ootn4pqv90ir","content":"<blockquote>\r\n<p><a href=\"http://codeforces.com/problemset/problem/845/F\"></a></p>\r\n<p> <span class=\"math inline\">\\(n \\times m\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(10^9+7\\)</span> </p>\r\n<p><span class=\"math inline\">\\(nm \\le 250\\)</span></p>\r\n</blockquote>\r\n<p><span class=\"math inline\">\\(\\land\\)</span> <span class=\"math inline\">\\(\\lor\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(nm \\le 250 \\Rightarrow \\min\\{n,m\\} \\le 15\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n &lt; m\\)</span> <span class=\"math inline\">\\(m \\le 15\\)</span> </p>\r\n<p></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(f_{i\\,a,b,S}\\)</span> <strong></strong> <span class=\"math inline\">\\(i=(x,y)\\)</span> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(1\\)</span><span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(b\\)</span> <strong></strong> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(y-1\\)</span>  <span class=\"math inline\">\\(x-1\\)</span>  <span class=\"math inline\">\\(m-y+1\\)</span> <span class=\"math inline\">\\(1\\)</span><span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a = 0, b = 1, S = \\{0,0,1,0,1\\}\\)</span></p>\r\n<p><img src=\"https://i.loli.net/2021/03/26/3JZXsTfOdn2GyAe.png\" /></p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math display\">\\[\r\na \\rightarrow 0,S \\rightarrow S \\setminus \\{y\\}\\\\\r\n\\]</span> <figure class=\"highlight plaintext\"><figcaption><span> ```f[nxt][0][b][~(~S | 1 << y)]```</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">-  $i$  $i$ </span><br><span class=\"line\">  $$</span><br><span class=\"line\">  a \\rightarrow 1,S \\rightarrow S \\cup \\&#123;y\\&#125;</span><br><span class=\"line\">  $$</span><br><span class=\"line\">  ```f[i][a][b][S]```  ```f[nxt][1][b][S | 1 &lt;&lt; y]```</span><br><span class=\"line\"></span><br><span class=\"line\">-  $i$  $i$  $i$ </span><br><span class=\"line\"></span><br><span class=\"line\">   $a=1 \\lor y \\in S$ $i$ $a,b$  $S$   $i$  $b$  0 $1$$a$  $S$ </span><br><span class=\"line\"></span><br><span class=\"line\"> $i$  $a$  $0$</span><br><span class=\"line\"></span><br><span class=\"line\"> $(n+1,1)$  ```f``` ****</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">```cpp</span><br><span class=\"line\">#include &lt;bits/stdc++.h&gt;</span><br><span class=\"line\">#define rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span><br><span class=\"line\">#define per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span><br><span class=\"line\">#define mem(a, b) memset(a, b, sizeof a)</span><br><span class=\"line\">#define For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span><br><span class=\"line\"></span><br><span class=\"line\">using namespace std;</span><br><span class=\"line\">typedef long long ll;</span><br><span class=\"line\">const ll P = 1e9 + 7;</span><br><span class=\"line\">int n, m, f[255][2][2][1 &lt;&lt; 15]; char s[255][255];</span><br><span class=\"line\"></span><br><span class=\"line\">int main() &#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    For(i, 0, n) scanf(&quot;%s&quot;, s[i]);</span><br><span class=\"line\">    if(n &lt; m) &#123;</span><br><span class=\"line\">        For(i, 0, n) For(j, i + 1, m) swap(s[i][j], s[j][i]);</span><br><span class=\"line\">        swap(n, m);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    f[0][0][0][0] = 1;</span><br><span class=\"line\">    For(i, 0, n) For(j, 0, m) rep(a, 0, 1) rep(b, 0, 1) For(S, 0, 1 &lt;&lt; m) &#123;</span><br><span class=\"line\">        int x = f[i * m + j][a][b][S], nxt = i * m + j + 1;</span><br><span class=\"line\">        if(!x) continue;</span><br><span class=\"line\">        if(s[i][j] == &#x27;x&#x27;) (f[nxt][0][b][~(~S | 1 &lt;&lt; j)] += x) %= P;</span><br><span class=\"line\">        else &#123;</span><br><span class=\"line\">            (f[nxt][j &lt; m - 1][b][S | 1 &lt;&lt; j] += x) %= P;</span><br><span class=\"line\">            if(a | (S &gt;&gt; j &amp; 1)) (f[nxt][a &amp; (j &lt; m - 1)][b][S] += x) %= P;</span><br><span class=\"line\">            else if(!b) (f[nxt][0][1][S] += x) %= P;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    int as = 0;</span><br><span class=\"line\">    rep(b, 0, 1) For(S, 0, 1 &lt;&lt; m) (as += f[n * m][0][b][S]) %= P;</span><br><span class=\"line\">    cout &lt;&lt; as;</span><br><span class=\"line\">    return 0;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\r\n</ul>\r\n","site":{"data":{}},"length":709,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"http://codeforces.com/problemset/problem/845/F\"></a></p>\r\n<p> <span class=\"math inline\">\\(n \\times m\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(10^9+7\\)</span> </p>\r\n<p><span class=\"math inline\">\\(nm \\le 250\\)</span></p>\r\n</blockquote>\r\n<p><span class=\"math inline\">\\(\\land\\)</span> <span class=\"math inline\">\\(\\lor\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(nm \\le 250 \\Rightarrow \\min\\{n,m\\} \\le 15\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n &lt; m\\)</span> <span class=\"math inline\">\\(m \\le 15\\)</span> </p>\r\n<p></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(f_{i\\,a,b,S}\\)</span> <strong></strong> <span class=\"math inline\">\\(i=(x,y)\\)</span> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(1\\)</span><span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(b\\)</span> <strong></strong> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(y-1\\)</span>  <span class=\"math inline\">\\(x-1\\)</span>  <span class=\"math inline\">\\(m-y+1\\)</span> <span class=\"math inline\">\\(1\\)</span><span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a = 0, b = 1, S = \\{0,0,1,0,1\\}\\)</span></p>\r\n<p><img src=\"https://i.loli.net/2021/03/26/3JZXsTfOdn2GyAe.png\" /></p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math display\">\\[\r\na \\rightarrow 0,S \\rightarrow S \\setminus \\{y\\}\\\\\r\n\\]</span> <figure class=\"highlight plaintext\"><figcaption><span> ```f[nxt][0][b][~(~S | 1 << y)]```</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">-  $i$  $i$ </span><br><span class=\"line\">  $$</span><br><span class=\"line\">  a \\rightarrow 1,S \\rightarrow S \\cup \\&#123;y\\&#125;</span><br><span class=\"line\">  $$</span><br><span class=\"line\">  ```f[i][a][b][S]```  ```f[nxt][1][b][S | 1 &lt;&lt; y]```</span><br><span class=\"line\"></span><br><span class=\"line\">-  $i$  $i$  $i$ </span><br><span class=\"line\"></span><br><span class=\"line\">   $a=1 \\lor y \\in S$ $i$ $a,b$  $S$   $i$  $b$  0 $1$$a$  $S$ </span><br><span class=\"line\"></span><br><span class=\"line\"> $i$  $a$  $0$</span><br><span class=\"line\"></span><br><span class=\"line\"> $(n+1,1)$  ```f``` ****</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">```cpp</span><br><span class=\"line\">#include &lt;bits/stdc++.h&gt;</span><br><span class=\"line\">#define rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span><br><span class=\"line\">#define per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span><br><span class=\"line\">#define mem(a, b) memset(a, b, sizeof a)</span><br><span class=\"line\">#define For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span><br><span class=\"line\"></span><br><span class=\"line\">using namespace std;</span><br><span class=\"line\">typedef long long ll;</span><br><span class=\"line\">const ll P = 1e9 + 7;</span><br><span class=\"line\">int n, m, f[255][2][2][1 &lt;&lt; 15]; char s[255][255];</span><br><span class=\"line\"></span><br><span class=\"line\">int main() &#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    For(i, 0, n) scanf(&quot;%s&quot;, s[i]);</span><br><span class=\"line\">    if(n &lt; m) &#123;</span><br><span class=\"line\">        For(i, 0, n) For(j, i + 1, m) swap(s[i][j], s[j][i]);</span><br><span class=\"line\">        swap(n, m);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    f[0][0][0][0] = 1;</span><br><span class=\"line\">    For(i, 0, n) For(j, 0, m) rep(a, 0, 1) rep(b, 0, 1) For(S, 0, 1 &lt;&lt; m) &#123;</span><br><span class=\"line\">        int x = f[i * m + j][a][b][S], nxt = i * m + j + 1;</span><br><span class=\"line\">        if(!x) continue;</span><br><span class=\"line\">        if(s[i][j] == &#x27;x&#x27;) (f[nxt][0][b][~(~S | 1 &lt;&lt; j)] += x) %= P;</span><br><span class=\"line\">        else &#123;</span><br><span class=\"line\">            (f[nxt][j &lt; m - 1][b][S | 1 &lt;&lt; j] += x) %= P;</span><br><span class=\"line\">            if(a | (S &gt;&gt; j &amp; 1)) (f[nxt][a &amp; (j &lt; m - 1)][b][S] += x) %= P;</span><br><span class=\"line\">            else if(!b) (f[nxt][0][1][S] += x) %= P;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    int as = 0;</span><br><span class=\"line\">    rep(b, 0, 1) For(S, 0, 1 &lt;&lt; m) (as += f[n * m][0][b][S]) %= P;</span><br><span class=\"line\">    cout &lt;&lt; as;</span><br><span class=\"line\">    return 0;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\r\n</ul>\r\n"},{"title":"Yura and Developers | Codeforces 549F","date":"2021-04-23T00:22:10.000Z","updated":"2021-04-23T00:22:10.000Z","_content":"> [](https://codeforces.com/contest/549/problem/F)\n>\n>  $n$  $k$ $1$  $k$ \n>\n> $n \\le 3 \\cdot 10^5,k \\le 10^6,a_i \\le 10^9$\n\n $pre$\n\n $pre_r \\equiv pre_{l-1} + \\max \\pmod k$\n\n $i$  $\\text{vector}[pre_i \\bmod k]$ $k$  $x$\n\n $x$\n\n $x$  $x$ \n\n $x$  $O(n^2\\log n)$\n\n $O(n \\log^2 n)$\n\n\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\ntypedef long long ll;\nconst int N = 3e5 + 5;\nint n, K, a[N], L[N], R[N], su[N];\nvector <int> v[1000000];\nint main() {\n    cin >> n >> K;\n    rep(i, 1, n) scanf(\"%d\", &a[i]);\n    v[0].pb(0);\n    rep(i, 1, n) su[i] = (su[i - 1] + a[i]) % K, v[su[i]].pb(i);\n    rep(i, 1, n) for(int& j = L[i] = i - 1; j && a[j] <= a[i]; j = L[j]);\n    per(i, n, 1) for(int& j = R[i] = i + 1; j <= n && a[j] < a[i]; j = R[j]);\n    long long as = 0;\n    rep(i, 1, n) if(i - L[i] < R[i] - i) For(j, L[i], i) {\n        int t = (su[j] + a[i]) % K;\n        #define lb lower_bound\n        #define all v[t].begin(), v[t].end()\n        as += lb(all, R[i]) - lb(all, i);\n    } else For(j, i, R[i]) {\n        int t = ((su[j] - a[i]) % K + K) % K;\n        as += lb(all, i) - lb(all, L[i]);\n    }\n    cout << as - n;    \n    return 0;\n}\n```","source":"_posts/CF549F.md","raw":"---\ntitle: Yura and Developers | Codeforces 549F\ndate: 2021-04-23 08:22:10\nupdated: 2021-04-23 08:22:10\ntags: []\ncategories: Codeforces\n---\n> [](https://codeforces.com/contest/549/problem/F)\n>\n>  $n$  $k$ $1$  $k$ \n>\n> $n \\le 3 \\cdot 10^5,k \\le 10^6,a_i \\le 10^9$\n\n $pre$\n\n $pre_r \\equiv pre_{l-1} + \\max \\pmod k$\n\n $i$  $\\text{vector}[pre_i \\bmod k]$ $k$  $x$\n\n $x$\n\n $x$  $x$ \n\n $x$  $O(n^2\\log n)$\n\n $O(n \\log^2 n)$\n\n\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\ntypedef long long ll;\nconst int N = 3e5 + 5;\nint n, K, a[N], L[N], R[N], su[N];\nvector <int> v[1000000];\nint main() {\n    cin >> n >> K;\n    rep(i, 1, n) scanf(\"%d\", &a[i]);\n    v[0].pb(0);\n    rep(i, 1, n) su[i] = (su[i - 1] + a[i]) % K, v[su[i]].pb(i);\n    rep(i, 1, n) for(int& j = L[i] = i - 1; j && a[j] <= a[i]; j = L[j]);\n    per(i, n, 1) for(int& j = R[i] = i + 1; j <= n && a[j] < a[i]; j = R[j]);\n    long long as = 0;\n    rep(i, 1, n) if(i - L[i] < R[i] - i) For(j, L[i], i) {\n        int t = (su[j] + a[i]) % K;\n        #define lb lower_bound\n        #define all v[t].begin(), v[t].end()\n        as += lb(all, R[i]) - lb(all, i);\n    } else For(j, i, R[i]) {\n        int t = ((su[j] - a[i]) % K + K) % K;\n        as += lb(all, i) - lb(all, L[i]);\n    }\n    cout << as - n;    \n    return 0;\n}\n```","slug":"CF549F","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzw0019ootn9cet8kv2","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/549/problem/F\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(k\\)</span> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 3 \\cdot 10^5,k \\le 10^6,a_i \\le 10^9\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(pre\\)</span></p>\r\n<p> <span class=\"math inline\">\\(pre_r \\equiv pre_{l-1} + \\max \\pmod k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(\\text{vector}[pre_i \\bmod k]\\)</span> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(x\\)</span></p>\r\n<p> <span class=\"math inline\">\\(x\\)</span></p>\r\n<p> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(x\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(O(n^2\\log n)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n \\log^2 n)\\)</span></p>\r\n<p></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">3e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, K, a[N], L[N], R[N], su[N];</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; v[<span class=\"number\">1000000</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; K;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class=\"line\">    v[<span class=\"number\">0</span>].<span class=\"built_in\">pb</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) su[i] = (su[i - <span class=\"number\">1</span>] + a[i]) % K, v[su[i]].<span class=\"built_in\">pb</span>(i);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span>&amp; j = L[i] = i - <span class=\"number\">1</span>; j &amp;&amp; a[j] &lt;= a[i]; j = L[j]);</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, n, <span class=\"number\">1</span>) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span>&amp; j = R[i] = i + <span class=\"number\">1</span>; j &lt;= n &amp;&amp; a[j] &lt; a[i]; j = R[j]);</span><br><span class=\"line\">    <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> as = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(i - L[i] &lt; R[i] - i) <span class=\"built_in\">For</span>(j, L[i], i) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> t = (su[j] + a[i]) % K;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">define</span> lb lower_bound</span></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">define</span> all v[t].begin(), v[t].end()</span></span><br><span class=\"line\">        as += <span class=\"built_in\">lb</span>(all, R[i]) - <span class=\"built_in\">lb</span>(all, i);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"built_in\">For</span>(j, i, R[i]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> t = ((su[j] - a[i]) % K + K) % K;</span><br><span class=\"line\">        as += <span class=\"built_in\">lb</span>(all, i) - <span class=\"built_in\">lb</span>(all, L[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; as - n;    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":1337,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/549/problem/F\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(k\\)</span> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 3 \\cdot 10^5,k \\le 10^6,a_i \\le 10^9\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(pre\\)</span></p>\r\n<p> <span class=\"math inline\">\\(pre_r \\equiv pre_{l-1} + \\max \\pmod k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(\\text{vector}[pre_i \\bmod k]\\)</span> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(x\\)</span></p>\r\n<p> <span class=\"math inline\">\\(x\\)</span></p>\r\n<p> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(x\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(O(n^2\\log n)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n \\log^2 n)\\)</span></p>\r\n<p></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">3e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, K, a[N], L[N], R[N], su[N];</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; v[<span class=\"number\">1000000</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; K;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class=\"line\">    v[<span class=\"number\">0</span>].<span class=\"built_in\">pb</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) su[i] = (su[i - <span class=\"number\">1</span>] + a[i]) % K, v[su[i]].<span class=\"built_in\">pb</span>(i);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span>&amp; j = L[i] = i - <span class=\"number\">1</span>; j &amp;&amp; a[j] &lt;= a[i]; j = L[j]);</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, n, <span class=\"number\">1</span>) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span>&amp; j = R[i] = i + <span class=\"number\">1</span>; j &lt;= n &amp;&amp; a[j] &lt; a[i]; j = R[j]);</span><br><span class=\"line\">    <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> as = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(i - L[i] &lt; R[i] - i) <span class=\"built_in\">For</span>(j, L[i], i) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> t = (su[j] + a[i]) % K;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">define</span> lb lower_bound</span></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">define</span> all v[t].begin(), v[t].end()</span></span><br><span class=\"line\">        as += <span class=\"built_in\">lb</span>(all, R[i]) - <span class=\"built_in\">lb</span>(all, i);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"built_in\">For</span>(j, i, R[i]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> t = ((su[j] - a[i]) % K + K) % K;</span><br><span class=\"line\">        as += <span class=\"built_in\">lb</span>(all, i) - <span class=\"built_in\">lb</span>(all, L[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; as - n;    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Case of Computer Network | Codeforces 555E","date":"2021-04-03T13:15:06.000Z","updated":"2021-04-03T13:15:06.000Z","_content":"> [](https://codeforces.com/contest/555/problem/E)\n>\n>  $n$  $m$  $q$  $(s_i,t_i)$\n>\n>  $s_i$  $t_i$\n>\n> $n,m,q \\le 2 \\cdot 10^5$ \n\n\n\n### \n\n\n\n> ********\n>\n> ********\n\n\n\n\n\n**** $s_i$  $t_i$ \n\n**```tarjan``` ** \n\n ```dfs```  $(s_i,t_i)$ $s_i$  $t_i$  $s_i$  $t_i$\n\n $s_i \\rightarrow lca$  $+1$$lca \\rightarrow t_i$  $-1$ $s_i$  $+1$$t_i$  $-1$$lca$ \n\n![](https://i.loli.net/2021/04/03/t6zWCK1xuaEgcb5.png)\n\n $0$ \n\n### \n\n $s_i \\rightarrow lca$ $lca \\rightarrow t_i$ \n\n $up_u$  $u$ ****\n\n$down_u$  $u$ ****\n\n $up_{s_i}$  $down_{t_i}$  $s_i$  $t_i$  $(s_i,t_i)$  ```dfs``` \n\n $O(n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\nconst int N = 2e5 + 5;\nint n, m, q, idx, dfn[N], suf[N], cut[N];\nvector <pair <int, int>> G[N];\nint vis[N], sz[N], s[N], t[N], up[N], down[N];\nint dfs(int u, int lst) {\n    int lowu = dfn[u] = ++idx;\n    for(auto [v, w] : G[u]) if(!dfn[v]) {\n        int lowv = dfs(v, w);\n        lowu = min(lowu, lowv), cut[v] = lowv > dfn[u];\n    } else if(w ^ lst && dfn[v] < dfn[u]) lowu = min(lowu, dfn[v]);\n    suf[u] = idx;\n    return lowu;\n}\nvoid Dfs(int u) {\n    vis[u] = 1;\n    for(auto [v, w] : G[u]) if(!vis[v]) Dfs(v), sz[u] += sz[v];\n}\nvoid DFs(int u, int fa) {\n    vis[u] = 1, up[u] = up[fa], down[u] = down[fa];\n    if(!fa || (cut[u] && sz[u] <= 0)) up[u] = u;\n    if(!fa || (cut[u] && sz[u] >= 0)) down[u] = u;\n    for(auto [v, w] : G[u]) if(!vis[v]) DFs(v, u);\n}\nint main() {\n    cin >> n >> m >> q; \n    int u, v;\n    rep(i, 1, m) {\n        scanf(\"%d%d\", &u, &v);\n        G[u].push_back({v, ++idx}), G[v].push_back({u, idx});\n    }\n    idx = 0;\n    rep(i, 1, n) if(!dfn[i]) dfs(i, 0);\n    rep(i, 1, q) scanf(\"%d%d\", &s[i], &t[i]), sz[s[i]]++, sz[t[i]]--;\n    rep(i, 1, n) if(!vis[i]) Dfs(i);\n    mem(vis, 0);\n    rep(i, 1, n) if(!vis[i]) DFs(i, 0);\n    rep(i, 1, q) {\n        int lca = dfn[up[s[i]]] > dfn[down[t[i]]] ? up[s[i]] : down[t[i]];\n        if(dfn[s[i]] > dfn[t[i]]) swap(s[i], t[i]);\n        if(dfn[s[i]] < dfn[lca] || dfn[t[i]] > suf[lca]) puts(\"No\"), exit(0);\n    }\n    puts(\"Yes\");\n    return 0;\n}\n```","source":"_posts/CF555E.md","raw":"---\ntitle: Case of Computer Network | Codeforces 555E\ndate: 2021-04-03 21:15:06\nupdated: 2021-04-03 21:15:06\ntags: [,,]\ncategories: Codeforces\n---\n> [](https://codeforces.com/contest/555/problem/E)\n>\n>  $n$  $m$  $q$  $(s_i,t_i)$\n>\n>  $s_i$  $t_i$\n>\n> $n,m,q \\le 2 \\cdot 10^5$ \n\n\n\n### \n\n\n\n> ********\n>\n> ********\n\n\n\n\n\n**** $s_i$  $t_i$ \n\n**```tarjan``` ** \n\n ```dfs```  $(s_i,t_i)$ $s_i$  $t_i$  $s_i$  $t_i$\n\n $s_i \\rightarrow lca$  $+1$$lca \\rightarrow t_i$  $-1$ $s_i$  $+1$$t_i$  $-1$$lca$ \n\n![](https://i.loli.net/2021/04/03/t6zWCK1xuaEgcb5.png)\n\n $0$ \n\n### \n\n $s_i \\rightarrow lca$ $lca \\rightarrow t_i$ \n\n $up_u$  $u$ ****\n\n$down_u$  $u$ ****\n\n $up_{s_i}$  $down_{t_i}$  $s_i$  $t_i$  $(s_i,t_i)$  ```dfs``` \n\n $O(n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\nconst int N = 2e5 + 5;\nint n, m, q, idx, dfn[N], suf[N], cut[N];\nvector <pair <int, int>> G[N];\nint vis[N], sz[N], s[N], t[N], up[N], down[N];\nint dfs(int u, int lst) {\n    int lowu = dfn[u] = ++idx;\n    for(auto [v, w] : G[u]) if(!dfn[v]) {\n        int lowv = dfs(v, w);\n        lowu = min(lowu, lowv), cut[v] = lowv > dfn[u];\n    } else if(w ^ lst && dfn[v] < dfn[u]) lowu = min(lowu, dfn[v]);\n    suf[u] = idx;\n    return lowu;\n}\nvoid Dfs(int u) {\n    vis[u] = 1;\n    for(auto [v, w] : G[u]) if(!vis[v]) Dfs(v), sz[u] += sz[v];\n}\nvoid DFs(int u, int fa) {\n    vis[u] = 1, up[u] = up[fa], down[u] = down[fa];\n    if(!fa || (cut[u] && sz[u] <= 0)) up[u] = u;\n    if(!fa || (cut[u] && sz[u] >= 0)) down[u] = u;\n    for(auto [v, w] : G[u]) if(!vis[v]) DFs(v, u);\n}\nint main() {\n    cin >> n >> m >> q; \n    int u, v;\n    rep(i, 1, m) {\n        scanf(\"%d%d\", &u, &v);\n        G[u].push_back({v, ++idx}), G[v].push_back({u, idx});\n    }\n    idx = 0;\n    rep(i, 1, n) if(!dfn[i]) dfs(i, 0);\n    rep(i, 1, q) scanf(\"%d%d\", &s[i], &t[i]), sz[s[i]]++, sz[t[i]]--;\n    rep(i, 1, n) if(!vis[i]) Dfs(i);\n    mem(vis, 0);\n    rep(i, 1, n) if(!vis[i]) DFs(i, 0);\n    rep(i, 1, q) {\n        int lca = dfn[up[s[i]]] > dfn[down[t[i]]] ? up[s[i]] : down[t[i]];\n        if(dfn[s[i]] > dfn[t[i]]) swap(s[i], t[i]);\n        if(dfn[s[i]] < dfn[lca] || dfn[t[i]] > suf[lca]) puts(\"No\"), exit(0);\n    }\n    puts(\"Yes\");\n    return 0;\n}\n```","slug":"CF555E","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzx001bootn9hy4h0le","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/555/problem/E\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(q\\)</span>  <span class=\"math inline\">\\((s_i,t_i)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(t_i\\)</span></p>\r\n<p><span class=\"math inline\">\\(n,m,q \\le 2 \\cdot 10^5\\)</span> </p>\r\n</blockquote>\r\n<p></p>\r\n<h3 id=\"\"></h3>\r\n<p></p>\r\n<blockquote>\r\n<p><strong></strong><strong></strong></p>\r\n<p><strong></strong><strong></strong></p>\r\n</blockquote>\r\n<p></p>\r\n<p></p>\r\n<p><strong></strong> <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(t_i\\)</span> </p>\r\n<p><strong><code>tarjan</code> </strong></p>\r\n<p> <code>dfs</code>  <span class=\"math inline\">\\((s_i,t_i)\\)</span> <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(t_i\\)</span>  <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(t_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(s_i \\rightarrow lca\\)</span>  <span class=\"math inline\">\\(+1\\)</span><span class=\"math inline\">\\(lca \\rightarrow t_i\\)</span>  <span class=\"math inline\">\\(-1\\)</span> <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(+1\\)</span><span class=\"math inline\">\\(t_i\\)</span>  <span class=\"math inline\">\\(-1\\)</span><span class=\"math inline\">\\(lca\\)</span> </p>\r\n<p><img src=\"https://i.loli.net/2021/04/03/t6zWCK1xuaEgcb5.png\" /></p>\r\n<p> <span class=\"math inline\">\\(0\\)</span> </p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(s_i \\rightarrow lca\\)</span> <span class=\"math inline\">\\(lca \\rightarrow t_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(up_u\\)</span>  <span class=\"math inline\">\\(u\\)</span> <strong></strong></p>\r\n<p><span class=\"math inline\">\\(down_u\\)</span>  <span class=\"math inline\">\\(u\\)</span> <strong></strong></p>\r\n<p> <span class=\"math inline\">\\(up_{s_i}\\)</span>  <span class=\"math inline\">\\(down_{t_i}\\)</span>  <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(t_i\\)</span>  <span class=\"math inline\">\\((s_i,t_i)\\)</span>  <code>dfs</code> </p>\r\n<p> <span class=\"math inline\">\\(O(n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, q, idx, dfn[N], suf[N], cut[N];</span><br><span class=\"line\">vector &lt;pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; G[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> vis[N], sz[N], s[N], t[N], up[N], down[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> lst)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> lowu = dfn[u] = ++idx;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, w] : G[u]) <span class=\"keyword\">if</span>(!dfn[v]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> lowv = <span class=\"built_in\">dfs</span>(v, w);</span><br><span class=\"line\">        lowu = <span class=\"built_in\">min</span>(lowu, lowv), cut[v] = lowv &gt; dfn[u];</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(w ^ lst &amp;&amp; dfn[v] &lt; dfn[u]) lowu = <span class=\"built_in\">min</span>(lowu, dfn[v]);</span><br><span class=\"line\">    suf[u] = idx;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> lowu;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    vis[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, w] : G[u]) <span class=\"keyword\">if</span>(!vis[v]) <span class=\"built_in\">Dfs</span>(v), sz[u] += sz[v];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">DFs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> fa)</span> </span>&#123;</span><br><span class=\"line\">    vis[u] = <span class=\"number\">1</span>, up[u] = up[fa], down[u] = down[fa];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!fa || (cut[u] &amp;&amp; sz[u] &lt;= <span class=\"number\">0</span>)) up[u] = u;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!fa || (cut[u] &amp;&amp; sz[u] &gt;= <span class=\"number\">0</span>)) down[u] = u;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, w] : G[u]) <span class=\"keyword\">if</span>(!vis[v]) <span class=\"built_in\">DFs</span>(v, u);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; q; </span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class=\"line\">        G[u].<span class=\"built_in\">push_back</span>(&#123;v, ++idx&#125;), G[v].<span class=\"built_in\">push_back</span>(&#123;u, idx&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    idx = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(!dfn[i]) <span class=\"built_in\">dfs</span>(i, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;s[i], &amp;t[i]), sz[s[i]]++, sz[t[i]]--;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(!vis[i]) <span class=\"built_in\">Dfs</span>(i);</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(vis, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(!vis[i]) <span class=\"built_in\">DFs</span>(i, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> lca = dfn[up[s[i]]] &gt; dfn[down[t[i]]] ? up[s[i]] : down[t[i]];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dfn[s[i]] &gt; dfn[t[i]]) <span class=\"built_in\">swap</span>(s[i], t[i]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dfn[s[i]] &lt; dfn[lca] || dfn[t[i]] &gt; suf[lca]) <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;No&quot;</span>), <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Yes&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2418,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://codeforces.com/contest/555/problem/E\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(q\\)</span>  <span class=\"math inline\">\\((s_i,t_i)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(t_i\\)</span></p>\r\n<p><span class=\"math inline\">\\(n,m,q \\le 2 \\cdot 10^5\\)</span> </p>\r\n</blockquote>\r\n<p></p>\r\n<h3 id=\"\"></h3>\r\n<p></p>\r\n<blockquote>\r\n<p><strong></strong><strong></strong></p>\r\n<p><strong></strong><strong></strong></p>\r\n</blockquote>\r\n<p></p>\r\n<p></p>\r\n<p><strong></strong> <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(t_i\\)</span> </p>\r\n<p><strong><code>tarjan</code> </strong></p>\r\n<p> <code>dfs</code>  <span class=\"math inline\">\\((s_i,t_i)\\)</span> <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(t_i\\)</span>  <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(t_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(s_i \\rightarrow lca\\)</span>  <span class=\"math inline\">\\(+1\\)</span><span class=\"math inline\">\\(lca \\rightarrow t_i\\)</span>  <span class=\"math inline\">\\(-1\\)</span> <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(+1\\)</span><span class=\"math inline\">\\(t_i\\)</span>  <span class=\"math inline\">\\(-1\\)</span><span class=\"math inline\">\\(lca\\)</span> </p>\r\n<p><img src=\"https://i.loli.net/2021/04/03/t6zWCK1xuaEgcb5.png\" /></p>\r\n<p> <span class=\"math inline\">\\(0\\)</span> </p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(s_i \\rightarrow lca\\)</span> <span class=\"math inline\">\\(lca \\rightarrow t_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(up_u\\)</span>  <span class=\"math inline\">\\(u\\)</span> <strong></strong></p>\r\n<p><span class=\"math inline\">\\(down_u\\)</span>  <span class=\"math inline\">\\(u\\)</span> <strong></strong></p>\r\n<p> <span class=\"math inline\">\\(up_{s_i}\\)</span>  <span class=\"math inline\">\\(down_{t_i}\\)</span>  <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(t_i\\)</span>  <span class=\"math inline\">\\((s_i,t_i)\\)</span>  <code>dfs</code> </p>\r\n<p> <span class=\"math inline\">\\(O(n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, q, idx, dfn[N], suf[N], cut[N];</span><br><span class=\"line\">vector &lt;pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; G[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> vis[N], sz[N], s[N], t[N], up[N], down[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> lst)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> lowu = dfn[u] = ++idx;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, w] : G[u]) <span class=\"keyword\">if</span>(!dfn[v]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> lowv = <span class=\"built_in\">dfs</span>(v, w);</span><br><span class=\"line\">        lowu = <span class=\"built_in\">min</span>(lowu, lowv), cut[v] = lowv &gt; dfn[u];</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(w ^ lst &amp;&amp; dfn[v] &lt; dfn[u]) lowu = <span class=\"built_in\">min</span>(lowu, dfn[v]);</span><br><span class=\"line\">    suf[u] = idx;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> lowu;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    vis[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, w] : G[u]) <span class=\"keyword\">if</span>(!vis[v]) <span class=\"built_in\">Dfs</span>(v), sz[u] += sz[v];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">DFs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> fa)</span> </span>&#123;</span><br><span class=\"line\">    vis[u] = <span class=\"number\">1</span>, up[u] = up[fa], down[u] = down[fa];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!fa || (cut[u] &amp;&amp; sz[u] &lt;= <span class=\"number\">0</span>)) up[u] = u;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!fa || (cut[u] &amp;&amp; sz[u] &gt;= <span class=\"number\">0</span>)) down[u] = u;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, w] : G[u]) <span class=\"keyword\">if</span>(!vis[v]) <span class=\"built_in\">DFs</span>(v, u);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; q; </span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class=\"line\">        G[u].<span class=\"built_in\">push_back</span>(&#123;v, ++idx&#125;), G[v].<span class=\"built_in\">push_back</span>(&#123;u, idx&#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    idx = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(!dfn[i]) <span class=\"built_in\">dfs</span>(i, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;s[i], &amp;t[i]), sz[s[i]]++, sz[t[i]]--;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(!vis[i]) <span class=\"built_in\">Dfs</span>(i);</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(vis, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(!vis[i]) <span class=\"built_in\">DFs</span>(i, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> lca = dfn[up[s[i]]] &gt; dfn[down[t[i]]] ? up[s[i]] : down[t[i]];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dfn[s[i]] &gt; dfn[t[i]]) <span class=\"built_in\">swap</span>(s[i], t[i]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dfn[s[i]] &lt; dfn[lca] || dfn[t[i]] &gt; suf[lca]) <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;No&quot;</span>), <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Yes&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Policeman and a Tree | Codeforces 868E","date":"2021-03-18T08:10:31.000Z","updated":"2021-03-18T08:10:31.000Z","_content":"> [](http://codeforces.com/problemset/problem/868/E)\n>\n>  $n$  $s$  $1$ $m$ \n>\n> $1 \\le n, m, w_i \\le 50$$w_i$ \n>\n>  $s$ \n\n### \n\n\n\n $1$  $1$ **** $1$  $2,3,4$ \n\n\n\n![](https://i.loli.net/2021/03/18/A4Zpd72bkRMeINU.png)\n\n $1$  $4$  $4$  $5,6$  $2,3$  $1$\n\n![](https://i.loli.net/2021/03/18/gtTQYLueC21mlZW.png)\n\n $u$  $u$   \n  $O(n)$ \n\n  \n $O(n^3)$\n\n $f_{i,j,k}$  $i$ **** $j = u \\rightarrow v$ **** $u$  $v$  $k$ \n\n### \n\n  $i$ **** $j = u \\rightarrow v$  $w$ $v$  $k$ \n\n $v$ \n$$\nf_{i,j,k}=f_{i-k,\\bar j,i-k} + w\n$$\n $\\bar j$  $j$ \n\n\n\n![](https://i.loli.net/2021/03/18/Vsnf9c6hIvYkCRd.png)\n\n $4$  $k$  $a$  $5$$b$  $6$  \n $4 \\rightarrow 5$  $4 \\rightarrow 6$ \n\n\n$$\nf_{i,1 \\rightarrow 4,k} = \\max_{a+b=k}\\min \\lbrace f_{i,4 \\rightarrow 5,a},f_{i,4 \\rightarrow 6,b}\\rbrace + w\n$$\n $v$  $u$  $a_1,a_2,a_3,\\cdots,a_d$\n$$\nf_{i,j,k}=\\max_{c_1+c_2+\\cdots+c_d=k}\\min_{s=1}^df_{i,v \\rightarrow a_s,c_s} + w\n$$\n\n\n> $f_{i,j,k}$ **** $c_1,c_2,\\cdots,c_d$  \n> $f_{i,j,k+1}$  $\\bar c_1,\\bar c_2,\\cdots,\\bar c_d$  $c_1,c_2,\\cdots,c_d$  $+1$   \n> $+1$  $c_x$ \n>$$\n>f_{i,v \\rightarrow a_x,c_x+1}=\\max_{s=1}^df_{i,v \\rightarrow a_s,c_s+1}\n>$$\n>  \n> $f_{i,j,0} \\ge f_{i,j,1} \\ge f_{i,j,2} \\ge \\cdots \\ge f_{i,j,i}$\n>\n>\n>$$\n>\\forall x \\le f_{i,j,k}\\exists c_1,c_2,\\cdots,c_d,\\\\f_{i,v \\rightarrow a_1,c_1} \\ge x\\\\f_{i,v \\rightarrow a_2,c_2} \\ge x\\\\\\cdots\\\\f_{i,v \\rightarrow a_d,c_d} \\ge x\n>$$\n> ```check```  $m_i$  $f_{i,v \\rightarrow a_i}$  $x$   \n> $m_1+m_2+\\cdots+m_d \\ge k$\n>\n> $c_1 \\le m_1,c_2 \\le m_2, \\cdots, c_d \\le m_d$ $x$\n>\n\n $x$ $O(n\\log n)$  $f_{i,j,0},f_{i,j,1},\\cdots,f_{i,j,i}$\n\n $O(n^3\\log n)$ $O(n^5)$ \n\n $15$ ```ms``` $30$ ```ms```\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\nconst int N = 55, Inf = 1e9;\nint n, s, m, ev[N * 2], ew[N * 2], cnt[N], deg[N];\nvector <int> G[N];\nint f[N][N * 2][N];\nvoid solve(int, int);\nint dp(int i, int j, int k) {\n    if(!f[i][j][k]) solve(i, j);\n    return f[i][j][k];\n}\nstruct node {\n    int i, e, c;\n    int val()const { return c < i ? dp(i, e, c + 1) : 0; }\n    bool operator <(const node& b)const { return val() < b.val(); }\n};\nvoid solve(int i, int j) {\n    f[i][j][0] = Inf;\n    if(deg[ev[j]] == 1)\n        rep(k, 1, i) f[i][j][k] = k < i ? dp(i - k, j ^ 1, i - k) + ew[j] : ew[j];\n    else {\n        priority_queue <node> q;\n        for(int e : G[ev[j]]) if(e ^ j ^ 1) q.push({ i, e, 0 });\n        rep(k, 1, i) {\n            node x = q.top(); q.pop();\n            f[i][j][k] = min(f[i][j][k - 1], x.val() + ew[j]);\n            x.c++, q.push(x);\n        }\n    }\n}\nint dfs(int u, int fa) {\n    int res = cnt[u];\n    for(int e : G[u]) if(ev[e] ^ fa) res += dfs(ev[e], u);\n    return res;\n}\nint main() {\n    ios::sync_with_stdio(0), cin.tie(0);\n    cin >> n;\n    int u, v, w;\n    rep(i, 2, n) {\n        int a = i * 2, b = a + 1;\n        cin >> u >> v >> w, deg[ev[a] = v]++, deg[ev[b] = u]++, ew[a] = ew[b] = w;\n        G[u].push_back(a), G[v].push_back(b);\n    }\n    cin >> s >> m;\n    rep(i, 1, m) cin >> u, cnt[u]++;\n    int ans = Inf;\n    for(int e : G[s]) ans = min(ans, dp(m, e, dfs(ev[e], s)));\n    cout << ans;\n    return 0;\n}\n```","source":"_posts/CF868E.md","raw":"---\ntitle: Policeman and a Tree | Codeforces 868E\ndate: 2021-03-18 16:10:31\nupdated: 2021-03-18 16:10:31\ntags: [,]\ncategories: Codeforces\n---\n> [](http://codeforces.com/problemset/problem/868/E)\n>\n>  $n$  $s$  $1$ $m$ \n>\n> $1 \\le n, m, w_i \\le 50$$w_i$ \n>\n>  $s$ \n\n### \n\n\n\n $1$  $1$ **** $1$  $2,3,4$ \n\n\n\n![](https://i.loli.net/2021/03/18/A4Zpd72bkRMeINU.png)\n\n $1$  $4$  $4$  $5,6$  $2,3$  $1$\n\n![](https://i.loli.net/2021/03/18/gtTQYLueC21mlZW.png)\n\n $u$  $u$   \n  $O(n)$ \n\n  \n $O(n^3)$\n\n $f_{i,j,k}$  $i$ **** $j = u \\rightarrow v$ **** $u$  $v$  $k$ \n\n### \n\n  $i$ **** $j = u \\rightarrow v$  $w$ $v$  $k$ \n\n $v$ \n$$\nf_{i,j,k}=f_{i-k,\\bar j,i-k} + w\n$$\n $\\bar j$  $j$ \n\n\n\n![](https://i.loli.net/2021/03/18/Vsnf9c6hIvYkCRd.png)\n\n $4$  $k$  $a$  $5$$b$  $6$  \n $4 \\rightarrow 5$  $4 \\rightarrow 6$ \n\n\n$$\nf_{i,1 \\rightarrow 4,k} = \\max_{a+b=k}\\min \\lbrace f_{i,4 \\rightarrow 5,a},f_{i,4 \\rightarrow 6,b}\\rbrace + w\n$$\n $v$  $u$  $a_1,a_2,a_3,\\cdots,a_d$\n$$\nf_{i,j,k}=\\max_{c_1+c_2+\\cdots+c_d=k}\\min_{s=1}^df_{i,v \\rightarrow a_s,c_s} + w\n$$\n\n\n> $f_{i,j,k}$ **** $c_1,c_2,\\cdots,c_d$  \n> $f_{i,j,k+1}$  $\\bar c_1,\\bar c_2,\\cdots,\\bar c_d$  $c_1,c_2,\\cdots,c_d$  $+1$   \n> $+1$  $c_x$ \n>$$\n>f_{i,v \\rightarrow a_x,c_x+1}=\\max_{s=1}^df_{i,v \\rightarrow a_s,c_s+1}\n>$$\n>  \n> $f_{i,j,0} \\ge f_{i,j,1} \\ge f_{i,j,2} \\ge \\cdots \\ge f_{i,j,i}$\n>\n>\n>$$\n>\\forall x \\le f_{i,j,k}\\exists c_1,c_2,\\cdots,c_d,\\\\f_{i,v \\rightarrow a_1,c_1} \\ge x\\\\f_{i,v \\rightarrow a_2,c_2} \\ge x\\\\\\cdots\\\\f_{i,v \\rightarrow a_d,c_d} \\ge x\n>$$\n> ```check```  $m_i$  $f_{i,v \\rightarrow a_i}$  $x$   \n> $m_1+m_2+\\cdots+m_d \\ge k$\n>\n> $c_1 \\le m_1,c_2 \\le m_2, \\cdots, c_d \\le m_d$ $x$\n>\n\n $x$ $O(n\\log n)$  $f_{i,j,0},f_{i,j,1},\\cdots,f_{i,j,i}$\n\n $O(n^3\\log n)$ $O(n^5)$ \n\n $15$ ```ms``` $30$ ```ms```\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\nconst int N = 55, Inf = 1e9;\nint n, s, m, ev[N * 2], ew[N * 2], cnt[N], deg[N];\nvector <int> G[N];\nint f[N][N * 2][N];\nvoid solve(int, int);\nint dp(int i, int j, int k) {\n    if(!f[i][j][k]) solve(i, j);\n    return f[i][j][k];\n}\nstruct node {\n    int i, e, c;\n    int val()const { return c < i ? dp(i, e, c + 1) : 0; }\n    bool operator <(const node& b)const { return val() < b.val(); }\n};\nvoid solve(int i, int j) {\n    f[i][j][0] = Inf;\n    if(deg[ev[j]] == 1)\n        rep(k, 1, i) f[i][j][k] = k < i ? dp(i - k, j ^ 1, i - k) + ew[j] : ew[j];\n    else {\n        priority_queue <node> q;\n        for(int e : G[ev[j]]) if(e ^ j ^ 1) q.push({ i, e, 0 });\n        rep(k, 1, i) {\n            node x = q.top(); q.pop();\n            f[i][j][k] = min(f[i][j][k - 1], x.val() + ew[j]);\n            x.c++, q.push(x);\n        }\n    }\n}\nint dfs(int u, int fa) {\n    int res = cnt[u];\n    for(int e : G[u]) if(ev[e] ^ fa) res += dfs(ev[e], u);\n    return res;\n}\nint main() {\n    ios::sync_with_stdio(0), cin.tie(0);\n    cin >> n;\n    int u, v, w;\n    rep(i, 2, n) {\n        int a = i * 2, b = a + 1;\n        cin >> u >> v >> w, deg[ev[a] = v]++, deg[ev[b] = u]++, ew[a] = ew[b] = w;\n        G[u].push_back(a), G[v].push_back(b);\n    }\n    cin >> s >> m;\n    rep(i, 1, m) cin >> u, cnt[u]++;\n    int ans = Inf;\n    for(int e : G[s]) ans = min(ans, dp(m, e, dfs(ev[e], s)));\n    cout << ans;\n    return 0;\n}\n```","slug":"CF868E","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzy001eootnctq0fpr7","content":"<blockquote>\r\n<p><a href=\"http://codeforces.com/problemset/problem/868/E\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(m\\)</span> </p>\r\n<p><span class=\"math inline\">\\(1 \\le n, m, w_i \\le 50\\)</span><span class=\"math inline\">\\(w_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(s\\)</span> </p>\r\n</blockquote>\r\n<h3 id=\"\"></h3>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(1\\)</span> <strong></strong> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(2,3,4\\)</span> </p>\r\n<p></p>\r\n<p><img src=\"https://i.loli.net/2021/03/18/A4Zpd72bkRMeINU.png\" /></p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(5,6\\)</span>  <span class=\"math inline\">\\(2,3\\)</span>  <span class=\"math inline\">\\(1\\)</span></p>\r\n<p><img src=\"https://i.loli.net/2021/03/18/gtTQYLueC21mlZW.png\" /></p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u\\)</span> <br />\r\n <span class=\"math inline\">\\(O(n)\\)</span> </p>\r\n<p><br />\r\n <span class=\"math inline\">\\(O(n^3)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(f_{i,j,k}\\)</span>  <span class=\"math inline\">\\(i\\)</span> <strong></strong> <span class=\"math inline\">\\(j = u \\rightarrow v\\)</span> <strong></strong> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(i\\)</span> <strong></strong> <span class=\"math inline\">\\(j = u \\rightarrow v\\)</span>  <span class=\"math inline\">\\(w\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math display\">\\[\r\nf_{i,j,k}=f_{i-k,\\bar j,i-k} + w\r\n\\]</span>  <span class=\"math inline\">\\(\\bar j\\)</span>  <span class=\"math inline\">\\(j\\)</span> </p>\r\n<p></p>\r\n<p><img src=\"https://i.loli.net/2021/03/18/Vsnf9c6hIvYkCRd.png\" /></p>\r\n<p> <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(5\\)</span><span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\(6\\)</span><br />\r\n <span class=\"math inline\">\\(4 \\rightarrow 5\\)</span>  <span class=\"math inline\">\\(4 \\rightarrow 6\\)</span> </p>\r\n<p> <span class=\"math display\">\\[\r\nf_{i,1 \\rightarrow 4,k} = \\max_{a+b=k}\\min \\lbrace f_{i,4 \\rightarrow 5,a},f_{i,4 \\rightarrow 6,b}\\rbrace + w\r\n\\]</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(a_1,a_2,a_3,\\cdots,a_d\\)</span> <span class=\"math display\">\\[\r\nf_{i,j,k}=\\max_{c_1+c_2+\\cdots+c_d=k}\\min_{s=1}^df_{i,v \\rightarrow a_s,c_s} + w\r\n\\]</span> </p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(f_{i,j,k}\\)</span> <strong></strong> <span class=\"math inline\">\\(c_1,c_2,\\cdots,c_d\\)</span><br />\r\n <span class=\"math inline\">\\(f_{i,j,k+1}\\)</span>  <span class=\"math inline\">\\(\\bar c_1,\\bar c_2,\\cdots,\\bar c_d\\)</span>  <span class=\"math inline\">\\(c_1,c_2,\\cdots,c_d\\)</span>  <span class=\"math inline\">\\(+1\\)</span> <br />\r\n <span class=\"math inline\">\\(+1\\)</span>  <span class=\"math inline\">\\(c_x\\)</span>  <span class=\"math display\">\\[\r\nf_{i,v \\rightarrow a_x,c_x+1}=\\max_{s=1}^df_{i,v \\rightarrow a_s,c_s+1}\r\n\\]</span> <br />\r\n <span class=\"math inline\">\\(f_{i,j,0} \\ge f_{i,j,1} \\ge f_{i,j,2} \\ge \\cdots \\ge f_{i,j,i}\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\forall x \\le f_{i,j,k}\\exists c_1,c_2,\\cdots,c_d,\\\\f_{i,v \\rightarrow a_1,c_1} \\ge x\\\\f_{i,v \\rightarrow a_2,c_2} \\ge x\\\\\\cdots\\\\f_{i,v \\rightarrow a_d,c_d} \\ge x\r\n\\]</span>  <code>check</code>  <span class=\"math inline\">\\(m_i\\)</span>  <span class=\"math inline\">\\(f_{i,v \\rightarrow a_i}\\)</span>  <span class=\"math inline\">\\(x\\)</span> <br />\r\n <span class=\"math inline\">\\(m_1+m_2+\\cdots+m_d \\ge k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(c_1 \\le m_1,c_2 \\le m_2, \\cdots, c_d \\le m_d\\)</span> <span class=\"math inline\">\\(x\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(O(n\\log n)\\)</span>  <span class=\"math inline\">\\(f_{i,j,0},f_{i,j,1},\\cdots,f_{i,j,i}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n^3\\log n)\\)</span> <span class=\"math inline\">\\(O(n^5)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(15\\)</span> <code>ms</code> <span class=\"math inline\">\\(30\\)</span> <code>ms</code></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">55</span>, Inf = <span class=\"number\">1e9</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, s, m, ev[N * <span class=\"number\">2</span>], ew[N * <span class=\"number\">2</span>], cnt[N], deg[N];</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; G[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> f[N][N * <span class=\"number\">2</span>][N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">(<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>)</span></span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dp</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> j, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!f[i][j][k]) <span class=\"built_in\">solve</span>(i, j);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> f[i][j][k];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> i, e, c;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">val</span><span class=\"params\">()</span><span class=\"keyword\">const</span> </span>&#123; <span class=\"keyword\">return</span> c &lt; i ? <span class=\"built_in\">dp</span>(i, e, c + <span class=\"number\">1</span>) : <span class=\"number\">0</span>; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span> &lt;(<span class=\"keyword\">const</span> node&amp; b)<span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">val</span>() &lt; b.<span class=\"built_in\">val</span>(); &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> j)</span> </span>&#123;</span><br><span class=\"line\">    f[i][j][<span class=\"number\">0</span>] = Inf;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(deg[ev[j]] == <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(k, <span class=\"number\">1</span>, i) f[i][j][k] = k &lt; i ? <span class=\"built_in\">dp</span>(i - k, j ^ <span class=\"number\">1</span>, i - k) + ew[j] : ew[j];</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        priority_queue &lt;node&gt; q;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> e : G[ev[j]]) <span class=\"keyword\">if</span>(e ^ j ^ <span class=\"number\">1</span>) q.<span class=\"built_in\">push</span>(&#123; i, e, <span class=\"number\">0</span> &#125;);</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(k, <span class=\"number\">1</span>, i) &#123;</span><br><span class=\"line\">            node x = q.<span class=\"built_in\">top</span>(); q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            f[i][j][k] = <span class=\"built_in\">min</span>(f[i][j][k - <span class=\"number\">1</span>], x.<span class=\"built_in\">val</span>() + ew[j]);</span><br><span class=\"line\">            x.c++, q.<span class=\"built_in\">push</span>(x);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> fa)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res = cnt[u];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> e : G[u]) <span class=\"keyword\">if</span>(ev[e] ^ fa) res += <span class=\"built_in\">dfs</span>(ev[e], u);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>), cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v, w;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> a = i * <span class=\"number\">2</span>, b = a + <span class=\"number\">1</span>;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w, deg[ev[a] = v]++, deg[ev[b] = u]++, ew[a] = ew[b] = w;</span><br><span class=\"line\">        G[u].<span class=\"built_in\">push_back</span>(a), G[v].<span class=\"built_in\">push_back</span>(b);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cin &gt;&gt; s &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) cin &gt;&gt; u, cnt[u]++;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> ans = Inf;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> e : G[s]) ans = <span class=\"built_in\">min</span>(ans, <span class=\"built_in\">dp</span>(m, e, <span class=\"built_in\">dfs</span>(ev[e], s)));</span><br><span class=\"line\">    cout &lt;&lt; ans;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":3481,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"http://codeforces.com/problemset/problem/868/E\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(m\\)</span> </p>\r\n<p><span class=\"math inline\">\\(1 \\le n, m, w_i \\le 50\\)</span><span class=\"math inline\">\\(w_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(s\\)</span> </p>\r\n</blockquote>\r\n<h3 id=\"\"></h3>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(1\\)</span> <strong></strong> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(2,3,4\\)</span> </p>\r\n<p></p>\r\n<p><img src=\"https://i.loli.net/2021/03/18/A4Zpd72bkRMeINU.png\" /></p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(5,6\\)</span>  <span class=\"math inline\">\\(2,3\\)</span>  <span class=\"math inline\">\\(1\\)</span></p>\r\n<p><img src=\"https://i.loli.net/2021/03/18/gtTQYLueC21mlZW.png\" /></p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u\\)</span> <br />\r\n <span class=\"math inline\">\\(O(n)\\)</span> </p>\r\n<p><br />\r\n <span class=\"math inline\">\\(O(n^3)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(f_{i,j,k}\\)</span>  <span class=\"math inline\">\\(i\\)</span> <strong></strong> <span class=\"math inline\">\\(j = u \\rightarrow v\\)</span> <strong></strong> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(i\\)</span> <strong></strong> <span class=\"math inline\">\\(j = u \\rightarrow v\\)</span>  <span class=\"math inline\">\\(w\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math display\">\\[\r\nf_{i,j,k}=f_{i-k,\\bar j,i-k} + w\r\n\\]</span>  <span class=\"math inline\">\\(\\bar j\\)</span>  <span class=\"math inline\">\\(j\\)</span> </p>\r\n<p></p>\r\n<p><img src=\"https://i.loli.net/2021/03/18/Vsnf9c6hIvYkCRd.png\" /></p>\r\n<p> <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(5\\)</span><span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\(6\\)</span><br />\r\n <span class=\"math inline\">\\(4 \\rightarrow 5\\)</span>  <span class=\"math inline\">\\(4 \\rightarrow 6\\)</span> </p>\r\n<p> <span class=\"math display\">\\[\r\nf_{i,1 \\rightarrow 4,k} = \\max_{a+b=k}\\min \\lbrace f_{i,4 \\rightarrow 5,a},f_{i,4 \\rightarrow 6,b}\\rbrace + w\r\n\\]</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(a_1,a_2,a_3,\\cdots,a_d\\)</span> <span class=\"math display\">\\[\r\nf_{i,j,k}=\\max_{c_1+c_2+\\cdots+c_d=k}\\min_{s=1}^df_{i,v \\rightarrow a_s,c_s} + w\r\n\\]</span> </p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(f_{i,j,k}\\)</span> <strong></strong> <span class=\"math inline\">\\(c_1,c_2,\\cdots,c_d\\)</span><br />\r\n <span class=\"math inline\">\\(f_{i,j,k+1}\\)</span>  <span class=\"math inline\">\\(\\bar c_1,\\bar c_2,\\cdots,\\bar c_d\\)</span>  <span class=\"math inline\">\\(c_1,c_2,\\cdots,c_d\\)</span>  <span class=\"math inline\">\\(+1\\)</span> <br />\r\n <span class=\"math inline\">\\(+1\\)</span>  <span class=\"math inline\">\\(c_x\\)</span>  <span class=\"math display\">\\[\r\nf_{i,v \\rightarrow a_x,c_x+1}=\\max_{s=1}^df_{i,v \\rightarrow a_s,c_s+1}\r\n\\]</span> <br />\r\n <span class=\"math inline\">\\(f_{i,j,0} \\ge f_{i,j,1} \\ge f_{i,j,2} \\ge \\cdots \\ge f_{i,j,i}\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\forall x \\le f_{i,j,k}\\exists c_1,c_2,\\cdots,c_d,\\\\f_{i,v \\rightarrow a_1,c_1} \\ge x\\\\f_{i,v \\rightarrow a_2,c_2} \\ge x\\\\\\cdots\\\\f_{i,v \\rightarrow a_d,c_d} \\ge x\r\n\\]</span>  <code>check</code>  <span class=\"math inline\">\\(m_i\\)</span>  <span class=\"math inline\">\\(f_{i,v \\rightarrow a_i}\\)</span>  <span class=\"math inline\">\\(x\\)</span> <br />\r\n <span class=\"math inline\">\\(m_1+m_2+\\cdots+m_d \\ge k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(c_1 \\le m_1,c_2 \\le m_2, \\cdots, c_d \\le m_d\\)</span> <span class=\"math inline\">\\(x\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(O(n\\log n)\\)</span>  <span class=\"math inline\">\\(f_{i,j,0},f_{i,j,1},\\cdots,f_{i,j,i}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n^3\\log n)\\)</span> <span class=\"math inline\">\\(O(n^5)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(15\\)</span> <code>ms</code> <span class=\"math inline\">\\(30\\)</span> <code>ms</code></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">55</span>, Inf = <span class=\"number\">1e9</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, s, m, ev[N * <span class=\"number\">2</span>], ew[N * <span class=\"number\">2</span>], cnt[N], deg[N];</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; G[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> f[N][N * <span class=\"number\">2</span>][N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">(<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>)</span></span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dp</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> j, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!f[i][j][k]) <span class=\"built_in\">solve</span>(i, j);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> f[i][j][k];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> i, e, c;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">val</span><span class=\"params\">()</span><span class=\"keyword\">const</span> </span>&#123; <span class=\"keyword\">return</span> c &lt; i ? <span class=\"built_in\">dp</span>(i, e, c + <span class=\"number\">1</span>) : <span class=\"number\">0</span>; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span> &lt;(<span class=\"keyword\">const</span> node&amp; b)<span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">val</span>() &lt; b.<span class=\"built_in\">val</span>(); &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> j)</span> </span>&#123;</span><br><span class=\"line\">    f[i][j][<span class=\"number\">0</span>] = Inf;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(deg[ev[j]] == <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(k, <span class=\"number\">1</span>, i) f[i][j][k] = k &lt; i ? <span class=\"built_in\">dp</span>(i - k, j ^ <span class=\"number\">1</span>, i - k) + ew[j] : ew[j];</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        priority_queue &lt;node&gt; q;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> e : G[ev[j]]) <span class=\"keyword\">if</span>(e ^ j ^ <span class=\"number\">1</span>) q.<span class=\"built_in\">push</span>(&#123; i, e, <span class=\"number\">0</span> &#125;);</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(k, <span class=\"number\">1</span>, i) &#123;</span><br><span class=\"line\">            node x = q.<span class=\"built_in\">top</span>(); q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">            f[i][j][k] = <span class=\"built_in\">min</span>(f[i][j][k - <span class=\"number\">1</span>], x.<span class=\"built_in\">val</span>() + ew[j]);</span><br><span class=\"line\">            x.c++, q.<span class=\"built_in\">push</span>(x);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> fa)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res = cnt[u];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> e : G[u]) <span class=\"keyword\">if</span>(ev[e] ^ fa) res += <span class=\"built_in\">dfs</span>(ev[e], u);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>), cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v, w;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> a = i * <span class=\"number\">2</span>, b = a + <span class=\"number\">1</span>;</span><br><span class=\"line\">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w, deg[ev[a] = v]++, deg[ev[b] = u]++, ew[a] = ew[b] = w;</span><br><span class=\"line\">        G[u].<span class=\"built_in\">push_back</span>(a), G[v].<span class=\"built_in\">push_back</span>(b);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cin &gt;&gt; s &gt;&gt; m;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) cin &gt;&gt; u, cnt[u]++;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> ans = Inf;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> e : G[s]) ans = <span class=\"built_in\">min</span>(ans, <span class=\"built_in\">dp</span>(m, e, <span class=\"built_in\">dfs</span>(ev[e], s)));</span><br><span class=\"line\">    cout &lt;&lt; ans;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"New Year and Original Order | Codeforces 908G","date":"2021-03-26T12:19:09.000Z","updated":"2021-03-26T12:19:09.000Z","_content":"> [](https://codeforces.com/problemset/problem/908/G)\n>\n>  $S(x)$  $x$ $S(353594)=334559$\n>\n>  $n$ $\\sum\\limits_{i=1}^nS(i) \\bmod 10^9+7$\n>\n> $n \\le 10^{700}$\n\n $n$  $m$ $h_{x,i}$  $x$  $i$  \n\n<!-- more -->\n\n $S(x) = \\sum\\limits_{i=1}^9 \\underbrace{111\\cdots 1}=\\frac 19\\sum\\limits_{i=1}^910^{h_{x,i}}-1=\\frac 19\\sum\\limits_{i=1}^9\\sum\\limits_{j=0}^{m}(10^j-1)\\sum\\limits_{k=1}^n[h_{k,i}=j]$  \n_________________________$h_{x,i}$  $1$\n\n $i,j$  $\\sum\\limits_{k=1}^n[h_{k,i}=j]$ \n\n ```DP```  $O(100m^2)$\n\n\n\n ```n++``` $\\sum_{x < n}S(x)$\n\n $i$  $i$ $a_i$  $n$  $i$ \n\n $x$  $n$  ```LCP``` $i \\in [0,m)$ $x$  $i+1$  $j \\in [0,a_{i+1})$ $x$ \n\n $k$  $m-i-1$  $d$\n$$\n\\frac 19\\sum_{d=1}^9\\sum_{k=0}^{m-i-1}\\binom {m-i-1}k(10-d)^kd^{m-i-1-k}(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]+k}-1)\n$$\n\n$$\n\\begin{aligned}\n&\\frac 19\\sum_{i=0}^{m-1}\\sum_{j=0}^{a_{i+1}-1}\\sum_{d=1}^9\\sum_{k=0}^{m-i-1}\\binom {m-i-1}k(10-d)^kd^{m-i-1-k}(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]+k}-1)\\\\\n&=\\frac 19\\sum_{i=0}^{m-1}\\sum_{j=0}^{a_{i+1}-1}\\sum_{d=1}^9\\left(\\left(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]}\\sum_{k=0}^{m-i-1}\\binom {m-i-1}k(100-10d)^kd^{m-i-1-k}\\right)-10^{m-i-1}\\right)\\\\\n&=\\frac 19\\sum_{i=0}^{m-1}\\sum_{j=0}^{a_{i+1}-1}\\sum_{d=1}^9\\left(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]}(100-9d)^{m-i-1}-10^{m-i-1}\\right)\\\\\n&=\\frac 19\\sum_{i=0}^{m-1}\\sum_{d=1}^9\\left(10^{\\sum_{s=1}^i[a_s \\ge d]}(10\\max\\{a_{i+1}-d,0\\}+\\min\\{a_{i+1},d\\})(100-9d)^{m-i-1}-a_{i+1}10^{m-i-1}\\right)\\\\\n&=\\frac 19\\sum_{i=1}^m\\sum_{j=1}^9\\left(10^{\\sum_{s=1}^{i-1}[a_s \\ge j]}(100-9j)^{m-i}(10\\max\\{a_i-j,0\\}+\\min\\{a_i,j\\})-a_i10^{m-i}\\right)\n\\end{aligned}\n$$\n$\\sum_{s=1}^i[a_s \\ge d],(100-9d)^{m-i-1},10^{m-i-1}$  $i$ \n\n $O(10m)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\ntypedef long long ll;\nconst ll P = 1e9 + 7;\nint n, a[705]; char s[705];\nll Pow[705][11];\nint main() {\n    cin >> s, n = strlen(s);\n    rep(i, 1, n) a[i] = s[n - i] - 48;\n    int i = 1;\n    while(a[i] == 9) a[i++] = 0;\n    a[i]++;\n    if(i > n) n++;\n    reverse(a + 1, a + n + 1);\n    rep(i, 1, 10) Pow[0][i] = 1;\n    rep(i, 1, n) rep(j, 1, 10) Pow[i][j] = Pow[i - 1][j] * (100 - 9 * j) % P;\n    int idx[11] = {};\n    ll as = 0;\n    rep(i, 1, n) rep(j, 1, 9) {\n        (as += Pow[idx[j]][10] * Pow[n - i][j] % P * (10 * max(a[i] - j, 0) + min(a[i], j)) - a[i] * Pow[n - i][10]) %= P;\n        idx[j] += a[i] >= j;\n    }\n    cout << (as * 111111112 % P + P) % P;\n    return 0;\n}\n```","source":"_posts/CF908G.md","raw":"---\ntitle: New Year and Original Order | Codeforces 908G\ndate: 2021-03-26 20:19:09\nupdated: 2021-03-26 20:19:09\ntags: [,,]\ncategories: Codeforces\n---\n> [](https://codeforces.com/problemset/problem/908/G)\n>\n>  $S(x)$  $x$ $S(353594)=334559$\n>\n>  $n$ $\\sum\\limits_{i=1}^nS(i) \\bmod 10^9+7$\n>\n> $n \\le 10^{700}$\n\n $n$  $m$ $h_{x,i}$  $x$  $i$  \n\n<!-- more -->\n\n $S(x) = \\sum\\limits_{i=1}^9 \\underbrace{111\\cdots 1}=\\frac 19\\sum\\limits_{i=1}^910^{h_{x,i}}-1=\\frac 19\\sum\\limits_{i=1}^9\\sum\\limits_{j=0}^{m}(10^j-1)\\sum\\limits_{k=1}^n[h_{k,i}=j]$  \n_________________________$h_{x,i}$  $1$\n\n $i,j$  $\\sum\\limits_{k=1}^n[h_{k,i}=j]$ \n\n ```DP```  $O(100m^2)$\n\n\n\n ```n++``` $\\sum_{x < n}S(x)$\n\n $i$  $i$ $a_i$  $n$  $i$ \n\n $x$  $n$  ```LCP``` $i \\in [0,m)$ $x$  $i+1$  $j \\in [0,a_{i+1})$ $x$ \n\n $k$  $m-i-1$  $d$\n$$\n\\frac 19\\sum_{d=1}^9\\sum_{k=0}^{m-i-1}\\binom {m-i-1}k(10-d)^kd^{m-i-1-k}(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]+k}-1)\n$$\n\n$$\n\\begin{aligned}\n&\\frac 19\\sum_{i=0}^{m-1}\\sum_{j=0}^{a_{i+1}-1}\\sum_{d=1}^9\\sum_{k=0}^{m-i-1}\\binom {m-i-1}k(10-d)^kd^{m-i-1-k}(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]+k}-1)\\\\\n&=\\frac 19\\sum_{i=0}^{m-1}\\sum_{j=0}^{a_{i+1}-1}\\sum_{d=1}^9\\left(\\left(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]}\\sum_{k=0}^{m-i-1}\\binom {m-i-1}k(100-10d)^kd^{m-i-1-k}\\right)-10^{m-i-1}\\right)\\\\\n&=\\frac 19\\sum_{i=0}^{m-1}\\sum_{j=0}^{a_{i+1}-1}\\sum_{d=1}^9\\left(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]}(100-9d)^{m-i-1}-10^{m-i-1}\\right)\\\\\n&=\\frac 19\\sum_{i=0}^{m-1}\\sum_{d=1}^9\\left(10^{\\sum_{s=1}^i[a_s \\ge d]}(10\\max\\{a_{i+1}-d,0\\}+\\min\\{a_{i+1},d\\})(100-9d)^{m-i-1}-a_{i+1}10^{m-i-1}\\right)\\\\\n&=\\frac 19\\sum_{i=1}^m\\sum_{j=1}^9\\left(10^{\\sum_{s=1}^{i-1}[a_s \\ge j]}(100-9j)^{m-i}(10\\max\\{a_i-j,0\\}+\\min\\{a_i,j\\})-a_i10^{m-i}\\right)\n\\end{aligned}\n$$\n$\\sum_{s=1}^i[a_s \\ge d],(100-9d)^{m-i-1},10^{m-i-1}$  $i$ \n\n $O(10m)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\ntypedef long long ll;\nconst ll P = 1e9 + 7;\nint n, a[705]; char s[705];\nll Pow[705][11];\nint main() {\n    cin >> s, n = strlen(s);\n    rep(i, 1, n) a[i] = s[n - i] - 48;\n    int i = 1;\n    while(a[i] == 9) a[i++] = 0;\n    a[i]++;\n    if(i > n) n++;\n    reverse(a + 1, a + n + 1);\n    rep(i, 1, 10) Pow[0][i] = 1;\n    rep(i, 1, n) rep(j, 1, 10) Pow[i][j] = Pow[i - 1][j] * (100 - 9 * j) % P;\n    int idx[11] = {};\n    ll as = 0;\n    rep(i, 1, n) rep(j, 1, 9) {\n        (as += Pow[idx[j]][10] * Pow[n - i][j] % P * (10 * max(a[i] - j, 0) + min(a[i], j)) - a[i] * Pow[n - i][10]) %= P;\n        idx[j] += a[i] >= j;\n    }\n    cout << (as * 111111112 % P + P) % P;\n    return 0;\n}\n```","slug":"CF908G","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxgzz001hootnfqcqgs66","content":"<blockquote>\r\n<p><a href=\"https://codeforces.com/problemset/problem/908/G\"></a></p>\r\n<p> <span class=\"math inline\">\\(S(x)\\)</span>  <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(S(353594)=334559\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span> <span class=\"math inline\">\\(\\sum\\limits_{i=1}^nS(i) \\bmod 10^9+7\\)</span></p>\r\n<p><span class=\"math inline\">\\(n \\le 10^{700}\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span> <span class=\"math inline\">\\(h_{x,i}\\)</span>  <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(i\\)</span></p>\r\n<span id=\"more\"></span>\r\n<p> <span class=\"math inline\">\\(S(x) = \\sum\\limits_{i=1}^9 \\underbrace{111\\cdots 1}=\\frac 19\\sum\\limits_{i=1}^910^{h_{x,i}}-1=\\frac 19\\sum\\limits_{i=1}^9\\sum\\limits_{j=0}^{m}(10^j-1)\\sum\\limits_{k=1}^n[h_{k,i}=j]\\)</span><br />\r\n_________________________<span class=\"math inline\">\\(h_{x,i}\\)</span>  <span class=\"math inline\">\\(1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i,j\\)</span>  <span class=\"math inline\">\\(\\sum\\limits_{k=1}^n[h_{k,i}=j]\\)</span> </p>\r\n<p> <code>DP</code>  <span class=\"math inline\">\\(O(100m^2)\\)</span></p>\r\n<p></p>\r\n<p> <code>n++</code> <span class=\"math inline\">\\(\\sum_{x &lt; n}S(x)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(a_i\\)</span>  <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(n\\)</span>  <code>LCP</code> <span class=\"math inline\">\\(i \\in [0,m)\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(i+1\\)</span>  <span class=\"math inline\">\\(j \\in [0,a_{i+1})\\)</span> <span class=\"math inline\">\\(x\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(m-i-1\\)</span>  <span class=\"math inline\">\\(d\\)</span> <span class=\"math display\">\\[\r\n\\frac 19\\sum_{d=1}^9\\sum_{k=0}^{m-i-1}\\binom {m-i-1}k(10-d)^kd^{m-i-1-k}(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]+k}-1)\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;\\frac 19\\sum_{i=0}^{m-1}\\sum_{j=0}^{a_{i+1}-1}\\sum_{d=1}^9\\sum_{k=0}^{m-i-1}\\binom {m-i-1}k(10-d)^kd^{m-i-1-k}(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]+k}-1)\\\\\r\n&amp;=\\frac 19\\sum_{i=0}^{m-1}\\sum_{j=0}^{a_{i+1}-1}\\sum_{d=1}^9\\left(\\left(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]}\\sum_{k=0}^{m-i-1}\\binom {m-i-1}k(100-10d)^kd^{m-i-1-k}\\right)-10^{m-i-1}\\right)\\\\\r\n&amp;=\\frac 19\\sum_{i=0}^{m-1}\\sum_{j=0}^{a_{i+1}-1}\\sum_{d=1}^9\\left(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]}(100-9d)^{m-i-1}-10^{m-i-1}\\right)\\\\\r\n&amp;=\\frac 19\\sum_{i=0}^{m-1}\\sum_{d=1}^9\\left(10^{\\sum_{s=1}^i[a_s \\ge d]}(10\\max\\{a_{i+1}-d,0\\}+\\min\\{a_{i+1},d\\})(100-9d)^{m-i-1}-a_{i+1}10^{m-i-1}\\right)\\\\\r\n&amp;=\\frac 19\\sum_{i=1}^m\\sum_{j=1}^9\\left(10^{\\sum_{s=1}^{i-1}[a_s \\ge j]}(100-9j)^{m-i}(10\\max\\{a_i-j,0\\}+\\min\\{a_i,j\\})-a_i10^{m-i}\\right)\r\n\\end{aligned}\r\n\\]</span> <span class=\"math inline\">\\(\\sum_{s=1}^i[a_s \\ge d],(100-9d)^{m-i-1},10^{m-i-1}\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(10m)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> ll P = <span class=\"number\">1e9</span> + <span class=\"number\">7</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, a[<span class=\"number\">705</span>]; <span class=\"keyword\">char</span> s[<span class=\"number\">705</span>];</span><br><span class=\"line\">ll Pow[<span class=\"number\">705</span>][<span class=\"number\">11</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; s, n = <span class=\"built_in\">strlen</span>(s);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) a[i] = s[n - i] - <span class=\"number\">48</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(a[i] == <span class=\"number\">9</span>) a[i++] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    a[i]++;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i &gt; n) n++;</span><br><span class=\"line\">    <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + n + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">10</span>) Pow[<span class=\"number\">0</span>][i] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, <span class=\"number\">10</span>) Pow[i][j] = Pow[i - <span class=\"number\">1</span>][j] * (<span class=\"number\">100</span> - <span class=\"number\">9</span> * j) % P;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> idx[<span class=\"number\">11</span>] = &#123;&#125;;</span><br><span class=\"line\">    ll as = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, <span class=\"number\">9</span>) &#123;</span><br><span class=\"line\">        (as += Pow[idx[j]][<span class=\"number\">10</span>] * Pow[n - i][j] % P * (<span class=\"number\">10</span> * <span class=\"built_in\">max</span>(a[i] - j, <span class=\"number\">0</span>) + <span class=\"built_in\">min</span>(a[i], j)) - a[i] * Pow[n - i][<span class=\"number\">10</span>]) %= P;</span><br><span class=\"line\">        idx[j] += a[i] &gt;= j;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; (as * <span class=\"number\">111111112</span> % P + P) % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2478,"excerpt":"<blockquote>\r\n<p><a href=\"https://codeforces.com/problemset/problem/908/G\"></a></p>\r\n<p> <span class=\"math inline\">\\(S(x)\\)</span>  <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(S(353594)=334559\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span> <span class=\"math inline\">\\(\\sum\\limits_{i=1}^nS(i) \\bmod 10^9+7\\)</span></p>\r\n<p><span class=\"math inline\">\\(n \\le 10^{700}\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span> <span class=\"math inline\">\\(h_{x,i}\\)</span>  <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(i\\)</span></p>","more":"<p> <span class=\"math inline\">\\(S(x) = \\sum\\limits_{i=1}^9 \\underbrace{111\\cdots 1}=\\frac 19\\sum\\limits_{i=1}^910^{h_{x,i}}-1=\\frac 19\\sum\\limits_{i=1}^9\\sum\\limits_{j=0}^{m}(10^j-1)\\sum\\limits_{k=1}^n[h_{k,i}=j]\\)</span><br />\r\n_________________________<span class=\"math inline\">\\(h_{x,i}\\)</span>  <span class=\"math inline\">\\(1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i,j\\)</span>  <span class=\"math inline\">\\(\\sum\\limits_{k=1}^n[h_{k,i}=j]\\)</span> </p>\r\n<p> <code>DP</code>  <span class=\"math inline\">\\(O(100m^2)\\)</span></p>\r\n<p></p>\r\n<p> <code>n++</code> <span class=\"math inline\">\\(\\sum_{x &lt; n}S(x)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(a_i\\)</span>  <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(n\\)</span>  <code>LCP</code> <span class=\"math inline\">\\(i \\in [0,m)\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(i+1\\)</span>  <span class=\"math inline\">\\(j \\in [0,a_{i+1})\\)</span> <span class=\"math inline\">\\(x\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(m-i-1\\)</span>  <span class=\"math inline\">\\(d\\)</span> <span class=\"math display\">\\[\r\n\\frac 19\\sum_{d=1}^9\\sum_{k=0}^{m-i-1}\\binom {m-i-1}k(10-d)^kd^{m-i-1-k}(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]+k}-1)\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;\\frac 19\\sum_{i=0}^{m-1}\\sum_{j=0}^{a_{i+1}-1}\\sum_{d=1}^9\\sum_{k=0}^{m-i-1}\\binom {m-i-1}k(10-d)^kd^{m-i-1-k}(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]+k}-1)\\\\\r\n&amp;=\\frac 19\\sum_{i=0}^{m-1}\\sum_{j=0}^{a_{i+1}-1}\\sum_{d=1}^9\\left(\\left(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]}\\sum_{k=0}^{m-i-1}\\binom {m-i-1}k(100-10d)^kd^{m-i-1-k}\\right)-10^{m-i-1}\\right)\\\\\r\n&amp;=\\frac 19\\sum_{i=0}^{m-1}\\sum_{j=0}^{a_{i+1}-1}\\sum_{d=1}^9\\left(10^{\\sum_{s=1}^i[a_s \\ge d]+[j \\ge d]}(100-9d)^{m-i-1}-10^{m-i-1}\\right)\\\\\r\n&amp;=\\frac 19\\sum_{i=0}^{m-1}\\sum_{d=1}^9\\left(10^{\\sum_{s=1}^i[a_s \\ge d]}(10\\max\\{a_{i+1}-d,0\\}+\\min\\{a_{i+1},d\\})(100-9d)^{m-i-1}-a_{i+1}10^{m-i-1}\\right)\\\\\r\n&amp;=\\frac 19\\sum_{i=1}^m\\sum_{j=1}^9\\left(10^{\\sum_{s=1}^{i-1}[a_s \\ge j]}(100-9j)^{m-i}(10\\max\\{a_i-j,0\\}+\\min\\{a_i,j\\})-a_i10^{m-i}\\right)\r\n\\end{aligned}\r\n\\]</span> <span class=\"math inline\">\\(\\sum_{s=1}^i[a_s \\ge d],(100-9d)^{m-i-1},10^{m-i-1}\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(10m)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> ll P = <span class=\"number\">1e9</span> + <span class=\"number\">7</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, a[<span class=\"number\">705</span>]; <span class=\"keyword\">char</span> s[<span class=\"number\">705</span>];</span><br><span class=\"line\">ll Pow[<span class=\"number\">705</span>][<span class=\"number\">11</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; s, n = <span class=\"built_in\">strlen</span>(s);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) a[i] = s[n - i] - <span class=\"number\">48</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(a[i] == <span class=\"number\">9</span>) a[i++] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    a[i]++;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i &gt; n) n++;</span><br><span class=\"line\">    <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + n + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">10</span>) Pow[<span class=\"number\">0</span>][i] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, <span class=\"number\">10</span>) Pow[i][j] = Pow[i - <span class=\"number\">1</span>][j] * (<span class=\"number\">100</span> - <span class=\"number\">9</span> * j) % P;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> idx[<span class=\"number\">11</span>] = &#123;&#125;;</span><br><span class=\"line\">    ll as = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, <span class=\"number\">9</span>) &#123;</span><br><span class=\"line\">        (as += Pow[idx[j]][<span class=\"number\">10</span>] * Pow[n - i][j] % P * (<span class=\"number\">10</span> * <span class=\"built_in\">max</span>(a[i] - j, <span class=\"number\">0</span>) + <span class=\"built_in\">min</span>(a[i], j)) - a[i] * Pow[n - i][<span class=\"number\">10</span>]) %= P;</span><br><span class=\"line\">        idx[j] += a[i] &gt;= j;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; (as * <span class=\"number\">111111112</span> % P + P) % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"Dictionary | Gym 100958B","date":"2021-03-13T14:49:04.000Z","updated":"2021-03-13T14:49:04.000Z","_content":"> [](http://codeforces.com/gym/100958/problem/B)\n>\n>  $n$ ** ```?``` ** ```?```  $S_1,S_2,\\cdots,S_n$ \n>\n> $n \\le 50, |S_i| \\le 20$\n\n###### \n\n\n\n ```DP``` \n\n$f_{i,l,r}$  $i$  $l$  $r$  ```?```  $S_l,S_{l+1},\\cdots,S_r$ \n\n ```DP```\n\n $k$  $l$  $r$  $i$  $k$\n\n $j \\in [l,r]$ $S_{j}[i] > k$ $\\forall x \\in [l,j-1]$ $S_x[i] = k$$\\forall x \\in [j,r]$ $S_x[i] \\ge k + 1$\n$$\nf_{i,l,r,k}=\\sum\\limits_{j=l}^{r+1}f_{i+1,l,j-1,'a'}\\cdot f_{i,j,r,k+1}\n$$\n $k=-1$  $S_l[i]$  $f_{i,l+1,r,'a'}$ $f_{i,l,r,'a'}$ $k \\ne -1$ $S_l[i]$ \n\n $l > r$  $1$ $l \\le r \\land k > 'z'$  $0$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n\nusing namespace std;\nconst int P = 1e9 + 7;\ntypedef long long ll;\nint n;\nchar S[55][25];\nll f[25][55][55][26];\nll dp(int i, int l, int r, int k) {\n    if(l > r) return 1; if(k > 25) return 0;\n    if(k == -1) return S[l][i] ? dp(i, l, r, 0) : dp(i, l + 1, r, 0);\n    if(!S[l][i]) return 0;\n    ll& res = f[i][l][r][k];\n    if(~res) return res; res = 0;\n    rep(j, l, r + 1) {\n        res = (res + dp(i + 1, l, j - 1, -1) * dp(i, j, r, k + 1)) % P;\n        if(S[j][i] != '?' && S[j][i] != 'a' + k) break;\n    }\n    return res;\n}\nint main() {\n    cin >> n;\n    rep(i, 1, n) cin >> (S[i] + 1);\n    mem(f, -1);\n    cout << dp(1, 1, n, 0);\n    return 0;\n}\n```\n\n###### \n\n1. **a\"** $20$ $k='z'+1$  $i=21$  ```?```  $k$  $k$ \n\n2.  $f_{i,l,r}$  DP $T_{i,j}$ \"a\"-$i$ $l$  $i$ \n\n   \n\n3. ","source":"_posts/Gym100958B.md","raw":"---\ntitle: Dictionary | Gym 100958B\ndate: 2021-03-13 22:49:04\nupdated: 2021-03-13 22:49:04\ntags: [,]\ncategories: Codeforces\n---\n> [](http://codeforces.com/gym/100958/problem/B)\n>\n>  $n$ ** ```?``` ** ```?```  $S_1,S_2,\\cdots,S_n$ \n>\n> $n \\le 50, |S_i| \\le 20$\n\n###### \n\n\n\n ```DP``` \n\n$f_{i,l,r}$  $i$  $l$  $r$  ```?```  $S_l,S_{l+1},\\cdots,S_r$ \n\n ```DP```\n\n $k$  $l$  $r$  $i$  $k$\n\n $j \\in [l,r]$ $S_{j}[i] > k$ $\\forall x \\in [l,j-1]$ $S_x[i] = k$$\\forall x \\in [j,r]$ $S_x[i] \\ge k + 1$\n$$\nf_{i,l,r,k}=\\sum\\limits_{j=l}^{r+1}f_{i+1,l,j-1,'a'}\\cdot f_{i,j,r,k+1}\n$$\n $k=-1$  $S_l[i]$  $f_{i,l+1,r,'a'}$ $f_{i,l,r,'a'}$ $k \\ne -1$ $S_l[i]$ \n\n $l > r$  $1$ $l \\le r \\land k > 'z'$  $0$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n\nusing namespace std;\nconst int P = 1e9 + 7;\ntypedef long long ll;\nint n;\nchar S[55][25];\nll f[25][55][55][26];\nll dp(int i, int l, int r, int k) {\n    if(l > r) return 1; if(k > 25) return 0;\n    if(k == -1) return S[l][i] ? dp(i, l, r, 0) : dp(i, l + 1, r, 0);\n    if(!S[l][i]) return 0;\n    ll& res = f[i][l][r][k];\n    if(~res) return res; res = 0;\n    rep(j, l, r + 1) {\n        res = (res + dp(i + 1, l, j - 1, -1) * dp(i, j, r, k + 1)) % P;\n        if(S[j][i] != '?' && S[j][i] != 'a' + k) break;\n    }\n    return res;\n}\nint main() {\n    cin >> n;\n    rep(i, 1, n) cin >> (S[i] + 1);\n    mem(f, -1);\n    cout << dp(1, 1, n, 0);\n    return 0;\n}\n```\n\n###### \n\n1. **a\"** $20$ $k='z'+1$  $i=21$  ```?```  $k$  $k$ \n\n2.  $f_{i,l,r}$  DP $T_{i,j}$ \"a\"-$i$ $l$  $i$ \n\n   \n\n3. ","slug":"Gym100958B","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh00001lootn0ruo852i","content":"<blockquote>\r\n<p><a href=\"http://codeforces.com/gym/100958/problem/B\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span> <strong> <code>?</code> </strong> <code>?</code>  <span class=\"math inline\">\\(S_1,S_2,\\cdots,S_n\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 50, |S_i| \\le 20\\)</span></p>\r\n</blockquote>\r\n<h6 id=\"\"></h6>\r\n<p></p>\r\n<p> <code>DP</code> </p>\r\n<p><span class=\"math inline\">\\(f_{i,l,r}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(r\\)</span>  <code>?</code>  <span class=\"math inline\">\\(S_l,S_{l+1},\\cdots,S_r\\)</span> </p>\r\n<p> <code>DP</code></p>\r\n<p> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(r\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(j \\in [l,r]\\)</span> <span class=\"math inline\">\\(S_{j}[i] &gt; k\\)</span> <span class=\"math inline\">\\(\\forall x \\in [l,j-1]\\)</span> <span class=\"math inline\">\\(S_x[i] = k\\)</span><span class=\"math inline\">\\(\\forall x \\in [j,r]\\)</span> <span class=\"math inline\">\\(S_x[i] \\ge k + 1\\)</span> <span class=\"math display\">\\[\r\nf_{i,l,r,k}=\\sum\\limits_{j=l}^{r+1}f_{i+1,l,j-1,&#39;a&#39;}\\cdot f_{i,j,r,k+1}\r\n\\]</span>  <span class=\"math inline\">\\(k=-1\\)</span>  <span class=\"math inline\">\\(S_l[i]\\)</span>  <span class=\"math inline\">\\(f_{i,l+1,r,&#39;a&#39;}\\)</span> <span class=\"math inline\">\\(f_{i,l,r,&#39;a&#39;}\\)</span> <span class=\"math inline\">\\(k \\ne -1\\)</span> <span class=\"math inline\">\\(S_l[i]\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(l &gt; r\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(l \\le r \\land k &gt; &#39;z&#39;\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> P = <span class=\"number\">1e9</span> + <span class=\"number\">7</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n;</span><br><span class=\"line\"><span class=\"keyword\">char</span> S[<span class=\"number\">55</span>][<span class=\"number\">25</span>];</span><br><span class=\"line\">ll f[<span class=\"number\">25</span>][<span class=\"number\">55</span>][<span class=\"number\">55</span>][<span class=\"number\">26</span>];</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">dp</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l &gt; r) <span class=\"keyword\">return</span> <span class=\"number\">1</span>; <span class=\"keyword\">if</span>(k &gt; <span class=\"number\">25</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(k == <span class=\"number\">-1</span>) <span class=\"keyword\">return</span> S[l][i] ? <span class=\"built_in\">dp</span>(i, l, r, <span class=\"number\">0</span>) : <span class=\"built_in\">dp</span>(i, l + <span class=\"number\">1</span>, r, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!S[l][i]) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    ll&amp; res = f[i][l][r][k];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(~res) <span class=\"keyword\">return</span> res; res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(j, l, r + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        res = (res + <span class=\"built_in\">dp</span>(i + <span class=\"number\">1</span>, l, j - <span class=\"number\">1</span>, <span class=\"number\">-1</span>) * <span class=\"built_in\">dp</span>(i, j, r, k + <span class=\"number\">1</span>)) % P;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(S[j][i] != <span class=\"string\">&#x27;?&#x27;</span> &amp;&amp; S[j][i] != <span class=\"string\">&#x27;a&#x27;</span> + k) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) cin &gt;&gt; (S[i] + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(f, <span class=\"number\">-1</span>);</span><br><span class=\"line\">    cout &lt;&lt; <span class=\"built_in\">dp</span>(<span class=\"number\">1</span>, <span class=\"number\">1</span>, n, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h6 id=\"\"></h6>\r\n<ol type=\"1\">\r\n<li><p><strong>a\"</strong> <span class=\"math inline\">\\(20\\)</span> <span class=\"math inline\">\\(k=&#39;z&#39;+1\\)</span>  <span class=\"math inline\">\\(i=21\\)</span>  <code>?</code>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p></li>\r\n<li><p> <span class=\"math inline\">\\(f_{i,l,r}\\)</span>  DP <span class=\"math inline\">\\(T_{i,j}\\)</span> \"a\"-<span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p></p></li>\r\n<li><p></p></li>\r\n</ol>\r\n","site":{"data":{}},"length":1965,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"http://codeforces.com/gym/100958/problem/B\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span> <strong> <code>?</code> </strong> <code>?</code>  <span class=\"math inline\">\\(S_1,S_2,\\cdots,S_n\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 50, |S_i| \\le 20\\)</span></p>\r\n</blockquote>\r\n<h6 id=\"\"></h6>\r\n<p></p>\r\n<p> <code>DP</code> </p>\r\n<p><span class=\"math inline\">\\(f_{i,l,r}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(r\\)</span>  <code>?</code>  <span class=\"math inline\">\\(S_l,S_{l+1},\\cdots,S_r\\)</span> </p>\r\n<p> <code>DP</code></p>\r\n<p> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(r\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(j \\in [l,r]\\)</span> <span class=\"math inline\">\\(S_{j}[i] &gt; k\\)</span> <span class=\"math inline\">\\(\\forall x \\in [l,j-1]\\)</span> <span class=\"math inline\">\\(S_x[i] = k\\)</span><span class=\"math inline\">\\(\\forall x \\in [j,r]\\)</span> <span class=\"math inline\">\\(S_x[i] \\ge k + 1\\)</span> <span class=\"math display\">\\[\r\nf_{i,l,r,k}=\\sum\\limits_{j=l}^{r+1}f_{i+1,l,j-1,&#39;a&#39;}\\cdot f_{i,j,r,k+1}\r\n\\]</span>  <span class=\"math inline\">\\(k=-1\\)</span>  <span class=\"math inline\">\\(S_l[i]\\)</span>  <span class=\"math inline\">\\(f_{i,l+1,r,&#39;a&#39;}\\)</span> <span class=\"math inline\">\\(f_{i,l,r,&#39;a&#39;}\\)</span> <span class=\"math inline\">\\(k \\ne -1\\)</span> <span class=\"math inline\">\\(S_l[i]\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(l &gt; r\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(l \\le r \\land k &gt; &#39;z&#39;\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> P = <span class=\"number\">1e9</span> + <span class=\"number\">7</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n;</span><br><span class=\"line\"><span class=\"keyword\">char</span> S[<span class=\"number\">55</span>][<span class=\"number\">25</span>];</span><br><span class=\"line\">ll f[<span class=\"number\">25</span>][<span class=\"number\">55</span>][<span class=\"number\">55</span>][<span class=\"number\">26</span>];</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">dp</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l &gt; r) <span class=\"keyword\">return</span> <span class=\"number\">1</span>; <span class=\"keyword\">if</span>(k &gt; <span class=\"number\">25</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(k == <span class=\"number\">-1</span>) <span class=\"keyword\">return</span> S[l][i] ? <span class=\"built_in\">dp</span>(i, l, r, <span class=\"number\">0</span>) : <span class=\"built_in\">dp</span>(i, l + <span class=\"number\">1</span>, r, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!S[l][i]) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    ll&amp; res = f[i][l][r][k];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(~res) <span class=\"keyword\">return</span> res; res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(j, l, r + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        res = (res + <span class=\"built_in\">dp</span>(i + <span class=\"number\">1</span>, l, j - <span class=\"number\">1</span>, <span class=\"number\">-1</span>) * <span class=\"built_in\">dp</span>(i, j, r, k + <span class=\"number\">1</span>)) % P;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(S[j][i] != <span class=\"string\">&#x27;?&#x27;</span> &amp;&amp; S[j][i] != <span class=\"string\">&#x27;a&#x27;</span> + k) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) cin &gt;&gt; (S[i] + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(f, <span class=\"number\">-1</span>);</span><br><span class=\"line\">    cout &lt;&lt; <span class=\"built_in\">dp</span>(<span class=\"number\">1</span>, <span class=\"number\">1</span>, n, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h6 id=\"\"></h6>\r\n<ol type=\"1\">\r\n<li><p><strong>a\"</strong> <span class=\"math inline\">\\(20\\)</span> <span class=\"math inline\">\\(k=&#39;z&#39;+1\\)</span>  <span class=\"math inline\">\\(i=21\\)</span>  <code>?</code>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p></li>\r\n<li><p> <span class=\"math inline\">\\(f_{i,l,r}\\)</span>  DP <span class=\"math inline\">\\(T_{i,j}\\)</span> \"a\"-<span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p></p></li>\r\n<li><p></p></li>\r\n</ol>\r\n"},{"title":"Hello World!","date":"2021-03-13T13:06:21.000Z","updated":"2021-03-13T13:06:21.000Z","top":255,"_content":"![](https://ipcounter.ihcr.top/?mode=2&mail=(2465478971qq@gmail.com)&qq=(2465478971)&gh=(song-jx)&lg=(plate_let))\n  \n\n\n\n- [uDebug](https://www.udebug.com/)\n- [Codeforces Official](https://t.me/codeforces_official)\n- [Codeforces m2](http://m2.codeforces.com)\n- [LaTeX ](https://blog.csdn.net/garfielder007/article/details/51646604)\n- [graph editor](https://csacademy.com/app/graph_editor/)\n\n\n\n- QQ: 2465478971\n- E-Mail: 2465478971qq@gmail.com\n- Codeforces IDsongjiaxing platelets\n- Atcoder IDsongjiaxing platelets\n-  IDplate_let\n\n```cpp\n  _|_|                              _|  _|    _|  \n_|    _|  _|  _|_|  _|_|_|_|        _|  _|  _|    \n_|    _|  _|_|          _|          _|  _|_|      \n_|    _|  _|          _|      _|    _|  _|  _|    \n  _|_|    _|        _|_|_|_|    _|_|    _|    _|\n```","source":"_posts/Hello-world.md","raw":"---\ntitle: 'Hello World!'\ndate: 2021-03-13 21:06:21\nupdated: 2021-03-13 21:06:21\ntop: 255\n---\n![](https://ipcounter.ihcr.top/?mode=2&mail=(2465478971qq@gmail.com)&qq=(2465478971)&gh=(song-jx)&lg=(plate_let))\n  \n\n\n\n- [uDebug](https://www.udebug.com/)\n- [Codeforces Official](https://t.me/codeforces_official)\n- [Codeforces m2](http://m2.codeforces.com)\n- [LaTeX ](https://blog.csdn.net/garfielder007/article/details/51646604)\n- [graph editor](https://csacademy.com/app/graph_editor/)\n\n\n\n- QQ: 2465478971\n- E-Mail: 2465478971qq@gmail.com\n- Codeforces IDsongjiaxing platelets\n- Atcoder IDsongjiaxing platelets\n-  IDplate_let\n\n```cpp\n  _|_|                              _|  _|    _|  \n_|    _|  _|  _|_|  _|_|_|_|        _|  _|  _|    \n_|    _|  _|_|          _|          _|  _|_|      \n_|    _|  _|          _|      _|    _|  _|  _|    \n  _|_|    _|        _|_|_|_|    _|_|    _|    _|\n```","slug":"Hello-world","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh01001oootncdlg737z","content":"<p><img src=\"https://ipcounter.ihcr.top/?mode=2&amp;mail=(2465478971qq@gmail.com)&amp;qq=(2465478971)&amp;gh=(song-jx)&amp;lg=(plate_let)\" />   </p>\r\n<p></p>\r\n<ul>\r\n<li><a href=\"https://www.udebug.com/\">uDebug</a></li>\r\n<li><a href=\"https://t.me/codeforces_official\">Codeforces Official</a></li>\r\n<li><a href=\"http://m2.codeforces.com\">Codeforces m2</a></li>\r\n<li><a href=\"https://blog.csdn.net/garfielder007/article/details/51646604\">LaTeX </a></li>\r\n<li><a href=\"https://csacademy.com/app/graph_editor/\">graph editor</a></li>\r\n</ul>\r\n<p></p>\r\n<ul>\r\n<li>QQ: 2465478971</li>\r\n<li>E-Mail: 2465478971qq@gmail.com</li>\r\n<li>Codeforces IDsongjiaxing platelets</li>\r\n<li>Atcoder IDsongjiaxing platelets</li>\r\n<li> IDplate_let</li>\r\n</ul>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  _|_|                              _|  _|    _|  </span><br><span class=\"line\">_|    _|  _|  _|_|  _|_|_|_|        _|  _|  _|    </span><br><span class=\"line\">_|    _|  _|_|          _|          _|  _|_|      </span><br><span class=\"line\">_|    _|  _|          _|      _|    _|  _|  _|    </span><br><span class=\"line\">  _|_|    _|        _|_|_|_|    _|_|    _|    _|</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":303,"excerpt":"","more":"<p><img src=\"https://ipcounter.ihcr.top/?mode=2&amp;mail=(2465478971qq@gmail.com)&amp;qq=(2465478971)&amp;gh=(song-jx)&amp;lg=(plate_let)\" />   </p>\r\n<p></p>\r\n<ul>\r\n<li><a href=\"https://www.udebug.com/\">uDebug</a></li>\r\n<li><a href=\"https://t.me/codeforces_official\">Codeforces Official</a></li>\r\n<li><a href=\"http://m2.codeforces.com\">Codeforces m2</a></li>\r\n<li><a href=\"https://blog.csdn.net/garfielder007/article/details/51646604\">LaTeX </a></li>\r\n<li><a href=\"https://csacademy.com/app/graph_editor/\">graph editor</a></li>\r\n</ul>\r\n<p></p>\r\n<ul>\r\n<li>QQ: 2465478971</li>\r\n<li>E-Mail: 2465478971qq@gmail.com</li>\r\n<li>Codeforces IDsongjiaxing platelets</li>\r\n<li>Atcoder IDsongjiaxing platelets</li>\r\n<li> IDplate_let</li>\r\n</ul>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  _|_|                              _|  _|    _|  </span><br><span class=\"line\">_|    _|  _|  _|_|  _|_|_|_|        _|  _|  _|    </span><br><span class=\"line\">_|    _|  _|_|          _|          _|  _|_|      </span><br><span class=\"line\">_|    _|  _|          _|      _|    _|  _|  _|    </span><br><span class=\"line\">  _|_|    _|        _|_|_|_|    _|_|    _|    _|</span><br></pre></td></tr></table></figure>\r\n"},{"title":"salesman | IOI2009","date":"2021-05-02T13:25:00.000Z","updated":"2021-05-02T13:25:00.000Z","_content":">  $N$  $T_i$  $L_i$  $M_i$\n>\n>  $1$  $D$ $1$  $U$\n>\n>  $S$  $S$ \n>\n> $N,T_i \\le 5 \\cdot 10^5,L_i \\le 5 \\cdot 10^5+1$\n\n$T_i$ \n\n $f_i$ $i$ \n\n $f_i = \\max\\limits_{T_j < T_i}f_j-cost(j,i)$\n\n\n$$\ncost(i,j)=\\begin{cases}\nD(L_j-L_i) &(L_i<L_j)\\\\\nU(L_i-L_j) &(L_i>L_j)\n\\end{cases}\n$$\n $O(\\log n)$ \n\n\n\n $f_{i,0/1}$ / $i$ \n\n ```DP``` ```DP``` \n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define upd(a, b) (a = max(a, b))\n#define pb push_back\n\nusing namespace std;\nconst int N = 5e5 + 5;\nint read() {\n    int c = getchar(), r = 0;\n    while(c < 48) c = getchar();\n    while(c > 47) r = r * 10 + c - 48, c = getchar();\n    return r;\n}\nint n, U, D, s, L[N], M[N], f[N][2];\nvector <int> id[N];\nstruct BIT {\n    int c[N];\n    BIT() { rep(i, 1, N - 4) c[i] = INT_MIN; }\n    void ins(int i, int v) { for(; i <= N - 4; i += i & -i) upd(c[i], v); }\n    int qry(int i, int r = INT_MIN) { for(; i; i &= i - 1) upd(r, c[i]); return r; }\n} Td, Tu;\nvoid ins(int i, int v) {\n    Td.ins(i, v - (N - i) * D), Tu.ins(N - 3 - i, v - i * U);\n}\nint qry(int i) {\n    return max(Td.qry(i) + (N - i) * D, Tu.qry(N - 3 - i) + i * U);\n}\nint main() {\n    cin >> n >> U >> D >> s;\n    rep(i, 1, n) id[read()].pb(i), L[i] = read(), M[i] = read();\n    ins(s, 0);\n    rep(i, 1, N - 5) {\n        sort(id[i].begin(), id[i].end(), [](int a, int b) { return L[a] < L[b]; });\n        int pre = INT_MIN, suf = INT_MIN;\n        for(int j : id[i])\n            upd(pre, (f[j][0] = max(qry(L[j]), pre + (N - L[j]) * D) + M[j]) - (N - L[j]) * D);\n        for(auto j = id[i].rbegin(); j != id[i].rend(); j++)\n            upd(suf, (f[*j][1] = max(qry(L[*j]), suf + L[*j] * U) + M[*j]) - L[*j] * U);\n        for(int j : id[i]) ins(L[j], max(f[j][0], f[j][1]));\n    }\n    cout << qry(s);\n    return 0;\n}\n```","source":"_posts/IOI2009.md","raw":"---\ntitle: salesman | IOI2009\ndate: 2021-05-02 21:25:00\nupdated: 2021-05-02 21:25:00\ntags: [,]\ncategories: Codeforces\n---\n>  $N$  $T_i$  $L_i$  $M_i$\n>\n>  $1$  $D$ $1$  $U$\n>\n>  $S$  $S$ \n>\n> $N,T_i \\le 5 \\cdot 10^5,L_i \\le 5 \\cdot 10^5+1$\n\n$T_i$ \n\n $f_i$ $i$ \n\n $f_i = \\max\\limits_{T_j < T_i}f_j-cost(j,i)$\n\n\n$$\ncost(i,j)=\\begin{cases}\nD(L_j-L_i) &(L_i<L_j)\\\\\nU(L_i-L_j) &(L_i>L_j)\n\\end{cases}\n$$\n $O(\\log n)$ \n\n\n\n $f_{i,0/1}$ / $i$ \n\n ```DP``` ```DP``` \n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define upd(a, b) (a = max(a, b))\n#define pb push_back\n\nusing namespace std;\nconst int N = 5e5 + 5;\nint read() {\n    int c = getchar(), r = 0;\n    while(c < 48) c = getchar();\n    while(c > 47) r = r * 10 + c - 48, c = getchar();\n    return r;\n}\nint n, U, D, s, L[N], M[N], f[N][2];\nvector <int> id[N];\nstruct BIT {\n    int c[N];\n    BIT() { rep(i, 1, N - 4) c[i] = INT_MIN; }\n    void ins(int i, int v) { for(; i <= N - 4; i += i & -i) upd(c[i], v); }\n    int qry(int i, int r = INT_MIN) { for(; i; i &= i - 1) upd(r, c[i]); return r; }\n} Td, Tu;\nvoid ins(int i, int v) {\n    Td.ins(i, v - (N - i) * D), Tu.ins(N - 3 - i, v - i * U);\n}\nint qry(int i) {\n    return max(Td.qry(i) + (N - i) * D, Tu.qry(N - 3 - i) + i * U);\n}\nint main() {\n    cin >> n >> U >> D >> s;\n    rep(i, 1, n) id[read()].pb(i), L[i] = read(), M[i] = read();\n    ins(s, 0);\n    rep(i, 1, N - 5) {\n        sort(id[i].begin(), id[i].end(), [](int a, int b) { return L[a] < L[b]; });\n        int pre = INT_MIN, suf = INT_MIN;\n        for(int j : id[i])\n            upd(pre, (f[j][0] = max(qry(L[j]), pre + (N - L[j]) * D) + M[j]) - (N - L[j]) * D);\n        for(auto j = id[i].rbegin(); j != id[i].rend(); j++)\n            upd(suf, (f[*j][1] = max(qry(L[*j]), suf + L[*j] * U) + M[*j]) - L[*j] * U);\n        for(int j : id[i]) ins(L[j], max(f[j][0], f[j][1]));\n    }\n    cout << qry(s);\n    return 0;\n}\n```","slug":"IOI2009","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh02001sootn8y17gs97","content":"<blockquote>\r\n<p> <span class=\"math inline\">\\(N\\)</span>  <span class=\"math inline\">\\(T_i\\)</span>  <span class=\"math inline\">\\(L_i\\)</span>  <span class=\"math inline\">\\(M_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(D\\)</span> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(U\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S\\)</span> </p>\r\n<p><span class=\"math inline\">\\(N,T_i \\le 5 \\cdot 10^5,L_i \\le 5 \\cdot 10^5+1\\)</span></p>\r\n</blockquote>\r\n<p><span class=\"math inline\">\\(T_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(f_i\\)</span> <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(f_i = \\max\\limits_{T_j &lt; T_i}f_j-cost(j,i)\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\ncost(i,j)=\\begin{cases}\r\nD(L_j-L_i) &amp;(L_i&lt;L_j)\\\\\r\nU(L_i-L_j) &amp;(L_i&gt;L_j)\r\n\\end{cases}\r\n\\]</span>  <span class=\"math inline\">\\(O(\\log n)\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(f_{i,0/1}\\)</span> / <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p> <code>DP</code> <code>DP</code> </p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> upd(a, b) (a = max(a, b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">5e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> c = <span class=\"built_in\">getchar</span>(), r = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &lt; <span class=\"number\">48</span>) c = <span class=\"built_in\">getchar</span>();</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &gt; <span class=\"number\">47</span>) r = r * <span class=\"number\">10</span> + c - <span class=\"number\">48</span>, c = <span class=\"built_in\">getchar</span>();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, U, D, s, L[N], M[N], f[N][<span class=\"number\">2</span>];</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; id[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">BIT</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> c[N];</span><br><span class=\"line\">    <span class=\"built_in\">BIT</span>() &#123; <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, N - <span class=\"number\">4</span>) c[i] = INT_MIN; &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> v)</span> </span>&#123; <span class=\"keyword\">for</span>(; i &lt;= N - <span class=\"number\">4</span>; i += i &amp; -i) <span class=\"built_in\">upd</span>(c[i], v); &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> r = INT_MIN)</span> </span>&#123; <span class=\"keyword\">for</span>(; i; i &amp;= i - <span class=\"number\">1</span>) <span class=\"built_in\">upd</span>(r, c[i]); <span class=\"keyword\">return</span> r; &#125;</span><br><span class=\"line\">&#125; Td, Tu;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    Td.<span class=\"built_in\">ins</span>(i, v - (N - i) * D), Tu.<span class=\"built_in\">ins</span>(N - <span class=\"number\">3</span> - i, v - i * U);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">max</span>(Td.<span class=\"built_in\">qry</span>(i) + (N - i) * D, Tu.<span class=\"built_in\">qry</span>(N - <span class=\"number\">3</span> - i) + i * U);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; U &gt;&gt; D &gt;&gt; s;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) id[<span class=\"built_in\">read</span>()].<span class=\"built_in\">pb</span>(i), L[i] = <span class=\"built_in\">read</span>(), M[i] = <span class=\"built_in\">read</span>();</span><br><span class=\"line\">    <span class=\"built_in\">ins</span>(s, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, N - <span class=\"number\">5</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">sort</span>(id[i].<span class=\"built_in\">begin</span>(), id[i].<span class=\"built_in\">end</span>(), [](<span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> b) &#123; <span class=\"keyword\">return</span> L[a] &lt; L[b]; &#125;);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> pre = INT_MIN, suf = INT_MIN;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j : id[i])</span><br><span class=\"line\">            <span class=\"built_in\">upd</span>(pre, (f[j][<span class=\"number\">0</span>] = <span class=\"built_in\">max</span>(<span class=\"built_in\">qry</span>(L[j]), pre + (N - L[j]) * D) + M[j]) - (N - L[j]) * D);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> j = id[i].<span class=\"built_in\">rbegin</span>(); j != id[i].<span class=\"built_in\">rend</span>(); j++)</span><br><span class=\"line\">            <span class=\"built_in\">upd</span>(suf, (f[*j][<span class=\"number\">1</span>] = <span class=\"built_in\">max</span>(<span class=\"built_in\">qry</span>(L[*j]), suf + L[*j] * U) + M[*j]) - L[*j] * U);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j : id[i]) <span class=\"built_in\">ins</span>(L[j], <span class=\"built_in\">max</span>(f[j][<span class=\"number\">0</span>], f[j][<span class=\"number\">1</span>]));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; <span class=\"built_in\">qry</span>(s);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":1900,"excerpt":"","more":"<blockquote>\r\n<p> <span class=\"math inline\">\\(N\\)</span>  <span class=\"math inline\">\\(T_i\\)</span>  <span class=\"math inline\">\\(L_i\\)</span>  <span class=\"math inline\">\\(M_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(D\\)</span> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(U\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S\\)</span> </p>\r\n<p><span class=\"math inline\">\\(N,T_i \\le 5 \\cdot 10^5,L_i \\le 5 \\cdot 10^5+1\\)</span></p>\r\n</blockquote>\r\n<p><span class=\"math inline\">\\(T_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(f_i\\)</span> <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(f_i = \\max\\limits_{T_j &lt; T_i}f_j-cost(j,i)\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\ncost(i,j)=\\begin{cases}\r\nD(L_j-L_i) &amp;(L_i&lt;L_j)\\\\\r\nU(L_i-L_j) &amp;(L_i&gt;L_j)\r\n\\end{cases}\r\n\\]</span>  <span class=\"math inline\">\\(O(\\log n)\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(f_{i,0/1}\\)</span> / <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p> <code>DP</code> <code>DP</code> </p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> upd(a, b) (a = max(a, b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">5e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> c = <span class=\"built_in\">getchar</span>(), r = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &lt; <span class=\"number\">48</span>) c = <span class=\"built_in\">getchar</span>();</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &gt; <span class=\"number\">47</span>) r = r * <span class=\"number\">10</span> + c - <span class=\"number\">48</span>, c = <span class=\"built_in\">getchar</span>();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, U, D, s, L[N], M[N], f[N][<span class=\"number\">2</span>];</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; id[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">BIT</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> c[N];</span><br><span class=\"line\">    <span class=\"built_in\">BIT</span>() &#123; <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, N - <span class=\"number\">4</span>) c[i] = INT_MIN; &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> v)</span> </span>&#123; <span class=\"keyword\">for</span>(; i &lt;= N - <span class=\"number\">4</span>; i += i &amp; -i) <span class=\"built_in\">upd</span>(c[i], v); &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> r = INT_MIN)</span> </span>&#123; <span class=\"keyword\">for</span>(; i; i &amp;= i - <span class=\"number\">1</span>) <span class=\"built_in\">upd</span>(r, c[i]); <span class=\"keyword\">return</span> r; &#125;</span><br><span class=\"line\">&#125; Td, Tu;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    Td.<span class=\"built_in\">ins</span>(i, v - (N - i) * D), Tu.<span class=\"built_in\">ins</span>(N - <span class=\"number\">3</span> - i, v - i * U);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">max</span>(Td.<span class=\"built_in\">qry</span>(i) + (N - i) * D, Tu.<span class=\"built_in\">qry</span>(N - <span class=\"number\">3</span> - i) + i * U);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; U &gt;&gt; D &gt;&gt; s;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) id[<span class=\"built_in\">read</span>()].<span class=\"built_in\">pb</span>(i), L[i] = <span class=\"built_in\">read</span>(), M[i] = <span class=\"built_in\">read</span>();</span><br><span class=\"line\">    <span class=\"built_in\">ins</span>(s, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, N - <span class=\"number\">5</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">sort</span>(id[i].<span class=\"built_in\">begin</span>(), id[i].<span class=\"built_in\">end</span>(), [](<span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> b) &#123; <span class=\"keyword\">return</span> L[a] &lt; L[b]; &#125;);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> pre = INT_MIN, suf = INT_MIN;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j : id[i])</span><br><span class=\"line\">            <span class=\"built_in\">upd</span>(pre, (f[j][<span class=\"number\">0</span>] = <span class=\"built_in\">max</span>(<span class=\"built_in\">qry</span>(L[j]), pre + (N - L[j]) * D) + M[j]) - (N - L[j]) * D);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> j = id[i].<span class=\"built_in\">rbegin</span>(); j != id[i].<span class=\"built_in\">rend</span>(); j++)</span><br><span class=\"line\">            <span class=\"built_in\">upd</span>(suf, (f[*j][<span class=\"number\">1</span>] = <span class=\"built_in\">max</span>(<span class=\"built_in\">qry</span>(L[*j]), suf + L[*j] * U) + M[*j]) - L[*j] * U);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j : id[i]) <span class=\"built_in\">ins</span>(L[j], <span class=\"built_in\">max</span>(f[j][<span class=\"number\">0</span>], f[j][<span class=\"number\">1</span>]));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; <span class=\"built_in\">qry</span>(s);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Food Court | JOISC2021 D1T3","date":"2021-03-22T12:16:07.000Z","updated":"2021-03-22T12:16:07.000Z","_content":">  $N$  $M$ \n>\n>  $Q$ \n>\n> -  $L$  $R$  $K$  $C$ \n> -  $L$  $R$  $K$ $K$ \n> -  $A$  $B$  $0$\n>\n> $N, M, Q \\le 2.5 \\cdot 10^5$\n\n###  $A$ \n\n $0$  ```max```\n\n $0$  ```max```\n\n $a_1,a_2,\\cdots,a_k$\n$$\n\\max\\{0,\\max\\{0,\\max\\{0,\\cdots\\max\\{0,a_1\\}\\cdots+a_{k-1}\\}+a_k\\}\\\\\n=\\max\\{0,a_k,a_{k-1}+a_k,a_{k-2}+a_{k-1}+a_k,\\cdots,a_1+a_2+\\cdots+a_k\\}\\\\\n=\\sum_{i=1}^ka_i-\\min\\{0,a_1,a_1+a_2,\\cdots,a_1+a_2+\\cdots+a_k\\}\n$$\n $0$  ```max``` ****\n\n $tag_i$ **** $minTag_i$\n\n $b$  ```tag[i] += b, minTag[i] = min(minTag[i], tag[i])```\n\n ```tag[son] += tag[fa], minTag[son] = min(minTag[son], tag[son] + minTag[fa])```\n\n### \n\n $A$  $K$  $S$  $B$  $B+S-K$ \n\n$S$  $K$  $K$ \n\n $1$  $n$ \n\n $L$  $t$  $B$**** $R$  $R+1$ $t$  $B$\n\n $T$  $[1,T]$  $K$  $T$  $C$\n\n $O(n\\log n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define mid ((l + r) / 2)\n#define lch l, mid, o * 2\n#define rch mid + 1, r, o * 2 + 1\n\nusing namespace std;\nconst int N = 2.5e5 + 5;\ntypedef long long ll;\nint n, m, q;\nll c[N];\nvoid add(int i, int v) { for(; i <= n; i += i & -i) c[i] += v; }\nll qry(int i, ll r = 0) { for(; i; i &= i - 1) r += c[i]; return r; }\nnamespace seg1 {\n    ll ta[N * 4], mi[N * 4];\n    void put(int o, ll k, ll kk) {\n        mi[o] = min(mi[o], ta[o] + kk), ta[o] += k;\n    }\n    void pd(int o) {\n        put(o * 2, ta[o], mi[o]);\n        put(o * 2 + 1, ta[o], mi[o]);\n        ta[o] = mi[o] = 0;\n    }\n    void upd(int L, int R, int k, int l, int r, int o) {\n        if(L <= l && r <= R) return put(o, k, k);\n        pd(o);\n        if(L <= mid) upd(L, R, k, lch);\n        if(R > mid) upd(L, R, k, rch);\n    }\n    ll qry(int p, int l, int r, int o) {\n        if(l == r) return ta[o] - mi[o];\n        pd(o);\n        return p <= mid ? qry(p, lch) : qry(p, rch);\n    }\n};\nnamespace seg2 {\n    ll c[N * 4];\n    void upd(int p, int v, int l, int r, int o) {\n        c[o] += v; if(p > mid) upd(p, v, rch); else if(l < r) upd(p, v, lch);\n    }\n    ll qry(ll k, int l, int r, int o) {\n        return l < r ? k <= c[o * 2] ? qry(k, lch) : qry(k - c[o * 2], rch) : l;\n    }\n};\nvector <pair <int, int>> Add[N];\nvector <pair <ll, int>> Qry[N];\nint id[N], ans[N];\nint main() {\n    cin >> n >> m >> q;\n    int op, l, r, a, b; ll c;\n    rep(i, 1, q) {\n        scanf(\"%d\", &op);\n        if(op == 1) {\n            scanf(\"%d%d%d%d\", &l, &r, &id[i], &b);\n            seg1::upd(l, r, b, 1, n, 1);\n            Add[l].push_back({ b, i }), add(l, b);\n            Add[r + 1].push_back({ -b, i }), add(r + 1, -b);\n        }\n        if(op == 2) {\n            scanf(\"%d%d%d\", &l, &r, &b);\n            seg1::upd(l, r, -b, 1, n, 1);\n        }\n        if(op == 3) {\n            scanf(\"%d%lld\", &a, &c);\n            ll K = seg1::qry(a, 1, n, 1);\n            if(K < c) ans[i] = 0;\n            else Qry[a].push_back({ c + qry(a) - K, i });\n        } else ans[i] = -1;\n    }\n    rep(i, 1, n) {\n        for(auto [v, t] : Add[i]) seg2::upd(t, v, 1, q, 1);\n        for(auto [k, t] : Qry[i]) ans[t] = id[seg2::qry(k, 1, q, 1)];\n    }\n    rep(i, 1, q) if(~ans[i]) printf(\"%d\\n\", ans[i]);\n    return 0;\n}\n```\n\n","source":"_posts/JOI2021D1T3.md","raw":"---\ntitle: Food Court | JOISC2021 D1T3\ndate: 2021-03-22 20:16:07\nupdated: 2021-03-22 20:16:07\ntags: []\ncategories: JOISC\n---\n>  $N$  $M$ \n>\n>  $Q$ \n>\n> -  $L$  $R$  $K$  $C$ \n> -  $L$  $R$  $K$ $K$ \n> -  $A$  $B$  $0$\n>\n> $N, M, Q \\le 2.5 \\cdot 10^5$\n\n###  $A$ \n\n $0$  ```max```\n\n $0$  ```max```\n\n $a_1,a_2,\\cdots,a_k$\n$$\n\\max\\{0,\\max\\{0,\\max\\{0,\\cdots\\max\\{0,a_1\\}\\cdots+a_{k-1}\\}+a_k\\}\\\\\n=\\max\\{0,a_k,a_{k-1}+a_k,a_{k-2}+a_{k-1}+a_k,\\cdots,a_1+a_2+\\cdots+a_k\\}\\\\\n=\\sum_{i=1}^ka_i-\\min\\{0,a_1,a_1+a_2,\\cdots,a_1+a_2+\\cdots+a_k\\}\n$$\n $0$  ```max``` ****\n\n $tag_i$ **** $minTag_i$\n\n $b$  ```tag[i] += b, minTag[i] = min(minTag[i], tag[i])```\n\n ```tag[son] += tag[fa], minTag[son] = min(minTag[son], tag[son] + minTag[fa])```\n\n### \n\n $A$  $K$  $S$  $B$  $B+S-K$ \n\n$S$  $K$  $K$ \n\n $1$  $n$ \n\n $L$  $t$  $B$**** $R$  $R+1$ $t$  $B$\n\n $T$  $[1,T]$  $K$  $T$  $C$\n\n $O(n\\log n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define mid ((l + r) / 2)\n#define lch l, mid, o * 2\n#define rch mid + 1, r, o * 2 + 1\n\nusing namespace std;\nconst int N = 2.5e5 + 5;\ntypedef long long ll;\nint n, m, q;\nll c[N];\nvoid add(int i, int v) { for(; i <= n; i += i & -i) c[i] += v; }\nll qry(int i, ll r = 0) { for(; i; i &= i - 1) r += c[i]; return r; }\nnamespace seg1 {\n    ll ta[N * 4], mi[N * 4];\n    void put(int o, ll k, ll kk) {\n        mi[o] = min(mi[o], ta[o] + kk), ta[o] += k;\n    }\n    void pd(int o) {\n        put(o * 2, ta[o], mi[o]);\n        put(o * 2 + 1, ta[o], mi[o]);\n        ta[o] = mi[o] = 0;\n    }\n    void upd(int L, int R, int k, int l, int r, int o) {\n        if(L <= l && r <= R) return put(o, k, k);\n        pd(o);\n        if(L <= mid) upd(L, R, k, lch);\n        if(R > mid) upd(L, R, k, rch);\n    }\n    ll qry(int p, int l, int r, int o) {\n        if(l == r) return ta[o] - mi[o];\n        pd(o);\n        return p <= mid ? qry(p, lch) : qry(p, rch);\n    }\n};\nnamespace seg2 {\n    ll c[N * 4];\n    void upd(int p, int v, int l, int r, int o) {\n        c[o] += v; if(p > mid) upd(p, v, rch); else if(l < r) upd(p, v, lch);\n    }\n    ll qry(ll k, int l, int r, int o) {\n        return l < r ? k <= c[o * 2] ? qry(k, lch) : qry(k - c[o * 2], rch) : l;\n    }\n};\nvector <pair <int, int>> Add[N];\nvector <pair <ll, int>> Qry[N];\nint id[N], ans[N];\nint main() {\n    cin >> n >> m >> q;\n    int op, l, r, a, b; ll c;\n    rep(i, 1, q) {\n        scanf(\"%d\", &op);\n        if(op == 1) {\n            scanf(\"%d%d%d%d\", &l, &r, &id[i], &b);\n            seg1::upd(l, r, b, 1, n, 1);\n            Add[l].push_back({ b, i }), add(l, b);\n            Add[r + 1].push_back({ -b, i }), add(r + 1, -b);\n        }\n        if(op == 2) {\n            scanf(\"%d%d%d\", &l, &r, &b);\n            seg1::upd(l, r, -b, 1, n, 1);\n        }\n        if(op == 3) {\n            scanf(\"%d%lld\", &a, &c);\n            ll K = seg1::qry(a, 1, n, 1);\n            if(K < c) ans[i] = 0;\n            else Qry[a].push_back({ c + qry(a) - K, i });\n        } else ans[i] = -1;\n    }\n    rep(i, 1, n) {\n        for(auto [v, t] : Add[i]) seg2::upd(t, v, 1, q, 1);\n        for(auto [k, t] : Qry[i]) ans[t] = id[seg2::qry(k, 1, q, 1)];\n    }\n    rep(i, 1, q) if(~ans[i]) printf(\"%d\\n\", ans[i]);\n    return 0;\n}\n```\n\n","slug":"JOI2021D1T3","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh03001uootncgxbc09w","content":"<blockquote>\r\n<p> <span class=\"math inline\">\\(N\\)</span>  <span class=\"math inline\">\\(M\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(Q\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(L\\)</span>  <span class=\"math inline\">\\(R\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(C\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(L\\)</span>  <span class=\"math inline\">\\(R\\)</span>  <span class=\"math inline\">\\(K\\)</span> <span class=\"math inline\">\\(K\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(0\\)</span></li>\r\n</ul>\r\n<p><span class=\"math inline\">\\(N, M, Q \\le 2.5 \\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<h3 id=\"-a-\"> <span class=\"math inline\">\\(A\\)</span> </h3>\r\n<p> <span class=\"math inline\">\\(0\\)</span>  <code>max</code></p>\r\n<p> <span class=\"math inline\">\\(0\\)</span>  <code>max</code></p>\r\n<p> <span class=\"math inline\">\\(a_1,a_2,\\cdots,a_k\\)</span> <span class=\"math display\">\\[\r\n\\max\\{0,\\max\\{0,\\max\\{0,\\cdots\\max\\{0,a_1\\}\\cdots+a_{k-1}\\}+a_k\\}\\\\\r\n=\\max\\{0,a_k,a_{k-1}+a_k,a_{k-2}+a_{k-1}+a_k,\\cdots,a_1+a_2+\\cdots+a_k\\}\\\\\r\n=\\sum_{i=1}^ka_i-\\min\\{0,a_1,a_1+a_2,\\cdots,a_1+a_2+\\cdots+a_k\\}\r\n\\]</span>  <span class=\"math inline\">\\(0\\)</span>  <code>max</code> <strong></strong></p>\r\n<p> <span class=\"math inline\">\\(tag_i\\)</span> <strong></strong> <span class=\"math inline\">\\(minTag_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(b\\)</span>  <code>tag[i] += b, minTag[i] = min(minTag[i], tag[i])</code></p>\r\n<p> <code>tag[son] += tag[fa], minTag[son] = min(minTag[son], tag[son] + minTag[fa])</code></p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(B+S-K\\)</span> </p>\r\n<p><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(K\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(L\\)</span>  <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(B\\)</span><strong></strong> <span class=\"math inline\">\\(R\\)</span>  <span class=\"math inline\">\\(R+1\\)</span> <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(B\\)</span></p>\r\n<p> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\([1,T]\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(C\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) / 2)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, o * 2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, o * 2 + 1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2.5e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, q;</span><br><span class=\"line\">ll c[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> v)</span> </span>&#123; <span class=\"keyword\">for</span>(; i &lt;= n; i += i &amp; -i) c[i] += v; &#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> i, ll r = <span class=\"number\">0</span>)</span> </span>&#123; <span class=\"keyword\">for</span>(; i; i &amp;= i - <span class=\"number\">1</span>) r += c[i]; <span class=\"keyword\">return</span> r; &#125;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> seg1 &#123;</span><br><span class=\"line\">    ll ta[N * <span class=\"number\">4</span>], mi[N * <span class=\"number\">4</span>];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">put</span><span class=\"params\">(<span class=\"keyword\">int</span> o, ll k, ll kk)</span> </span>&#123;</span><br><span class=\"line\">        mi[o] = <span class=\"built_in\">min</span>(mi[o], ta[o] + kk), ta[o] += k;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pd</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">put</span>(o * <span class=\"number\">2</span>, ta[o], mi[o]);</span><br><span class=\"line\">        <span class=\"built_in\">put</span>(o * <span class=\"number\">2</span> + <span class=\"number\">1</span>, ta[o], mi[o]);</span><br><span class=\"line\">        ta[o] = mi[o] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(L &lt;= l &amp;&amp; r &lt;= R) <span class=\"keyword\">return</span> <span class=\"built_in\">put</span>(o, k, k);</span><br><span class=\"line\">        <span class=\"built_in\">pd</span>(o);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(L &lt;= mid) <span class=\"built_in\">upd</span>(L, R, k, lch);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(R &gt; mid) <span class=\"built_in\">upd</span>(L, R, k, rch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> p, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(l == r) <span class=\"keyword\">return</span> ta[o] - mi[o];</span><br><span class=\"line\">        <span class=\"built_in\">pd</span>(o);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> p &lt;= mid ? <span class=\"built_in\">qry</span>(p, lch) : <span class=\"built_in\">qry</span>(p, rch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> seg2 &#123;</span><br><span class=\"line\">    ll c[N * <span class=\"number\">4</span>];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> p, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        c[o] += v; <span class=\"keyword\">if</span>(p &gt; mid) <span class=\"built_in\">upd</span>(p, v, rch); <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(l &lt; r) <span class=\"built_in\">upd</span>(p, v, lch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">qry</span><span class=\"params\">(ll k, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> l &lt; r ? k &lt;= c[o * <span class=\"number\">2</span>] ? <span class=\"built_in\">qry</span>(k, lch) : <span class=\"built_in\">qry</span>(k - c[o * <span class=\"number\">2</span>], rch) : l;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">vector &lt;pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; Add[N];</span><br><span class=\"line\">vector &lt;pair &lt;ll, <span class=\"keyword\">int</span>&gt;&gt; Qry[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> id[N], ans[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> op, l, r, a, b; ll c;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;op);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;id[i], &amp;b);</span><br><span class=\"line\">            seg1::<span class=\"built_in\">upd</span>(l, r, b, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">            Add[l].<span class=\"built_in\">push_back</span>(&#123; b, i &#125;), <span class=\"built_in\">add</span>(l, b);</span><br><span class=\"line\">            Add[r + <span class=\"number\">1</span>].<span class=\"built_in\">push_back</span>(&#123; -b, i &#125;), <span class=\"built_in\">add</span>(r + <span class=\"number\">1</span>, -b);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op == <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;b);</span><br><span class=\"line\">            seg1::<span class=\"built_in\">upd</span>(l, r, -b, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op == <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%lld&quot;</span>, &amp;a, &amp;c);</span><br><span class=\"line\">            ll K = seg1::<span class=\"built_in\">qry</span>(a, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(K &lt; c) ans[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> Qry[a].<span class=\"built_in\">push_back</span>(&#123; c + <span class=\"built_in\">qry</span>(a) - K, i &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> ans[i] = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, t] : Add[i]) seg2::<span class=\"built_in\">upd</span>(t, v, <span class=\"number\">1</span>, q, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [k, t] : Qry[i]) ans[t] = id[seg2::<span class=\"built_in\">qry</span>(k, <span class=\"number\">1</span>, q, <span class=\"number\">1</span>)];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) <span class=\"keyword\">if</span>(~ans[i]) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, ans[i]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":3339,"excerpt":"","more":"<blockquote>\r\n<p> <span class=\"math inline\">\\(N\\)</span>  <span class=\"math inline\">\\(M\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(Q\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(L\\)</span>  <span class=\"math inline\">\\(R\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(C\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(L\\)</span>  <span class=\"math inline\">\\(R\\)</span>  <span class=\"math inline\">\\(K\\)</span> <span class=\"math inline\">\\(K\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(0\\)</span></li>\r\n</ul>\r\n<p><span class=\"math inline\">\\(N, M, Q \\le 2.5 \\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<h3 id=\"-a-\"> <span class=\"math inline\">\\(A\\)</span> </h3>\r\n<p> <span class=\"math inline\">\\(0\\)</span>  <code>max</code></p>\r\n<p> <span class=\"math inline\">\\(0\\)</span>  <code>max</code></p>\r\n<p> <span class=\"math inline\">\\(a_1,a_2,\\cdots,a_k\\)</span> <span class=\"math display\">\\[\r\n\\max\\{0,\\max\\{0,\\max\\{0,\\cdots\\max\\{0,a_1\\}\\cdots+a_{k-1}\\}+a_k\\}\\\\\r\n=\\max\\{0,a_k,a_{k-1}+a_k,a_{k-2}+a_{k-1}+a_k,\\cdots,a_1+a_2+\\cdots+a_k\\}\\\\\r\n=\\sum_{i=1}^ka_i-\\min\\{0,a_1,a_1+a_2,\\cdots,a_1+a_2+\\cdots+a_k\\}\r\n\\]</span>  <span class=\"math inline\">\\(0\\)</span>  <code>max</code> <strong></strong></p>\r\n<p> <span class=\"math inline\">\\(tag_i\\)</span> <strong></strong> <span class=\"math inline\">\\(minTag_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(b\\)</span>  <code>tag[i] += b, minTag[i] = min(minTag[i], tag[i])</code></p>\r\n<p> <code>tag[son] += tag[fa], minTag[son] = min(minTag[son], tag[son] + minTag[fa])</code></p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(B+S-K\\)</span> </p>\r\n<p><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(K\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(L\\)</span>  <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(B\\)</span><strong></strong> <span class=\"math inline\">\\(R\\)</span>  <span class=\"math inline\">\\(R+1\\)</span> <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(B\\)</span></p>\r\n<p> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\([1,T]\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(C\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) / 2)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, o * 2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, o * 2 + 1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2.5e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, q;</span><br><span class=\"line\">ll c[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> v)</span> </span>&#123; <span class=\"keyword\">for</span>(; i &lt;= n; i += i &amp; -i) c[i] += v; &#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> i, ll r = <span class=\"number\">0</span>)</span> </span>&#123; <span class=\"keyword\">for</span>(; i; i &amp;= i - <span class=\"number\">1</span>) r += c[i]; <span class=\"keyword\">return</span> r; &#125;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> seg1 &#123;</span><br><span class=\"line\">    ll ta[N * <span class=\"number\">4</span>], mi[N * <span class=\"number\">4</span>];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">put</span><span class=\"params\">(<span class=\"keyword\">int</span> o, ll k, ll kk)</span> </span>&#123;</span><br><span class=\"line\">        mi[o] = <span class=\"built_in\">min</span>(mi[o], ta[o] + kk), ta[o] += k;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pd</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">put</span>(o * <span class=\"number\">2</span>, ta[o], mi[o]);</span><br><span class=\"line\">        <span class=\"built_in\">put</span>(o * <span class=\"number\">2</span> + <span class=\"number\">1</span>, ta[o], mi[o]);</span><br><span class=\"line\">        ta[o] = mi[o] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(L &lt;= l &amp;&amp; r &lt;= R) <span class=\"keyword\">return</span> <span class=\"built_in\">put</span>(o, k, k);</span><br><span class=\"line\">        <span class=\"built_in\">pd</span>(o);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(L &lt;= mid) <span class=\"built_in\">upd</span>(L, R, k, lch);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(R &gt; mid) <span class=\"built_in\">upd</span>(L, R, k, rch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> p, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(l == r) <span class=\"keyword\">return</span> ta[o] - mi[o];</span><br><span class=\"line\">        <span class=\"built_in\">pd</span>(o);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> p &lt;= mid ? <span class=\"built_in\">qry</span>(p, lch) : <span class=\"built_in\">qry</span>(p, rch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> seg2 &#123;</span><br><span class=\"line\">    ll c[N * <span class=\"number\">4</span>];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> p, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        c[o] += v; <span class=\"keyword\">if</span>(p &gt; mid) <span class=\"built_in\">upd</span>(p, v, rch); <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(l &lt; r) <span class=\"built_in\">upd</span>(p, v, lch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">qry</span><span class=\"params\">(ll k, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> l &lt; r ? k &lt;= c[o * <span class=\"number\">2</span>] ? <span class=\"built_in\">qry</span>(k, lch) : <span class=\"built_in\">qry</span>(k - c[o * <span class=\"number\">2</span>], rch) : l;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">vector &lt;pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; Add[N];</span><br><span class=\"line\">vector &lt;pair &lt;ll, <span class=\"keyword\">int</span>&gt;&gt; Qry[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> id[N], ans[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> op, l, r, a, b; ll c;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;op);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;id[i], &amp;b);</span><br><span class=\"line\">            seg1::<span class=\"built_in\">upd</span>(l, r, b, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">            Add[l].<span class=\"built_in\">push_back</span>(&#123; b, i &#125;), <span class=\"built_in\">add</span>(l, b);</span><br><span class=\"line\">            Add[r + <span class=\"number\">1</span>].<span class=\"built_in\">push_back</span>(&#123; -b, i &#125;), <span class=\"built_in\">add</span>(r + <span class=\"number\">1</span>, -b);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op == <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;b);</span><br><span class=\"line\">            seg1::<span class=\"built_in\">upd</span>(l, r, -b, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op == <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%lld&quot;</span>, &amp;a, &amp;c);</span><br><span class=\"line\">            ll K = seg1::<span class=\"built_in\">qry</span>(a, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(K &lt; c) ans[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> Qry[a].<span class=\"built_in\">push_back</span>(&#123; c + <span class=\"built_in\">qry</span>(a) - K, i &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> ans[i] = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, t] : Add[i]) seg2::<span class=\"built_in\">upd</span>(t, v, <span class=\"number\">1</span>, q, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [k, t] : Qry[i]) ans[t] = id[seg2::<span class=\"built_in\">qry</span>(k, <span class=\"number\">1</span>, q, <span class=\"number\">1</span>)];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) <span class=\"keyword\">if</span>(~ans[i]) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, ans[i]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Food Court | JOISC2021 D1T3","date":"2021-03-22T12:16:07.000Z","updated":"2021-03-22T12:16:07.000Z","_content":">  $N$  $M$ \n>\n>  $Q$ \n>\n> -  $L$  $R$  $K$  $C$ \n> -  $L$  $R$  $K$ $K$ \n> -  $A$  $B$  $0$\n>\n> $N, M, Q \\le 2.5 \\cdot 10^5$\n\n###  $A$ \n\n $0$  ```max```\n\n $0$  ```max```\n\n $a_1,a_2,\\cdots,a_k$\n$$\n\\max\\{0,\\max\\{0,\\max\\{0,\\cdots\\max\\{0,a_1\\}\\cdots+a_{k-1}\\}+a_k\\}\\\\\n=\\max\\{0,a_k,a_{k-1}+a_k,a_{k-2}+a_{k-1}+a_k,\\cdots,a_1+a_2+\\cdots+a_k\\}\\\\\n=\\sum_{i=1}^ka_i-\\min\\{0,a_1,a_1+a_2,\\cdots,a_1+a_2+\\cdots+a_k\\}\n$$\n $0$  ```max``` ****\n\n $tag_i$ **** $minTag_i$\n\n $b$  ```tag[i] += b, minTag[i] = min(minTag[i], tag[i])```\n\n ```tag[son] += tag[fa], minTag[son] = min(minTag[son], tag[son] + minTag[fa])```\n\n### \n\n $A$  $K$  $S$  $B$  $B+S-K$ \n\n$S$  $K$  $K$ \n\n $1$  $n$ \n\n $L$  $t$  $B$**** $R$  $R+1$ $t$  $B$\n\n $T$  $[1,T]$  $K$  $T$  $C$\n\n $O(n\\log n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define mid ((l + r) / 2)\n#define lch l, mid, o * 2\n#define rch mid + 1, r, o * 2 + 1\n\nusing namespace std;\nconst int N = 2.5e5 + 5;\ntypedef long long ll;\nint n, m, q;\nll c[N];\nvoid add(int i, int v) { for(; i <= n; i += i & -i) c[i] += v; }\nll qry(int i, ll r = 0) { for(; i; i &= i - 1) r += c[i]; return r; }\nnamespace seg1 {\n    ll ta[N * 4], mi[N * 4];\n    void put(int o, ll k, ll kk) {\n        mi[o] = min(mi[o], ta[o] + kk), ta[o] += k;\n    }\n    void pd(int o) {\n        put(o * 2, ta[o], mi[o]);\n        put(o * 2 + 1, ta[o], mi[o]);\n        ta[o] = mi[o] = 0;\n    }\n    void upd(int L, int R, int k, int l, int r, int o) {\n        if(L <= l && r <= R) return put(o, k, k);\n        pd(o);\n        if(L <= mid) upd(L, R, k, lch);\n        if(R > mid) upd(L, R, k, rch);\n    }\n    ll qry(int p, int l, int r, int o) {\n        if(l == r) return ta[o] - mi[o];\n        pd(o);\n        return p <= mid ? qry(p, lch) : qry(p, rch);\n    }\n};\nnamespace seg2 {\n    ll c[N * 4];\n    void upd(int p, int v, int l, int r, int o) {\n        c[o] += v; if(p > mid) upd(p, v, rch); else if(l < r) upd(p, v, lch);\n    }\n    ll qry(ll k, int l, int r, int o) {\n        return l < r ? k <= c[o * 2] ? qry(k, lch) : qry(k - c[o * 2], rch) : l;\n    }\n};\nvector <pair <int, int>> Add[N];\nvector <pair <ll, int>> Qry[N];\nint id[N], ans[N];\nint main() {\n    cin >> n >> m >> q;\n    int op, l, r, a, b; ll c;\n    rep(i, 1, q) {\n        scanf(\"%d\", &op);\n        if(op == 1) {\n            scanf(\"%d%d%d%d\", &l, &r, &id[i], &b);\n            seg1::upd(l, r, b, 1, n, 1);\n            Add[l].push_back({ b, i }), add(l, b);\n            Add[r + 1].push_back({ -b, i }), add(r + 1, -b);\n        }\n        if(op == 2) {\n            scanf(\"%d%d%d\", &l, &r, &b);\n            seg1::upd(l, r, -b, 1, n, 1);\n        }\n        if(op == 3) {\n            scanf(\"%d%lld\", &a, &c);\n            ll K = seg1::qry(a, 1, n, 1);\n            if(K < c) ans[i] = 0;\n            else Qry[a].push_back({ c + qry(a) - K, i });\n        } else ans[i] = -1;\n    }\n    rep(i, 1, n) {\n        for(auto [v, t] : Add[i]) seg2::upd(t, v, 1, q, 1);\n        for(auto [k, t] : Qry[i]) ans[t] = id[seg2::qry(k, 1, q, 1)];\n    }\n    rep(i, 1, q) if(~ans[i]) printf(\"%d\\n\", ans[i]);\n    return 0;\n}\n```\n\n","source":"_posts/JOISC2021D1T3.md","raw":"---\ntitle: Food Court | JOISC2021 D1T3\ndate: 2021-03-22 20:16:07\nupdated: 2021-03-22 20:16:07\ntags: []\ncategories: JOISC\n---\n>  $N$  $M$ \n>\n>  $Q$ \n>\n> -  $L$  $R$  $K$  $C$ \n> -  $L$  $R$  $K$ $K$ \n> -  $A$  $B$  $0$\n>\n> $N, M, Q \\le 2.5 \\cdot 10^5$\n\n###  $A$ \n\n $0$  ```max```\n\n $0$  ```max```\n\n $a_1,a_2,\\cdots,a_k$\n$$\n\\max\\{0,\\max\\{0,\\max\\{0,\\cdots\\max\\{0,a_1\\}\\cdots+a_{k-1}\\}+a_k\\}\\\\\n=\\max\\{0,a_k,a_{k-1}+a_k,a_{k-2}+a_{k-1}+a_k,\\cdots,a_1+a_2+\\cdots+a_k\\}\\\\\n=\\sum_{i=1}^ka_i-\\min\\{0,a_1,a_1+a_2,\\cdots,a_1+a_2+\\cdots+a_k\\}\n$$\n $0$  ```max``` ****\n\n $tag_i$ **** $minTag_i$\n\n $b$  ```tag[i] += b, minTag[i] = min(minTag[i], tag[i])```\n\n ```tag[son] += tag[fa], minTag[son] = min(minTag[son], tag[son] + minTag[fa])```\n\n### \n\n $A$  $K$  $S$  $B$  $B+S-K$ \n\n$S$  $K$  $K$ \n\n $1$  $n$ \n\n $L$  $t$  $B$**** $R$  $R+1$ $t$  $B$\n\n $T$  $[1,T]$  $K$  $T$  $C$\n\n $O(n\\log n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define mid ((l + r) / 2)\n#define lch l, mid, o * 2\n#define rch mid + 1, r, o * 2 + 1\n\nusing namespace std;\nconst int N = 2.5e5 + 5;\ntypedef long long ll;\nint n, m, q;\nll c[N];\nvoid add(int i, int v) { for(; i <= n; i += i & -i) c[i] += v; }\nll qry(int i, ll r = 0) { for(; i; i &= i - 1) r += c[i]; return r; }\nnamespace seg1 {\n    ll ta[N * 4], mi[N * 4];\n    void put(int o, ll k, ll kk) {\n        mi[o] = min(mi[o], ta[o] + kk), ta[o] += k;\n    }\n    void pd(int o) {\n        put(o * 2, ta[o], mi[o]);\n        put(o * 2 + 1, ta[o], mi[o]);\n        ta[o] = mi[o] = 0;\n    }\n    void upd(int L, int R, int k, int l, int r, int o) {\n        if(L <= l && r <= R) return put(o, k, k);\n        pd(o);\n        if(L <= mid) upd(L, R, k, lch);\n        if(R > mid) upd(L, R, k, rch);\n    }\n    ll qry(int p, int l, int r, int o) {\n        if(l == r) return ta[o] - mi[o];\n        pd(o);\n        return p <= mid ? qry(p, lch) : qry(p, rch);\n    }\n};\nnamespace seg2 {\n    ll c[N * 4];\n    void upd(int p, int v, int l, int r, int o) {\n        c[o] += v; if(p > mid) upd(p, v, rch); else if(l < r) upd(p, v, lch);\n    }\n    ll qry(ll k, int l, int r, int o) {\n        return l < r ? k <= c[o * 2] ? qry(k, lch) : qry(k - c[o * 2], rch) : l;\n    }\n};\nvector <pair <int, int>> Add[N];\nvector <pair <ll, int>> Qry[N];\nint id[N], ans[N];\nint main() {\n    cin >> n >> m >> q;\n    int op, l, r, a, b; ll c;\n    rep(i, 1, q) {\n        scanf(\"%d\", &op);\n        if(op == 1) {\n            scanf(\"%d%d%d%d\", &l, &r, &id[i], &b);\n            seg1::upd(l, r, b, 1, n, 1);\n            Add[l].push_back({ b, i }), add(l, b);\n            Add[r + 1].push_back({ -b, i }), add(r + 1, -b);\n        }\n        if(op == 2) {\n            scanf(\"%d%d%d\", &l, &r, &b);\n            seg1::upd(l, r, -b, 1, n, 1);\n        }\n        if(op == 3) {\n            scanf(\"%d%lld\", &a, &c);\n            ll K = seg1::qry(a, 1, n, 1);\n            if(K < c) ans[i] = 0;\n            else Qry[a].push_back({ c + qry(a) - K, i });\n        } else ans[i] = -1;\n    }\n    rep(i, 1, n) {\n        for(auto [v, t] : Add[i]) seg2::upd(t, v, 1, q, 1);\n        for(auto [k, t] : Qry[i]) ans[t] = id[seg2::qry(k, 1, q, 1)];\n    }\n    rep(i, 1, q) if(~ans[i]) printf(\"%d\\n\", ans[i]);\n    return 0;\n}\n```\n\n","slug":"JOISC2021D1T3","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh03001wootnaf27hcj4","content":"<blockquote>\r\n<p> <span class=\"math inline\">\\(N\\)</span>  <span class=\"math inline\">\\(M\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(Q\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(L\\)</span>  <span class=\"math inline\">\\(R\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(C\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(L\\)</span>  <span class=\"math inline\">\\(R\\)</span>  <span class=\"math inline\">\\(K\\)</span> <span class=\"math inline\">\\(K\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(0\\)</span></li>\r\n</ul>\r\n<p><span class=\"math inline\">\\(N, M, Q \\le 2.5 \\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<h3 id=\"-a-\"> <span class=\"math inline\">\\(A\\)</span> </h3>\r\n<p> <span class=\"math inline\">\\(0\\)</span>  <code>max</code></p>\r\n<p> <span class=\"math inline\">\\(0\\)</span>  <code>max</code></p>\r\n<p> <span class=\"math inline\">\\(a_1,a_2,\\cdots,a_k\\)</span> <span class=\"math display\">\\[\r\n\\max\\{0,\\max\\{0,\\max\\{0,\\cdots\\max\\{0,a_1\\}\\cdots+a_{k-1}\\}+a_k\\}\\\\\r\n=\\max\\{0,a_k,a_{k-1}+a_k,a_{k-2}+a_{k-1}+a_k,\\cdots,a_1+a_2+\\cdots+a_k\\}\\\\\r\n=\\sum_{i=1}^ka_i-\\min\\{0,a_1,a_1+a_2,\\cdots,a_1+a_2+\\cdots+a_k\\}\r\n\\]</span>  <span class=\"math inline\">\\(0\\)</span>  <code>max</code> <strong></strong></p>\r\n<p> <span class=\"math inline\">\\(tag_i\\)</span> <strong></strong> <span class=\"math inline\">\\(minTag_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(b\\)</span>  <code>tag[i] += b, minTag[i] = min(minTag[i], tag[i])</code></p>\r\n<p> <code>tag[son] += tag[fa], minTag[son] = min(minTag[son], tag[son] + minTag[fa])</code></p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(B+S-K\\)</span> </p>\r\n<p><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(K\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(L\\)</span>  <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(B\\)</span><strong></strong> <span class=\"math inline\">\\(R\\)</span>  <span class=\"math inline\">\\(R+1\\)</span> <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(B\\)</span></p>\r\n<p> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\([1,T]\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(C\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) / 2)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, o * 2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, o * 2 + 1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2.5e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, q;</span><br><span class=\"line\">ll c[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> v)</span> </span>&#123; <span class=\"keyword\">for</span>(; i &lt;= n; i += i &amp; -i) c[i] += v; &#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> i, ll r = <span class=\"number\">0</span>)</span> </span>&#123; <span class=\"keyword\">for</span>(; i; i &amp;= i - <span class=\"number\">1</span>) r += c[i]; <span class=\"keyword\">return</span> r; &#125;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> seg1 &#123;</span><br><span class=\"line\">    ll ta[N * <span class=\"number\">4</span>], mi[N * <span class=\"number\">4</span>];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">put</span><span class=\"params\">(<span class=\"keyword\">int</span> o, ll k, ll kk)</span> </span>&#123;</span><br><span class=\"line\">        mi[o] = <span class=\"built_in\">min</span>(mi[o], ta[o] + kk), ta[o] += k;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pd</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">put</span>(o * <span class=\"number\">2</span>, ta[o], mi[o]);</span><br><span class=\"line\">        <span class=\"built_in\">put</span>(o * <span class=\"number\">2</span> + <span class=\"number\">1</span>, ta[o], mi[o]);</span><br><span class=\"line\">        ta[o] = mi[o] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(L &lt;= l &amp;&amp; r &lt;= R) <span class=\"keyword\">return</span> <span class=\"built_in\">put</span>(o, k, k);</span><br><span class=\"line\">        <span class=\"built_in\">pd</span>(o);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(L &lt;= mid) <span class=\"built_in\">upd</span>(L, R, k, lch);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(R &gt; mid) <span class=\"built_in\">upd</span>(L, R, k, rch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> p, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(l == r) <span class=\"keyword\">return</span> ta[o] - mi[o];</span><br><span class=\"line\">        <span class=\"built_in\">pd</span>(o);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> p &lt;= mid ? <span class=\"built_in\">qry</span>(p, lch) : <span class=\"built_in\">qry</span>(p, rch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> seg2 &#123;</span><br><span class=\"line\">    ll c[N * <span class=\"number\">4</span>];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> p, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        c[o] += v; <span class=\"keyword\">if</span>(p &gt; mid) <span class=\"built_in\">upd</span>(p, v, rch); <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(l &lt; r) <span class=\"built_in\">upd</span>(p, v, lch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">qry</span><span class=\"params\">(ll k, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> l &lt; r ? k &lt;= c[o * <span class=\"number\">2</span>] ? <span class=\"built_in\">qry</span>(k, lch) : <span class=\"built_in\">qry</span>(k - c[o * <span class=\"number\">2</span>], rch) : l;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">vector &lt;pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; Add[N];</span><br><span class=\"line\">vector &lt;pair &lt;ll, <span class=\"keyword\">int</span>&gt;&gt; Qry[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> id[N], ans[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> op, l, r, a, b; ll c;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;op);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;id[i], &amp;b);</span><br><span class=\"line\">            seg1::<span class=\"built_in\">upd</span>(l, r, b, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">            Add[l].<span class=\"built_in\">push_back</span>(&#123; b, i &#125;), <span class=\"built_in\">add</span>(l, b);</span><br><span class=\"line\">            Add[r + <span class=\"number\">1</span>].<span class=\"built_in\">push_back</span>(&#123; -b, i &#125;), <span class=\"built_in\">add</span>(r + <span class=\"number\">1</span>, -b);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op == <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;b);</span><br><span class=\"line\">            seg1::<span class=\"built_in\">upd</span>(l, r, -b, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op == <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%lld&quot;</span>, &amp;a, &amp;c);</span><br><span class=\"line\">            ll K = seg1::<span class=\"built_in\">qry</span>(a, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(K &lt; c) ans[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> Qry[a].<span class=\"built_in\">push_back</span>(&#123; c + <span class=\"built_in\">qry</span>(a) - K, i &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> ans[i] = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, t] : Add[i]) seg2::<span class=\"built_in\">upd</span>(t, v, <span class=\"number\">1</span>, q, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [k, t] : Qry[i]) ans[t] = id[seg2::<span class=\"built_in\">qry</span>(k, <span class=\"number\">1</span>, q, <span class=\"number\">1</span>)];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) <span class=\"keyword\">if</span>(~ans[i]) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, ans[i]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":3339,"excerpt":"","more":"<blockquote>\r\n<p> <span class=\"math inline\">\\(N\\)</span>  <span class=\"math inline\">\\(M\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(Q\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(L\\)</span>  <span class=\"math inline\">\\(R\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(C\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(L\\)</span>  <span class=\"math inline\">\\(R\\)</span>  <span class=\"math inline\">\\(K\\)</span> <span class=\"math inline\">\\(K\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(0\\)</span></li>\r\n</ul>\r\n<p><span class=\"math inline\">\\(N, M, Q \\le 2.5 \\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<h3 id=\"-a-\"> <span class=\"math inline\">\\(A\\)</span> </h3>\r\n<p> <span class=\"math inline\">\\(0\\)</span>  <code>max</code></p>\r\n<p> <span class=\"math inline\">\\(0\\)</span>  <code>max</code></p>\r\n<p> <span class=\"math inline\">\\(a_1,a_2,\\cdots,a_k\\)</span> <span class=\"math display\">\\[\r\n\\max\\{0,\\max\\{0,\\max\\{0,\\cdots\\max\\{0,a_1\\}\\cdots+a_{k-1}\\}+a_k\\}\\\\\r\n=\\max\\{0,a_k,a_{k-1}+a_k,a_{k-2}+a_{k-1}+a_k,\\cdots,a_1+a_2+\\cdots+a_k\\}\\\\\r\n=\\sum_{i=1}^ka_i-\\min\\{0,a_1,a_1+a_2,\\cdots,a_1+a_2+\\cdots+a_k\\}\r\n\\]</span>  <span class=\"math inline\">\\(0\\)</span>  <code>max</code> <strong></strong></p>\r\n<p> <span class=\"math inline\">\\(tag_i\\)</span> <strong></strong> <span class=\"math inline\">\\(minTag_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(b\\)</span>  <code>tag[i] += b, minTag[i] = min(minTag[i], tag[i])</code></p>\r\n<p> <code>tag[son] += tag[fa], minTag[son] = min(minTag[son], tag[son] + minTag[fa])</code></p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(B+S-K\\)</span> </p>\r\n<p><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(K\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(L\\)</span>  <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(B\\)</span><strong></strong> <span class=\"math inline\">\\(R\\)</span>  <span class=\"math inline\">\\(R+1\\)</span> <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(B\\)</span></p>\r\n<p> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\([1,T]\\)</span>  <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(C\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) / 2)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, o * 2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, o * 2 + 1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2.5e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, q;</span><br><span class=\"line\">ll c[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> v)</span> </span>&#123; <span class=\"keyword\">for</span>(; i &lt;= n; i += i &amp; -i) c[i] += v; &#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> i, ll r = <span class=\"number\">0</span>)</span> </span>&#123; <span class=\"keyword\">for</span>(; i; i &amp;= i - <span class=\"number\">1</span>) r += c[i]; <span class=\"keyword\">return</span> r; &#125;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> seg1 &#123;</span><br><span class=\"line\">    ll ta[N * <span class=\"number\">4</span>], mi[N * <span class=\"number\">4</span>];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">put</span><span class=\"params\">(<span class=\"keyword\">int</span> o, ll k, ll kk)</span> </span>&#123;</span><br><span class=\"line\">        mi[o] = <span class=\"built_in\">min</span>(mi[o], ta[o] + kk), ta[o] += k;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pd</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">put</span>(o * <span class=\"number\">2</span>, ta[o], mi[o]);</span><br><span class=\"line\">        <span class=\"built_in\">put</span>(o * <span class=\"number\">2</span> + <span class=\"number\">1</span>, ta[o], mi[o]);</span><br><span class=\"line\">        ta[o] = mi[o] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(L &lt;= l &amp;&amp; r &lt;= R) <span class=\"keyword\">return</span> <span class=\"built_in\">put</span>(o, k, k);</span><br><span class=\"line\">        <span class=\"built_in\">pd</span>(o);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(L &lt;= mid) <span class=\"built_in\">upd</span>(L, R, k, lch);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(R &gt; mid) <span class=\"built_in\">upd</span>(L, R, k, rch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> p, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(l == r) <span class=\"keyword\">return</span> ta[o] - mi[o];</span><br><span class=\"line\">        <span class=\"built_in\">pd</span>(o);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> p &lt;= mid ? <span class=\"built_in\">qry</span>(p, lch) : <span class=\"built_in\">qry</span>(p, rch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> seg2 &#123;</span><br><span class=\"line\">    ll c[N * <span class=\"number\">4</span>];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> p, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        c[o] += v; <span class=\"keyword\">if</span>(p &gt; mid) <span class=\"built_in\">upd</span>(p, v, rch); <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(l &lt; r) <span class=\"built_in\">upd</span>(p, v, lch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">qry</span><span class=\"params\">(ll k, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> l &lt; r ? k &lt;= c[o * <span class=\"number\">2</span>] ? <span class=\"built_in\">qry</span>(k, lch) : <span class=\"built_in\">qry</span>(k - c[o * <span class=\"number\">2</span>], rch) : l;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">vector &lt;pair &lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; Add[N];</span><br><span class=\"line\">vector &lt;pair &lt;ll, <span class=\"keyword\">int</span>&gt;&gt; Qry[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> id[N], ans[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> op, l, r, a, b; ll c;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;op);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;id[i], &amp;b);</span><br><span class=\"line\">            seg1::<span class=\"built_in\">upd</span>(l, r, b, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">            Add[l].<span class=\"built_in\">push_back</span>(&#123; b, i &#125;), <span class=\"built_in\">add</span>(l, b);</span><br><span class=\"line\">            Add[r + <span class=\"number\">1</span>].<span class=\"built_in\">push_back</span>(&#123; -b, i &#125;), <span class=\"built_in\">add</span>(r + <span class=\"number\">1</span>, -b);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op == <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;b);</span><br><span class=\"line\">            seg1::<span class=\"built_in\">upd</span>(l, r, -b, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op == <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%lld&quot;</span>, &amp;a, &amp;c);</span><br><span class=\"line\">            ll K = seg1::<span class=\"built_in\">qry</span>(a, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(K &lt; c) ans[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> Qry[a].<span class=\"built_in\">push_back</span>(&#123; c + <span class=\"built_in\">qry</span>(a) - K, i &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> ans[i] = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [v, t] : Add[i]) seg2::<span class=\"built_in\">upd</span>(t, v, <span class=\"number\">1</span>, q, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [k, t] : Qry[i]) ans[t] = id[seg2::<span class=\"built_in\">qry</span>(k, <span class=\"number\">1</span>, q, <span class=\"number\">1</span>)];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) <span class=\"keyword\">if</span>(~ans[i]) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, ans[i]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Meetings 2 | JOISC2021 D3T3","date":"2021-03-22T12:16:23.000Z","updated":"2021-03-22T12:16:23.000Z","_content":">  $n$ \n>\n> \n>\n>  $k \\in [1,n]$ $k$ \n>\n> $n \\le 2 \\cdot 10^5$\n\n####  ```size``` \n\n###  $1$ $k$  $1$\n\n\n\n $f(u)$  $u$ \n\n $u$  $f(u) \\le \\lfloor \\frac k2 \\rfloor$  $u$  $v$  $\\lfloor \\frac k2 \\rfloor$  $v$  $u$ \n\n $u$  $v$  $f(v) \\ge k -f(u) > \\lfloor \\frac k2 \\rfloor$ $v$ \n\n###  $2$ $k$ \n\n \n\n $u, v$  $(u,v)$  $a,b$\n\n $a + b = k, a \\le f(v) \\le \\frac k2,b \\le f(u) \\le \\frac k2 \\Rightarrow a = b = \\frac k2$\n\n $k$  $(u,v)$ \n\n![](https://i.loli.net/2021/03/22/cs9ZJOrImCibEAz.png)\n\n $O(n^2)$ \n\n $F(u,v)$  $u - v$ \n\n $u - v$ $F(u,v) \\ge \\frac k2$ $\\frac k2$   \n $k=2F(u,v)$ \n\n $u - v$$F(u,v) = \\min\\{size_u,size_v\\}$\n\n $size$  $D$\n\n $u$ $D$  $k=2size_u$ \n\n $a, b$ $u$  $u - a$ $u - b$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\nconst int N = 2e5 + 5;\n\nint n, sz[N], rt, d[N], fa[18][N], ans[N];\nvector <int> G[N], nds[N];\nvoid dfs(int u, int fa) {\n    sz[u] = 1;\n    int ma = 0;\n    for(int v : G[u]) if(v ^ fa)\n        dfs(v, u), sz[u] += sz[v], ma = max(ma, sz[v]);\n    if(max(ma, n - sz[u]) <= n / 2) rt = u;\n}\nvoid Dfs(int u) {\n    sz[u] = 1;\n    rep(i, 1, 17) fa[i][u] = fa[i - 1][fa[i - 1][u]];\n    for(int v : G[u]) if(v ^ fa[0][u])\n        fa[0][v] = u, d[v] = d[u] + 1, Dfs(v), sz[u] += sz[v];\n}\nint dis(int u, int v) {\n    if(d[u] < d[v]) swap(u, v);\n    int res = d[u] - d[v];\n    per(i, 17, 0) if(d[u] - (1 << i) >= d[v]) u = fa[i][u];\n    if(u == v) return res;\n    per(i, 17, 0) if(fa[i][u] ^ fa[i][v])\n        u = fa[i][u], v = fa[i][v], res += 2 << i;\n    return res + 2;\n}\n\nint main() {\n    cin >> n;\n    int u, v;\n    rep(i, 2, n) {\n        scanf(\"%d%d\", &u, &v);\n        G[u].push_back(v), G[v].push_back(u);\n    }\n    dfs(1, 0), Dfs(rt);\n    rep(i, 1, n) nds[sz[i]].push_back(i);\n    u = v = rt;\n    int D = 0, d;\n    per(i, n, 1) {\n        for(int x : nds[i]) {\n            if((d = dis(x, u)) > D) v = x, D = d;\n            if((d = dis(x, v)) > D) u = x, D = d;\n        }\n        ans[i] = D + 1;\n    }\n    rep(i, 1, n) printf(\"%d\\n\", i & 1 ? 1 : ans[i / 2]);\n    return 0;\n}\n```","source":"_posts/JOISC2021D3T3.md","raw":"---\ntitle: Meetings 2 | JOISC2021 D3T3\ndate: 2021-03-22 20:16:23\nupdated: 2021-03-22 20:16:23\ntags: [,,]\ncategories: JOISC\n---\n>  $n$ \n>\n> \n>\n>  $k \\in [1,n]$ $k$ \n>\n> $n \\le 2 \\cdot 10^5$\n\n####  ```size``` \n\n###  $1$ $k$  $1$\n\n\n\n $f(u)$  $u$ \n\n $u$  $f(u) \\le \\lfloor \\frac k2 \\rfloor$  $u$  $v$  $\\lfloor \\frac k2 \\rfloor$  $v$  $u$ \n\n $u$  $v$  $f(v) \\ge k -f(u) > \\lfloor \\frac k2 \\rfloor$ $v$ \n\n###  $2$ $k$ \n\n \n\n $u, v$  $(u,v)$  $a,b$\n\n $a + b = k, a \\le f(v) \\le \\frac k2,b \\le f(u) \\le \\frac k2 \\Rightarrow a = b = \\frac k2$\n\n $k$  $(u,v)$ \n\n![](https://i.loli.net/2021/03/22/cs9ZJOrImCibEAz.png)\n\n $O(n^2)$ \n\n $F(u,v)$  $u - v$ \n\n $u - v$ $F(u,v) \\ge \\frac k2$ $\\frac k2$   \n $k=2F(u,v)$ \n\n $u - v$$F(u,v) = \\min\\{size_u,size_v\\}$\n\n $size$  $D$\n\n $u$ $D$  $k=2size_u$ \n\n $a, b$ $u$  $u - a$ $u - b$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\nconst int N = 2e5 + 5;\n\nint n, sz[N], rt, d[N], fa[18][N], ans[N];\nvector <int> G[N], nds[N];\nvoid dfs(int u, int fa) {\n    sz[u] = 1;\n    int ma = 0;\n    for(int v : G[u]) if(v ^ fa)\n        dfs(v, u), sz[u] += sz[v], ma = max(ma, sz[v]);\n    if(max(ma, n - sz[u]) <= n / 2) rt = u;\n}\nvoid Dfs(int u) {\n    sz[u] = 1;\n    rep(i, 1, 17) fa[i][u] = fa[i - 1][fa[i - 1][u]];\n    for(int v : G[u]) if(v ^ fa[0][u])\n        fa[0][v] = u, d[v] = d[u] + 1, Dfs(v), sz[u] += sz[v];\n}\nint dis(int u, int v) {\n    if(d[u] < d[v]) swap(u, v);\n    int res = d[u] - d[v];\n    per(i, 17, 0) if(d[u] - (1 << i) >= d[v]) u = fa[i][u];\n    if(u == v) return res;\n    per(i, 17, 0) if(fa[i][u] ^ fa[i][v])\n        u = fa[i][u], v = fa[i][v], res += 2 << i;\n    return res + 2;\n}\n\nint main() {\n    cin >> n;\n    int u, v;\n    rep(i, 2, n) {\n        scanf(\"%d%d\", &u, &v);\n        G[u].push_back(v), G[v].push_back(u);\n    }\n    dfs(1, 0), Dfs(rt);\n    rep(i, 1, n) nds[sz[i]].push_back(i);\n    u = v = rt;\n    int D = 0, d;\n    per(i, n, 1) {\n        for(int x : nds[i]) {\n            if((d = dis(x, u)) > D) v = x, D = d;\n            if((d = dis(x, v)) > D) u = x, D = d;\n        }\n        ans[i] = D + 1;\n    }\n    rep(i, 1, n) printf(\"%d\\n\", i & 1 ? 1 : ans[i / 2]);\n    return 0;\n}\n```","slug":"JOISC2021D3T3","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh050021ootnbviu7tnp","content":"<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(k \\in [1,n]\\)</span> <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 2 \\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<h4 id=\"-size-\"> <code>size</code> </h4>\r\n<h3 id=\"-1-k--1\"> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(1\\)</span></h3>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(f(u)\\)</span>  <span class=\"math inline\">\\(u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(f(u) \\le \\lfloor \\frac k2 \\rfloor\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(\\lfloor \\frac k2 \\rfloor\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(f(v) \\ge k -f(u) &gt; \\lfloor \\frac k2 \\rfloor\\)</span> <span class=\"math inline\">\\(v\\)</span> </p>\r\n<h3 id=\"-2-k-\"> <span class=\"math inline\">\\(2\\)</span> <span class=\"math inline\">\\(k\\)</span> </h3>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(u, v\\)</span>  <span class=\"math inline\">\\((u,v)\\)</span>  <span class=\"math inline\">\\(a,b\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a + b = k, a \\le f(v) \\le \\frac k2,b \\le f(u) \\le \\frac k2 \\Rightarrow a = b = \\frac k2\\)</span></p>\r\n<p> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\((u,v)\\)</span> </p>\r\n<p><img src=\"https://i.loli.net/2021/03/22/cs9ZJOrImCibEAz.png\" /></p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(F(u,v)\\)</span>  <span class=\"math inline\">\\(u - v\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(u - v\\)</span> <span class=\"math inline\">\\(F(u,v) \\ge \\frac k2\\)</span> <span class=\"math inline\">\\(\\frac k2\\)</span> <br />\r\n <span class=\"math inline\">\\(k=2F(u,v)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(u - v\\)</span><span class=\"math inline\">\\(F(u,v) = \\min\\{size_u,size_v\\}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(size\\)</span>  <span class=\"math inline\">\\(D\\)</span></p>\r\n<p> <span class=\"math inline\">\\(u\\)</span> <span class=\"math inline\">\\(D\\)</span>  <span class=\"math inline\">\\(k=2size_u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(a, b\\)</span> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u - a\\)</span> <span class=\"math inline\">\\(u - b\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, sz[N], rt, d[N], fa[<span class=\"number\">18</span>][N], ans[N];</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; G[N], nds[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> fa)</span> </span>&#123;</span><br><span class=\"line\">    sz[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> ma = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(v ^ fa)</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(v, u), sz[u] += sz[v], ma = <span class=\"built_in\">max</span>(ma, sz[v]);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">max</span>(ma, n - sz[u]) &lt;= n / <span class=\"number\">2</span>) rt = u;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    sz[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">17</span>) fa[i][u] = fa[i - <span class=\"number\">1</span>][fa[i - <span class=\"number\">1</span>][u]];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(v ^ fa[<span class=\"number\">0</span>][u])</span><br><span class=\"line\">        fa[<span class=\"number\">0</span>][v] = u, d[v] = d[u] + <span class=\"number\">1</span>, <span class=\"built_in\">Dfs</span>(v), sz[u] += sz[v];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dis</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(d[u] &lt; d[v]) <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res = d[u] - d[v];</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, <span class=\"number\">17</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(d[u] - (<span class=\"number\">1</span> &lt;&lt; i) &gt;= d[v]) u = fa[i][u];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u == v) <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, <span class=\"number\">17</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(fa[i][u] ^ fa[i][v])</span><br><span class=\"line\">        u = fa[i][u], v = fa[i][v], res += <span class=\"number\">2</span> &lt;&lt; i;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res + <span class=\"number\">2</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class=\"line\">        G[u].<span class=\"built_in\">push_back</span>(v), G[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>), <span class=\"built_in\">Dfs</span>(rt);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) nds[sz[i]].<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">    u = v = rt;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> D = <span class=\"number\">0</span>, d;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, n, <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> x : nds[i]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>((d = <span class=\"built_in\">dis</span>(x, u)) &gt; D) v = x, D = d;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>((d = <span class=\"built_in\">dis</span>(x, v)) &gt; D) u = x, D = d;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ans[i] = D + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, i &amp; <span class=\"number\">1</span> ? <span class=\"number\">1</span> : ans[i / <span class=\"number\">2</span>]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2360,"excerpt":"","more":"<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(k \\in [1,n]\\)</span> <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 2 \\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<h4 id=\"-size-\"> <code>size</code> </h4>\r\n<h3 id=\"-1-k--1\"> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(1\\)</span></h3>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(f(u)\\)</span>  <span class=\"math inline\">\\(u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(f(u) \\le \\lfloor \\frac k2 \\rfloor\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(\\lfloor \\frac k2 \\rfloor\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(f(v) \\ge k -f(u) &gt; \\lfloor \\frac k2 \\rfloor\\)</span> <span class=\"math inline\">\\(v\\)</span> </p>\r\n<h3 id=\"-2-k-\"> <span class=\"math inline\">\\(2\\)</span> <span class=\"math inline\">\\(k\\)</span> </h3>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(u, v\\)</span>  <span class=\"math inline\">\\((u,v)\\)</span>  <span class=\"math inline\">\\(a,b\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a + b = k, a \\le f(v) \\le \\frac k2,b \\le f(u) \\le \\frac k2 \\Rightarrow a = b = \\frac k2\\)</span></p>\r\n<p> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\((u,v)\\)</span> </p>\r\n<p><img src=\"https://i.loli.net/2021/03/22/cs9ZJOrImCibEAz.png\" /></p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(F(u,v)\\)</span>  <span class=\"math inline\">\\(u - v\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(u - v\\)</span> <span class=\"math inline\">\\(F(u,v) \\ge \\frac k2\\)</span> <span class=\"math inline\">\\(\\frac k2\\)</span> <br />\r\n <span class=\"math inline\">\\(k=2F(u,v)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(u - v\\)</span><span class=\"math inline\">\\(F(u,v) = \\min\\{size_u,size_v\\}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(size\\)</span>  <span class=\"math inline\">\\(D\\)</span></p>\r\n<p> <span class=\"math inline\">\\(u\\)</span> <span class=\"math inline\">\\(D\\)</span>  <span class=\"math inline\">\\(k=2size_u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(a, b\\)</span> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u - a\\)</span> <span class=\"math inline\">\\(u - b\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, sz[N], rt, d[N], fa[<span class=\"number\">18</span>][N], ans[N];</span><br><span class=\"line\">vector &lt;<span class=\"keyword\">int</span>&gt; G[N], nds[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> fa)</span> </span>&#123;</span><br><span class=\"line\">    sz[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> ma = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(v ^ fa)</span><br><span class=\"line\">        <span class=\"built_in\">dfs</span>(v, u), sz[u] += sz[v], ma = <span class=\"built_in\">max</span>(ma, sz[v]);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">max</span>(ma, n - sz[u]) &lt;= n / <span class=\"number\">2</span>) rt = u;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    sz[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">17</span>) fa[i][u] = fa[i - <span class=\"number\">1</span>][fa[i - <span class=\"number\">1</span>][u]];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(v ^ fa[<span class=\"number\">0</span>][u])</span><br><span class=\"line\">        fa[<span class=\"number\">0</span>][v] = u, d[v] = d[u] + <span class=\"number\">1</span>, <span class=\"built_in\">Dfs</span>(v), sz[u] += sz[v];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dis</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(d[u] &lt; d[v]) <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> res = d[u] - d[v];</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, <span class=\"number\">17</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(d[u] - (<span class=\"number\">1</span> &lt;&lt; i) &gt;= d[v]) u = fa[i][u];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u == v) <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, <span class=\"number\">17</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(fa[i][u] ^ fa[i][v])</span><br><span class=\"line\">        u = fa[i][u], v = fa[i][v], res += <span class=\"number\">2</span> &lt;&lt; i;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res + <span class=\"number\">2</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> u, v;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class=\"line\">        G[u].<span class=\"built_in\">push_back</span>(v), G[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>), <span class=\"built_in\">Dfs</span>(rt);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) nds[sz[i]].<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">    u = v = rt;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> D = <span class=\"number\">0</span>, d;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, n, <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> x : nds[i]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>((d = <span class=\"built_in\">dis</span>(x, u)) &gt; D) v = x, D = d;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>((d = <span class=\"built_in\">dis</span>(x, v)) &gt; D) u = x, D = d;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ans[i] = D + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, i &amp; <span class=\"number\">1</span> ? <span class=\"number\">1</span> : ans[i / <span class=\"number\">2</span>]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"Password Remembering | UVa12212","date":"2021-03-13T14:47:35.000Z","updated":"2021-03-13T14:47:35.000Z","_content":"> [](https://onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=244&page=show_problem&problem=3364)\n>\n>  $A$$B$ $(A \\le B < 2^{64})$ $n$ : $A \\le n \\le B \\land A \\le rev(n) \\le B$$rev(1203)=3021$$rev(1050)=501$\n\n DP\n\n-  $i$ \n-  $i$  $A$ \n-  $i$  $B$ \n-  $i$  $j$ \n-  $j$   $A$  $j$ \n-  $j$   $B$  $j$ \n- \n- ```DP``` \n\n DP  $0/1/2$ \n\n  $\\text{calc}(A, B)$  $n$ : $n<A \\land rev(n)<B$\n\n $\\text{calc}(B+1,B+1)-\\text{calc}(A,B+1)-\\text{calc}(B+1,A)+\\text{calc}(A,A)$\n\n $\\text{calc}$  DP\n\n-  $i$ \n-  $i$  $A$ \n-  $i$  $j$ \n-  $j$   $B$  $j$ \n- \n\n $0/1/2$ \n\n ${(i,leA,j,leB,hv0)}$,  $i-1$  $s$.\n\n$hv0=0\\lor s>0$)\n$$\n(i-1,leA\\lor s<a_{i-1},j+1,s<b_{j+1}\\lor (s=b_{j+1}\\land leB),0)\\leftarrow (i,leA,j,leB,0)\n$$\n\n$$\n(i-1,leA\\lor s<a_{i-1},1,0,1)\\leftarrow (i,leA,1,0,1)\n$$\n $\\text{calc}$  $A=2^{64}$  $B=2^{64}$ \n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++) \n\nusing namespace std;\ntypedef unsigned long long ull;\nconst int U64[] = { 0,6,1,6,1,5,5,9,0,7,3,7,0,4,4,7,6,4,4,8,1 };\null A, B, f[25][25][2][2][2]; int na, a[25], nb, b[25];\null dp(int i, int j, int leA, int leB, int hv0) {\n    if(!i) return leA && (j <= nb || leB);\n    ull& res = f[i][j][leA][leB][hv0];\n    if(~res) return res; res = 0;\n    rep(s, 0, j > nb ? 0 : leA ? 9 : a[i]) {\n        int Hv0 = hv0 & !s;\n        res += dp(i - 1, j > nb ? j : j + !Hv0, leA || s < a[i], j > nb ? leB : !Hv0 && (s < b[j] || (s == b[j] && leB)), Hv0);\n    }\n    return res;\n}\null calc(ull A, ull B) {\n    na = nb = 0, mem(f, -1);\n    if(A) while(A) a[++na] = A % 10, A /= 10;\n    else rep(i, 1, 20) a[++na] = U64[i];\n    if(B) while(B) b[++nb] = B % 10, B /= 10;\n    else rep(i, 1, 20) b[++nb] = U64[i];\n    return dp(na, 1, 0, 0, 1);\n}\nint main() {\n    int T; cin >> T;\n    rep(kase, 1, T) {\n        scanf(\"%llu%llu\", &A, &B), B++;\n        printf(\"Case %d: %llu\\n\", kase, calc(B, B) - calc(A, B) - calc(B, A) + calc(A, A));\n    }\n    return 0;\n}\n```","source":"_posts/UVa12212.md","raw":"---\ntitle: Password Remembering | UVa12212\ndate: 2021-03-13 22:47:35\nupdated: 2021-03-13 22:47:35\ntags: [,]\ncategories: UVa\n---\n> [](https://onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=244&page=show_problem&problem=3364)\n>\n>  $A$$B$ $(A \\le B < 2^{64})$ $n$ : $A \\le n \\le B \\land A \\le rev(n) \\le B$$rev(1203)=3021$$rev(1050)=501$\n\n DP\n\n-  $i$ \n-  $i$  $A$ \n-  $i$  $B$ \n-  $i$  $j$ \n-  $j$   $A$  $j$ \n-  $j$   $B$  $j$ \n- \n- ```DP``` \n\n DP  $0/1/2$ \n\n  $\\text{calc}(A, B)$  $n$ : $n<A \\land rev(n)<B$\n\n $\\text{calc}(B+1,B+1)-\\text{calc}(A,B+1)-\\text{calc}(B+1,A)+\\text{calc}(A,A)$\n\n $\\text{calc}$  DP\n\n-  $i$ \n-  $i$  $A$ \n-  $i$  $j$ \n-  $j$   $B$  $j$ \n- \n\n $0/1/2$ \n\n ${(i,leA,j,leB,hv0)}$,  $i-1$  $s$.\n\n$hv0=0\\lor s>0$)\n$$\n(i-1,leA\\lor s<a_{i-1},j+1,s<b_{j+1}\\lor (s=b_{j+1}\\land leB),0)\\leftarrow (i,leA,j,leB,0)\n$$\n\n$$\n(i-1,leA\\lor s<a_{i-1},1,0,1)\\leftarrow (i,leA,1,0,1)\n$$\n $\\text{calc}$  $A=2^{64}$  $B=2^{64}$ \n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++) \n\nusing namespace std;\ntypedef unsigned long long ull;\nconst int U64[] = { 0,6,1,6,1,5,5,9,0,7,3,7,0,4,4,7,6,4,4,8,1 };\null A, B, f[25][25][2][2][2]; int na, a[25], nb, b[25];\null dp(int i, int j, int leA, int leB, int hv0) {\n    if(!i) return leA && (j <= nb || leB);\n    ull& res = f[i][j][leA][leB][hv0];\n    if(~res) return res; res = 0;\n    rep(s, 0, j > nb ? 0 : leA ? 9 : a[i]) {\n        int Hv0 = hv0 & !s;\n        res += dp(i - 1, j > nb ? j : j + !Hv0, leA || s < a[i], j > nb ? leB : !Hv0 && (s < b[j] || (s == b[j] && leB)), Hv0);\n    }\n    return res;\n}\null calc(ull A, ull B) {\n    na = nb = 0, mem(f, -1);\n    if(A) while(A) a[++na] = A % 10, A /= 10;\n    else rep(i, 1, 20) a[++na] = U64[i];\n    if(B) while(B) b[++nb] = B % 10, B /= 10;\n    else rep(i, 1, 20) b[++nb] = U64[i];\n    return dp(na, 1, 0, 0, 1);\n}\nint main() {\n    int T; cin >> T;\n    rep(kase, 1, T) {\n        scanf(\"%llu%llu\", &A, &B), B++;\n        printf(\"Case %d: %llu\\n\", kase, calc(B, B) - calc(A, B) - calc(B, A) + calc(A, A));\n    }\n    return 0;\n}\n```","slug":"UVa12212","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh060024ootnhn3b2p5l","content":"<blockquote>\r\n<p><a href=\"https://onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;category=244&amp;page=show_problem&amp;problem=3364\"></a></p>\r\n<p> <span class=\"math inline\">\\(A\\)</span><span class=\"math inline\">\\(B\\)</span> <span class=\"math inline\">\\((A \\le B &lt; 2^{64})\\)</span> <span class=\"math inline\">\\(n\\)</span> : <span class=\"math inline\">\\(A \\le n \\le B \\land A \\le rev(n) \\le B\\)</span><span class=\"math inline\">\\(rev(1203)=3021\\)</span><span class=\"math inline\">\\(rev(1050)=501\\)</span></p>\r\n</blockquote>\r\n<p> DP</p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(A\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(B\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(j\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(j\\)</span> </li>\r\n<li></li>\r\n<li><code>DP</code> </li>\r\n</ul>\r\n<p> DP  <span class=\"math inline\">\\(0/1/2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\text{calc}(A, B)\\)</span>  <span class=\"math inline\">\\(n\\)</span> : <span class=\"math inline\">\\(n&lt;A \\land rev(n)&lt;B\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\text{calc}(B+1,B+1)-\\text{calc}(A,B+1)-\\text{calc}(B+1,A)+\\text{calc}(A,A)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\text{calc}\\)</span>  DP</p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(A\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(j\\)</span> </li>\r\n<li></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(0/1/2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\({(i,leA,j,leB,hv0)}\\)</span>,  <span class=\"math inline\">\\(i-1\\)</span>  <span class=\"math inline\">\\(s\\)</span>.</p>\r\n<p><span class=\"math inline\">\\(hv0=0\\lor s&gt;0\\)</span>) <span class=\"math display\">\\[\r\n(i-1,leA\\lor s&lt;a_{i-1},j+1,s&lt;b_{j+1}\\lor (s=b_{j+1}\\land leB),0)\\leftarrow (i,leA,j,leB,0)\r\n\\]</span>  <span class=\"math display\">\\[\r\n(i-1,leA\\lor s&lt;a_{i-1},1,0,1)\\leftarrow (i,leA,1,0,1)\r\n\\]</span>  <span class=\"math inline\">\\(\\text{calc}\\)</span>  <span class=\"math inline\">\\(A=2^{64}\\)</span>  <span class=\"math inline\">\\(B=2^{64}\\)</span> </p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++) </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ull;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> U64[] = &#123; <span class=\"number\">0</span>,<span class=\"number\">6</span>,<span class=\"number\">1</span>,<span class=\"number\">6</span>,<span class=\"number\">1</span>,<span class=\"number\">5</span>,<span class=\"number\">5</span>,<span class=\"number\">9</span>,<span class=\"number\">0</span>,<span class=\"number\">7</span>,<span class=\"number\">3</span>,<span class=\"number\">7</span>,<span class=\"number\">0</span>,<span class=\"number\">4</span>,<span class=\"number\">4</span>,<span class=\"number\">7</span>,<span class=\"number\">6</span>,<span class=\"number\">4</span>,<span class=\"number\">4</span>,<span class=\"number\">8</span>,<span class=\"number\">1</span> &#125;;</span><br><span class=\"line\">ull A, B, f[<span class=\"number\">25</span>][<span class=\"number\">25</span>][<span class=\"number\">2</span>][<span class=\"number\">2</span>][<span class=\"number\">2</span>]; <span class=\"keyword\">int</span> na, a[<span class=\"number\">25</span>], nb, b[<span class=\"number\">25</span>];</span><br><span class=\"line\"><span class=\"function\">ull <span class=\"title\">dp</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> j, <span class=\"keyword\">int</span> leA, <span class=\"keyword\">int</span> leB, <span class=\"keyword\">int</span> hv0)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!i) <span class=\"keyword\">return</span> leA &amp;&amp; (j &lt;= nb || leB);</span><br><span class=\"line\">    ull&amp; res = f[i][j][leA][leB][hv0];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(~res) <span class=\"keyword\">return</span> res; res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(s, <span class=\"number\">0</span>, j &gt; nb ? <span class=\"number\">0</span> : leA ? <span class=\"number\">9</span> : a[i]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> Hv0 = hv0 &amp; !s;</span><br><span class=\"line\">        res += <span class=\"built_in\">dp</span>(i - <span class=\"number\">1</span>, j &gt; nb ? j : j + !Hv0, leA || s &lt; a[i], j &gt; nb ? leB : !Hv0 &amp;&amp; (s &lt; b[j] || (s == b[j] &amp;&amp; leB)), Hv0);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ull <span class=\"title\">calc</span><span class=\"params\">(ull A, ull B)</span> </span>&#123;</span><br><span class=\"line\">    na = nb = <span class=\"number\">0</span>, <span class=\"built_in\">mem</span>(f, <span class=\"number\">-1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(A) <span class=\"keyword\">while</span>(A) a[++na] = A % <span class=\"number\">10</span>, A /= <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">20</span>) a[++na] = U64[i];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(B) <span class=\"keyword\">while</span>(B) b[++nb] = B % <span class=\"number\">10</span>, B /= <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">20</span>) b[++nb] = U64[i];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">dp</span>(na, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> T; cin &gt;&gt; T;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(kase, <span class=\"number\">1</span>, T) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%llu%llu&quot;</span>, &amp;A, &amp;B), B++;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;Case %d: %llu\\n&quot;</span>, kase, <span class=\"built_in\">calc</span>(B, B) - <span class=\"built_in\">calc</span>(A, B) - <span class=\"built_in\">calc</span>(B, A) + <span class=\"built_in\">calc</span>(A, A));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2157,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;category=244&amp;page=show_problem&amp;problem=3364\"></a></p>\r\n<p> <span class=\"math inline\">\\(A\\)</span><span class=\"math inline\">\\(B\\)</span> <span class=\"math inline\">\\((A \\le B &lt; 2^{64})\\)</span> <span class=\"math inline\">\\(n\\)</span> : <span class=\"math inline\">\\(A \\le n \\le B \\land A \\le rev(n) \\le B\\)</span><span class=\"math inline\">\\(rev(1203)=3021\\)</span><span class=\"math inline\">\\(rev(1050)=501\\)</span></p>\r\n</blockquote>\r\n<p> DP</p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(A\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(B\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(j\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(j\\)</span> </li>\r\n<li></li>\r\n<li><code>DP</code> </li>\r\n</ul>\r\n<p> DP  <span class=\"math inline\">\\(0/1/2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\text{calc}(A, B)\\)</span>  <span class=\"math inline\">\\(n\\)</span> : <span class=\"math inline\">\\(n&lt;A \\land rev(n)&lt;B\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\text{calc}(B+1,B+1)-\\text{calc}(A,B+1)-\\text{calc}(B+1,A)+\\text{calc}(A,A)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\text{calc}\\)</span>  DP</p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(A\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(j\\)</span> </li>\r\n<li></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(0/1/2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\({(i,leA,j,leB,hv0)}\\)</span>,  <span class=\"math inline\">\\(i-1\\)</span>  <span class=\"math inline\">\\(s\\)</span>.</p>\r\n<p><span class=\"math inline\">\\(hv0=0\\lor s&gt;0\\)</span>) <span class=\"math display\">\\[\r\n(i-1,leA\\lor s&lt;a_{i-1},j+1,s&lt;b_{j+1}\\lor (s=b_{j+1}\\land leB),0)\\leftarrow (i,leA,j,leB,0)\r\n\\]</span>  <span class=\"math display\">\\[\r\n(i-1,leA\\lor s&lt;a_{i-1},1,0,1)\\leftarrow (i,leA,1,0,1)\r\n\\]</span>  <span class=\"math inline\">\\(\\text{calc}\\)</span>  <span class=\"math inline\">\\(A=2^{64}\\)</span>  <span class=\"math inline\">\\(B=2^{64}\\)</span> </p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++) </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ull;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> U64[] = &#123; <span class=\"number\">0</span>,<span class=\"number\">6</span>,<span class=\"number\">1</span>,<span class=\"number\">6</span>,<span class=\"number\">1</span>,<span class=\"number\">5</span>,<span class=\"number\">5</span>,<span class=\"number\">9</span>,<span class=\"number\">0</span>,<span class=\"number\">7</span>,<span class=\"number\">3</span>,<span class=\"number\">7</span>,<span class=\"number\">0</span>,<span class=\"number\">4</span>,<span class=\"number\">4</span>,<span class=\"number\">7</span>,<span class=\"number\">6</span>,<span class=\"number\">4</span>,<span class=\"number\">4</span>,<span class=\"number\">8</span>,<span class=\"number\">1</span> &#125;;</span><br><span class=\"line\">ull A, B, f[<span class=\"number\">25</span>][<span class=\"number\">25</span>][<span class=\"number\">2</span>][<span class=\"number\">2</span>][<span class=\"number\">2</span>]; <span class=\"keyword\">int</span> na, a[<span class=\"number\">25</span>], nb, b[<span class=\"number\">25</span>];</span><br><span class=\"line\"><span class=\"function\">ull <span class=\"title\">dp</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> j, <span class=\"keyword\">int</span> leA, <span class=\"keyword\">int</span> leB, <span class=\"keyword\">int</span> hv0)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!i) <span class=\"keyword\">return</span> leA &amp;&amp; (j &lt;= nb || leB);</span><br><span class=\"line\">    ull&amp; res = f[i][j][leA][leB][hv0];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(~res) <span class=\"keyword\">return</span> res; res = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(s, <span class=\"number\">0</span>, j &gt; nb ? <span class=\"number\">0</span> : leA ? <span class=\"number\">9</span> : a[i]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> Hv0 = hv0 &amp; !s;</span><br><span class=\"line\">        res += <span class=\"built_in\">dp</span>(i - <span class=\"number\">1</span>, j &gt; nb ? j : j + !Hv0, leA || s &lt; a[i], j &gt; nb ? leB : !Hv0 &amp;&amp; (s &lt; b[j] || (s == b[j] &amp;&amp; leB)), Hv0);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ull <span class=\"title\">calc</span><span class=\"params\">(ull A, ull B)</span> </span>&#123;</span><br><span class=\"line\">    na = nb = <span class=\"number\">0</span>, <span class=\"built_in\">mem</span>(f, <span class=\"number\">-1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(A) <span class=\"keyword\">while</span>(A) a[++na] = A % <span class=\"number\">10</span>, A /= <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">20</span>) a[++na] = U64[i];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(B) <span class=\"keyword\">while</span>(B) b[++nb] = B % <span class=\"number\">10</span>, B /= <span class=\"number\">10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">20</span>) b[++nb] = U64[i];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">dp</span>(na, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> T; cin &gt;&gt; T;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(kase, <span class=\"number\">1</span>, T) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%llu%llu&quot;</span>, &amp;A, &amp;B), B++;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;Case %d: %llu\\n&quot;</span>, kase, <span class=\"built_in\">calc</span>(B, B) - <span class=\"built_in\">calc</span>(A, B) - <span class=\"built_in\">calc</span>(B, A) + <span class=\"built_in\">calc</span>(A, A));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"TheCowDivOne | TopCoder 11351","date":"2021-03-13T13:48:41.000Z","updated":"2021-03-13T13:48:41.000Z","_content":"> [](https://vjudge.net/problem/TopCoder-11351/origin)\n>\n>  $n, k$\n>\n>  $0,1,2,\\cdots,n-1$  $k$  $n$  $10^9+7$\n>\n> $n \\le 10^9, k \\le 1000$\n\n $k - 1$  $2$ \n\n $2$  $3$ $\\cdots$\n\n $x$  $t$  $k - t$  $S$\n$$\ntx + S \\equiv 0\\pmod n\n$$\n $[0, n)$ \n$$\n\\gcd(t,n)|S\n$$\n\n$$\n\\gcd(t,n)\n$$\n $f_{i,S}$  $i$  $S$ \n$$\nf_{i,S} = \\frac 1i \\sum_{j = 1}^i (-1)^{j+1} \\frac nS\\gcd(j,S) f_{i-j,\\gcd(j,S)}\n$$\n $\\frac nS$  $[0,\\ n)$  $\\frac 1i$  \n $S=n$  $S|(k-i)$ $k\\log k$ $O(k^2\\log k)$\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nusing ll = long long;\nconst int N = 1005;\nconst ll P = 1e9 + 7;\n\nll inv[N], f[N][N];\n\nstruct TheCowDivOne {\n    int find(int n, int k) {\n        inv[1] = 1;\n        rep(i, 2, k) inv[i] = (P - P / i) * inv[P % i] % P;\n        rep(s, 1, k) f[0][s] = 1;\n        rep(i, 1, k) rep(s, 1, k) if((k - i) % s == 0) {\n            ll& re = f[i][s];\n            rep(j, 1, i) {\n                int g = __gcd(j, s);\n                (re += (j & 1 ? 1 : -1) * n / s * g * f[i - j][g]) %= P;\n            }\n            re = re * inv[i] % P;\n        }\n        ll as = 0;\n        rep(j, 1, k) {\n            int g = __gcd(j, n);\n            (as += (j & 1 ? 1 : -1) * g * f[k - j][g]) %= P;\n        }\n        return (as + P) * inv[k] % P;\n    }\n};\n```","source":"_posts/TC11351.md","raw":"---\ntitle: TheCowDivOne | TopCoder 11351\ndate: 2021-03-13 21:48:41\nupdated: 2021-03-13 21:48:41\ntags: [,,]\ncategories: TopCoder\n---\n> [](https://vjudge.net/problem/TopCoder-11351/origin)\n>\n>  $n, k$\n>\n>  $0,1,2,\\cdots,n-1$  $k$  $n$  $10^9+7$\n>\n> $n \\le 10^9, k \\le 1000$\n\n $k - 1$  $2$ \n\n $2$  $3$ $\\cdots$\n\n $x$  $t$  $k - t$  $S$\n$$\ntx + S \\equiv 0\\pmod n\n$$\n $[0, n)$ \n$$\n\\gcd(t,n)|S\n$$\n\n$$\n\\gcd(t,n)\n$$\n $f_{i,S}$  $i$  $S$ \n$$\nf_{i,S} = \\frac 1i \\sum_{j = 1}^i (-1)^{j+1} \\frac nS\\gcd(j,S) f_{i-j,\\gcd(j,S)}\n$$\n $\\frac nS$  $[0,\\ n)$  $\\frac 1i$  \n $S=n$  $S|(k-i)$ $k\\log k$ $O(k^2\\log k)$\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nusing ll = long long;\nconst int N = 1005;\nconst ll P = 1e9 + 7;\n\nll inv[N], f[N][N];\n\nstruct TheCowDivOne {\n    int find(int n, int k) {\n        inv[1] = 1;\n        rep(i, 2, k) inv[i] = (P - P / i) * inv[P % i] % P;\n        rep(s, 1, k) f[0][s] = 1;\n        rep(i, 1, k) rep(s, 1, k) if((k - i) % s == 0) {\n            ll& re = f[i][s];\n            rep(j, 1, i) {\n                int g = __gcd(j, s);\n                (re += (j & 1 ? 1 : -1) * n / s * g * f[i - j][g]) %= P;\n            }\n            re = re * inv[i] % P;\n        }\n        ll as = 0;\n        rep(j, 1, k) {\n            int g = __gcd(j, n);\n            (as += (j & 1 ? 1 : -1) * g * f[k - j][g]) %= P;\n        }\n        return (as + P) * inv[k] % P;\n    }\n};\n```","slug":"TC11351","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0a0028ootn116ffzdj","content":"<blockquote>\r\n<p><a href=\"https://vjudge.net/problem/TopCoder-11351/origin\"></a></p>\r\n<p> <span class=\"math inline\">\\(n, k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(0,1,2,\\cdots,n-1\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(10^9+7\\)</span></p>\r\n<p><span class=\"math inline\">\\(n \\le 10^9, k \\le 1000\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(k - 1\\)</span>  <span class=\"math inline\">\\(2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(3\\)</span> <span class=\"math inline\">\\(\\cdots\\)</span></p>\r\n<p> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(k - t\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math display\">\\[\r\ntx + S \\equiv 0\\pmod n\r\n\\]</span>  <span class=\"math inline\">\\([0, n)\\)</span>  <span class=\"math display\">\\[\r\n\\gcd(t,n)|S\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\gcd(t,n)\r\n\\]</span>  <span class=\"math inline\">\\(f_{i,S}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math display\">\\[\r\nf_{i,S} = \\frac 1i \\sum_{j = 1}^i (-1)^{j+1} \\frac nS\\gcd(j,S) f_{i-j,\\gcd(j,S)}\r\n\\]</span>  <span class=\"math inline\">\\(\\frac nS\\)</span>  <span class=\"math inline\">\\([0,\\ n)\\)</span>  <span class=\"math inline\">\\(\\frac 1i\\)</span>   <span class=\"math inline\">\\(S=n\\)</span>  <span class=\"math inline\">\\(S|(k-i)\\)</span> <span class=\"math inline\">\\(k\\log k\\)</span> <span class=\"math inline\">\\(O(k^2\\log k)\\)</span></p>\r\n<p> <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1005</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> ll P = <span class=\"number\">1e9</span> + <span class=\"number\">7</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">ll inv[N], f[N][N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">TheCowDivOne</span> &#123;</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">find</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">        inv[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, k) inv[i] = (P - P / i) * inv[P % i] % P;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(s, <span class=\"number\">1</span>, k) f[<span class=\"number\">0</span>][s] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, k) <span class=\"built_in\">rep</span>(s, <span class=\"number\">1</span>, k) <span class=\"keyword\">if</span>((k - i) % s == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            ll&amp; re = f[i][s];</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, i) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">int</span> g = __gcd(j, s);</span><br><span class=\"line\">                (re += (j &amp; <span class=\"number\">1</span> ? <span class=\"number\">1</span> : <span class=\"number\">-1</span>) * n / s * g * f[i - j][g]) %= P;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            re = re * inv[i] % P;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ll as = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, k) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> g = __gcd(j, n);</span><br><span class=\"line\">            (as += (j &amp; <span class=\"number\">1</span> ? <span class=\"number\">1</span> : <span class=\"number\">-1</span>) * g * f[k - j][g]) %= P;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (as + P) * inv[k] % P;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure></p>\r\n","site":{"data":{}},"length":1340,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://vjudge.net/problem/TopCoder-11351/origin\"></a></p>\r\n<p> <span class=\"math inline\">\\(n, k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(0,1,2,\\cdots,n-1\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(10^9+7\\)</span></p>\r\n<p><span class=\"math inline\">\\(n \\le 10^9, k \\le 1000\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(k - 1\\)</span>  <span class=\"math inline\">\\(2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(3\\)</span> <span class=\"math inline\">\\(\\cdots\\)</span></p>\r\n<p> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(k - t\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math display\">\\[\r\ntx + S \\equiv 0\\pmod n\r\n\\]</span>  <span class=\"math inline\">\\([0, n)\\)</span>  <span class=\"math display\">\\[\r\n\\gcd(t,n)|S\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\gcd(t,n)\r\n\\]</span>  <span class=\"math inline\">\\(f_{i,S}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math display\">\\[\r\nf_{i,S} = \\frac 1i \\sum_{j = 1}^i (-1)^{j+1} \\frac nS\\gcd(j,S) f_{i-j,\\gcd(j,S)}\r\n\\]</span>  <span class=\"math inline\">\\(\\frac nS\\)</span>  <span class=\"math inline\">\\([0,\\ n)\\)</span>  <span class=\"math inline\">\\(\\frac 1i\\)</span>   <span class=\"math inline\">\\(S=n\\)</span>  <span class=\"math inline\">\\(S|(k-i)\\)</span> <span class=\"math inline\">\\(k\\log k\\)</span> <span class=\"math inline\">\\(O(k^2\\log k)\\)</span></p>\r\n<p> <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1005</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> ll P = <span class=\"number\">1e9</span> + <span class=\"number\">7</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">ll inv[N], f[N][N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">TheCowDivOne</span> &#123;</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">find</span><span class=\"params\">(<span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">        inv[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, k) inv[i] = (P - P / i) * inv[P % i] % P;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(s, <span class=\"number\">1</span>, k) f[<span class=\"number\">0</span>][s] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, k) <span class=\"built_in\">rep</span>(s, <span class=\"number\">1</span>, k) <span class=\"keyword\">if</span>((k - i) % s == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            ll&amp; re = f[i][s];</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, i) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">int</span> g = __gcd(j, s);</span><br><span class=\"line\">                (re += (j &amp; <span class=\"number\">1</span> ? <span class=\"number\">1</span> : <span class=\"number\">-1</span>) * n / s * g * f[i - j][g]) %= P;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            re = re * inv[i] % P;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ll as = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, k) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> g = __gcd(j, n);</span><br><span class=\"line\">            (as += (j &amp; <span class=\"number\">1</span> ? <span class=\"number\">1</span> : <span class=\"number\">-1</span>) * g * f[k - j][g]) %= P;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (as + P) * inv[k] % P;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure></p>\r\n"},{"title":"Many Slimes | abc 140f","date":"2021-03-13T15:10:49.000Z","updated":"2021-03-13T15:10:49.000Z","_content":"> [](https://atcoder.jp/contests/abc140/tasks/abc140_f)\n>\n>  $s$ \n>\n>  $s$  $s$ \n>\n>  $n$  $2^n$ \n>\n>  $n$  $s$ \n>\n> $n \\le 10^5,s_i \\le 10^9$\n\n $s$  $i$  $s$ \n\n\n\n****\n\n>  $i$ ****  $a, b$ s  $A, B (A < B)$\n>\n>  $a$  $s$  $xy(x < y)$\n>\n>  $y < A$ $s$  $yx$\n>\n>  $a, b$ ****\n>\n>  $y > A$ s \n\n $j(j<2^i)$  $j+2^i$\n\n $s$  ```multiset```  $s$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n\nusing namespace std;\n\nint main() {\n    cin >> n, m = 1 << n;\n    multiset <int, greater <int> > s;\n    For(i, 0, m) s.insert(read());\n    vector <int> c;\n    c.push_back(*s.begin()), s.erase(s.begin());\n    For(i, 0, m) {\n        For(j, 0, 1 << i) {\n            auto it = s.upper_bound(c[j]);\n            if(it != s.end()) c.push_back(*it), s.erase(it);\n            else return puts(\"No\") < 0;\n        }\n    }\n    return puts(\"Yes\") < 0;\n    return 0;\n}\n```\n\n","source":"_posts/abc140f.md","raw":"---\ntitle: Many Slimes | abc 140f\ndate: 2021-03-13 23:10:49\nupdated: 2021-03-13 23:10:49\ntags: [,]\ncategories: ABC\n---\n> [](https://atcoder.jp/contests/abc140/tasks/abc140_f)\n>\n>  $s$ \n>\n>  $s$  $s$ \n>\n>  $n$  $2^n$ \n>\n>  $n$  $s$ \n>\n> $n \\le 10^5,s_i \\le 10^9$\n\n $s$  $i$  $s$ \n\n\n\n****\n\n>  $i$ ****  $a, b$ s  $A, B (A < B)$\n>\n>  $a$  $s$  $xy(x < y)$\n>\n>  $y < A$ $s$  $yx$\n>\n>  $a, b$ ****\n>\n>  $y > A$ s \n\n $j(j<2^i)$  $j+2^i$\n\n $s$  ```multiset```  $s$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n\nusing namespace std;\n\nint main() {\n    cin >> n, m = 1 << n;\n    multiset <int, greater <int> > s;\n    For(i, 0, m) s.insert(read());\n    vector <int> c;\n    c.push_back(*s.begin()), s.erase(s.begin());\n    For(i, 0, m) {\n        For(j, 0, 1 << i) {\n            auto it = s.upper_bound(c[j]);\n            if(it != s.end()) c.push_back(*it), s.erase(it);\n            else return puts(\"No\") < 0;\n        }\n    }\n    return puts(\"Yes\") < 0;\n    return 0;\n}\n```\n\n","slug":"abc140f","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0b002bootngpls904j","content":"<blockquote>\r\n<p><a href=\"https://atcoder.jp/contests/abc140/tasks/abc140_f\"></a></p>\r\n<p> <span class=\"math inline\">\\(s\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(s\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(2^n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(s\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 10^5,s_i \\le 10^9\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(s\\)</span> </p>\r\n<p></p>\r\n<p><strong></strong></p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(i\\)</span> <strong></strong> <span class=\"math inline\">\\(a, b\\)</span> s  <span class=\"math inline\">\\(A, B (A &lt; B)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(xy(x &lt; y)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(y &lt; A\\)</span> <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(yx\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a, b\\)</span> <strong></strong></p>\r\n<p> <span class=\"math inline\">\\(y &gt; A\\)</span> s </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(j(j&lt;2^i)\\)</span>  <span class=\"math inline\">\\(j+2^i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(s\\)</span>  <code>multiset</code>  <span class=\"math inline\">\\(s\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n, m = <span class=\"number\">1</span> &lt;&lt; n;</span><br><span class=\"line\">    multiset &lt;<span class=\"keyword\">int</span>, greater &lt;<span class=\"keyword\">int</span>&gt; &gt; s;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, m) s.<span class=\"built_in\">insert</span>(<span class=\"built_in\">read</span>());</span><br><span class=\"line\">    vector &lt;<span class=\"keyword\">int</span>&gt; c;</span><br><span class=\"line\">    c.<span class=\"built_in\">push_back</span>(*s.<span class=\"built_in\">begin</span>()), s.<span class=\"built_in\">erase</span>(s.<span class=\"built_in\">begin</span>());</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, m) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(j, <span class=\"number\">0</span>, <span class=\"number\">1</span> &lt;&lt; i) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">auto</span> it = s.<span class=\"built_in\">upper_bound</span>(c[j]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(it != s.<span class=\"built_in\">end</span>()) c.<span class=\"built_in\">push_back</span>(*it), s.<span class=\"built_in\">erase</span>(it);</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">return</span> <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;No&quot;</span>) &lt; <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Yes&quot;</span>) &lt; <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":1176,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://atcoder.jp/contests/abc140/tasks/abc140_f\"></a></p>\r\n<p> <span class=\"math inline\">\\(s\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(s\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(2^n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(s\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 10^5,s_i \\le 10^9\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(s\\)</span> </p>\r\n<p></p>\r\n<p><strong></strong></p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(i\\)</span> <strong></strong> <span class=\"math inline\">\\(a, b\\)</span> s  <span class=\"math inline\">\\(A, B (A &lt; B)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(xy(x &lt; y)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(y &lt; A\\)</span> <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(yx\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a, b\\)</span> <strong></strong></p>\r\n<p> <span class=\"math inline\">\\(y &gt; A\\)</span> s </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(j(j&lt;2^i)\\)</span>  <span class=\"math inline\">\\(j+2^i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(s\\)</span>  <code>multiset</code>  <span class=\"math inline\">\\(s\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n, m = <span class=\"number\">1</span> &lt;&lt; n;</span><br><span class=\"line\">    multiset &lt;<span class=\"keyword\">int</span>, greater &lt;<span class=\"keyword\">int</span>&gt; &gt; s;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, m) s.<span class=\"built_in\">insert</span>(<span class=\"built_in\">read</span>());</span><br><span class=\"line\">    vector &lt;<span class=\"keyword\">int</span>&gt; c;</span><br><span class=\"line\">    c.<span class=\"built_in\">push_back</span>(*s.<span class=\"built_in\">begin</span>()), s.<span class=\"built_in\">erase</span>(s.<span class=\"built_in\">begin</span>());</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, m) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(j, <span class=\"number\">0</span>, <span class=\"number\">1</span> &lt;&lt; i) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">auto</span> it = s.<span class=\"built_in\">upper_bound</span>(c[j]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(it != s.<span class=\"built_in\">end</span>()) c.<span class=\"built_in\">push_back</span>(*it), s.<span class=\"built_in\">erase</span>(it);</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">return</span> <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;No&quot;</span>) &lt; <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Yes&quot;</span>) &lt; <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"(False)faces | Cerc2009","date":"2021-09-04T07:58:27.000Z","updated":"2021-09-04T07:58:27.000Z","_content":"> [](https://darkbzoj.tk/problem/2586)\n>\n>  $n$  $4$ \n>\n> $n \\le 300$\n\n\n\n $4$ \n\n\n$$\n\\text{perm }A = \\sum_{p}A_{i,p_i}\n$$\n $A$  $01$ \n$$\n\\text{prem} A = (-1)^n\\sum_{x_i \\in \\{0,1\\}}(-1)^{x1+x2+\\cdots+x_n}\\prod_{i=1}^n(Ax)_i\n$$\n=\n\n $\\prod$  $4$  $(Ax)_i$  $2$  $0$\n\n $(Ax)_i$  $2$  $0$ $n+1$ \n\n $x$ $x$ \n\n $x$ \n\n\n$$\n\\begin{bmatrix}\nA_{1,1}&A_{1,2}&\\cdots &A_{1,n}&v_1\\\\\nA_{2,1}&A_{2,2}&\\cdots &A_{2,n}&v_2\\\\\n\\vdots&&&&\\vdots\\\\\nA_{n,1}&A_{n,2}&\\cdots &A_{n,n}&v_n\\\\\n0&0&\\cdots&0&1\n\\end{bmatrix}\n$$\n\n\n $v$ $O(1)$ \n\n $O(n^4)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nconst int N = 305;\nint T, n, as;\nchar s[N];\nbitset <302> A[N], bas[N];\nint x[N];\nvoid dfs(int i) {\n    if(i > n) {\n        int mul = 1;\n        rep(i, 0, n) {\n            int su = 0;\n            rep(k, 0, n) su += A[i][k] & x[k];\n            (mul *= su) %= 4;\n        }\n        rep(i, 0, n) if(x[i]) mul *= -1;\n        (as += mul) %= 4;\n        return;\n    }\n    if(!bas[i][i]) rep(j, 0, 1) {\n        x[i] = j, dfs(i + 1);\n        rep(k, 0, n) if(bas[k][i]) x[k] ^= 1; \n    } else dfs(i + 1);\n}\nvoid solve() {\n    rep(i, 0, n) bas[i].reset();\n    rep(i, 0, n) {\n        bitset <302> nw = A[i];\n        rep(j, 0, n) if(nw[j]) {\n            if(bas[j][j]) nw ^= bas[j];\n            else { bas[j] = nw; break; }\n        }\n        if(nw[n + 1] && nw.count() == 1) return;\n    }\n    per(i, n, 0) if(bas[i][i]) rep(j, i + 1, n) if(bas[j][j] && bas[i][j]) bas[i] ^= bas[j];\n    rep(i, 0, n) x[i] = bas[i][n + 1];\n    dfs(0);\n}\nint main() {\n    srand(time(0));\n    for(cin >> T; T--;) {\n        scanf(\"%d\", &n), as = 0;\n        rep(i, 0, n) A[i].reset();\n        For(i, 0, n) {\n            scanf(\"%s\", s), A[i][n] = rand() & 1, A[i][n + 1] = 1;\n            For(j, 0, n) A[i][j] = s[j] - 48;\n        }\n        A[n][n] = A[n][n + 1] = 1;\n        solve();\n        rep(i, 0, n) A[i][n + 1] = 0, solve(), A[i][n + 1] = 1;\n        puts(as ? \"NO\" : \"YES\");\n    }\n    return 0;\n}\n```","source":"_posts/cerc2009.md","raw":"---\ntitle: (False)faces | Cerc2009\ndate: 2021-09-04 15:58:27\nupdated: 2021-09-04 15:58:27\ntags: []\ncategories: Cerc\n---\n> [](https://darkbzoj.tk/problem/2586)\n>\n>  $n$  $4$ \n>\n> $n \\le 300$\n\n\n\n $4$ \n\n\n$$\n\\text{perm }A = \\sum_{p}A_{i,p_i}\n$$\n $A$  $01$ \n$$\n\\text{prem} A = (-1)^n\\sum_{x_i \\in \\{0,1\\}}(-1)^{x1+x2+\\cdots+x_n}\\prod_{i=1}^n(Ax)_i\n$$\n=\n\n $\\prod$  $4$  $(Ax)_i$  $2$  $0$\n\n $(Ax)_i$  $2$  $0$ $n+1$ \n\n $x$ $x$ \n\n $x$ \n\n\n$$\n\\begin{bmatrix}\nA_{1,1}&A_{1,2}&\\cdots &A_{1,n}&v_1\\\\\nA_{2,1}&A_{2,2}&\\cdots &A_{2,n}&v_2\\\\\n\\vdots&&&&\\vdots\\\\\nA_{n,1}&A_{n,2}&\\cdots &A_{n,n}&v_n\\\\\n0&0&\\cdots&0&1\n\\end{bmatrix}\n$$\n\n\n $v$ $O(1)$ \n\n $O(n^4)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nconst int N = 305;\nint T, n, as;\nchar s[N];\nbitset <302> A[N], bas[N];\nint x[N];\nvoid dfs(int i) {\n    if(i > n) {\n        int mul = 1;\n        rep(i, 0, n) {\n            int su = 0;\n            rep(k, 0, n) su += A[i][k] & x[k];\n            (mul *= su) %= 4;\n        }\n        rep(i, 0, n) if(x[i]) mul *= -1;\n        (as += mul) %= 4;\n        return;\n    }\n    if(!bas[i][i]) rep(j, 0, 1) {\n        x[i] = j, dfs(i + 1);\n        rep(k, 0, n) if(bas[k][i]) x[k] ^= 1; \n    } else dfs(i + 1);\n}\nvoid solve() {\n    rep(i, 0, n) bas[i].reset();\n    rep(i, 0, n) {\n        bitset <302> nw = A[i];\n        rep(j, 0, n) if(nw[j]) {\n            if(bas[j][j]) nw ^= bas[j];\n            else { bas[j] = nw; break; }\n        }\n        if(nw[n + 1] && nw.count() == 1) return;\n    }\n    per(i, n, 0) if(bas[i][i]) rep(j, i + 1, n) if(bas[j][j] && bas[i][j]) bas[i] ^= bas[j];\n    rep(i, 0, n) x[i] = bas[i][n + 1];\n    dfs(0);\n}\nint main() {\n    srand(time(0));\n    for(cin >> T; T--;) {\n        scanf(\"%d\", &n), as = 0;\n        rep(i, 0, n) A[i].reset();\n        For(i, 0, n) {\n            scanf(\"%s\", s), A[i][n] = rand() & 1, A[i][n + 1] = 1;\n            For(j, 0, n) A[i][j] = s[j] - 48;\n        }\n        A[n][n] = A[n][n + 1] = 1;\n        solve();\n        rep(i, 0, n) A[i][n + 1] = 0, solve(), A[i][n + 1] = 1;\n        puts(as ? \"NO\" : \"YES\");\n    }\n    return 0;\n}\n```","slug":"cerc2009","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0e002footncyti6e54","content":"<blockquote>\r\n<p><a href=\"https://darkbzoj.tk/problem/2586\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(4\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 300\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(4\\)</span> </p>\r\n<p> <span class=\"math display\">\\[\r\n\\text{perm }A = \\sum_{p}A_{i,p_i}\r\n\\]</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(01\\)</span>  <span class=\"math display\">\\[\r\n\\text{prem} A = (-1)^n\\sum_{x_i \\in \\{0,1\\}}(-1)^{x1+x2+\\cdots+x_n}\\prod_{i=1}^n(Ax)_i\r\n\\]</span> =</p>\r\n<p> <span class=\"math inline\">\\(\\prod\\)</span>  <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\((Ax)_i\\)</span>  <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\((Ax)_i\\)</span>  <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(n+1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(x\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(x\\)</span> </p>\r\n<p> <span class=\"math display\">\\[\r\n\\begin{bmatrix}\r\nA_{1,1}&amp;A_{1,2}&amp;\\cdots &amp;A_{1,n}&amp;v_1\\\\\r\nA_{2,1}&amp;A_{2,2}&amp;\\cdots &amp;A_{2,n}&amp;v_2\\\\\r\n\\vdots&amp;&amp;&amp;&amp;\\vdots\\\\\r\nA_{n,1}&amp;A_{n,2}&amp;\\cdots &amp;A_{n,n}&amp;v_n\\\\\r\n0&amp;0&amp;\\cdots&amp;0&amp;1\r\n\\end{bmatrix}\r\n\\]</span> </p>\r\n<p> <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\(O(1)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^4)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">305</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> T, n, as;</span><br><span class=\"line\"><span class=\"keyword\">char</span> s[N];</span><br><span class=\"line\">bitset &lt;302&gt; A[N], bas[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> x[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i &gt; n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> mul = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> su = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(k, <span class=\"number\">0</span>, n) su += A[i][k] &amp; x[k];</span><br><span class=\"line\">            (mul *= su) %= <span class=\"number\">4</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) <span class=\"keyword\">if</span>(x[i]) mul *= <span class=\"number\">-1</span>;</span><br><span class=\"line\">        (as += mul) %= <span class=\"number\">4</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!bas[i][i]) <span class=\"built_in\">rep</span>(j, <span class=\"number\">0</span>, <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        x[i] = j, <span class=\"built_in\">dfs</span>(i + <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(k, <span class=\"number\">0</span>, n) <span class=\"keyword\">if</span>(bas[k][i]) x[k] ^= <span class=\"number\">1</span>; </span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"built_in\">dfs</span>(i + <span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) bas[i].<span class=\"built_in\">reset</span>();</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) &#123;</span><br><span class=\"line\">        bitset &lt;302&gt; nw = A[i];</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">0</span>, n) <span class=\"keyword\">if</span>(nw[j]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(bas[j][j]) nw ^= bas[j];</span><br><span class=\"line\">            <span class=\"keyword\">else</span> &#123; bas[j] = nw; <span class=\"keyword\">break</span>; &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(nw[n + <span class=\"number\">1</span>] &amp;&amp; nw.<span class=\"built_in\">count</span>() == <span class=\"number\">1</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, n, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(bas[i][i]) <span class=\"built_in\">rep</span>(j, i + <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(bas[j][j] &amp;&amp; bas[i][j]) bas[i] ^= bas[j];</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) x[i] = bas[i][n + <span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">srand</span>(<span class=\"built_in\">time</span>(<span class=\"number\">0</span>));</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(cin &gt;&gt; T; T--;) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;n), as = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) A[i].<span class=\"built_in\">reset</span>();</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, n) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%s&quot;</span>, s), A[i][n] = <span class=\"built_in\">rand</span>() &amp; <span class=\"number\">1</span>, A[i][n + <span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">For</span>(j, <span class=\"number\">0</span>, n) A[i][j] = s[j] - <span class=\"number\">48</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        A[n][n] = A[n][n + <span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">solve</span>();</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) A[i][n + <span class=\"number\">1</span>] = <span class=\"number\">0</span>, <span class=\"built_in\">solve</span>(), A[i][n + <span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">puts</span>(as ? <span class=\"string\">&quot;NO&quot;</span> : <span class=\"string\">&quot;YES&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2183,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://darkbzoj.tk/problem/2586\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(4\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 300\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(4\\)</span> </p>\r\n<p> <span class=\"math display\">\\[\r\n\\text{perm }A = \\sum_{p}A_{i,p_i}\r\n\\]</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(01\\)</span>  <span class=\"math display\">\\[\r\n\\text{prem} A = (-1)^n\\sum_{x_i \\in \\{0,1\\}}(-1)^{x1+x2+\\cdots+x_n}\\prod_{i=1}^n(Ax)_i\r\n\\]</span> =</p>\r\n<p> <span class=\"math inline\">\\(\\prod\\)</span>  <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\((Ax)_i\\)</span>  <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\((Ax)_i\\)</span>  <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(n+1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(x\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(x\\)</span> </p>\r\n<p> <span class=\"math display\">\\[\r\n\\begin{bmatrix}\r\nA_{1,1}&amp;A_{1,2}&amp;\\cdots &amp;A_{1,n}&amp;v_1\\\\\r\nA_{2,1}&amp;A_{2,2}&amp;\\cdots &amp;A_{2,n}&amp;v_2\\\\\r\n\\vdots&amp;&amp;&amp;&amp;\\vdots\\\\\r\nA_{n,1}&amp;A_{n,2}&amp;\\cdots &amp;A_{n,n}&amp;v_n\\\\\r\n0&amp;0&amp;\\cdots&amp;0&amp;1\r\n\\end{bmatrix}\r\n\\]</span> </p>\r\n<p> <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\(O(1)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^4)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">305</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> T, n, as;</span><br><span class=\"line\"><span class=\"keyword\">char</span> s[N];</span><br><span class=\"line\">bitset &lt;302&gt; A[N], bas[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> x[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i &gt; n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> mul = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> su = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(k, <span class=\"number\">0</span>, n) su += A[i][k] &amp; x[k];</span><br><span class=\"line\">            (mul *= su) %= <span class=\"number\">4</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) <span class=\"keyword\">if</span>(x[i]) mul *= <span class=\"number\">-1</span>;</span><br><span class=\"line\">        (as += mul) %= <span class=\"number\">4</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!bas[i][i]) <span class=\"built_in\">rep</span>(j, <span class=\"number\">0</span>, <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        x[i] = j, <span class=\"built_in\">dfs</span>(i + <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(k, <span class=\"number\">0</span>, n) <span class=\"keyword\">if</span>(bas[k][i]) x[k] ^= <span class=\"number\">1</span>; </span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"built_in\">dfs</span>(i + <span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) bas[i].<span class=\"built_in\">reset</span>();</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) &#123;</span><br><span class=\"line\">        bitset &lt;302&gt; nw = A[i];</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">0</span>, n) <span class=\"keyword\">if</span>(nw[j]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(bas[j][j]) nw ^= bas[j];</span><br><span class=\"line\">            <span class=\"keyword\">else</span> &#123; bas[j] = nw; <span class=\"keyword\">break</span>; &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(nw[n + <span class=\"number\">1</span>] &amp;&amp; nw.<span class=\"built_in\">count</span>() == <span class=\"number\">1</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, n, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(bas[i][i]) <span class=\"built_in\">rep</span>(j, i + <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(bas[j][j] &amp;&amp; bas[i][j]) bas[i] ^= bas[j];</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) x[i] = bas[i][n + <span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">srand</span>(<span class=\"built_in\">time</span>(<span class=\"number\">0</span>));</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(cin &gt;&gt; T; T--;) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;n), as = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) A[i].<span class=\"built_in\">reset</span>();</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, n) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%s&quot;</span>, s), A[i][n] = <span class=\"built_in\">rand</span>() &amp; <span class=\"number\">1</span>, A[i][n + <span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">For</span>(j, <span class=\"number\">0</span>, n) A[i][j] = s[j] - <span class=\"number\">48</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        A[n][n] = A[n][n + <span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">solve</span>();</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) A[i][n + <span class=\"number\">1</span>] = <span class=\"number\">0</span>, <span class=\"built_in\">solve</span>(), A[i][n + <span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">puts</span>(as ? <span class=\"string\">&quot;NO&quot;</span> : <span class=\"string\">&quot;YES&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":" C++11  C++17","date":"2021-09-01T08:30:02.000Z","updated":"2021-09-01T08:30:02.000Z","_content":" `C++17`\n\n `C++11`  `C++14`  `C++17` \n\n### lambda \n\n lambda  `auto`\n\n```cpp\nauto lambda = [](auto x, auto y) { return x + y; };\n// since C++14\n```\n\n lambda \n\n```cpp\nint a = 1, b = 2, c = 3;\nauto lambda1 = [value = a + b] { return value + c; };\n// since C++14\n```\n\n lambda  `*this`\n\n```cpp\nstruct node { int value; void func(); };\nint node::func() {\n    auto lambda = [this]() { return ++value; }; // by reference\n    return lambda();\n}\n// since C++11\nstruct node { int value; void func(); };\nint node::func() {\n    auto lambda = [*this]() { return ++value; }; // by copy\n    return lambda();\n}\n// since C++17\n```\n\n### \n\n`C++11`  lambda  `auto``C++14`  `return` \n\n```cpp\nauto factorial(int n) {\n    if(n == 0) return 1;\n    return factorial(n - 1) * n;\n}\n// since C++14\n```\n\n\n\n```cpp\nauto factorial(int n) {\n    if(n) return factorial(n - 1) * n;\n    return 1;\n}\n```\n\n### \n\n\n\n```cpp\npair a(1, 2.2);\nvector b{1, 2, 3};\nset c{1, 2, 3};\ntuple d(1, 2.2, a);\n// since C++17\n```\n\n### \n\n `C++11`  `tie` \n\n```cpp\nvector a{pair(1, 2), pair(2, 3)};\nauto [first, second] = a[0];\ncout << first << ' ' << second << endl;\nfor(auto& [first, second] : a) first++, second++; // by reference\nfor(auto [first, second] : a) cout << first << ' ' << second << endl; // by copy\n// since C++17\n```\n\n### `if` \n\n`if`  `for` \n\n```cpp\nif(int value = func(); value < 100) cout << value;\n// since C++17\n```\n\n### \n\n `0b`  `0B`\n\n `s` `string` \n\n `i``if``il`  `complex<double>``complex<float>`  `complex<long double>` \n\n```cpp\nauto str = \"hello world\"s; // string\nauto value = 0b1010; // 10\nauto z = 1i; // complex<double>\n// since C++14\n```\n\n### \n\n\n\n```cpp\ntemplate<class ...T> auto sum(T ...value) { return value + ...; }\n// since C++17\n```\n\n### namespace \n\n```cpp\nnamespace A {\n    namespace B {\n        namespace C {\n            int func();\n        }\n    }\n}\nnamespace A::B::C {\n    int func() { return 100; }\n}\n// since C++17\n```\n\n### \n\n`from_chars`  `const char*` \n\n`to_chars`  `const char*`\n\n","source":"_posts/cong-c11-dao-c17.md","raw":"---\ntitle:  C++11  C++17\ndate: 2021-09-01 16:30:02\nupdated: 2021-09-01 16:30:02\ntags: []\n---\n `C++17`\n\n `C++11`  `C++14`  `C++17` \n\n### lambda \n\n lambda  `auto`\n\n```cpp\nauto lambda = [](auto x, auto y) { return x + y; };\n// since C++14\n```\n\n lambda \n\n```cpp\nint a = 1, b = 2, c = 3;\nauto lambda1 = [value = a + b] { return value + c; };\n// since C++14\n```\n\n lambda  `*this`\n\n```cpp\nstruct node { int value; void func(); };\nint node::func() {\n    auto lambda = [this]() { return ++value; }; // by reference\n    return lambda();\n}\n// since C++11\nstruct node { int value; void func(); };\nint node::func() {\n    auto lambda = [*this]() { return ++value; }; // by copy\n    return lambda();\n}\n// since C++17\n```\n\n### \n\n`C++11`  lambda  `auto``C++14`  `return` \n\n```cpp\nauto factorial(int n) {\n    if(n == 0) return 1;\n    return factorial(n - 1) * n;\n}\n// since C++14\n```\n\n\n\n```cpp\nauto factorial(int n) {\n    if(n) return factorial(n - 1) * n;\n    return 1;\n}\n```\n\n### \n\n\n\n```cpp\npair a(1, 2.2);\nvector b{1, 2, 3};\nset c{1, 2, 3};\ntuple d(1, 2.2, a);\n// since C++17\n```\n\n### \n\n `C++11`  `tie` \n\n```cpp\nvector a{pair(1, 2), pair(2, 3)};\nauto [first, second] = a[0];\ncout << first << ' ' << second << endl;\nfor(auto& [first, second] : a) first++, second++; // by reference\nfor(auto [first, second] : a) cout << first << ' ' << second << endl; // by copy\n// since C++17\n```\n\n### `if` \n\n`if`  `for` \n\n```cpp\nif(int value = func(); value < 100) cout << value;\n// since C++17\n```\n\n### \n\n `0b`  `0B`\n\n `s` `string` \n\n `i``if``il`  `complex<double>``complex<float>`  `complex<long double>` \n\n```cpp\nauto str = \"hello world\"s; // string\nauto value = 0b1010; // 10\nauto z = 1i; // complex<double>\n// since C++14\n```\n\n### \n\n\n\n```cpp\ntemplate<class ...T> auto sum(T ...value) { return value + ...; }\n// since C++17\n```\n\n### namespace \n\n```cpp\nnamespace A {\n    namespace B {\n        namespace C {\n            int func();\n        }\n    }\n}\nnamespace A::B::C {\n    int func() { return 100; }\n}\n// since C++17\n```\n\n### \n\n`from_chars`  `const char*` \n\n`to_chars`  `const char*`\n\n","slug":"cong-c11-dao-c17","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0f002jootn27mhbaai","content":"<p> <code>C++17</code></p>\r\n<p> <code>C++11</code>  <code>C++14</code>  <code>C++17</code> </p>\r\n<h3 id=\"lambda-\">lambda </h3>\r\n<p> lambda  <code>auto</code></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">auto</span> lambda = [](<span class=\"keyword\">auto</span> x, <span class=\"keyword\">auto</span> y) &#123; <span class=\"keyword\">return</span> x + y; &#125;;</span><br><span class=\"line\"><span class=\"comment\">// since C++14</span></span><br></pre></td></tr></table></figure>\r\n<p> lambda </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a = <span class=\"number\">1</span>, b = <span class=\"number\">2</span>, c = <span class=\"number\">3</span>;</span><br><span class=\"line\"><span class=\"keyword\">auto</span> lambda1 = [value = a + b] &#123; <span class=\"keyword\">return</span> value + c; &#125;;</span><br><span class=\"line\"><span class=\"comment\">// since C++14</span></span><br></pre></td></tr></table></figure>\r\n<p> lambda  <code>*this</code></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span> &#123;</span> <span class=\"keyword\">int</span> value; <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">func</span><span class=\"params\">()</span></span>; &#125;;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">node::func</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> lambda = [<span class=\"keyword\">this</span>]() &#123; <span class=\"keyword\">return</span> ++value; &#125;; <span class=\"comment\">// by reference</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">lambda</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// since C++11</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span> &#123;</span> <span class=\"keyword\">int</span> value; <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">func</span><span class=\"params\">()</span></span>; &#125;;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">node::func</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> lambda = [*<span class=\"keyword\">this</span>]() &#123; <span class=\"keyword\">return</span> ++value; &#125;; <span class=\"comment\">// by copy</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">lambda</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// since C++17</span></span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<p><code>C++11</code>  lambda  <code>auto</code><code>C++14</code>  <code>return</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">auto</span> <span class=\"title\">factorial</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">factorial</span>(n - <span class=\"number\">1</span>) * n;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// since C++14</span></span><br></pre></td></tr></table></figure>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">auto</span> <span class=\"title\">factorial</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n) <span class=\"keyword\">return</span> <span class=\"built_in\">factorial</span>(n - <span class=\"number\">1</span>) * n;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">pair <span class=\"title\">a</span><span class=\"params\">(<span class=\"number\">1</span>, <span class=\"number\">2.2</span>)</span></span>;</span><br><span class=\"line\">vector b&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>&#125;;</span><br><span class=\"line\">set c&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>&#125;;</span><br><span class=\"line\"><span class=\"function\">tuple <span class=\"title\">d</span><span class=\"params\">(<span class=\"number\">1</span>, <span class=\"number\">2.2</span>, a)</span></span>;</span><br><span class=\"line\"><span class=\"comment\">// since C++17</span></span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<p> <code>C++11</code>  <code>tie</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vector a&#123;<span class=\"built_in\">pair</span>(<span class=\"number\">1</span>, <span class=\"number\">2</span>), <span class=\"built_in\">pair</span>(<span class=\"number\">2</span>, <span class=\"number\">3</span>)&#125;;</span><br><span class=\"line\"><span class=\"keyword\">auto</span> [first, second] = a[<span class=\"number\">0</span>];</span><br><span class=\"line\">cout &lt;&lt; first &lt;&lt; <span class=\"string\">&#x27; &#x27;</span> &lt;&lt; second &lt;&lt; endl;</span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span>&amp; [first, second] : a) first++, second++; <span class=\"comment\">// by reference</span></span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [first, second] : a) cout &lt;&lt; first &lt;&lt; <span class=\"string\">&#x27; &#x27;</span> &lt;&lt; second &lt;&lt; endl; <span class=\"comment\">// by copy</span></span><br><span class=\"line\"><span class=\"comment\">// since C++17</span></span><br></pre></td></tr></table></figure>\r\n<h3 id=\"if-\"><code>if</code> </h3>\r\n<p><code>if</code>  <code>for</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">int</span> value = <span class=\"built_in\">func</span>(); value &lt; <span class=\"number\">100</span>) cout &lt;&lt; value;</span><br><span class=\"line\"><span class=\"comment\">// since C++17</span></span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<p> <code>0b</code>  <code>0B</code></p>\r\n<p> <code>s</code> <code>string</code> </p>\r\n<p> <code>i</code><code>if</code><code>il</code>  <code>complex&lt;double&gt;</code><code>complex&lt;float&gt;</code>  <code>complex&lt;long double&gt;</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">auto</span> str = <span class=\"string\">&quot;hello world&quot;</span>s; <span class=\"comment\">// string</span></span><br><span class=\"line\"><span class=\"keyword\">auto</span> value = <span class=\"number\">0b1010</span>; <span class=\"comment\">// 10</span></span><br><span class=\"line\"><span class=\"keyword\">auto</span> z = <span class=\"number\">1</span>i; <span class=\"comment\">// complex&lt;double&gt;</span></span><br><span class=\"line\"><span class=\"comment\">// since C++14</span></span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">template</span>&lt;class ...T&gt; <span class=\"keyword\">auto</span> <span class=\"title\">sum</span><span class=\"params\">(T ...value)</span> </span>&#123; <span class=\"keyword\">return</span> value + ...; &#125;</span><br><span class=\"line\"><span class=\"comment\">// since C++17</span></span><br></pre></td></tr></table></figure>\r\n<h3 id=\"namespace-\">namespace </h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">namespace</span> A &#123;</span><br><span class=\"line\">    <span class=\"keyword\">namespace</span> B &#123;</span><br><span class=\"line\">        <span class=\"keyword\">namespace</span> C &#123;</span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">func</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> A::B::C &#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">func</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> <span class=\"number\">100</span>; &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// since C++17</span></span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<p><code>from_chars</code>  <code>const char*</code> </p>\r\n<p><code>to_chars</code>  <code>const char*</code></p>\r\n","site":{"data":{}},"length":2034,"excerpt":"","more":"<p> <code>C++17</code></p>\r\n<p> <code>C++11</code>  <code>C++14</code>  <code>C++17</code> </p>\r\n<h3 id=\"lambda-\">lambda </h3>\r\n<p> lambda  <code>auto</code></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">auto</span> lambda = [](<span class=\"keyword\">auto</span> x, <span class=\"keyword\">auto</span> y) &#123; <span class=\"keyword\">return</span> x + y; &#125;;</span><br><span class=\"line\"><span class=\"comment\">// since C++14</span></span><br></pre></td></tr></table></figure>\r\n<p> lambda </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a = <span class=\"number\">1</span>, b = <span class=\"number\">2</span>, c = <span class=\"number\">3</span>;</span><br><span class=\"line\"><span class=\"keyword\">auto</span> lambda1 = [value = a + b] &#123; <span class=\"keyword\">return</span> value + c; &#125;;</span><br><span class=\"line\"><span class=\"comment\">// since C++14</span></span><br></pre></td></tr></table></figure>\r\n<p> lambda  <code>*this</code></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span> &#123;</span> <span class=\"keyword\">int</span> value; <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">func</span><span class=\"params\">()</span></span>; &#125;;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">node::func</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> lambda = [<span class=\"keyword\">this</span>]() &#123; <span class=\"keyword\">return</span> ++value; &#125;; <span class=\"comment\">// by reference</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">lambda</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// since C++11</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span> &#123;</span> <span class=\"keyword\">int</span> value; <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">func</span><span class=\"params\">()</span></span>; &#125;;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">node::func</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> lambda = [*<span class=\"keyword\">this</span>]() &#123; <span class=\"keyword\">return</span> ++value; &#125;; <span class=\"comment\">// by copy</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">lambda</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// since C++17</span></span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<p><code>C++11</code>  lambda  <code>auto</code><code>C++14</code>  <code>return</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">auto</span> <span class=\"title\">factorial</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">factorial</span>(n - <span class=\"number\">1</span>) * n;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// since C++14</span></span><br></pre></td></tr></table></figure>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">auto</span> <span class=\"title\">factorial</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n) <span class=\"keyword\">return</span> <span class=\"built_in\">factorial</span>(n - <span class=\"number\">1</span>) * n;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">pair <span class=\"title\">a</span><span class=\"params\">(<span class=\"number\">1</span>, <span class=\"number\">2.2</span>)</span></span>;</span><br><span class=\"line\">vector b&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>&#125;;</span><br><span class=\"line\">set c&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>&#125;;</span><br><span class=\"line\"><span class=\"function\">tuple <span class=\"title\">d</span><span class=\"params\">(<span class=\"number\">1</span>, <span class=\"number\">2.2</span>, a)</span></span>;</span><br><span class=\"line\"><span class=\"comment\">// since C++17</span></span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<p> <code>C++11</code>  <code>tie</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vector a&#123;<span class=\"built_in\">pair</span>(<span class=\"number\">1</span>, <span class=\"number\">2</span>), <span class=\"built_in\">pair</span>(<span class=\"number\">2</span>, <span class=\"number\">3</span>)&#125;;</span><br><span class=\"line\"><span class=\"keyword\">auto</span> [first, second] = a[<span class=\"number\">0</span>];</span><br><span class=\"line\">cout &lt;&lt; first &lt;&lt; <span class=\"string\">&#x27; &#x27;</span> &lt;&lt; second &lt;&lt; endl;</span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span>&amp; [first, second] : a) first++, second++; <span class=\"comment\">// by reference</span></span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [first, second] : a) cout &lt;&lt; first &lt;&lt; <span class=\"string\">&#x27; &#x27;</span> &lt;&lt; second &lt;&lt; endl; <span class=\"comment\">// by copy</span></span><br><span class=\"line\"><span class=\"comment\">// since C++17</span></span><br></pre></td></tr></table></figure>\r\n<h3 id=\"if-\"><code>if</code> </h3>\r\n<p><code>if</code>  <code>for</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">int</span> value = <span class=\"built_in\">func</span>(); value &lt; <span class=\"number\">100</span>) cout &lt;&lt; value;</span><br><span class=\"line\"><span class=\"comment\">// since C++17</span></span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<p> <code>0b</code>  <code>0B</code></p>\r\n<p> <code>s</code> <code>string</code> </p>\r\n<p> <code>i</code><code>if</code><code>il</code>  <code>complex&lt;double&gt;</code><code>complex&lt;float&gt;</code>  <code>complex&lt;long double&gt;</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">auto</span> str = <span class=\"string\">&quot;hello world&quot;</span>s; <span class=\"comment\">// string</span></span><br><span class=\"line\"><span class=\"keyword\">auto</span> value = <span class=\"number\">0b1010</span>; <span class=\"comment\">// 10</span></span><br><span class=\"line\"><span class=\"keyword\">auto</span> z = <span class=\"number\">1</span>i; <span class=\"comment\">// complex&lt;double&gt;</span></span><br><span class=\"line\"><span class=\"comment\">// since C++14</span></span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">template</span>&lt;class ...T&gt; <span class=\"keyword\">auto</span> <span class=\"title\">sum</span><span class=\"params\">(T ...value)</span> </span>&#123; <span class=\"keyword\">return</span> value + ...; &#125;</span><br><span class=\"line\"><span class=\"comment\">// since C++17</span></span><br></pre></td></tr></table></figure>\r\n<h3 id=\"namespace-\">namespace </h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">namespace</span> A &#123;</span><br><span class=\"line\">    <span class=\"keyword\">namespace</span> B &#123;</span><br><span class=\"line\">        <span class=\"keyword\">namespace</span> C &#123;</span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">func</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> A::B::C &#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">func</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> <span class=\"number\">100</span>; &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// since C++17</span></span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<p><code>from_chars</code>  <code>const char*</code> </p>\r\n<p><code>to_chars</code>  <code>const char*</code></p>\r\n"},{"title":" & Min-25  & Powerful Number ","date":"2021-03-13T15:13:29.000Z","updated":"2021-03-13T15:13:29.000Z","_content":">  $f(x)$ $\\sum\\limits_{i=1}^Nf(i)$\n\n### \n\n $g(x)$ $S(x) = \\sum\\limits_{i=1}^x f(i)$ $S(N)$\n\n****\n$$\ng(1)S(n) = \\sum\\limits_{i=1}^n (f*g)(i) - \\sum\\limits_{i=2}^n g(i)S(\\big\\lfloor \\dfrac n i \\big\\rfloor)\n$$\n $g(x)$  $(f*g)(x)$ \n\n****\n\n $S(1) - S(N^{\\frac 2 3})$ $S(x)$$x$  $\\big\\lfloor\\dfrac N i \\big \\rfloor$ $F_i$  $S(x)$\n\n $O(n^{\\frac 2 3})$\n\n### Min-25 \n\n$p_i$  $i$ $d_i$  $i$ \n\n$S(n, i) = \\sum\\limits_{j = 2}^n [d_j > p_i]f(j)$\n\n $S(N, 0)$\n\n $S(n, i) = \\sum\\limits_{j = i+1}^{p_j \\le n} f(p_j) + \\sum\\limits_{j = i+1}^{p_j^2 \\le n}\\sum\\limits_{k=1}^{p_j^k \\le n} f(p_j^k)(S(\\big\\lfloor \\dfrac n{p_j^k} \\big\\rfloor, j) + [k>1])$\n\n $f(p^k)$  $0$****\n\n\n\n $h(x)$  $h(p) = f(p)$\n\n $g(n, i) = \\sum\\limits_{j=2}^n [j \\in P \\lor d_j > p_i]h(j)$\n\n $g(n, i) = g(n, i - 1) - h(p_i)(g(\\big\\lfloor\\dfrac n {p_i} \\big\\rfloor, i - 1) - \\sum\\limits_{j=1}^{i-1}h(p_j))$\n\n $p_ip_j(j < i)$  $p_i$\n\n $n < p_i^2$ $g(n,i)=g(n,i-1)$\n\n $n$  $\\big\\lfloor\\dfrac N i \\big \\rfloor$ $j \\le \\sqrt N$\n\n $g(n, 0) = \\sum\\limits_{i=2}^n h(i)$** $1$ **\n\n $j$\n\n>  1 - n \n>\n> $n \\le 10^{11}$\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n\nusing namespace std;\nconstexpr int N = sqrt(1e11) + 5;\ntypedef long long ll;\nll n, f1[N], f2[N];\nint main() {\n    cin >> n;\n    int lim = sqrt(n);\n    rep(i, 1, lim) f1[i] = i - 1, f2[i] = n / i - 1;\n\n    rep(p, 2, lim) if (f1[p] ^ f1[p - 1]) {\n        int w1 = lim / p;\n        ll x = f1[p - 1], w3 = (ll)p * p, w2 = min((ll)lim, n / w3), d = n / p;\n        rep(i, 1, w1) f2[i] -= f2[i * p] - x;\n        rep(i, w1 + 1, w2) f2[i] -= f1[d / i] - x;\n        per(i, lim, w3) f1[i] -= f1[i / p] - x;\n    }\n\n    cout << f2[1];\n    return 0;\n}\n```\n\n#### \n\n ```double```  ```long long```  $1-\\sqrt n$ \n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n\nusing namespace std;\nconstexpr int N = sqrt(1e11) + 5;\nconst double Eps = 1e-7;\ntypedef long long ll;\nll n, f1[N], f2[N];\ndouble inv[N];\nint main() {\n    cin >> n;\n    int lim = sqrt(n);\n    rep(i, 1, lim) f1[i] = i - 1, f2[i] = n / i - 1, inv[i] = 1.0 / i;\n\n    rep(p, 2, lim) if (f1[p] ^ f1[p - 1]) {\n        int w1 = lim / p;\n        ll x = f1[p - 1], w3 = (ll)p * p, w2 = min((ll)lim, n / w3), d = n / p;\n        rep(i, 1, w1) f2[i] -= f2[i * p] - x;\n        rep(i, w1 + 1, w2) f2[i] -= f1[int(d * inv[i] + Eps)] - x;\n        per(i, lim, w3) f1[i] -= f1[int(i * inv[p] + Eps)] - x;\n    }\n\n    cout << f2[1];\n    return 0;\n}\n```\n\n### Powerful Number \n\n $1$  ```Powerful Number```\n\n $a^2b^3$\n\n> $n$  ```Powerful Number```  $O(\\sqrt n)$ \n>\n>  $a$\n> $$\n> \\sum_{i=1}^{\\sqrt n}\\sqrt[3] {\\frac n{a^2}} < \\int_0^{\\sqrt n - 1}\\sqrt[3] {\\frac n{a^2}}da = 3n^\\frac 13(\\sqrt n - 1)^\\frac 13 < 3\\sqrt n\n> $$\n\n ```Powerful Number```  $0$\n\n**** $g(x)$  $g(x)=f(x) (x \\in Prime)$ $f(x)=\\sum\\limits_{ab=x}g(a)h(b)$ $h(x)$  ```Powerful Number```  $0$\n\n $h(x)$  $p^k(p \\in Prime,k > 1)$  $O(\\sqrt N)$ $O(1)$  $h(p^k)$  $O(k)$ \n\n\n$$\n\\sum_{i=1}^Nf(i)=\\sum_{ab \\le N}g(a)h(b)=\\sum_{b=1}^Nh(b)\\sum_{a=1}^{\\lfloor \\frac Na \\rfloor}g(a)\n$$\n $g(x)$  $\\lfloor \\frac Na \\rfloor$ ","source":"_posts/du-jiao-shai-and-min-25-shai-and-powerful-number-shai.md","raw":"---\ntitle:  & Min-25  & Powerful Number \ndate: 2021-03-13 23:13:29\nupdated: 2021-03-13 23:13:29\ntags: [,,,Min-25 ,Powerful Number ]\ncategories: \n---\n>  $f(x)$ $\\sum\\limits_{i=1}^Nf(i)$\n\n### \n\n $g(x)$ $S(x) = \\sum\\limits_{i=1}^x f(i)$ $S(N)$\n\n****\n$$\ng(1)S(n) = \\sum\\limits_{i=1}^n (f*g)(i) - \\sum\\limits_{i=2}^n g(i)S(\\big\\lfloor \\dfrac n i \\big\\rfloor)\n$$\n $g(x)$  $(f*g)(x)$ \n\n****\n\n $S(1) - S(N^{\\frac 2 3})$ $S(x)$$x$  $\\big\\lfloor\\dfrac N i \\big \\rfloor$ $F_i$  $S(x)$\n\n $O(n^{\\frac 2 3})$\n\n### Min-25 \n\n$p_i$  $i$ $d_i$  $i$ \n\n$S(n, i) = \\sum\\limits_{j = 2}^n [d_j > p_i]f(j)$\n\n $S(N, 0)$\n\n $S(n, i) = \\sum\\limits_{j = i+1}^{p_j \\le n} f(p_j) + \\sum\\limits_{j = i+1}^{p_j^2 \\le n}\\sum\\limits_{k=1}^{p_j^k \\le n} f(p_j^k)(S(\\big\\lfloor \\dfrac n{p_j^k} \\big\\rfloor, j) + [k>1])$\n\n $f(p^k)$  $0$****\n\n\n\n $h(x)$  $h(p) = f(p)$\n\n $g(n, i) = \\sum\\limits_{j=2}^n [j \\in P \\lor d_j > p_i]h(j)$\n\n $g(n, i) = g(n, i - 1) - h(p_i)(g(\\big\\lfloor\\dfrac n {p_i} \\big\\rfloor, i - 1) - \\sum\\limits_{j=1}^{i-1}h(p_j))$\n\n $p_ip_j(j < i)$  $p_i$\n\n $n < p_i^2$ $g(n,i)=g(n,i-1)$\n\n $n$  $\\big\\lfloor\\dfrac N i \\big \\rfloor$ $j \\le \\sqrt N$\n\n $g(n, 0) = \\sum\\limits_{i=2}^n h(i)$** $1$ **\n\n $j$\n\n>  1 - n \n>\n> $n \\le 10^{11}$\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n\nusing namespace std;\nconstexpr int N = sqrt(1e11) + 5;\ntypedef long long ll;\nll n, f1[N], f2[N];\nint main() {\n    cin >> n;\n    int lim = sqrt(n);\n    rep(i, 1, lim) f1[i] = i - 1, f2[i] = n / i - 1;\n\n    rep(p, 2, lim) if (f1[p] ^ f1[p - 1]) {\n        int w1 = lim / p;\n        ll x = f1[p - 1], w3 = (ll)p * p, w2 = min((ll)lim, n / w3), d = n / p;\n        rep(i, 1, w1) f2[i] -= f2[i * p] - x;\n        rep(i, w1 + 1, w2) f2[i] -= f1[d / i] - x;\n        per(i, lim, w3) f1[i] -= f1[i / p] - x;\n    }\n\n    cout << f2[1];\n    return 0;\n}\n```\n\n#### \n\n ```double```  ```long long```  $1-\\sqrt n$ \n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n\nusing namespace std;\nconstexpr int N = sqrt(1e11) + 5;\nconst double Eps = 1e-7;\ntypedef long long ll;\nll n, f1[N], f2[N];\ndouble inv[N];\nint main() {\n    cin >> n;\n    int lim = sqrt(n);\n    rep(i, 1, lim) f1[i] = i - 1, f2[i] = n / i - 1, inv[i] = 1.0 / i;\n\n    rep(p, 2, lim) if (f1[p] ^ f1[p - 1]) {\n        int w1 = lim / p;\n        ll x = f1[p - 1], w3 = (ll)p * p, w2 = min((ll)lim, n / w3), d = n / p;\n        rep(i, 1, w1) f2[i] -= f2[i * p] - x;\n        rep(i, w1 + 1, w2) f2[i] -= f1[int(d * inv[i] + Eps)] - x;\n        per(i, lim, w3) f1[i] -= f1[int(i * inv[p] + Eps)] - x;\n    }\n\n    cout << f2[1];\n    return 0;\n}\n```\n\n### Powerful Number \n\n $1$  ```Powerful Number```\n\n $a^2b^3$\n\n> $n$  ```Powerful Number```  $O(\\sqrt n)$ \n>\n>  $a$\n> $$\n> \\sum_{i=1}^{\\sqrt n}\\sqrt[3] {\\frac n{a^2}} < \\int_0^{\\sqrt n - 1}\\sqrt[3] {\\frac n{a^2}}da = 3n^\\frac 13(\\sqrt n - 1)^\\frac 13 < 3\\sqrt n\n> $$\n\n ```Powerful Number```  $0$\n\n**** $g(x)$  $g(x)=f(x) (x \\in Prime)$ $f(x)=\\sum\\limits_{ab=x}g(a)h(b)$ $h(x)$  ```Powerful Number```  $0$\n\n $h(x)$  $p^k(p \\in Prime,k > 1)$  $O(\\sqrt N)$ $O(1)$  $h(p^k)$  $O(k)$ \n\n\n$$\n\\sum_{i=1}^Nf(i)=\\sum_{ab \\le N}g(a)h(b)=\\sum_{b=1}^Nh(b)\\sum_{a=1}^{\\lfloor \\frac Na \\rfloor}g(a)\n$$\n $g(x)$  $\\lfloor \\frac Na \\rfloor$ ","slug":"du-jiao-shai-and-min-25-shai-and-powerful-number-shai","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0i002mootn52vu9bia","content":"<blockquote>\r\n<p> <span class=\"math inline\">\\(f(x)\\)</span> <span class=\"math inline\">\\(\\sum\\limits_{i=1}^Nf(i)\\)</span></p>\r\n</blockquote>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(g(x)\\)</span> <span class=\"math inline\">\\(S(x) = \\sum\\limits_{i=1}^x f(i)\\)</span> <span class=\"math inline\">\\(S(N)\\)</span></p>\r\n<p><strong></strong> <span class=\"math display\">\\[\r\ng(1)S(n) = \\sum\\limits_{i=1}^n (f*g)(i) - \\sum\\limits_{i=2}^n g(i)S(\\big\\lfloor \\dfrac n i \\big\\rfloor)\r\n\\]</span>  <span class=\"math inline\">\\(g(x)\\)</span>  <span class=\"math inline\">\\((f*g)(x)\\)</span> </p>\r\n<p><strong></strong></p>\r\n<p> <span class=\"math inline\">\\(S(1) - S(N^{\\frac 2 3})\\)</span> <span class=\"math inline\">\\(S(x)\\)</span><span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(\\big\\lfloor\\dfrac N i \\big \\rfloor\\)</span> <span class=\"math inline\">\\(F_i\\)</span>  <span class=\"math inline\">\\(S(x)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n^{\\frac 2 3})\\)</span></p>\r\n<h3 id=\"min-25-\">Min-25 </h3>\r\n<p><span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(d_i\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p><span class=\"math inline\">\\(S(n, i) = \\sum\\limits_{j = 2}^n [d_j &gt; p_i]f(j)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S(N, 0)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S(n, i) = \\sum\\limits_{j = i+1}^{p_j \\le n} f(p_j) + \\sum\\limits_{j = i+1}^{p_j^2 \\le n}\\sum\\limits_{k=1}^{p_j^k \\le n} f(p_j^k)(S(\\big\\lfloor \\dfrac n{p_j^k} \\big\\rfloor, j) + [k&gt;1])\\)</span></p>\r\n<p> <span class=\"math inline\">\\(f(p^k)\\)</span>  <span class=\"math inline\">\\(0\\)</span><strong></strong></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(h(x)\\)</span>  <span class=\"math inline\">\\(h(p) = f(p)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(g(n, i) = \\sum\\limits_{j=2}^n [j \\in P \\lor d_j &gt; p_i]h(j)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(g(n, i) = g(n, i - 1) - h(p_i)(g(\\big\\lfloor\\dfrac n {p_i} \\big\\rfloor, i - 1) - \\sum\\limits_{j=1}^{i-1}h(p_j))\\)</span></p>\r\n<p> <span class=\"math inline\">\\(p_ip_j(j &lt; i)\\)</span>  <span class=\"math inline\">\\(p_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n &lt; p_i^2\\)</span> <span class=\"math inline\">\\(g(n,i)=g(n,i-1)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(\\big\\lfloor\\dfrac N i \\big \\rfloor\\)</span> <span class=\"math inline\">\\(j \\le \\sqrt N\\)</span></p>\r\n<p> <span class=\"math inline\">\\(g(n, 0) = \\sum\\limits_{i=2}^n h(i)\\)</span><strong> <span class=\"math inline\">\\(1\\)</span> </strong></p>\r\n<p> <span class=\"math inline\">\\(j\\)</span></p>\r\n<blockquote>\r\n<p> 1 - n </p>\r\n<p><span class=\"math inline\">\\(n \\le 10^{11}\\)</span></p>\r\n</blockquote>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">constexpr</span> <span class=\"keyword\">int</span> N = <span class=\"built_in\">sqrt</span>(<span class=\"number\">1e11</span>) + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\">ll n, f1[N], f2[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> lim = <span class=\"built_in\">sqrt</span>(n);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, lim) f1[i] = i - <span class=\"number\">1</span>, f2[i] = n / i - <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(p, <span class=\"number\">2</span>, lim) <span class=\"keyword\">if</span> (f1[p] ^ f1[p - <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> w1 = lim / p;</span><br><span class=\"line\">        ll x = f1[p - <span class=\"number\">1</span>], w3 = (ll)p * p, w2 = <span class=\"built_in\">min</span>((ll)lim, n / w3), d = n / p;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, w1) f2[i] -= f2[i * p] - x;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, w1 + <span class=\"number\">1</span>, w2) f2[i] -= f1[d / i] - x;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(i, lim, w3) f1[i] -= f1[i / p] - x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    cout &lt;&lt; f2[<span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"\"></h4>\r\n<p> <code>double</code>  <code>long long</code>  <span class=\"math inline\">\\(1-\\sqrt n\\)</span> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">constexpr</span> <span class=\"keyword\">int</span> N = <span class=\"built_in\">sqrt</span>(<span class=\"number\">1e11</span>) + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">double</span> Eps = <span class=\"number\">1e-7</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\">ll n, f1[N], f2[N];</span><br><span class=\"line\"><span class=\"keyword\">double</span> inv[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> lim = <span class=\"built_in\">sqrt</span>(n);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, lim) f1[i] = i - <span class=\"number\">1</span>, f2[i] = n / i - <span class=\"number\">1</span>, inv[i] = <span class=\"number\">1.0</span> / i;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(p, <span class=\"number\">2</span>, lim) <span class=\"keyword\">if</span> (f1[p] ^ f1[p - <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> w1 = lim / p;</span><br><span class=\"line\">        ll x = f1[p - <span class=\"number\">1</span>], w3 = (ll)p * p, w2 = <span class=\"built_in\">min</span>((ll)lim, n / w3), d = n / p;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, w1) f2[i] -= f2[i * p] - x;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, w1 + <span class=\"number\">1</span>, w2) f2[i] -= f1[<span class=\"built_in\"><span class=\"keyword\">int</span></span>(d * inv[i] + Eps)] - x;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(i, lim, w3) f1[i] -= f1[<span class=\"built_in\"><span class=\"keyword\">int</span></span>(i * inv[p] + Eps)] - x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    cout &lt;&lt; f2[<span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"powerful-number-\">Powerful Number </h3>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <code>Powerful Number</code></p>\r\n<p> <span class=\"math inline\">\\(a^2b^3\\)</span></p>\r\n<blockquote>\r\n<p><span class=\"math inline\">\\(n\\)</span>  <code>Powerful Number</code>  <span class=\"math inline\">\\(O(\\sqrt n)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(a\\)</span> <span class=\"math display\">\\[\r\n\\sum_{i=1}^{\\sqrt n}\\sqrt[3] {\\frac n{a^2}} &lt; \\int_0^{\\sqrt n - 1}\\sqrt[3] {\\frac n{a^2}}da = 3n^\\frac 13(\\sqrt n - 1)^\\frac 13 &lt; 3\\sqrt n\r\n\\]</span></p>\r\n</blockquote>\r\n<p> <code>Powerful Number</code>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p><strong></strong> <span class=\"math inline\">\\(g(x)\\)</span>  <span class=\"math inline\">\\(g(x)=f(x) (x \\in Prime)\\)</span> <span class=\"math inline\">\\(f(x)=\\sum\\limits_{ab=x}g(a)h(b)\\)</span> <span class=\"math inline\">\\(h(x)\\)</span>  <code>Powerful Number</code>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(h(x)\\)</span>  <span class=\"math inline\">\\(p^k(p \\in Prime,k &gt; 1)\\)</span>  <span class=\"math inline\">\\(O(\\sqrt N)\\)</span> <span class=\"math inline\">\\(O(1)\\)</span>  <span class=\"math inline\">\\(h(p^k)\\)</span>  <span class=\"math inline\">\\(O(k)\\)</span> </p>\r\n<p> <span class=\"math display\">\\[\r\n\\sum_{i=1}^Nf(i)=\\sum_{ab \\le N}g(a)h(b)=\\sum_{b=1}^Nh(b)\\sum_{a=1}^{\\lfloor \\frac Na \\rfloor}g(a)\r\n\\]</span>  <span class=\"math inline\">\\(g(x)\\)</span>  <span class=\"math inline\">\\(\\lfloor \\frac Na \\rfloor\\)</span> </p>\r\n","site":{"data":{}},"length":3081,"excerpt":"","more":"<blockquote>\r\n<p> <span class=\"math inline\">\\(f(x)\\)</span> <span class=\"math inline\">\\(\\sum\\limits_{i=1}^Nf(i)\\)</span></p>\r\n</blockquote>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(g(x)\\)</span> <span class=\"math inline\">\\(S(x) = \\sum\\limits_{i=1}^x f(i)\\)</span> <span class=\"math inline\">\\(S(N)\\)</span></p>\r\n<p><strong></strong> <span class=\"math display\">\\[\r\ng(1)S(n) = \\sum\\limits_{i=1}^n (f*g)(i) - \\sum\\limits_{i=2}^n g(i)S(\\big\\lfloor \\dfrac n i \\big\\rfloor)\r\n\\]</span>  <span class=\"math inline\">\\(g(x)\\)</span>  <span class=\"math inline\">\\((f*g)(x)\\)</span> </p>\r\n<p><strong></strong></p>\r\n<p> <span class=\"math inline\">\\(S(1) - S(N^{\\frac 2 3})\\)</span> <span class=\"math inline\">\\(S(x)\\)</span><span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(\\big\\lfloor\\dfrac N i \\big \\rfloor\\)</span> <span class=\"math inline\">\\(F_i\\)</span>  <span class=\"math inline\">\\(S(x)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n^{\\frac 2 3})\\)</span></p>\r\n<h3 id=\"min-25-\">Min-25 </h3>\r\n<p><span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(d_i\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p><span class=\"math inline\">\\(S(n, i) = \\sum\\limits_{j = 2}^n [d_j &gt; p_i]f(j)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S(N, 0)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S(n, i) = \\sum\\limits_{j = i+1}^{p_j \\le n} f(p_j) + \\sum\\limits_{j = i+1}^{p_j^2 \\le n}\\sum\\limits_{k=1}^{p_j^k \\le n} f(p_j^k)(S(\\big\\lfloor \\dfrac n{p_j^k} \\big\\rfloor, j) + [k&gt;1])\\)</span></p>\r\n<p> <span class=\"math inline\">\\(f(p^k)\\)</span>  <span class=\"math inline\">\\(0\\)</span><strong></strong></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(h(x)\\)</span>  <span class=\"math inline\">\\(h(p) = f(p)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(g(n, i) = \\sum\\limits_{j=2}^n [j \\in P \\lor d_j &gt; p_i]h(j)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(g(n, i) = g(n, i - 1) - h(p_i)(g(\\big\\lfloor\\dfrac n {p_i} \\big\\rfloor, i - 1) - \\sum\\limits_{j=1}^{i-1}h(p_j))\\)</span></p>\r\n<p> <span class=\"math inline\">\\(p_ip_j(j &lt; i)\\)</span>  <span class=\"math inline\">\\(p_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n &lt; p_i^2\\)</span> <span class=\"math inline\">\\(g(n,i)=g(n,i-1)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(\\big\\lfloor\\dfrac N i \\big \\rfloor\\)</span> <span class=\"math inline\">\\(j \\le \\sqrt N\\)</span></p>\r\n<p> <span class=\"math inline\">\\(g(n, 0) = \\sum\\limits_{i=2}^n h(i)\\)</span><strong> <span class=\"math inline\">\\(1\\)</span> </strong></p>\r\n<p> <span class=\"math inline\">\\(j\\)</span></p>\r\n<blockquote>\r\n<p> 1 - n </p>\r\n<p><span class=\"math inline\">\\(n \\le 10^{11}\\)</span></p>\r\n</blockquote>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">constexpr</span> <span class=\"keyword\">int</span> N = <span class=\"built_in\">sqrt</span>(<span class=\"number\">1e11</span>) + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\">ll n, f1[N], f2[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> lim = <span class=\"built_in\">sqrt</span>(n);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, lim) f1[i] = i - <span class=\"number\">1</span>, f2[i] = n / i - <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(p, <span class=\"number\">2</span>, lim) <span class=\"keyword\">if</span> (f1[p] ^ f1[p - <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> w1 = lim / p;</span><br><span class=\"line\">        ll x = f1[p - <span class=\"number\">1</span>], w3 = (ll)p * p, w2 = <span class=\"built_in\">min</span>((ll)lim, n / w3), d = n / p;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, w1) f2[i] -= f2[i * p] - x;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, w1 + <span class=\"number\">1</span>, w2) f2[i] -= f1[d / i] - x;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(i, lim, w3) f1[i] -= f1[i / p] - x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    cout &lt;&lt; f2[<span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"\"></h4>\r\n<p> <code>double</code>  <code>long long</code>  <span class=\"math inline\">\\(1-\\sqrt n\\)</span> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">constexpr</span> <span class=\"keyword\">int</span> N = <span class=\"built_in\">sqrt</span>(<span class=\"number\">1e11</span>) + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">double</span> Eps = <span class=\"number\">1e-7</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\">ll n, f1[N], f2[N];</span><br><span class=\"line\"><span class=\"keyword\">double</span> inv[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> lim = <span class=\"built_in\">sqrt</span>(n);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, lim) f1[i] = i - <span class=\"number\">1</span>, f2[i] = n / i - <span class=\"number\">1</span>, inv[i] = <span class=\"number\">1.0</span> / i;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(p, <span class=\"number\">2</span>, lim) <span class=\"keyword\">if</span> (f1[p] ^ f1[p - <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> w1 = lim / p;</span><br><span class=\"line\">        ll x = f1[p - <span class=\"number\">1</span>], w3 = (ll)p * p, w2 = <span class=\"built_in\">min</span>((ll)lim, n / w3), d = n / p;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, w1) f2[i] -= f2[i * p] - x;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, w1 + <span class=\"number\">1</span>, w2) f2[i] -= f1[<span class=\"built_in\"><span class=\"keyword\">int</span></span>(d * inv[i] + Eps)] - x;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(i, lim, w3) f1[i] -= f1[<span class=\"built_in\"><span class=\"keyword\">int</span></span>(i * inv[p] + Eps)] - x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    cout &lt;&lt; f2[<span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"powerful-number-\">Powerful Number </h3>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <code>Powerful Number</code></p>\r\n<p> <span class=\"math inline\">\\(a^2b^3\\)</span></p>\r\n<blockquote>\r\n<p><span class=\"math inline\">\\(n\\)</span>  <code>Powerful Number</code>  <span class=\"math inline\">\\(O(\\sqrt n)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(a\\)</span> <span class=\"math display\">\\[\r\n\\sum_{i=1}^{\\sqrt n}\\sqrt[3] {\\frac n{a^2}} &lt; \\int_0^{\\sqrt n - 1}\\sqrt[3] {\\frac n{a^2}}da = 3n^\\frac 13(\\sqrt n - 1)^\\frac 13 &lt; 3\\sqrt n\r\n\\]</span></p>\r\n</blockquote>\r\n<p> <code>Powerful Number</code>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p><strong></strong> <span class=\"math inline\">\\(g(x)\\)</span>  <span class=\"math inline\">\\(g(x)=f(x) (x \\in Prime)\\)</span> <span class=\"math inline\">\\(f(x)=\\sum\\limits_{ab=x}g(a)h(b)\\)</span> <span class=\"math inline\">\\(h(x)\\)</span>  <code>Powerful Number</code>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(h(x)\\)</span>  <span class=\"math inline\">\\(p^k(p \\in Prime,k &gt; 1)\\)</span>  <span class=\"math inline\">\\(O(\\sqrt N)\\)</span> <span class=\"math inline\">\\(O(1)\\)</span>  <span class=\"math inline\">\\(h(p^k)\\)</span>  <span class=\"math inline\">\\(O(k)\\)</span> </p>\r\n<p> <span class=\"math display\">\\[\r\n\\sum_{i=1}^Nf(i)=\\sum_{ab \\le N}g(a)h(b)=\\sum_{b=1}^Nh(b)\\sum_{a=1}^{\\lfloor \\frac Na \\rfloor}g(a)\r\n\\]</span>  <span class=\"math inline\">\\(g(x)\\)</span>  <span class=\"math inline\">\\(\\lfloor \\frac Na \\rfloor\\)</span> </p>\r\n"},{"title":"","date":"2021-03-13T13:36:41.000Z","updated":"2021-03-13T13:36:41.000Z","_content":"> [Play](https://playgameoflife.com/)\n>\n> \n>\n> -  - ****\n>\n> - 22\n>\n> - 23\n>\n> - 3\n>\n> - 3\n>\n>   \n\n\n\n1.  230   \n```plain\n     \n   \n     \n```\n\n2.   \n```plain\n                  \n     3      \n                  \n```\n\n3.  650  4 \n```plain\n                  \n     7      \n                  \n```\n\n4.  2500  20 \n```plain\n                  \n    10      \n                  \n```\n\n5. \n```plain\n                     \n        2      \n                     \n```","source":"_posts/guan-yu-xi-bao-zi-dong-ji-kang-wei-sheng-ming-you-xi.md","raw":"---\ntitle: \ndate: 2021-03-13 21:36:41\nupdated: 2021-03-13 21:36:41\ntags: []\n---\n> [Play](https://playgameoflife.com/)\n>\n> \n>\n> -  - ****\n>\n> - 22\n>\n> - 23\n>\n> - 3\n>\n> - 3\n>\n>   \n\n\n\n1.  230   \n```plain\n     \n   \n     \n```\n\n2.   \n```plain\n                  \n     3      \n                  \n```\n\n3.  650  4 \n```plain\n                  \n     7      \n                  \n```\n\n4.  2500  20 \n```plain\n                  \n    10      \n                  \n```\n\n5. \n```plain\n                     \n        2      \n                     \n```","slug":"guan-yu-xi-bao-zi-dong-ji-kang-wei-sheng-ming-you-xi","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0j002pootn6jdncae6","content":"<blockquote>\r\n<p><a href=\"https://playgameoflife.com/\">Play</a></p>\r\n<p></p>\r\n<ul>\r\n<li><p> - <strong></strong></p></li>\r\n<li><p>22</p></li>\r\n<li><p>23</p></li>\r\n<li><p>3</p></li>\r\n<li><p>3</p>\r\n<p></p></li>\r\n</ul>\r\n</blockquote>\r\n<p> 1.  230 <br />\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">     </span><br><span class=\"line\">   </span><br><span class=\"line\">     </span><br></pre></td></tr></table></figure></p>\r\n<ol start=\"2\" type=\"1\">\r\n<li><p><br />\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">                  </span><br><span class=\"line\">     3      </span><br><span class=\"line\">                  </span><br></pre></td></tr></table></figure></p></li>\r\n<li><p> 650  4  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">                  </span><br><span class=\"line\">     7      </span><br><span class=\"line\">                  </span><br></pre></td></tr></table></figure></p></li>\r\n<li><p> 2500  20  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">                  </span><br><span class=\"line\">    10      </span><br><span class=\"line\">                  </span><br></pre></td></tr></table></figure></p></li>\r\n<li><p> <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">                  </span><br><span class=\"line\">     2      </span><br><span class=\"line\">                  </span><br></pre></td></tr></table></figure></p></li>\r\n</ol>\r\n","site":{"data":{}},"length":438,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://playgameoflife.com/\">Play</a></p>\r\n<p></p>\r\n<ul>\r\n<li><p> - <strong></strong></p></li>\r\n<li><p>22</p></li>\r\n<li><p>23</p></li>\r\n<li><p>3</p></li>\r\n<li><p>3</p>\r\n<p></p></li>\r\n</ul>\r\n</blockquote>\r\n<p> 1.  230 <br />\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">     </span><br><span class=\"line\">   </span><br><span class=\"line\">     </span><br></pre></td></tr></table></figure></p>\r\n<ol start=\"2\" type=\"1\">\r\n<li><p><br />\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">                  </span><br><span class=\"line\">     3      </span><br><span class=\"line\">                  </span><br></pre></td></tr></table></figure></p></li>\r\n<li><p> 650  4  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">                  </span><br><span class=\"line\">     7      </span><br><span class=\"line\">                  </span><br></pre></td></tr></table></figure></p></li>\r\n<li><p> 2500  20  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">                  </span><br><span class=\"line\">    10      </span><br><span class=\"line\">                  </span><br></pre></td></tr></table></figure></p></li>\r\n<li><p> <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">                  </span><br><span class=\"line\">     2      </span><br><span class=\"line\">                  </span><br></pre></td></tr></table></figure></p></li>\r\n</ol>\r\n"},{"title":"Gridea C++ ","date":"2021-08-23T10:53:32.000Z","updated":"2021-08-23T10:53:32.000Z","hidden":true,"_content":"\n\n `html`  `Gridea`  `C++` \n\n```plain\n<details><summary></summary>\n<pre><code class=\"language-cpp\">#include &lt;bits/stdc++.h&gt;<br>\nint main() {\n    int a, b;\n    scanf(\"%d%d\", &a, &b);\n    printf(\"%d\\n\", a + b);\n}\n</code></pre></details>\n```\n\n`C++` \n\n-  `<`  `&lt;``>`  `&gt;`\n\n-  `<br>` \n\n `markdown` \n\n\n\n<details><summary></summary>\n<pre><code class=\"language-cpp\">#include &lt;bits/stdc++.h&gt;<br>\nint main() {\n    int a, b;\n    scanf(\"%d%d\", &a, &b);\n    printf(\"%d\\n\", a + b);\n}\n</code></pre></details>\n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary><pre><code class=\"language-cpp\">#include &lt;bits/stdc++.h&gt;<br>\nusing namespace std;<br>\nint main(int argc, char* argv[]) {\n    if(argc &lt; 3) exit(0);\n    freopen(argv[1], \"r\", stdin), freopen(argv[2], \"w\", stdout);\n    ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n    set&lt;int&gt; rows;\n    int tmp;\n    for(int i = 3; i &lt; argc; i++) sscanf(argv[i], \"%d\", &tmp), rows.insert(tmp);\n    string str, CodeBlock;\n    bool isCodeBlock = false;\n    for(int row = 1; getline(cin, str); row++)\n    if(isCodeBlock) {\n        if(str == \"```\") cout &lt;&lt; CodeBlock + \"&lt;/code&gt;&lt;/pre&gt;&lt;/details&gt;\\n\", isCodeBlock = false;\n        else if(str == \"\") CodeBlock.insert(CodeBlock.size() - (CodeBlock.back() == '\\n'), \"&lt;br&gt;\");\n        else {\n            for(char ch : str) if(ch == '&lt;') CodeBlock += \"&lt;\";\n            else if(ch == '&gt;') CodeBlock += \"&gt;\";\n            else CodeBlock += ch;\n            CodeBlock += '\\n';\n        }\n    } else {\n        if(str == \"```cpp\" && (argc == 3 || rows.count(row)))\n            CodeBlock = \"&lt;details&gt;&lt;summary&gt;&lt;span style=\\\"font-size: large; font-weight: bold; color: rgb(33,150,243);\\\"&gt;&lt;/span&gt;&lt;/summary&gt;&lt;pre&gt;&lt;code class=\\\"language-cpp\\\"&gt;\", isCodeBlock = true;\n        else cout &lt;&lt; str &lt;&lt; '\\n';\n    }\n}\n</code></pre></details>\n\n `tool.cpp`\n\n- `tool <input-file> <output-file>` `<input-file>`  `markdown` `<output-file>`  `cpp` \n\n- `tool <input-file> <output-file> row1 row2 row3 ...` `row1``row2``row3`...  ` ```cpp `\n","source":"_posts/gridea-c-gao-liang-dai-ma-kuai-zhe-die.md","raw":"---\ntitle: Gridea C++ \ndate: 2021-08-23 18:53:32\nupdated: 2021-08-23 18:53:32\ntags: []\nhidden: true\n---\n\n\n `html`  `Gridea`  `C++` \n\n```plain\n<details><summary></summary>\n<pre><code class=\"language-cpp\">#include &lt;bits/stdc++.h&gt;<br>\nint main() {\n    int a, b;\n    scanf(\"%d%d\", &a, &b);\n    printf(\"%d\\n\", a + b);\n}\n</code></pre></details>\n```\n\n`C++` \n\n-  `<`  `&lt;``>`  `&gt;`\n\n-  `<br>` \n\n `markdown` \n\n\n\n<details><summary></summary>\n<pre><code class=\"language-cpp\">#include &lt;bits/stdc++.h&gt;<br>\nint main() {\n    int a, b;\n    scanf(\"%d%d\", &a, &b);\n    printf(\"%d\\n\", a + b);\n}\n</code></pre></details>\n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary><pre><code class=\"language-cpp\">#include &lt;bits/stdc++.h&gt;<br>\nusing namespace std;<br>\nint main(int argc, char* argv[]) {\n    if(argc &lt; 3) exit(0);\n    freopen(argv[1], \"r\", stdin), freopen(argv[2], \"w\", stdout);\n    ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n    set&lt;int&gt; rows;\n    int tmp;\n    for(int i = 3; i &lt; argc; i++) sscanf(argv[i], \"%d\", &tmp), rows.insert(tmp);\n    string str, CodeBlock;\n    bool isCodeBlock = false;\n    for(int row = 1; getline(cin, str); row++)\n    if(isCodeBlock) {\n        if(str == \"```\") cout &lt;&lt; CodeBlock + \"&lt;/code&gt;&lt;/pre&gt;&lt;/details&gt;\\n\", isCodeBlock = false;\n        else if(str == \"\") CodeBlock.insert(CodeBlock.size() - (CodeBlock.back() == '\\n'), \"&lt;br&gt;\");\n        else {\n            for(char ch : str) if(ch == '&lt;') CodeBlock += \"&lt;\";\n            else if(ch == '&gt;') CodeBlock += \"&gt;\";\n            else CodeBlock += ch;\n            CodeBlock += '\\n';\n        }\n    } else {\n        if(str == \"```cpp\" && (argc == 3 || rows.count(row)))\n            CodeBlock = \"&lt;details&gt;&lt;summary&gt;&lt;span style=\\\"font-size: large; font-weight: bold; color: rgb(33,150,243);\\\"&gt;&lt;/span&gt;&lt;/summary&gt;&lt;pre&gt;&lt;code class=\\\"language-cpp\\\"&gt;\", isCodeBlock = true;\n        else cout &lt;&lt; str &lt;&lt; '\\n';\n    }\n}\n</code></pre></details>\n\n `tool.cpp`\n\n- `tool <input-file> <output-file>` `<input-file>`  `markdown` `<output-file>`  `cpp` \n\n- `tool <input-file> <output-file> row1 row2 row3 ...` `row1``row2``row3`...  ` ```cpp `\n","slug":"gridea-c-gao-liang-dai-ma-kuai-zhe-die","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0l002rootngylu202a","content":"<p></p>\r\n<p> <code>html</code>  <code>Gridea</code>  <code>C++</code> </p>\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;details&gt;&lt;summary&gt;&lt;/summary&gt;</span><br><span class=\"line\">&lt;pre&gt;&lt;code class=&quot;language-cpp&quot;&gt;#include &amp;lt;bits/stdc++.h&amp;gt;&lt;br&gt;</span><br><span class=\"line\">int main() &#123;</span><br><span class=\"line\">    int a, b;</span><br><span class=\"line\">    scanf(&quot;%d%d&quot;, &amp;a, &amp;b);</span><br><span class=\"line\">    printf(&quot;%d\\n&quot;, a + b);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/code&gt;&lt;/pre&gt;&lt;/details&gt;</span><br></pre></td></tr></table></figure>\r\n<p><code>C++</code> </p>\r\n<ul>\r\n<li><p> <code>&lt;</code>  <code>&amp;lt;</code><code>&gt;</code>  <code>&amp;gt;</code></p></li>\r\n<li><p> <code>&lt;br&gt;</code> </p></li>\r\n</ul>\r\n<p> <code>markdown</code> </p>\r\n<p></p>\r\n<details>\r\n<summary>\r\n\r\n</summary>\r\n<pre><code class=\"language-cpp\">#include &lt;bits/stdc++.h&gt;<br>\r\nint main() &#123;\r\n    int a, b;\r\n    scanf(\"%d%d\", &a, &b);\r\n    printf(\"%d\\n\", a + b);\r\n&#125;\r\n</code></pre>\r\n</details>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<pre><code class=\"language-cpp\">#include &lt;bits/stdc++.h&gt;<br>\r\nusing namespace std;<br>\r\nint main(int argc, char* argv[]) &#123;\r\n    if(argc &lt; 3) exit(0);\r\n    freopen(argv[1], \"r\", stdin), freopen(argv[2], \"w\", stdout);\r\n    ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\r\n    set&lt;int&gt; rows;\r\n    int tmp;\r\n    for(int i = 3; i &lt; argc; i++) sscanf(argv[i], \"%d\", &tmp), rows.insert(tmp);\r\n    string str, CodeBlock;\r\n    bool isCodeBlock = false;\r\n    for(int row = 1; getline(cin, str); row++)\r\n    if(isCodeBlock) &#123;\r\n        if(str == \"```\") cout &lt;&lt; CodeBlock + \"&lt;/code&gt;&lt;/pre&gt;&lt;/details&gt;\\n\", isCodeBlock = false;\r\n        else if(str == \"\") CodeBlock.insert(CodeBlock.size() - (CodeBlock.back() == '\\n'), \"&lt;br&gt;\");\r\n        else &#123;\r\n            for(char ch : str) if(ch == '&lt;') CodeBlock += \"&lt;\";\r\n            else if(ch == '&gt;') CodeBlock += \"&gt;\";\r\n            else CodeBlock += ch;\r\n            CodeBlock += '\\n';\r\n        &#125;\r\n    &#125; else &#123;\r\n        if(str == \"```cpp\" && (argc == 3 || rows.count(row)))\r\n            CodeBlock = \"&lt;details&gt;&lt;summary&gt;&lt;span style=\\\"font-size: large; font-weight: bold; color: rgb(33,150,243);\\\"&gt;&lt;/span&gt;&lt;/summary&gt;&lt;pre&gt;&lt;code class=\\\"language-cpp\\\"&gt;\", isCodeBlock = true;\r\n        else cout &lt;&lt; str &lt;&lt; '\\n';\r\n    &#125;\r\n&#125;\r\n</code></pre>\r\n</details>\r\n<p> <code>tool.cpp</code></p>\r\n<ul>\r\n<li><p><code>tool &lt;input-file&gt; &lt;output-file&gt;</code> <code>&lt;input-file&gt;</code>  <code>markdown</code> <code>&lt;output-file&gt;</code>  <code>cpp</code> </p></li>\r\n<li><p><code>tool &lt;input-file&gt; &lt;output-file&gt; row1 row2 row3 ...</code> <code>row1</code><code>row2</code><code>row3</code>...  <code>```cpp</code></p></li>\r\n</ul>\r\n<!-- flag of hidden posts -->","site":{"data":{}},"length":1919,"excerpt":"","more":"<p></p>\r\n<p> <code>html</code>  <code>Gridea</code>  <code>C++</code> </p>\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;details&gt;&lt;summary&gt;&lt;/summary&gt;</span><br><span class=\"line\">&lt;pre&gt;&lt;code class=&quot;language-cpp&quot;&gt;#include &amp;lt;bits/stdc++.h&amp;gt;&lt;br&gt;</span><br><span class=\"line\">int main() &#123;</span><br><span class=\"line\">    int a, b;</span><br><span class=\"line\">    scanf(&quot;%d%d&quot;, &amp;a, &amp;b);</span><br><span class=\"line\">    printf(&quot;%d\\n&quot;, a + b);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/code&gt;&lt;/pre&gt;&lt;/details&gt;</span><br></pre></td></tr></table></figure>\r\n<p><code>C++</code> </p>\r\n<ul>\r\n<li><p> <code>&lt;</code>  <code>&amp;lt;</code><code>&gt;</code>  <code>&amp;gt;</code></p></li>\r\n<li><p> <code>&lt;br&gt;</code> </p></li>\r\n</ul>\r\n<p> <code>markdown</code> </p>\r\n<p></p>\r\n<details>\r\n<summary>\r\n\r\n</summary>\r\n<pre><code class=\"language-cpp\">#include &lt;bits/stdc++.h&gt;<br>\r\nint main() &#123;\r\n    int a, b;\r\n    scanf(\"%d%d\", &a, &b);\r\n    printf(\"%d\\n\", a + b);\r\n&#125;\r\n</code></pre>\r\n</details>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<pre><code class=\"language-cpp\">#include &lt;bits/stdc++.h&gt;<br>\r\nusing namespace std;<br>\r\nint main(int argc, char* argv[]) &#123;\r\n    if(argc &lt; 3) exit(0);\r\n    freopen(argv[1], \"r\", stdin), freopen(argv[2], \"w\", stdout);\r\n    ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\r\n    set&lt;int&gt; rows;\r\n    int tmp;\r\n    for(int i = 3; i &lt; argc; i++) sscanf(argv[i], \"%d\", &tmp), rows.insert(tmp);\r\n    string str, CodeBlock;\r\n    bool isCodeBlock = false;\r\n    for(int row = 1; getline(cin, str); row++)\r\n    if(isCodeBlock) &#123;\r\n        if(str == \"```\") cout &lt;&lt; CodeBlock + \"&lt;/code&gt;&lt;/pre&gt;&lt;/details&gt;\\n\", isCodeBlock = false;\r\n        else if(str == \"\") CodeBlock.insert(CodeBlock.size() - (CodeBlock.back() == '\\n'), \"&lt;br&gt;\");\r\n        else &#123;\r\n            for(char ch : str) if(ch == '&lt;') CodeBlock += \"&lt;\";\r\n            else if(ch == '&gt;') CodeBlock += \"&gt;\";\r\n            else CodeBlock += ch;\r\n            CodeBlock += '\\n';\r\n        &#125;\r\n    &#125; else &#123;\r\n        if(str == \"```cpp\" && (argc == 3 || rows.count(row)))\r\n            CodeBlock = \"&lt;details&gt;&lt;summary&gt;&lt;span style=\\\"font-size: large; font-weight: bold; color: rgb(33,150,243);\\\"&gt;&lt;/span&gt;&lt;/summary&gt;&lt;pre&gt;&lt;code class=\\\"language-cpp\\\"&gt;\", isCodeBlock = true;\r\n        else cout &lt;&lt; str &lt;&lt; '\\n';\r\n    &#125;\r\n&#125;\r\n</code></pre>\r\n</details>\r\n<p> <code>tool.cpp</code></p>\r\n<ul>\r\n<li><p><code>tool &lt;input-file&gt; &lt;output-file&gt;</code> <code>&lt;input-file&gt;</code>  <code>markdown</code> <code>&lt;output-file&gt;</code>  <code>cpp</code> </p></li>\r\n<li><p><code>tool &lt;input-file&gt; &lt;output-file&gt; row1 row2 row3 ...</code> <code>row1</code><code>row2</code><code>row3</code>...  <code>```cpp</code></p></li>\r\n</ul>\r\n"},{"title":" std::streambuf  Fast IO ","date":"2021-03-13T14:22:39.000Z","updated":"2021-03-13T14:22:39.000Z","_content":"### \n\n```cpp\nint read() {\n    const int M = 1e6;\n    static streambuf* in = cin.rdbuf();\n    #define gc (p1 == p2 && (p2 = (p1 = buf) + in -> sgetn(buf, M), p1 == p2) ? -1 : *p1++)\n    static char buf[M], *p1, *p2;\n    int c = gc, r = 0;\n    while(c < 48) c = gc;\n    while(c > 47) r = r * 10 + (c & 15), c = gc;\n    return r;\n}\nvoid wrt(int x) {\n    static streambuf* out = cout.rdbuf();\n    #define pc out -> sputc\n    static char c[11]; int sz = 0;\n    do c[++sz] = x % 10, x /= 10; while(x);\n    while(sz) pc(c[sz--] + 48);\n    pc(10);\n}\n```\n\n**```main```  $3$ **\n\n```cpp\nios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n```\n\n\n\n**  ```cin, cout, scanf, printf, gets, puts, getchar, putchar``` **\n\n\n\n**```read```  ```Ctrl + Z```  ```WIN 10```**\n\n### \n\n```cpp\nint read() {\n    const int M = 1e6;\n    static streambuf* in = cin.rdbuf();\n    #define gc (p1 == p2 && (p2 = (p1 = buf) + in -> sgetn(buf, M), p1 == p2) ? -1 : *p1++)\n    static char buf[M], *p1, *p2;\n    int c = gc, r = 0, f = 1;\n    while(c < 48) { if(c == 45) f = -1; c = gc; }\n    while(c > 47) r = r * 10 + (c & 15), c = gc;\n    return r * f;\n}\nvoid wrt(int x) {\n    static streambuf* out = cout.rdbuf();\n    #define pc out -> sputc\n    static char c[11]; int sz = 0;\n    if(x < 0) pc(45), x = -x;\n    do c[++sz] = x % 10, x /= 10; while(x);\n    while(sz) pc(c[sz--] + 48);\n    pc(10);\n}\n```\n\n** ```long long```  ```wrt```  ```c```  $20$**\n\n### \n\n-  ```read```  ```cin.tie(0)``` ```wrt```  ```cout.tie(0)``` ```ios::sync_with_stdio(0)``` ****\n\n-  ```scanf, printf, gets, puts, getchar, putchar```  ```stdio``` \n\n   ```read```  ```cin```  ```streambuf```  \n\n   ```wrt```  ```cout```  ```streambuf```  ","source":"_posts/ji-yu-stdstreambuf-de-fast-io-mo-ban.md","raw":"---\ntitle:  std::streambuf  Fast IO \ndate: 2021-03-13 22:22:39\nupdated: 2021-03-13 22:22:39\ntags: []\n---\n### \n\n```cpp\nint read() {\n    const int M = 1e6;\n    static streambuf* in = cin.rdbuf();\n    #define gc (p1 == p2 && (p2 = (p1 = buf) + in -> sgetn(buf, M), p1 == p2) ? -1 : *p1++)\n    static char buf[M], *p1, *p2;\n    int c = gc, r = 0;\n    while(c < 48) c = gc;\n    while(c > 47) r = r * 10 + (c & 15), c = gc;\n    return r;\n}\nvoid wrt(int x) {\n    static streambuf* out = cout.rdbuf();\n    #define pc out -> sputc\n    static char c[11]; int sz = 0;\n    do c[++sz] = x % 10, x /= 10; while(x);\n    while(sz) pc(c[sz--] + 48);\n    pc(10);\n}\n```\n\n**```main```  $3$ **\n\n```cpp\nios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n```\n\n\n\n**  ```cin, cout, scanf, printf, gets, puts, getchar, putchar``` **\n\n\n\n**```read```  ```Ctrl + Z```  ```WIN 10```**\n\n### \n\n```cpp\nint read() {\n    const int M = 1e6;\n    static streambuf* in = cin.rdbuf();\n    #define gc (p1 == p2 && (p2 = (p1 = buf) + in -> sgetn(buf, M), p1 == p2) ? -1 : *p1++)\n    static char buf[M], *p1, *p2;\n    int c = gc, r = 0, f = 1;\n    while(c < 48) { if(c == 45) f = -1; c = gc; }\n    while(c > 47) r = r * 10 + (c & 15), c = gc;\n    return r * f;\n}\nvoid wrt(int x) {\n    static streambuf* out = cout.rdbuf();\n    #define pc out -> sputc\n    static char c[11]; int sz = 0;\n    if(x < 0) pc(45), x = -x;\n    do c[++sz] = x % 10, x /= 10; while(x);\n    while(sz) pc(c[sz--] + 48);\n    pc(10);\n}\n```\n\n** ```long long```  ```wrt```  ```c```  $20$**\n\n### \n\n-  ```read```  ```cin.tie(0)``` ```wrt```  ```cout.tie(0)``` ```ios::sync_with_stdio(0)``` ****\n\n-  ```scanf, printf, gets, puts, getchar, putchar```  ```stdio``` \n\n   ```read```  ```cin```  ```streambuf```  \n\n   ```wrt```  ```cout```  ```streambuf```  ","slug":"ji-yu-stdstreambuf-de-fast-io-mo-ban","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0m002uootncaw3crja","content":"<h3 id=\"\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">int</span> M = <span class=\"number\">1e6</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* in = cin.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> gc (p1 == p2 &amp;&amp; (p2 = (p1 = buf) + in -&gt; sgetn(buf, M), p1 == p2) ? -1 : *p1++)</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> buf[M], *p1, *p2;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> c = gc, r = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &lt; <span class=\"number\">48</span>) c = gc;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &gt; <span class=\"number\">47</span>) r = r * <span class=\"number\">10</span> + (c &amp; <span class=\"number\">15</span>), c = gc;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">wrt</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* out = cout.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> pc out -&gt; sputc</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> c[<span class=\"number\">11</span>]; <span class=\"keyword\">int</span> sz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> c[++sz] = x % <span class=\"number\">10</span>, x /= <span class=\"number\">10</span>; <span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(sz) <span class=\"built_in\">pc</span>(c[sz--] + <span class=\"number\">48</span>);</span><br><span class=\"line\">    <span class=\"built_in\">pc</span>(<span class=\"number\">10</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><strong><code>main</code>  <span class=\"math inline\">\\(3\\)</span> </strong></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>), cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>), cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\r\n<p></p>\r\n<p><strong> <code>cin, cout, scanf, printf, gets, puts, getchar, putchar</code> </strong></p>\r\n<p></p>\r\n<p><strong><code>read</code>  <code>Ctrl + Z</code>  <code>WIN 10</code></strong></p>\r\n<h3 id=\"\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">int</span> M = <span class=\"number\">1e6</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* in = cin.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> gc (p1 == p2 &amp;&amp; (p2 = (p1 = buf) + in -&gt; sgetn(buf, M), p1 == p2) ? -1 : *p1++)</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> buf[M], *p1, *p2;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> c = gc, r = <span class=\"number\">0</span>, f = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &lt; <span class=\"number\">48</span>) &#123; <span class=\"keyword\">if</span>(c == <span class=\"number\">45</span>) f = <span class=\"number\">-1</span>; c = gc; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &gt; <span class=\"number\">47</span>) r = r * <span class=\"number\">10</span> + (c &amp; <span class=\"number\">15</span>), c = gc;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r * f;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">wrt</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* out = cout.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> pc out -&gt; sputc</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> c[<span class=\"number\">11</span>]; <span class=\"keyword\">int</span> sz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(x &lt; <span class=\"number\">0</span>) <span class=\"built_in\">pc</span>(<span class=\"number\">45</span>), x = -x;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> c[++sz] = x % <span class=\"number\">10</span>, x /= <span class=\"number\">10</span>; <span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(sz) <span class=\"built_in\">pc</span>(c[sz--] + <span class=\"number\">48</span>);</span><br><span class=\"line\">    <span class=\"built_in\">pc</span>(<span class=\"number\">10</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><strong> <code>long long</code>  <code>wrt</code>  <code>c</code>  <span class=\"math inline\">\\(20\\)</span></strong></p>\r\n<h3 id=\"\"></h3>\r\n<ul>\r\n<li><p> <code>read</code>  <code>cin.tie(0)</code> <code>wrt</code>  <code>cout.tie(0)</code> <code>ios::sync_with_stdio(0)</code> <strong></strong></p></li>\r\n<li><p> <code>scanf, printf, gets, puts, getchar, putchar</code>  <code>stdio</code> </p>\r\n<p> <code>read</code>  <code>cin</code>  <code>streambuf</code> </p>\r\n<p><code>wrt</code>  <code>cout</code>  <code>streambuf</code> </p></li>\r\n</ul>\r\n","site":{"data":{}},"length":1395,"excerpt":"","more":"<h3 id=\"\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">int</span> M = <span class=\"number\">1e6</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* in = cin.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> gc (p1 == p2 &amp;&amp; (p2 = (p1 = buf) + in -&gt; sgetn(buf, M), p1 == p2) ? -1 : *p1++)</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> buf[M], *p1, *p2;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> c = gc, r = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &lt; <span class=\"number\">48</span>) c = gc;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &gt; <span class=\"number\">47</span>) r = r * <span class=\"number\">10</span> + (c &amp; <span class=\"number\">15</span>), c = gc;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">wrt</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* out = cout.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> pc out -&gt; sputc</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> c[<span class=\"number\">11</span>]; <span class=\"keyword\">int</span> sz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> c[++sz] = x % <span class=\"number\">10</span>, x /= <span class=\"number\">10</span>; <span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(sz) <span class=\"built_in\">pc</span>(c[sz--] + <span class=\"number\">48</span>);</span><br><span class=\"line\">    <span class=\"built_in\">pc</span>(<span class=\"number\">10</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><strong><code>main</code>  <span class=\"math inline\">\\(3\\)</span> </strong></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>), cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>), cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\r\n<p></p>\r\n<p><strong> <code>cin, cout, scanf, printf, gets, puts, getchar, putchar</code> </strong></p>\r\n<p></p>\r\n<p><strong><code>read</code>  <code>Ctrl + Z</code>  <code>WIN 10</code></strong></p>\r\n<h3 id=\"\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">int</span> M = <span class=\"number\">1e6</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* in = cin.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> gc (p1 == p2 &amp;&amp; (p2 = (p1 = buf) + in -&gt; sgetn(buf, M), p1 == p2) ? -1 : *p1++)</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> buf[M], *p1, *p2;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> c = gc, r = <span class=\"number\">0</span>, f = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &lt; <span class=\"number\">48</span>) &#123; <span class=\"keyword\">if</span>(c == <span class=\"number\">45</span>) f = <span class=\"number\">-1</span>; c = gc; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &gt; <span class=\"number\">47</span>) r = r * <span class=\"number\">10</span> + (c &amp; <span class=\"number\">15</span>), c = gc;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r * f;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">wrt</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* out = cout.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> pc out -&gt; sputc</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> c[<span class=\"number\">11</span>]; <span class=\"keyword\">int</span> sz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(x &lt; <span class=\"number\">0</span>) <span class=\"built_in\">pc</span>(<span class=\"number\">45</span>), x = -x;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> c[++sz] = x % <span class=\"number\">10</span>, x /= <span class=\"number\">10</span>; <span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(sz) <span class=\"built_in\">pc</span>(c[sz--] + <span class=\"number\">48</span>);</span><br><span class=\"line\">    <span class=\"built_in\">pc</span>(<span class=\"number\">10</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><strong> <code>long long</code>  <code>wrt</code>  <code>c</code>  <span class=\"math inline\">\\(20\\)</span></strong></p>\r\n<h3 id=\"\"></h3>\r\n<ul>\r\n<li><p> <code>read</code>  <code>cin.tie(0)</code> <code>wrt</code>  <code>cout.tie(0)</code> <code>ios::sync_with_stdio(0)</code> <strong></strong></p></li>\r\n<li><p> <code>scanf, printf, gets, puts, getchar, putchar</code>  <code>stdio</code> </p>\r\n<p> <code>read</code>  <code>cin</code>  <code>streambuf</code> </p>\r\n<p><code>wrt</code>  <code>cout</code>  <code>streambuf</code> </p></li>\r\n</ul>\r\n"},{"title":" | JSOI2019","date":"2021-09-04T07:58:47.000Z","updated":"2021-09-04T07:58:47.000Z","_content":">[](https://loj.ac/p/3101)\n>\n> $n$  $m$  $T +1$ \n>\n>-  $x$  $t$  $y$  $t+1$ \n>-  $x$  $t$  $y$  $t$ \n>\n> $i$ $j$  **$i$  $j$ **\n>\n>$n \\le 5 \\cdot 10^4,m \\le 10^5,t \\le T \\le 10^6$\n\n\n\n $Dead(x,t) \\rightarrow Dead(y,t+1),Alive(y,t+1) \\rightarrow Alive(x,t)$\n\n $Alive(x,t) \\rightarrow Dead(y,t),Alive(y,t) \\rightarrow Dead(x,t)$\n\n $Dead(x,t) \\rightarrow Dead(x,t+1),Alive(x,t+1) \\rightarrow Alive(x,t)$\n\n $x$  $Alive(x,T+1)$  $Dead(x, T+1)$ $Alive(x,T+1)$  $Dead(x, T+1)$\n\n $Dead(x,T+1)$  $Dead(y,T+1)$ $y$  $x$ \n\n $(x,t)$  $(x,T+1)$ $(x,t)$  $(y,t')$  $(y,t')$  $y$  $Dead(x,t)$ $Alive(x,t)$ \n\n $Dead(x,T+1)$  $Dead(y,T+1)$  ```bitset```  ```DP```\n\n```bitset```  $10000$ $10000$  ```DP```\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n\nusing namespace std;\nconst int N = 1e5 + 5;\nint T, n, K, c[N], t[N], x[N], y[N];\nmap<int, int> m[N];\nvector<int> G[N * 3];\nint ed[N], vis[N * 3], as[N];\nbitset<10000> ban, s[N * 3];\nvoid add(int c, int u, int v) {\n    G[u + c].push_back(v), G[v + 1].push_back(u + !c);\n}\nvoid dfs(int u) {\n    if(vis[u]) return;\n    vis[u] = 1;\n    for(int v : G[u]) dfs(v), s[u] |= s[v];\n}\nint main() {\n    cin >> T >> n >> K;\n    int p = 0;\n    rep(i, 1, K) scanf(\"%d%d%d%d\", &c[i], &t[i], &x[i], &y[i]), m[x[i]][t[i]] = p += 2;\n    rep(i, 1, n) ed[i] = m[i][T + 1] = p += 2;\n    rep(i, 1, K) add(c[i], m[x[i]][t[i]], m[y[i]].lower_bound(t[i] + !c[i]) -> second);\n    rep(i, 1, n) {\n        int lst = 0;\n        for(auto [t, j] : m[i]) { if(lst) add(0, lst, j); lst = j; }\n    }\n    for(int l = 1, r; l <= n; l += 10000) {\n        r = min(l + 9999, n), ban.reset();\n        rep(i, 2, p + 1) s[i].reset(), vis[i] = 0;\n        rep(i, l, r) s[ed[i]][i - l] = 1;\n        rep(i, 2, p + 1) dfs(i);\n        rep(i, l, r) if(s[ed[i] + 1][i - l]) ban[i - l] = 1, as[i] = -1e9;\n        rep(i, 1, n) as[i] += r - l + 1 - (s[ed[i] + 1] | ban).count();\n    }\n    rep(i, 1, n) printf(\"%d \", max(as[i] - 1, 0));\n    return 0;\n}\n```","source":"_posts/jing-zhun-yu-ce-or-jsoi2019.md","raw":"---\ntitle:  | JSOI2019\ndate: 2021-09-04 15:58:47\nupdated: 2021-09-04 15:58:47\ntags: []\ncategories: \n---\n>[](https://loj.ac/p/3101)\n>\n> $n$  $m$  $T +1$ \n>\n>-  $x$  $t$  $y$  $t+1$ \n>-  $x$  $t$  $y$  $t$ \n>\n> $i$ $j$  **$i$  $j$ **\n>\n>$n \\le 5 \\cdot 10^4,m \\le 10^5,t \\le T \\le 10^6$\n\n\n\n $Dead(x,t) \\rightarrow Dead(y,t+1),Alive(y,t+1) \\rightarrow Alive(x,t)$\n\n $Alive(x,t) \\rightarrow Dead(y,t),Alive(y,t) \\rightarrow Dead(x,t)$\n\n $Dead(x,t) \\rightarrow Dead(x,t+1),Alive(x,t+1) \\rightarrow Alive(x,t)$\n\n $x$  $Alive(x,T+1)$  $Dead(x, T+1)$ $Alive(x,T+1)$  $Dead(x, T+1)$\n\n $Dead(x,T+1)$  $Dead(y,T+1)$ $y$  $x$ \n\n $(x,t)$  $(x,T+1)$ $(x,t)$  $(y,t')$  $(y,t')$  $y$  $Dead(x,t)$ $Alive(x,t)$ \n\n $Dead(x,T+1)$  $Dead(y,T+1)$  ```bitset```  ```DP```\n\n```bitset```  $10000$ $10000$  ```DP```\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n\nusing namespace std;\nconst int N = 1e5 + 5;\nint T, n, K, c[N], t[N], x[N], y[N];\nmap<int, int> m[N];\nvector<int> G[N * 3];\nint ed[N], vis[N * 3], as[N];\nbitset<10000> ban, s[N * 3];\nvoid add(int c, int u, int v) {\n    G[u + c].push_back(v), G[v + 1].push_back(u + !c);\n}\nvoid dfs(int u) {\n    if(vis[u]) return;\n    vis[u] = 1;\n    for(int v : G[u]) dfs(v), s[u] |= s[v];\n}\nint main() {\n    cin >> T >> n >> K;\n    int p = 0;\n    rep(i, 1, K) scanf(\"%d%d%d%d\", &c[i], &t[i], &x[i], &y[i]), m[x[i]][t[i]] = p += 2;\n    rep(i, 1, n) ed[i] = m[i][T + 1] = p += 2;\n    rep(i, 1, K) add(c[i], m[x[i]][t[i]], m[y[i]].lower_bound(t[i] + !c[i]) -> second);\n    rep(i, 1, n) {\n        int lst = 0;\n        for(auto [t, j] : m[i]) { if(lst) add(0, lst, j); lst = j; }\n    }\n    for(int l = 1, r; l <= n; l += 10000) {\n        r = min(l + 9999, n), ban.reset();\n        rep(i, 2, p + 1) s[i].reset(), vis[i] = 0;\n        rep(i, l, r) s[ed[i]][i - l] = 1;\n        rep(i, 2, p + 1) dfs(i);\n        rep(i, l, r) if(s[ed[i] + 1][i - l]) ban[i - l] = 1, as[i] = -1e9;\n        rep(i, 1, n) as[i] += r - l + 1 - (s[ed[i] + 1] | ban).count();\n    }\n    rep(i, 1, n) printf(\"%d \", max(as[i] - 1, 0));\n    return 0;\n}\n```","slug":"jing-zhun-yu-ce-or-jsoi2019","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0n002wootn3lvc0avc","content":"<blockquote>\r\n<p><a href=\"https://loj.ac/p/3101\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(T +1\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(t+1\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(t\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(j\\)</span>  <strong><span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span> </strong></p>\r\n<p><span class=\"math inline\">\\(n \\le 5 \\cdot 10^4,m \\le 10^5,t \\le T \\le 10^6\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(Dead(x,t) \\rightarrow Dead(y,t+1),Alive(y,t+1) \\rightarrow Alive(x,t)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(Alive(x,t) \\rightarrow Dead(y,t),Alive(y,t) \\rightarrow Dead(x,t)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(Dead(x,t) \\rightarrow Dead(x,t+1),Alive(x,t+1) \\rightarrow Alive(x,t)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(Alive(x,T+1)\\)</span>  <span class=\"math inline\">\\(Dead(x, T+1)\\)</span> <span class=\"math inline\">\\(Alive(x,T+1)\\)</span>  <span class=\"math inline\">\\(Dead(x, T+1)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(Dead(x,T+1)\\)</span>  <span class=\"math inline\">\\(Dead(y,T+1)\\)</span> <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(x\\)</span> </p>\r\n<p> <span class=\"math inline\">\\((x,t)\\)</span>  <span class=\"math inline\">\\((x,T+1)\\)</span> <span class=\"math inline\">\\((x,t)\\)</span>  <span class=\"math inline\">\\((y,t&#39;)\\)</span>  <span class=\"math inline\">\\((y,t&#39;)\\)</span>  <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(Dead(x,t)\\)</span> <span class=\"math inline\">\\(Alive(x,t)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(Dead(x,T+1)\\)</span>  <span class=\"math inline\">\\(Dead(y,T+1)\\)</span>  <code>bitset</code>  <code>DP</code></p>\r\n<p><code>bitset</code>  <span class=\"math inline\">\\(10000\\)</span> <span class=\"math inline\">\\(10000\\)</span>  <code>DP</code></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> T, n, K, c[N], t[N], x[N], y[N];</span><br><span class=\"line\">map&lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt; m[N];</span><br><span class=\"line\">vector&lt;<span class=\"keyword\">int</span>&gt; G[N * <span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> ed[N], vis[N * <span class=\"number\">3</span>], as[N];</span><br><span class=\"line\">bitset&lt;10000&gt; ban, s[N * <span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> c, <span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    G[u + c].<span class=\"built_in\">push_back</span>(v), G[v + <span class=\"number\">1</span>].<span class=\"built_in\">push_back</span>(u + !c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(vis[u]) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    vis[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"built_in\">dfs</span>(v), s[u] |= s[v];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; T &gt;&gt; n &gt;&gt; K;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> p = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, K) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d%d&quot;</span>, &amp;c[i], &amp;t[i], &amp;x[i], &amp;y[i]), m[x[i]][t[i]] = p += <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) ed[i] = m[i][T + <span class=\"number\">1</span>] = p += <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, K) <span class=\"built_in\">add</span>(c[i], m[x[i]][t[i]], m[y[i]].<span class=\"built_in\">lower_bound</span>(t[i] + !c[i]) -&gt; second);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> lst = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [t, j] : m[i]) &#123; <span class=\"keyword\">if</span>(lst) <span class=\"built_in\">add</span>(<span class=\"number\">0</span>, lst, j); lst = j; &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> l = <span class=\"number\">1</span>, r; l &lt;= n; l += <span class=\"number\">10000</span>) &#123;</span><br><span class=\"line\">        r = <span class=\"built_in\">min</span>(l + <span class=\"number\">9999</span>, n), ban.<span class=\"built_in\">reset</span>();</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, p + <span class=\"number\">1</span>) s[i].<span class=\"built_in\">reset</span>(), vis[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, l, r) s[ed[i]][i - l] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, p + <span class=\"number\">1</span>) <span class=\"built_in\">dfs</span>(i);</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, l, r) <span class=\"keyword\">if</span>(s[ed[i] + <span class=\"number\">1</span>][i - l]) ban[i - l] = <span class=\"number\">1</span>, as[i] = <span class=\"number\">-1e9</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) as[i] += r - l + <span class=\"number\">1</span> - (s[ed[i] + <span class=\"number\">1</span>] | ban).<span class=\"built_in\">count</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, <span class=\"built_in\">max</span>(as[i] - <span class=\"number\">1</span>, <span class=\"number\">0</span>));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":1996,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://loj.ac/p/3101\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(T +1\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(t+1\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(t\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(j\\)</span>  <strong><span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span> </strong></p>\r\n<p><span class=\"math inline\">\\(n \\le 5 \\cdot 10^4,m \\le 10^5,t \\le T \\le 10^6\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(Dead(x,t) \\rightarrow Dead(y,t+1),Alive(y,t+1) \\rightarrow Alive(x,t)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(Alive(x,t) \\rightarrow Dead(y,t),Alive(y,t) \\rightarrow Dead(x,t)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(Dead(x,t) \\rightarrow Dead(x,t+1),Alive(x,t+1) \\rightarrow Alive(x,t)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(Alive(x,T+1)\\)</span>  <span class=\"math inline\">\\(Dead(x, T+1)\\)</span> <span class=\"math inline\">\\(Alive(x,T+1)\\)</span>  <span class=\"math inline\">\\(Dead(x, T+1)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(Dead(x,T+1)\\)</span>  <span class=\"math inline\">\\(Dead(y,T+1)\\)</span> <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(x\\)</span> </p>\r\n<p> <span class=\"math inline\">\\((x,t)\\)</span>  <span class=\"math inline\">\\((x,T+1)\\)</span> <span class=\"math inline\">\\((x,t)\\)</span>  <span class=\"math inline\">\\((y,t&#39;)\\)</span>  <span class=\"math inline\">\\((y,t&#39;)\\)</span>  <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(Dead(x,t)\\)</span> <span class=\"math inline\">\\(Alive(x,t)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(Dead(x,T+1)\\)</span>  <span class=\"math inline\">\\(Dead(y,T+1)\\)</span>  <code>bitset</code>  <code>DP</code></p>\r\n<p><code>bitset</code>  <span class=\"math inline\">\\(10000\\)</span> <span class=\"math inline\">\\(10000\\)</span>  <code>DP</code></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> T, n, K, c[N], t[N], x[N], y[N];</span><br><span class=\"line\">map&lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt; m[N];</span><br><span class=\"line\">vector&lt;<span class=\"keyword\">int</span>&gt; G[N * <span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> ed[N], vis[N * <span class=\"number\">3</span>], as[N];</span><br><span class=\"line\">bitset&lt;10000&gt; ban, s[N * <span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> c, <span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    G[u + c].<span class=\"built_in\">push_back</span>(v), G[v + <span class=\"number\">1</span>].<span class=\"built_in\">push_back</span>(u + !c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(vis[u]) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    vis[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"built_in\">dfs</span>(v), s[u] |= s[v];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; T &gt;&gt; n &gt;&gt; K;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> p = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, K) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d%d%d&quot;</span>, &amp;c[i], &amp;t[i], &amp;x[i], &amp;y[i]), m[x[i]][t[i]] = p += <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) ed[i] = m[i][T + <span class=\"number\">1</span>] = p += <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, K) <span class=\"built_in\">add</span>(c[i], m[x[i]][t[i]], m[y[i]].<span class=\"built_in\">lower_bound</span>(t[i] + !c[i]) -&gt; second);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> lst = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [t, j] : m[i]) &#123; <span class=\"keyword\">if</span>(lst) <span class=\"built_in\">add</span>(<span class=\"number\">0</span>, lst, j); lst = j; &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> l = <span class=\"number\">1</span>, r; l &lt;= n; l += <span class=\"number\">10000</span>) &#123;</span><br><span class=\"line\">        r = <span class=\"built_in\">min</span>(l + <span class=\"number\">9999</span>, n), ban.<span class=\"built_in\">reset</span>();</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, p + <span class=\"number\">1</span>) s[i].<span class=\"built_in\">reset</span>(), vis[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, l, r) s[ed[i]][i - l] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, p + <span class=\"number\">1</span>) <span class=\"built_in\">dfs</span>(i);</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, l, r) <span class=\"keyword\">if</span>(s[ed[i] + <span class=\"number\">1</span>][i - l]) ban[i - l] = <span class=\"number\">1</span>, as[i] = <span class=\"number\">-1e9</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) as[i] += r - l + <span class=\"number\">1</span> - (s[ed[i] + <span class=\"number\">1</span>] | ban).<span class=\"built_in\">count</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, <span class=\"built_in\">max</span>(as[i] - <span class=\"number\">1</span>, <span class=\"number\">0</span>));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":" |  P7481","date":"2021-04-12T07:25:13.000Z","updated":"2021-04-12T07:25:13.000Z","_content":"> [](https://www.luogu.com.cn/problem/P7481)\n>\n>  $n,m$ $m \\le n$ $f(a,b)=\\sum\\limits_{i=0}^b\\binom bi\\binom {n-i}a$\n>\n>  $\\bigoplus\\limits_{a=1}^m\\bigoplus\\limits_{b=1}^m\\left(f(a,b) \\bmod 998244353\\right)$\n>\n> $n \\le 10^9,m \\le 5000$\n\n### \n\n$$\n\\sum_{a=0}^n f(a,b)x^a=(x+2)^b(x+1)^{n-b}\n$$\n\n#### \n\n$$\n\\begin{aligned}\n&\\sum_{a=0}^n f(a,b)x^a\\\\\n&=\\sum_{a=0}^n\\sum\\limits_{i=0}^b\\binom bi\\binom {n-i}ax^a\\\\\n&=\\sum_{i=0}^b\\binom bi\\sum_{a=0}^n\\binom {n-i}ax^a\\\\\n&=\\sum_{i=0}^b\\binom bi(x+1)^{n-i}\\\\\n&=\\sum_{i=0}^b\\binom bi(x+1)^{b-i}(x+1)^{n-b}\\\\\n&=(x+2)^b(x+1)^{n-b}\n\\end{aligned}\n$$\n\n#### \n\n $f(a,b)$  $n$  $b$ \n\n-  $b$  $i$ \n-  $n-i$  $a$ \n\n $i \\in [0,b]$  $f(a,b)$  $a$ \n\n $a$  $x$ $y$ $a=x+y$\n\n-  $1$ $2$\n\n   $b$  $(x+2)^b$\n\n-  $1$ $1$\n\n   $n-b$  $(x+1)^{n-b}$\n\n $\\sum\\limits_{a=0}^n f(a,b)x^a=(x+2)^b(x+1)^{n-b}$\n\n### \n\n####  01  ```DP```\n\n\n$$\n\\sum_{a=0}^n f(a,b)x^a=\\frac {x+2}{x+1}\\sum_{a=0}^nf(a,b-1)x^a\n$$\n $x+2$  $x+1$ \n\n $O(m^2)$\n\n#### \n\n \n$$\n\\begin{aligned}\n&[(x+2)^b(x+1)^{n-b}]'\\\\\n&=b(x+2)^{b-1}(x+1)^{n-b}+(x+2)^b(n-b)(x+1)^{n-b-1}\\\\\n&=\\dfrac{b(x+1)+(n-b)(x+2)}{(x+2)(x+1)}(x+2)^b(x+1)^{n-b}\\\\\n&=\\dfrac{nx+2n-b}{(x+2)(x+1)}(x+2)^b(x+1)^{n-b}\\\\\n\\end{aligned}\n$$\n $(x+2)(x+1)$ \n$$\n(x+2)(x+1)[(x+2)^b(x+1)^{n-b}]'=(nx+2n-b)(x+2)^b(x+1)^{n-b}\n$$\n $x^a$ \n$$\n\\begin{aligned}\n&(a-1)f(a-1,b)+3af(a,b)+2(a+1)f(a+1,b)\\\\\n&=nf(a-1,b)+(2n-b)f(a,b)\n\\end{aligned}\n$$\n\n$$\nf(a+1,b)=\\frac {(2n-b-3a)f(a,b)+(n-a+1)f(a-1,b)}{2(a+1)}\n$$\n\n$$\nf(a,b)=\\frac {(2n-b-3a+3)f(a-1,b)+(n-a+2)f(a-2,b)}{2a}\n$$\n $b \\in [1,m]$ \n\n $O(m^2)$\n\n 01  ```DP```\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nconst int P = 998244353;\n\nint n, m;\nlong long inv[5005], f[5005];\n\nint main() {\n    cin >> n >> m;\n    f[0] = inv[1] = 1;\n    rep(i, 2, m) inv[i] = (P - P / i) * inv[P % i] % P;\n    rep(i, 1, m) f[i] = f[i - 1] * (n - i + 1) % P * inv[i] % P;\n    int as = 0;\n    rep(i, 1, m) {\n        per(j, m, 0) f[j] = (f[j] * 2 + f[j - 1]) % P;\n        rep(j, 1, m) as ^= f[j] = (f[j] + P - f[j - 1]) % P;\n    }\n    cout << as;\n    return 0;\n}\n```\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nconst int P = 998244353;\n\nint n, m;\nlong long inv[10005], f[5005];\n\nint main() {\n    cin >> n >> m;\n    inv[1] = 1;\n    rep(i, 2, m * 2) inv[i] = (P - P / i) * inv[P % i] % P;\n    int as = 0;\n    f[0] = 1;\n    rep(i, 1, m) {\n        (f[0] *= 2) %= P;\n        rep(j, 1, m) as ^= f[j] = (((n * 2 - i - j * 3 + 3) * f[j - 1] + (n - j + 2) * f[j - 2]) % P * inv[j * 2] % P + P) % P;\n    }\n    cout << as;\n    return 0;\n}\n```","source":"_posts/luogu7481.md","raw":"---\ntitle:  |  P7481\ndate: 2021-04-12 15:25:13\nupdated: 2021-04-12 15:25:13\ntags: [,,]\ncategories: \n---\n> [](https://www.luogu.com.cn/problem/P7481)\n>\n>  $n,m$ $m \\le n$ $f(a,b)=\\sum\\limits_{i=0}^b\\binom bi\\binom {n-i}a$\n>\n>  $\\bigoplus\\limits_{a=1}^m\\bigoplus\\limits_{b=1}^m\\left(f(a,b) \\bmod 998244353\\right)$\n>\n> $n \\le 10^9,m \\le 5000$\n\n### \n\n$$\n\\sum_{a=0}^n f(a,b)x^a=(x+2)^b(x+1)^{n-b}\n$$\n\n#### \n\n$$\n\\begin{aligned}\n&\\sum_{a=0}^n f(a,b)x^a\\\\\n&=\\sum_{a=0}^n\\sum\\limits_{i=0}^b\\binom bi\\binom {n-i}ax^a\\\\\n&=\\sum_{i=0}^b\\binom bi\\sum_{a=0}^n\\binom {n-i}ax^a\\\\\n&=\\sum_{i=0}^b\\binom bi(x+1)^{n-i}\\\\\n&=\\sum_{i=0}^b\\binom bi(x+1)^{b-i}(x+1)^{n-b}\\\\\n&=(x+2)^b(x+1)^{n-b}\n\\end{aligned}\n$$\n\n#### \n\n $f(a,b)$  $n$  $b$ \n\n-  $b$  $i$ \n-  $n-i$  $a$ \n\n $i \\in [0,b]$  $f(a,b)$  $a$ \n\n $a$  $x$ $y$ $a=x+y$\n\n-  $1$ $2$\n\n   $b$  $(x+2)^b$\n\n-  $1$ $1$\n\n   $n-b$  $(x+1)^{n-b}$\n\n $\\sum\\limits_{a=0}^n f(a,b)x^a=(x+2)^b(x+1)^{n-b}$\n\n### \n\n####  01  ```DP```\n\n\n$$\n\\sum_{a=0}^n f(a,b)x^a=\\frac {x+2}{x+1}\\sum_{a=0}^nf(a,b-1)x^a\n$$\n $x+2$  $x+1$ \n\n $O(m^2)$\n\n#### \n\n \n$$\n\\begin{aligned}\n&[(x+2)^b(x+1)^{n-b}]'\\\\\n&=b(x+2)^{b-1}(x+1)^{n-b}+(x+2)^b(n-b)(x+1)^{n-b-1}\\\\\n&=\\dfrac{b(x+1)+(n-b)(x+2)}{(x+2)(x+1)}(x+2)^b(x+1)^{n-b}\\\\\n&=\\dfrac{nx+2n-b}{(x+2)(x+1)}(x+2)^b(x+1)^{n-b}\\\\\n\\end{aligned}\n$$\n $(x+2)(x+1)$ \n$$\n(x+2)(x+1)[(x+2)^b(x+1)^{n-b}]'=(nx+2n-b)(x+2)^b(x+1)^{n-b}\n$$\n $x^a$ \n$$\n\\begin{aligned}\n&(a-1)f(a-1,b)+3af(a,b)+2(a+1)f(a+1,b)\\\\\n&=nf(a-1,b)+(2n-b)f(a,b)\n\\end{aligned}\n$$\n\n$$\nf(a+1,b)=\\frac {(2n-b-3a)f(a,b)+(n-a+1)f(a-1,b)}{2(a+1)}\n$$\n\n$$\nf(a,b)=\\frac {(2n-b-3a+3)f(a-1,b)+(n-a+2)f(a-2,b)}{2a}\n$$\n $b \\in [1,m]$ \n\n $O(m^2)$\n\n 01  ```DP```\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nconst int P = 998244353;\n\nint n, m;\nlong long inv[5005], f[5005];\n\nint main() {\n    cin >> n >> m;\n    f[0] = inv[1] = 1;\n    rep(i, 2, m) inv[i] = (P - P / i) * inv[P % i] % P;\n    rep(i, 1, m) f[i] = f[i - 1] * (n - i + 1) % P * inv[i] % P;\n    int as = 0;\n    rep(i, 1, m) {\n        per(j, m, 0) f[j] = (f[j] * 2 + f[j - 1]) % P;\n        rep(j, 1, m) as ^= f[j] = (f[j] + P - f[j - 1]) % P;\n    }\n    cout << as;\n    return 0;\n}\n```\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nconst int P = 998244353;\n\nint n, m;\nlong long inv[10005], f[5005];\n\nint main() {\n    cin >> n >> m;\n    inv[1] = 1;\n    rep(i, 2, m * 2) inv[i] = (P - P / i) * inv[P % i] % P;\n    int as = 0;\n    f[0] = 1;\n    rep(i, 1, m) {\n        (f[0] *= 2) %= P;\n        rep(j, 1, m) as ^= f[j] = (((n * 2 - i - j * 3 + 3) * f[j - 1] + (n - j + 2) * f[j - 2]) % P * inv[j * 2] % P + P) % P;\n    }\n    cout << as;\n    return 0;\n}\n```","slug":"luogu7481","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0o0030ootn4omf2cgf","content":"<blockquote>\r\n<p><a href=\"https://www.luogu.com.cn/problem/P7481\"></a></p>\r\n<p> <span class=\"math inline\">\\(n,m\\)</span> <span class=\"math inline\">\\(m \\le n\\)</span> <span class=\"math inline\">\\(f(a,b)=\\sum\\limits_{i=0}^b\\binom bi\\binom {n-i}a\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\bigoplus\\limits_{a=1}^m\\bigoplus\\limits_{b=1}^m\\left(f(a,b) \\bmod 998244353\\right)\\)</span></p>\r\n<p><span class=\"math inline\">\\(n \\le 10^9,m \\le 5000\\)</span></p>\r\n</blockquote>\r\n<h3 id=\"\"></h3>\r\n<p><span class=\"math display\">\\[\r\n\\sum_{a=0}^n f(a,b)x^a=(x+2)^b(x+1)^{n-b}\r\n\\]</span></p>\r\n<h4 id=\"\"></h4>\r\n<p><span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;\\sum_{a=0}^n f(a,b)x^a\\\\\r\n&amp;=\\sum_{a=0}^n\\sum\\limits_{i=0}^b\\binom bi\\binom {n-i}ax^a\\\\\r\n&amp;=\\sum_{i=0}^b\\binom bi\\sum_{a=0}^n\\binom {n-i}ax^a\\\\\r\n&amp;=\\sum_{i=0}^b\\binom bi(x+1)^{n-i}\\\\\r\n&amp;=\\sum_{i=0}^b\\binom bi(x+1)^{b-i}(x+1)^{n-b}\\\\\r\n&amp;=(x+2)^b(x+1)^{n-b}\r\n\\end{aligned}\r\n\\]</span></p>\r\n<h4 id=\"\"></h4>\r\n<p> <span class=\"math inline\">\\(f(a,b)\\)</span>  <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(b\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\(i\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(n-i\\)</span>  <span class=\"math inline\">\\(a\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i \\in [0,b]\\)</span>  <span class=\"math inline\">\\(f(a,b)\\)</span>  <span class=\"math inline\">\\(a\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(y\\)</span> <span class=\"math inline\">\\(a=x+y\\)</span></p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(2\\)</span></p>\r\n<p> <span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\((x+2)^b\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n-b\\)</span>  <span class=\"math inline\">\\((x+1)^{n-b}\\)</span></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(\\sum\\limits_{a=0}^n f(a,b)x^a=(x+2)^b(x+1)^{n-b}\\)</span></p>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"-01--dp\"> 01  <code>DP</code></h4>\r\n<p> <span class=\"math display\">\\[\r\n\\sum_{a=0}^n f(a,b)x^a=\\frac {x+2}{x+1}\\sum_{a=0}^nf(a,b-1)x^a\r\n\\]</span>  <span class=\"math inline\">\\(x+2\\)</span>  <span class=\"math inline\">\\(x+1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(m^2)\\)</span></p>\r\n<h4 id=\"\"></h4>\r\n<p> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;[(x+2)^b(x+1)^{n-b}]&#39;\\\\\r\n&amp;=b(x+2)^{b-1}(x+1)^{n-b}+(x+2)^b(n-b)(x+1)^{n-b-1}\\\\\r\n&amp;=\\dfrac{b(x+1)+(n-b)(x+2)}{(x+2)(x+1)}(x+2)^b(x+1)^{n-b}\\\\\r\n&amp;=\\dfrac{nx+2n-b}{(x+2)(x+1)}(x+2)^b(x+1)^{n-b}\\\\\r\n\\end{aligned}\r\n\\]</span>  <span class=\"math inline\">\\((x+2)(x+1)\\)</span>  <span class=\"math display\">\\[\r\n(x+2)(x+1)[(x+2)^b(x+1)^{n-b}]&#39;=(nx+2n-b)(x+2)^b(x+1)^{n-b}\r\n\\]</span>  <span class=\"math inline\">\\(x^a\\)</span>  <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;(a-1)f(a-1,b)+3af(a,b)+2(a+1)f(a+1,b)\\\\\r\n&amp;=nf(a-1,b)+(2n-b)f(a,b)\r\n\\end{aligned}\r\n\\]</span>  <span class=\"math display\">\\[\r\nf(a+1,b)=\\frac {(2n-b-3a)f(a,b)+(n-a+1)f(a-1,b)}{2(a+1)}\r\n\\]</span>  <span class=\"math display\">\\[\r\nf(a,b)=\\frac {(2n-b-3a+3)f(a-1,b)+(n-a+2)f(a-2,b)}{2a}\r\n\\]</span>  <span class=\"math inline\">\\(b \\in [1,m]\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(m^2)\\)</span></p>\r\n<p> 01  <code>DP</code></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> P = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m;</span><br><span class=\"line\"><span class=\"keyword\">long</span> <span class=\"keyword\">long</span> inv[<span class=\"number\">5005</span>], f[<span class=\"number\">5005</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    f[<span class=\"number\">0</span>] = inv[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, m) inv[i] = (P - P / i) * inv[P % i] % P;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) f[i] = f[i - <span class=\"number\">1</span>] * (n - i + <span class=\"number\">1</span>) % P * inv[i] % P;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> as = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(j, m, <span class=\"number\">0</span>) f[j] = (f[j] * <span class=\"number\">2</span> + f[j - <span class=\"number\">1</span>]) % P;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) as ^= f[j] = (f[j] + P - f[j - <span class=\"number\">1</span>]) % P;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; as;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> P = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m;</span><br><span class=\"line\"><span class=\"keyword\">long</span> <span class=\"keyword\">long</span> inv[<span class=\"number\">10005</span>], f[<span class=\"number\">5005</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    inv[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, m * <span class=\"number\">2</span>) inv[i] = (P - P / i) * inv[P % i] % P;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> as = <span class=\"number\">0</span>;</span><br><span class=\"line\">    f[<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        (f[<span class=\"number\">0</span>] *= <span class=\"number\">2</span>) %= P;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) as ^= f[j] = (((n * <span class=\"number\">2</span> - i - j * <span class=\"number\">3</span> + <span class=\"number\">3</span>) * f[j - <span class=\"number\">1</span>] + (n - j + <span class=\"number\">2</span>) * f[j - <span class=\"number\">2</span>]) % P * inv[j * <span class=\"number\">2</span>] % P + P) % P;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; as;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2927,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://www.luogu.com.cn/problem/P7481\"></a></p>\r\n<p> <span class=\"math inline\">\\(n,m\\)</span> <span class=\"math inline\">\\(m \\le n\\)</span> <span class=\"math inline\">\\(f(a,b)=\\sum\\limits_{i=0}^b\\binom bi\\binom {n-i}a\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\bigoplus\\limits_{a=1}^m\\bigoplus\\limits_{b=1}^m\\left(f(a,b) \\bmod 998244353\\right)\\)</span></p>\r\n<p><span class=\"math inline\">\\(n \\le 10^9,m \\le 5000\\)</span></p>\r\n</blockquote>\r\n<h3 id=\"\"></h3>\r\n<p><span class=\"math display\">\\[\r\n\\sum_{a=0}^n f(a,b)x^a=(x+2)^b(x+1)^{n-b}\r\n\\]</span></p>\r\n<h4 id=\"\"></h4>\r\n<p><span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;\\sum_{a=0}^n f(a,b)x^a\\\\\r\n&amp;=\\sum_{a=0}^n\\sum\\limits_{i=0}^b\\binom bi\\binom {n-i}ax^a\\\\\r\n&amp;=\\sum_{i=0}^b\\binom bi\\sum_{a=0}^n\\binom {n-i}ax^a\\\\\r\n&amp;=\\sum_{i=0}^b\\binom bi(x+1)^{n-i}\\\\\r\n&amp;=\\sum_{i=0}^b\\binom bi(x+1)^{b-i}(x+1)^{n-b}\\\\\r\n&amp;=(x+2)^b(x+1)^{n-b}\r\n\\end{aligned}\r\n\\]</span></p>\r\n<h4 id=\"\"></h4>\r\n<p> <span class=\"math inline\">\\(f(a,b)\\)</span>  <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(b\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\(i\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(n-i\\)</span>  <span class=\"math inline\">\\(a\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i \\in [0,b]\\)</span>  <span class=\"math inline\">\\(f(a,b)\\)</span>  <span class=\"math inline\">\\(a\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(y\\)</span> <span class=\"math inline\">\\(a=x+y\\)</span></p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(2\\)</span></p>\r\n<p> <span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\((x+2)^b\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n-b\\)</span>  <span class=\"math inline\">\\((x+1)^{n-b}\\)</span></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(\\sum\\limits_{a=0}^n f(a,b)x^a=(x+2)^b(x+1)^{n-b}\\)</span></p>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"-01--dp\"> 01  <code>DP</code></h4>\r\n<p> <span class=\"math display\">\\[\r\n\\sum_{a=0}^n f(a,b)x^a=\\frac {x+2}{x+1}\\sum_{a=0}^nf(a,b-1)x^a\r\n\\]</span>  <span class=\"math inline\">\\(x+2\\)</span>  <span class=\"math inline\">\\(x+1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(m^2)\\)</span></p>\r\n<h4 id=\"\"></h4>\r\n<p> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;[(x+2)^b(x+1)^{n-b}]&#39;\\\\\r\n&amp;=b(x+2)^{b-1}(x+1)^{n-b}+(x+2)^b(n-b)(x+1)^{n-b-1}\\\\\r\n&amp;=\\dfrac{b(x+1)+(n-b)(x+2)}{(x+2)(x+1)}(x+2)^b(x+1)^{n-b}\\\\\r\n&amp;=\\dfrac{nx+2n-b}{(x+2)(x+1)}(x+2)^b(x+1)^{n-b}\\\\\r\n\\end{aligned}\r\n\\]</span>  <span class=\"math inline\">\\((x+2)(x+1)\\)</span>  <span class=\"math display\">\\[\r\n(x+2)(x+1)[(x+2)^b(x+1)^{n-b}]&#39;=(nx+2n-b)(x+2)^b(x+1)^{n-b}\r\n\\]</span>  <span class=\"math inline\">\\(x^a\\)</span>  <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;(a-1)f(a-1,b)+3af(a,b)+2(a+1)f(a+1,b)\\\\\r\n&amp;=nf(a-1,b)+(2n-b)f(a,b)\r\n\\end{aligned}\r\n\\]</span>  <span class=\"math display\">\\[\r\nf(a+1,b)=\\frac {(2n-b-3a)f(a,b)+(n-a+1)f(a-1,b)}{2(a+1)}\r\n\\]</span>  <span class=\"math display\">\\[\r\nf(a,b)=\\frac {(2n-b-3a+3)f(a-1,b)+(n-a+2)f(a-2,b)}{2a}\r\n\\]</span>  <span class=\"math inline\">\\(b \\in [1,m]\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(m^2)\\)</span></p>\r\n<p> 01  <code>DP</code></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> P = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m;</span><br><span class=\"line\"><span class=\"keyword\">long</span> <span class=\"keyword\">long</span> inv[<span class=\"number\">5005</span>], f[<span class=\"number\">5005</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    f[<span class=\"number\">0</span>] = inv[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, m) inv[i] = (P - P / i) * inv[P % i] % P;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) f[i] = f[i - <span class=\"number\">1</span>] * (n - i + <span class=\"number\">1</span>) % P * inv[i] % P;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> as = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(j, m, <span class=\"number\">0</span>) f[j] = (f[j] * <span class=\"number\">2</span> + f[j - <span class=\"number\">1</span>]) % P;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) as ^= f[j] = (f[j] + P - f[j - <span class=\"number\">1</span>]) % P;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; as;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> P = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m;</span><br><span class=\"line\"><span class=\"keyword\">long</span> <span class=\"keyword\">long</span> inv[<span class=\"number\">10005</span>], f[<span class=\"number\">5005</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class=\"line\">    inv[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, m * <span class=\"number\">2</span>) inv[i] = (P - P / i) * inv[P % i] % P;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> as = <span class=\"number\">0</span>;</span><br><span class=\"line\">    f[<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        (f[<span class=\"number\">0</span>] *= <span class=\"number\">2</span>) %= P;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) as ^= f[j] = (((n * <span class=\"number\">2</span> - i - j * <span class=\"number\">3</span> + <span class=\"number\">3</span>) * f[j - <span class=\"number\">1</span>] + (n - j + <span class=\"number\">2</span>) * f[j - <span class=\"number\">2</span>]) % P * inv[j * <span class=\"number\">2</span>] % P + P) % P;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; as;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":" |  P7482","date":"2021-04-12T07:24:46.000Z","updated":"2021-04-12T07:24:46.000Z","_content":"> [](https://www.luogu.com.cn/problem/P7482)\n>\n>  $n$  $A$ $f(l,r)$  $[l,r]$ \n>\n>  $\\sum\\limits_{l=1}^n\\sum\\limits_{r=l}^nf(l,r) \\bmod 10^9 + 7$\n>\n> $n \\le 10^5,0 \\le a_i \\le 10^9$\n\n$f(l,r)$  ```DP```  $O(r-l+1)$ \n\n $p$ $p$  $f$  $p$ $p$ ****\n\n $p$  $[l,r]$\n$$\nf(l,r)=\\max\\{f(l,p-1)+f(p+1,r),f(l,p-2)+f(p+2,r)+A_p\\}\n$$\n\n$$\nx_i=\\begin{cases}f(i,p-1)&(i < p)\\\\f(p+1,i)&(i>p)\\\\0&(i=p)\\end{cases},y_i=\\begin{cases}f(i,p-2)&(i<p-1)\\\\f(p+2,i)&(i>p+1)\\\\0&(p-1 \\le i \\le p+1)\\end{cases}\n$$\n$x,y$  ```DP```  $O(n)$ \n$$\nf(l,r)=\\max\\{x_l+x_r,y_l+y_r+A_p\\}\\\\\nx_l+x_r \\ge y_l + y_r + A_p \\iff (x_l - y_l) + (x_r - y_r) \\ge A_p\n$$\n $p$  $x_i-y_i$  $p$ $p$  $f$  $O(n\\log n)$\n\n $solve(L,R)$  $\\sum\\limits_{l=L}^R\\sum\\limits_{r=l}^Rf(l,r)$\n\n $mid = \\lfloor \\frac {L + R}2 \\rfloor$ $solve(L, R) = solve(L, mid) + solve(mid, R) - A_{mid} + \\sum\\limits_{l=L}^{mid-1}\\sum\\limits_{r=mid+1}^Rf(l,r)$\n\n $O(n \\log^2 n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nconst int N = 1e5 + 5;\ntypedef long long ll;\nconst ll P = 1e9 + 7, Inf = 1e18;\nint n; ll a[N], f[N][2][2], A[N], B[N], as;\nvoid solve(int l, int r) {\n    if(l == r) { (as += a[l]) %= P; return; }\n    if(r == l + 1) { (as += a[l] + a[r] + max(a[l], a[r])) %= P; return; }\n    int mid = (l + r) / 2;\n    rep(i, 0, 1) f[mid][i][i] = 0, f[mid][i][!i] = -Inf;\n    rep(i, mid + 1, r) rep(j, 0, 1) {\n        f[i][j][0] = max(f[i - 1][j][0], f[i - 1][j][1]);\n        f[i][j][1] = f[i - 1][j][0] + a[i];\n    }\n    per(i, mid - 1, l) rep(j, 0, 1) {\n        f[i][j][0] = max(f[i + 1][j][0], f[i + 1][j][1]);\n        f[i][j][1] = f[i + 1][j][0] + a[i];\n    }\n    vector <int> v;\n    rep(i, l, r) if(i ^ mid) {\n        v.pb(i);\n        A[i] = max(f[i][0][0], f[i][0][1]);\n        B[i] = max(f[i][1][0], f[i][1][1]);\n    }\n    sort(v.begin(), v.end(), [](int i, int j){ return A[i] - B[i] < A[j] - B[j]; });\n    int j = v.size() - 1;\n    ll sua = 0, sub = 0; int cna = 0, cnb = 0;\n    for(int i : v) if(i > mid) (sub += B[i]) %= P, cnb++;\n    for(int i : v) if(i < mid) {\n        while(j >= 0 && (v[j] < mid || A[i] - B[i] + A[v[j]] - B[v[j]] > a[mid])) {\n            if(v[j] > mid) (sua += A[v[j]]) %= P, (sub -= B[v[j]]) %= P, cna++, cnb--;\n            j--;\n        }\n        (as += (a[mid] + B[i]) * cnb + A[i] * cna + sua + sub) %= P;\n    }\n    (as -= a[mid]) %= P, solve(l, mid), solve(mid, r);\n}\nint main() {\n    cin >> n;\n    rep(i, 1, n) scanf(\"%lld\", &a[i]);\n    solve(1, n);\n    cout << (as + P) % P;\n    return 0;\n}\n```","source":"_posts/luogu7482.md","raw":"---\ntitle:  |  P7482\ndate: 2021-04-12 15:24:46\nupdated: 2021-04-12 15:24:46\ntags: [,]\ncategories: \n---\n> [](https://www.luogu.com.cn/problem/P7482)\n>\n>  $n$  $A$ $f(l,r)$  $[l,r]$ \n>\n>  $\\sum\\limits_{l=1}^n\\sum\\limits_{r=l}^nf(l,r) \\bmod 10^9 + 7$\n>\n> $n \\le 10^5,0 \\le a_i \\le 10^9$\n\n$f(l,r)$  ```DP```  $O(r-l+1)$ \n\n $p$ $p$  $f$  $p$ $p$ ****\n\n $p$  $[l,r]$\n$$\nf(l,r)=\\max\\{f(l,p-1)+f(p+1,r),f(l,p-2)+f(p+2,r)+A_p\\}\n$$\n\n$$\nx_i=\\begin{cases}f(i,p-1)&(i < p)\\\\f(p+1,i)&(i>p)\\\\0&(i=p)\\end{cases},y_i=\\begin{cases}f(i,p-2)&(i<p-1)\\\\f(p+2,i)&(i>p+1)\\\\0&(p-1 \\le i \\le p+1)\\end{cases}\n$$\n$x,y$  ```DP```  $O(n)$ \n$$\nf(l,r)=\\max\\{x_l+x_r,y_l+y_r+A_p\\}\\\\\nx_l+x_r \\ge y_l + y_r + A_p \\iff (x_l - y_l) + (x_r - y_r) \\ge A_p\n$$\n $p$  $x_i-y_i$  $p$ $p$  $f$  $O(n\\log n)$\n\n $solve(L,R)$  $\\sum\\limits_{l=L}^R\\sum\\limits_{r=l}^Rf(l,r)$\n\n $mid = \\lfloor \\frac {L + R}2 \\rfloor$ $solve(L, R) = solve(L, mid) + solve(mid, R) - A_{mid} + \\sum\\limits_{l=L}^{mid-1}\\sum\\limits_{r=mid+1}^Rf(l,r)$\n\n $O(n \\log^2 n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nconst int N = 1e5 + 5;\ntypedef long long ll;\nconst ll P = 1e9 + 7, Inf = 1e18;\nint n; ll a[N], f[N][2][2], A[N], B[N], as;\nvoid solve(int l, int r) {\n    if(l == r) { (as += a[l]) %= P; return; }\n    if(r == l + 1) { (as += a[l] + a[r] + max(a[l], a[r])) %= P; return; }\n    int mid = (l + r) / 2;\n    rep(i, 0, 1) f[mid][i][i] = 0, f[mid][i][!i] = -Inf;\n    rep(i, mid + 1, r) rep(j, 0, 1) {\n        f[i][j][0] = max(f[i - 1][j][0], f[i - 1][j][1]);\n        f[i][j][1] = f[i - 1][j][0] + a[i];\n    }\n    per(i, mid - 1, l) rep(j, 0, 1) {\n        f[i][j][0] = max(f[i + 1][j][0], f[i + 1][j][1]);\n        f[i][j][1] = f[i + 1][j][0] + a[i];\n    }\n    vector <int> v;\n    rep(i, l, r) if(i ^ mid) {\n        v.pb(i);\n        A[i] = max(f[i][0][0], f[i][0][1]);\n        B[i] = max(f[i][1][0], f[i][1][1]);\n    }\n    sort(v.begin(), v.end(), [](int i, int j){ return A[i] - B[i] < A[j] - B[j]; });\n    int j = v.size() - 1;\n    ll sua = 0, sub = 0; int cna = 0, cnb = 0;\n    for(int i : v) if(i > mid) (sub += B[i]) %= P, cnb++;\n    for(int i : v) if(i < mid) {\n        while(j >= 0 && (v[j] < mid || A[i] - B[i] + A[v[j]] - B[v[j]] > a[mid])) {\n            if(v[j] > mid) (sua += A[v[j]]) %= P, (sub -= B[v[j]]) %= P, cna++, cnb--;\n            j--;\n        }\n        (as += (a[mid] + B[i]) * cnb + A[i] * cna + sua + sub) %= P;\n    }\n    (as -= a[mid]) %= P, solve(l, mid), solve(mid, r);\n}\nint main() {\n    cin >> n;\n    rep(i, 1, n) scanf(\"%lld\", &a[i]);\n    solve(1, n);\n    cout << (as + P) % P;\n    return 0;\n}\n```","slug":"luogu7482","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0q0033ootn0g78bh46","content":"<blockquote>\r\n<p><a href=\"https://www.luogu.com.cn/problem/P7482\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span> <span class=\"math inline\">\\(f(l,r)\\)</span>  <span class=\"math inline\">\\([l,r]\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\sum\\limits_{l=1}^n\\sum\\limits_{r=l}^nf(l,r) \\bmod 10^9 + 7\\)</span></p>\r\n<p><span class=\"math inline\">\\(n \\le 10^5,0 \\le a_i \\le 10^9\\)</span></p>\r\n</blockquote>\r\n<p><span class=\"math inline\">\\(f(l,r)\\)</span>  <code>DP</code>  <span class=\"math inline\">\\(O(r-l+1)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(p\\)</span> <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(f\\)</span>  <span class=\"math inline\">\\(p\\)</span> <span class=\"math inline\">\\(p\\)</span> <strong></strong></p>\r\n<p> <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\([l,r]\\)</span> <span class=\"math display\">\\[\r\nf(l,r)=\\max\\{f(l,p-1)+f(p+1,r),f(l,p-2)+f(p+2,r)+A_p\\}\r\n\\]</span>  <span class=\"math display\">\\[\r\nx_i=\\begin{cases}f(i,p-1)&amp;(i &lt; p)\\\\f(p+1,i)&amp;(i&gt;p)\\\\0&amp;(i=p)\\end{cases},y_i=\\begin{cases}f(i,p-2)&amp;(i&lt;p-1)\\\\f(p+2,i)&amp;(i&gt;p+1)\\\\0&amp;(p-1 \\le i \\le p+1)\\end{cases}\r\n\\]</span> <span class=\"math inline\">\\(x,y\\)</span>  <code>DP</code>  <span class=\"math inline\">\\(O(n)\\)</span>  <span class=\"math display\">\\[\r\nf(l,r)=\\max\\{x_l+x_r,y_l+y_r+A_p\\}\\\\\r\nx_l+x_r \\ge y_l + y_r + A_p \\iff (x_l - y_l) + (x_r - y_r) \\ge A_p\r\n\\]</span>  <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(x_i-y_i\\)</span>  <span class=\"math inline\">\\(p\\)</span> <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(f\\)</span>  <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(solve(L,R)\\)</span>  <span class=\"math inline\">\\(\\sum\\limits_{l=L}^R\\sum\\limits_{r=l}^Rf(l,r)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(mid = \\lfloor \\frac {L + R}2 \\rfloor\\)</span> <span class=\"math inline\">\\(solve(L, R) = solve(L, mid) + solve(mid, R) - A_{mid} + \\sum\\limits_{l=L}^{mid-1}\\sum\\limits_{r=mid+1}^Rf(l,r)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n \\log^2 n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> ll P = <span class=\"number\">1e9</span> + <span class=\"number\">7</span>, Inf = <span class=\"number\">1e18</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n; ll a[N], f[N][<span class=\"number\">2</span>][<span class=\"number\">2</span>], A[N], B[N], as;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">(<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l == r) &#123; (as += a[l]) %= P; <span class=\"keyword\">return</span>; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(r == l + <span class=\"number\">1</span>) &#123; (as += a[l] + a[r] + <span class=\"built_in\">max</span>(a[l], a[r])) %= P; <span class=\"keyword\">return</span>; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> mid = (l + r) / <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, <span class=\"number\">1</span>) f[mid][i][i] = <span class=\"number\">0</span>, f[mid][i][!i] = -Inf;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, mid + <span class=\"number\">1</span>, r) <span class=\"built_in\">rep</span>(j, <span class=\"number\">0</span>, <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        f[i][j][<span class=\"number\">0</span>] = <span class=\"built_in\">max</span>(f[i - <span class=\"number\">1</span>][j][<span class=\"number\">0</span>], f[i - <span class=\"number\">1</span>][j][<span class=\"number\">1</span>]);</span><br><span class=\"line\">        f[i][j][<span class=\"number\">1</span>] = f[i - <span class=\"number\">1</span>][j][<span class=\"number\">0</span>] + a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, mid - <span class=\"number\">1</span>, l) <span class=\"built_in\">rep</span>(j, <span class=\"number\">0</span>, <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        f[i][j][<span class=\"number\">0</span>] = <span class=\"built_in\">max</span>(f[i + <span class=\"number\">1</span>][j][<span class=\"number\">0</span>], f[i + <span class=\"number\">1</span>][j][<span class=\"number\">1</span>]);</span><br><span class=\"line\">        f[i][j][<span class=\"number\">1</span>] = f[i + <span class=\"number\">1</span>][j][<span class=\"number\">0</span>] + a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    vector &lt;<span class=\"keyword\">int</span>&gt; v;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, l, r) <span class=\"keyword\">if</span>(i ^ mid) &#123;</span><br><span class=\"line\">        v.<span class=\"built_in\">pb</span>(i);</span><br><span class=\"line\">        A[i] = <span class=\"built_in\">max</span>(f[i][<span class=\"number\">0</span>][<span class=\"number\">0</span>], f[i][<span class=\"number\">0</span>][<span class=\"number\">1</span>]);</span><br><span class=\"line\">        B[i] = <span class=\"built_in\">max</span>(f[i][<span class=\"number\">1</span>][<span class=\"number\">0</span>], f[i][<span class=\"number\">1</span>][<span class=\"number\">1</span>]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(v.<span class=\"built_in\">begin</span>(), v.<span class=\"built_in\">end</span>(), [](<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> j)&#123; <span class=\"keyword\">return</span> A[i] - B[i] &lt; A[j] - B[j]; &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> j = v.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>;</span><br><span class=\"line\">    ll sua = <span class=\"number\">0</span>, sub = <span class=\"number\">0</span>; <span class=\"keyword\">int</span> cna = <span class=\"number\">0</span>, cnb = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i : v) <span class=\"keyword\">if</span>(i &gt; mid) (sub += B[i]) %= P, cnb++;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i : v) <span class=\"keyword\">if</span>(i &lt; mid) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(j &gt;= <span class=\"number\">0</span> &amp;&amp; (v[j] &lt; mid || A[i] - B[i] + A[v[j]] - B[v[j]] &gt; a[mid])) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(v[j] &gt; mid) (sua += A[v[j]]) %= P, (sub -= B[v[j]]) %= P, cna++, cnb--;</span><br><span class=\"line\">            j--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        (as += (a[mid] + B[i]) * cnb + A[i] * cna + sua + sub) %= P;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    (as -= a[mid]) %= P, <span class=\"built_in\">solve</span>(l, mid), <span class=\"built_in\">solve</span>(mid, r);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%lld&quot;</span>, &amp;a[i]);</span><br><span class=\"line\">    <span class=\"built_in\">solve</span>(<span class=\"number\">1</span>, n);</span><br><span class=\"line\">    cout &lt;&lt; (as + P) % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2579,"excerpt":"","more":"<blockquote>\r\n<p><a href=\"https://www.luogu.com.cn/problem/P7482\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span> <span class=\"math inline\">\\(f(l,r)\\)</span>  <span class=\"math inline\">\\([l,r]\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\sum\\limits_{l=1}^n\\sum\\limits_{r=l}^nf(l,r) \\bmod 10^9 + 7\\)</span></p>\r\n<p><span class=\"math inline\">\\(n \\le 10^5,0 \\le a_i \\le 10^9\\)</span></p>\r\n</blockquote>\r\n<p><span class=\"math inline\">\\(f(l,r)\\)</span>  <code>DP</code>  <span class=\"math inline\">\\(O(r-l+1)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(p\\)</span> <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(f\\)</span>  <span class=\"math inline\">\\(p\\)</span> <span class=\"math inline\">\\(p\\)</span> <strong></strong></p>\r\n<p> <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\([l,r]\\)</span> <span class=\"math display\">\\[\r\nf(l,r)=\\max\\{f(l,p-1)+f(p+1,r),f(l,p-2)+f(p+2,r)+A_p\\}\r\n\\]</span>  <span class=\"math display\">\\[\r\nx_i=\\begin{cases}f(i,p-1)&amp;(i &lt; p)\\\\f(p+1,i)&amp;(i&gt;p)\\\\0&amp;(i=p)\\end{cases},y_i=\\begin{cases}f(i,p-2)&amp;(i&lt;p-1)\\\\f(p+2,i)&amp;(i&gt;p+1)\\\\0&amp;(p-1 \\le i \\le p+1)\\end{cases}\r\n\\]</span> <span class=\"math inline\">\\(x,y\\)</span>  <code>DP</code>  <span class=\"math inline\">\\(O(n)\\)</span>  <span class=\"math display\">\\[\r\nf(l,r)=\\max\\{x_l+x_r,y_l+y_r+A_p\\}\\\\\r\nx_l+x_r \\ge y_l + y_r + A_p \\iff (x_l - y_l) + (x_r - y_r) \\ge A_p\r\n\\]</span>  <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(x_i-y_i\\)</span>  <span class=\"math inline\">\\(p\\)</span> <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(f\\)</span>  <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(solve(L,R)\\)</span>  <span class=\"math inline\">\\(\\sum\\limits_{l=L}^R\\sum\\limits_{r=l}^Rf(l,r)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(mid = \\lfloor \\frac {L + R}2 \\rfloor\\)</span> <span class=\"math inline\">\\(solve(L, R) = solve(L, mid) + solve(mid, R) - A_{mid} + \\sum\\limits_{l=L}^{mid-1}\\sum\\limits_{r=mid+1}^Rf(l,r)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n \\log^2 n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> ll P = <span class=\"number\">1e9</span> + <span class=\"number\">7</span>, Inf = <span class=\"number\">1e18</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n; ll a[N], f[N][<span class=\"number\">2</span>][<span class=\"number\">2</span>], A[N], B[N], as;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">(<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l == r) &#123; (as += a[l]) %= P; <span class=\"keyword\">return</span>; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(r == l + <span class=\"number\">1</span>) &#123; (as += a[l] + a[r] + <span class=\"built_in\">max</span>(a[l], a[r])) %= P; <span class=\"keyword\">return</span>; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> mid = (l + r) / <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, <span class=\"number\">1</span>) f[mid][i][i] = <span class=\"number\">0</span>, f[mid][i][!i] = -Inf;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, mid + <span class=\"number\">1</span>, r) <span class=\"built_in\">rep</span>(j, <span class=\"number\">0</span>, <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        f[i][j][<span class=\"number\">0</span>] = <span class=\"built_in\">max</span>(f[i - <span class=\"number\">1</span>][j][<span class=\"number\">0</span>], f[i - <span class=\"number\">1</span>][j][<span class=\"number\">1</span>]);</span><br><span class=\"line\">        f[i][j][<span class=\"number\">1</span>] = f[i - <span class=\"number\">1</span>][j][<span class=\"number\">0</span>] + a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, mid - <span class=\"number\">1</span>, l) <span class=\"built_in\">rep</span>(j, <span class=\"number\">0</span>, <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        f[i][j][<span class=\"number\">0</span>] = <span class=\"built_in\">max</span>(f[i + <span class=\"number\">1</span>][j][<span class=\"number\">0</span>], f[i + <span class=\"number\">1</span>][j][<span class=\"number\">1</span>]);</span><br><span class=\"line\">        f[i][j][<span class=\"number\">1</span>] = f[i + <span class=\"number\">1</span>][j][<span class=\"number\">0</span>] + a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    vector &lt;<span class=\"keyword\">int</span>&gt; v;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, l, r) <span class=\"keyword\">if</span>(i ^ mid) &#123;</span><br><span class=\"line\">        v.<span class=\"built_in\">pb</span>(i);</span><br><span class=\"line\">        A[i] = <span class=\"built_in\">max</span>(f[i][<span class=\"number\">0</span>][<span class=\"number\">0</span>], f[i][<span class=\"number\">0</span>][<span class=\"number\">1</span>]);</span><br><span class=\"line\">        B[i] = <span class=\"built_in\">max</span>(f[i][<span class=\"number\">1</span>][<span class=\"number\">0</span>], f[i][<span class=\"number\">1</span>][<span class=\"number\">1</span>]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(v.<span class=\"built_in\">begin</span>(), v.<span class=\"built_in\">end</span>(), [](<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> j)&#123; <span class=\"keyword\">return</span> A[i] - B[i] &lt; A[j] - B[j]; &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> j = v.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>;</span><br><span class=\"line\">    ll sua = <span class=\"number\">0</span>, sub = <span class=\"number\">0</span>; <span class=\"keyword\">int</span> cna = <span class=\"number\">0</span>, cnb = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i : v) <span class=\"keyword\">if</span>(i &gt; mid) (sub += B[i]) %= P, cnb++;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i : v) <span class=\"keyword\">if</span>(i &lt; mid) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(j &gt;= <span class=\"number\">0</span> &amp;&amp; (v[j] &lt; mid || A[i] - B[i] + A[v[j]] - B[v[j]] &gt; a[mid])) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(v[j] &gt; mid) (sua += A[v[j]]) %= P, (sub -= B[v[j]]) %= P, cna++, cnb--;</span><br><span class=\"line\">            j--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        (as += (a[mid] + B[i]) * cnb + A[i] * cna + sua + sub) %= P;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    (as -= a[mid]) %= P, <span class=\"built_in\">solve</span>(l, mid), <span class=\"built_in\">solve</span>(mid, r);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%lld&quot;</span>, &amp;a[i]);</span><br><span class=\"line\">    <span class=\"built_in\">solve</span>(<span class=\"number\">1</span>, n);</span><br><span class=\"line\">    cout &lt;&lt; (as + P) % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"NIM  & SG ","date":"2021-03-31T02:45:39.000Z","updated":"2021-03-31T02:45:39.000Z","_content":"****************\n\n### \n\n> ****\n\n $u$  $k$  $v_1,v_2,\\cdots,v_k$ ```SG``` \n$$\nSG(u)=\\text{mex}\\{SG(v_1),SG(v_2),\\cdots,SG(v_k)\\}\n$$\n $u$  $SG(u)=0$\n\n $SG(u) \\ne 0$\n\n $n$  $n$  $S$ $s_1,s_2,\\cdots,s_n$ **```SG``` **\n\n$SG(S) = SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_n)$\n\n****\n\n-  $S$$\\forall i \\in [1,n], SG(s_i)=0, SG(S)=0$\n\n-  $S$  $SG(s_1) + SG(s_2) + \\cdots + SG(s_n) = m$ $SG(s_1') + SG(s_2') + \\cdots + SG(s_n') < m$  $SG(s_1') + SG(s_2') + \\cdots + SG(s_n') = m$  $S$ \n\n-  $SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_n) =k$\n\n   $\\forall k' < k$, $S$  $S'$  $SG(S')=k'$ \n  \n   $k \\oplus k'$  $m$  $k' < k$,  $k'$  $m$  $0$$k$  $m$  $1$\n\n   $i$  $SG(s_i)$  $m$  $1$\n\n   $SG(s_i) \\oplus k \\oplus k' < SG(s_i)$ ```SG``` $s_i$  $s_i'$ $SG(s_i') = SG(s_i) \\oplus k \\oplus k'$\n\n   $s_i$  $s_i'$  $SG(s_1) + SG(s_2) + \\cdots + SG(s_i') + \\cdots + SG(s_n) < m$ $SG(S')=SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_i') \\oplus \\cdots \\oplus SG(s_n)=k'$\n\n   $S$  $S'$  $SG(S')=k$\n\n   $s_i$  $s_i'$ $SG(s_i') \\ne SG(s_i)$\n\n   $SG(s_i') < SG(s_i)$ $SG(s_1) + SG(s_2) + \\cdots + SG(s_i') + \\cdots + SG(s_n) < m$ $SG(S')=SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_i') \\oplus \\cdots \\oplus SG(s_n) \\ne k$\n\n   $SG(s_i') > SG(s_i)$ $SG(s_1) + SG(s_2) + \\cdots + SG(s_i') + \\cdots + SG(s_n) > m$ $SG(S')$  $SG(S') \\ne k$ ```SG``` $s_i'$  $s_i''$ $SG(s_i'') = SG(s_i)$ $SG(s_1) + SG(s_2) + \\cdots + SG(s_i'') + \\cdots + SG(s_n) = m$ $S''$  $S$ $SG(S'')=SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_i'') \\oplus \\cdots \\oplus SG(s_n)=k$ $SG(S') \\ne k$\n\n### NIM \n\n **NIM **\n\n> $n$  $a_i$ \n>\n> \n\n $x$  $x$ \n\nNIM  $n$ \n\n $SG(x)=x$ ```SG```  $a_1 \\oplus a_2 \\oplus \\cdots \\oplus a_n \\ne 0$ \n\n###  NIM \n\n>  $n$  $a_i$  $i$ $i > 1$ $i-1$ \n>\n> \n\n** $\\lfloor \\frac n2 \\rfloor$   $a_{2i}$  NIM **\n\n NIM  ```A``` ```B```  ```A``` \n\n-  ```B```   $2i$ ```A```  NIM \n-  ```B```  $2i+1$ ```A```  $2i-1$ \n\n","source":"_posts/nim-you-xi-and-sg-ding-li.md","raw":"---\ntitle: NIM  & SG \ndate: 2021-03-31 10:45:39\nupdated: 2021-03-31 10:45:39\ntags: [,, NIM ]\ncategories: \n---\n****************\n\n### \n\n> ****\n\n $u$  $k$  $v_1,v_2,\\cdots,v_k$ ```SG``` \n$$\nSG(u)=\\text{mex}\\{SG(v_1),SG(v_2),\\cdots,SG(v_k)\\}\n$$\n $u$  $SG(u)=0$\n\n $SG(u) \\ne 0$\n\n $n$  $n$  $S$ $s_1,s_2,\\cdots,s_n$ **```SG``` **\n\n$SG(S) = SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_n)$\n\n****\n\n-  $S$$\\forall i \\in [1,n], SG(s_i)=0, SG(S)=0$\n\n-  $S$  $SG(s_1) + SG(s_2) + \\cdots + SG(s_n) = m$ $SG(s_1') + SG(s_2') + \\cdots + SG(s_n') < m$  $SG(s_1') + SG(s_2') + \\cdots + SG(s_n') = m$  $S$ \n\n-  $SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_n) =k$\n\n   $\\forall k' < k$, $S$  $S'$  $SG(S')=k'$ \n  \n   $k \\oplus k'$  $m$  $k' < k$,  $k'$  $m$  $0$$k$  $m$  $1$\n\n   $i$  $SG(s_i)$  $m$  $1$\n\n   $SG(s_i) \\oplus k \\oplus k' < SG(s_i)$ ```SG``` $s_i$  $s_i'$ $SG(s_i') = SG(s_i) \\oplus k \\oplus k'$\n\n   $s_i$  $s_i'$  $SG(s_1) + SG(s_2) + \\cdots + SG(s_i') + \\cdots + SG(s_n) < m$ $SG(S')=SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_i') \\oplus \\cdots \\oplus SG(s_n)=k'$\n\n   $S$  $S'$  $SG(S')=k$\n\n   $s_i$  $s_i'$ $SG(s_i') \\ne SG(s_i)$\n\n   $SG(s_i') < SG(s_i)$ $SG(s_1) + SG(s_2) + \\cdots + SG(s_i') + \\cdots + SG(s_n) < m$ $SG(S')=SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_i') \\oplus \\cdots \\oplus SG(s_n) \\ne k$\n\n   $SG(s_i') > SG(s_i)$ $SG(s_1) + SG(s_2) + \\cdots + SG(s_i') + \\cdots + SG(s_n) > m$ $SG(S')$  $SG(S') \\ne k$ ```SG``` $s_i'$  $s_i''$ $SG(s_i'') = SG(s_i)$ $SG(s_1) + SG(s_2) + \\cdots + SG(s_i'') + \\cdots + SG(s_n) = m$ $S''$  $S$ $SG(S'')=SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_i'') \\oplus \\cdots \\oplus SG(s_n)=k$ $SG(S') \\ne k$\n\n### NIM \n\n **NIM **\n\n> $n$  $a_i$ \n>\n> \n\n $x$  $x$ \n\nNIM  $n$ \n\n $SG(x)=x$ ```SG```  $a_1 \\oplus a_2 \\oplus \\cdots \\oplus a_n \\ne 0$ \n\n###  NIM \n\n>  $n$  $a_i$  $i$ $i > 1$ $i-1$ \n>\n> \n\n** $\\lfloor \\frac n2 \\rfloor$   $a_{2i}$  NIM **\n\n NIM  ```A``` ```B```  ```A``` \n\n-  ```B```   $2i$ ```A```  NIM \n-  ```B```  $2i+1$ ```A```  $2i-1$ \n\n","slug":"nim-you-xi-and-sg-ding-li","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0r0036ootn68hf2kpr","content":"<p><strong></strong><strong></strong><strong></strong><strong></strong></p>\r\n<h3 id=\"\"></h3>\r\n<blockquote>\r\n<p><strong></strong></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(v_1,v_2,\\cdots,v_k\\)</span> <code>SG</code>  <span class=\"math display\">\\[\r\nSG(u)=\\text{mex}\\{SG(v_1),SG(v_2),\\cdots,SG(v_k)\\}\r\n\\]</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(SG(u)=0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(SG(u) \\ne 0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(s_1,s_2,\\cdots,s_n\\)</span> <strong><code>SG</code> </strong></p>\r\n<p><span class=\"math inline\">\\(SG(S) = SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_n)\\)</span></p>\r\n<p><strong></strong></p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(S\\)</span><span class=\"math inline\">\\(\\forall i \\in [1,n], SG(s_i)=0, SG(S)=0\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(SG(s_1) + SG(s_2) + \\cdots + SG(s_n) = m\\)</span> <span class=\"math inline\">\\(SG(s_1&#39;) + SG(s_2&#39;) + \\cdots + SG(s_n&#39;) &lt; m\\)</span>  <span class=\"math inline\">\\(SG(s_1&#39;) + SG(s_2&#39;) + \\cdots + SG(s_n&#39;) = m\\)</span>  <span class=\"math inline\">\\(S\\)</span> </p></li>\r\n<li><p> <span class=\"math inline\">\\(SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_n) =k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\forall k&#39; &lt; k\\)</span>, <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S&#39;\\)</span>  <span class=\"math inline\">\\(SG(S&#39;)=k&#39;\\)</span></p>\r\n<p> <span class=\"math inline\">\\(k \\oplus k&#39;\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(k&#39; &lt; k\\)</span>,  <span class=\"math inline\">\\(k&#39;\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(0\\)</span><span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(SG(s_i)\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(SG(s_i) \\oplus k \\oplus k&#39; &lt; SG(s_i)\\)</span> <code>SG</code> <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(s_i&#39;\\)</span> <span class=\"math inline\">\\(SG(s_i&#39;) = SG(s_i) \\oplus k \\oplus k&#39;\\)</span></p>\r\n<p> <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(s_i&#39;\\)</span>  <span class=\"math inline\">\\(SG(s_1) + SG(s_2) + \\cdots + SG(s_i&#39;) + \\cdots + SG(s_n) &lt; m\\)</span> <span class=\"math inline\">\\(SG(S&#39;)=SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_i&#39;) \\oplus \\cdots \\oplus SG(s_n)=k&#39;\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S&#39;\\)</span>  <span class=\"math inline\">\\(SG(S&#39;)=k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(s_i&#39;\\)</span> <span class=\"math inline\">\\(SG(s_i&#39;) \\ne SG(s_i)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(SG(s_i&#39;) &lt; SG(s_i)\\)</span> <span class=\"math inline\">\\(SG(s_1) + SG(s_2) + \\cdots + SG(s_i&#39;) + \\cdots + SG(s_n) &lt; m\\)</span> <span class=\"math inline\">\\(SG(S&#39;)=SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_i&#39;) \\oplus \\cdots \\oplus SG(s_n) \\ne k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(SG(s_i&#39;) &gt; SG(s_i)\\)</span> <span class=\"math inline\">\\(SG(s_1) + SG(s_2) + \\cdots + SG(s_i&#39;) + \\cdots + SG(s_n) &gt; m\\)</span> <span class=\"math inline\">\\(SG(S&#39;)\\)</span>  <span class=\"math inline\">\\(SG(S&#39;) \\ne k\\)</span> <code>SG</code> <span class=\"math inline\">\\(s_i&#39;\\)</span>  <span class=\"math inline\">\\(s_i&#39;&#39;\\)</span> <span class=\"math inline\">\\(SG(s_i&#39;&#39;) = SG(s_i)\\)</span> <span class=\"math inline\">\\(SG(s_1) + SG(s_2) + \\cdots + SG(s_i&#39;&#39;) + \\cdots + SG(s_n) = m\\)</span> <span class=\"math inline\">\\(S&#39;&#39;\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(SG(S&#39;&#39;)=SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_i&#39;&#39;) \\oplus \\cdots \\oplus SG(s_n)=k\\)</span> <span class=\"math inline\">\\(SG(S&#39;) \\ne k\\)</span></p></li>\r\n</ul>\r\n<h3 id=\"nim-\">NIM </h3>\r\n<p> <strong>NIM </strong></p>\r\n<blockquote>\r\n<p><span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(a_i\\)</span> </p>\r\n<p></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(x\\)</span> </p>\r\n<p>NIM  <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(SG(x)=x\\)</span> <code>SG</code>  <span class=\"math inline\">\\(a_1 \\oplus a_2 \\oplus \\cdots \\oplus a_n \\ne 0\\)</span> </p>\r\n<h3 id=\"-nim-\"> NIM </h3>\r\n<blockquote>\r\n<p><span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(a_i\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(i &gt; 1\\)</span> <span class=\"math inline\">\\(i-1\\)</span> </p>\r\n<p></p>\r\n</blockquote>\r\n<p><strong> <span class=\"math inline\">\\(\\lfloor \\frac n2 \\rfloor\\)</span>  <span class=\"math inline\">\\(a_{2i}\\)</span>  NIM </strong></p>\r\n<p> NIM  <code>A</code> <code>B</code>  <code>A</code> </p>\r\n<ul>\r\n<li> <code>B</code>  <span class=\"math inline\">\\(2i\\)</span> <code>A</code>  NIM </li>\r\n<li> <code>B</code>  <span class=\"math inline\">\\(2i+1\\)</span> <code>A</code>  <span class=\"math inline\">\\(2i-1\\)</span> </li>\r\n</ul>\r\n<p></p>\r\n","site":{"data":{}},"length":2594,"excerpt":"","more":"<p><strong></strong><strong></strong><strong></strong><strong></strong></p>\r\n<h3 id=\"\"></h3>\r\n<blockquote>\r\n<p><strong></strong></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(v_1,v_2,\\cdots,v_k\\)</span> <code>SG</code>  <span class=\"math display\">\\[\r\nSG(u)=\\text{mex}\\{SG(v_1),SG(v_2),\\cdots,SG(v_k)\\}\r\n\\]</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(SG(u)=0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(SG(u) \\ne 0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(s_1,s_2,\\cdots,s_n\\)</span> <strong><code>SG</code> </strong></p>\r\n<p><span class=\"math inline\">\\(SG(S) = SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_n)\\)</span></p>\r\n<p><strong></strong></p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(S\\)</span><span class=\"math inline\">\\(\\forall i \\in [1,n], SG(s_i)=0, SG(S)=0\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(SG(s_1) + SG(s_2) + \\cdots + SG(s_n) = m\\)</span> <span class=\"math inline\">\\(SG(s_1&#39;) + SG(s_2&#39;) + \\cdots + SG(s_n&#39;) &lt; m\\)</span>  <span class=\"math inline\">\\(SG(s_1&#39;) + SG(s_2&#39;) + \\cdots + SG(s_n&#39;) = m\\)</span>  <span class=\"math inline\">\\(S\\)</span> </p></li>\r\n<li><p> <span class=\"math inline\">\\(SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_n) =k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\forall k&#39; &lt; k\\)</span>, <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S&#39;\\)</span>  <span class=\"math inline\">\\(SG(S&#39;)=k&#39;\\)</span></p>\r\n<p> <span class=\"math inline\">\\(k \\oplus k&#39;\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(k&#39; &lt; k\\)</span>,  <span class=\"math inline\">\\(k&#39;\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(0\\)</span><span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(SG(s_i)\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(SG(s_i) \\oplus k \\oplus k&#39; &lt; SG(s_i)\\)</span> <code>SG</code> <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(s_i&#39;\\)</span> <span class=\"math inline\">\\(SG(s_i&#39;) = SG(s_i) \\oplus k \\oplus k&#39;\\)</span></p>\r\n<p> <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(s_i&#39;\\)</span>  <span class=\"math inline\">\\(SG(s_1) + SG(s_2) + \\cdots + SG(s_i&#39;) + \\cdots + SG(s_n) &lt; m\\)</span> <span class=\"math inline\">\\(SG(S&#39;)=SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_i&#39;) \\oplus \\cdots \\oplus SG(s_n)=k&#39;\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S&#39;\\)</span>  <span class=\"math inline\">\\(SG(S&#39;)=k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(s_i\\)</span>  <span class=\"math inline\">\\(s_i&#39;\\)</span> <span class=\"math inline\">\\(SG(s_i&#39;) \\ne SG(s_i)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(SG(s_i&#39;) &lt; SG(s_i)\\)</span> <span class=\"math inline\">\\(SG(s_1) + SG(s_2) + \\cdots + SG(s_i&#39;) + \\cdots + SG(s_n) &lt; m\\)</span> <span class=\"math inline\">\\(SG(S&#39;)=SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_i&#39;) \\oplus \\cdots \\oplus SG(s_n) \\ne k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(SG(s_i&#39;) &gt; SG(s_i)\\)</span> <span class=\"math inline\">\\(SG(s_1) + SG(s_2) + \\cdots + SG(s_i&#39;) + \\cdots + SG(s_n) &gt; m\\)</span> <span class=\"math inline\">\\(SG(S&#39;)\\)</span>  <span class=\"math inline\">\\(SG(S&#39;) \\ne k\\)</span> <code>SG</code> <span class=\"math inline\">\\(s_i&#39;\\)</span>  <span class=\"math inline\">\\(s_i&#39;&#39;\\)</span> <span class=\"math inline\">\\(SG(s_i&#39;&#39;) = SG(s_i)\\)</span> <span class=\"math inline\">\\(SG(s_1) + SG(s_2) + \\cdots + SG(s_i&#39;&#39;) + \\cdots + SG(s_n) = m\\)</span> <span class=\"math inline\">\\(S&#39;&#39;\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(SG(S&#39;&#39;)=SG(s_1) \\oplus SG(s_2) \\oplus \\cdots \\oplus SG(s_i&#39;&#39;) \\oplus \\cdots \\oplus SG(s_n)=k\\)</span> <span class=\"math inline\">\\(SG(S&#39;) \\ne k\\)</span></p></li>\r\n</ul>\r\n<h3 id=\"nim-\">NIM </h3>\r\n<p> <strong>NIM </strong></p>\r\n<blockquote>\r\n<p><span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(a_i\\)</span> </p>\r\n<p></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(x\\)</span> </p>\r\n<p>NIM  <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(SG(x)=x\\)</span> <code>SG</code>  <span class=\"math inline\">\\(a_1 \\oplus a_2 \\oplus \\cdots \\oplus a_n \\ne 0\\)</span> </p>\r\n<h3 id=\"-nim-\"> NIM </h3>\r\n<blockquote>\r\n<p><span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(a_i\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(i &gt; 1\\)</span> <span class=\"math inline\">\\(i-1\\)</span> </p>\r\n<p></p>\r\n</blockquote>\r\n<p><strong> <span class=\"math inline\">\\(\\lfloor \\frac n2 \\rfloor\\)</span>  <span class=\"math inline\">\\(a_{2i}\\)</span>  NIM </strong></p>\r\n<p> NIM  <code>A</code> <code>B</code>  <code>A</code> </p>\r\n<ul>\r\n<li> <code>B</code>  <span class=\"math inline\">\\(2i\\)</span> <code>A</code>  NIM </li>\r\n<li> <code>B</code>  <span class=\"math inline\">\\(2i+1\\)</span> <code>A</code>  <span class=\"math inline\">\\(2i-1\\)</span> </li>\r\n</ul>\r\n<p></p>\r\n"},{"title":"","date":"2021-03-13T14:05:04.000Z","updated":"2021-03-13T14:05:04.000Z","_content":">  $n$  $u$  $k_u$ $m$ ****$q$ \n>\n> $n, m, q  \\le 10^5$\n\n\n\n $Max_u$ $u$**** $Max$ $Max$ \n\n-  $Max$\n\n  $Max_u$  $u$  $k_u$  $u$  $u$  $k$ \n\n   dfs  $k$ \n\n   $Max$\n\n  ```cpp\n  rep(i, 1, m) {\n      scanf(\"%d%d\", &x[i], &c[i]);\n      tim[dfn[x[i]]].push_back(i);\n  }\n  rep(i, 1, n) {\n      R[i] = R[i-1]; //R[i]  dfs  i \n      for(int t : tim[i]) SegTree::upd(t, R[i]), R[i]++;\n  }\n  rep(i, 1, n) Max[i] = SegTree::qry(k[i], R[dfn[i]-1], R[suf[i]]);\n  ```\n\n  \n\n- \n\n   $+1$ ```dfs```  ```dfs```  ```lca```  $-1$\n\n  \n\n    ![.jpg](https://i.loli.net/2020/10/24/8mOxgRBsJMpzLI1.jpg)\n\n   $45$  ```lca```$1$  $-1$\n\n   $56$  ```lca```$1$  $-1$\n\n  ...\n\n  \n\n   ```set``` ```set```  ```dfs```  ```set```  $+1$ ```lca```  $-1$ ```lca```  $-1$ ```lca```  $+1$\n\n  ```cpp\n  int ci = c[i], dfnx = dfn[x[i]];\n  if(s[ci].count(dfnx)) return;\n  s[ci].insert(dfnx), add(dfnx, 1);\n  auto it = s[ci].find(dfnx);\n  int pre = 0, suf = 0;\n  if(it != s[ci].begin()) pre = *(--it), it++;\n  if(it != --s[ci].end()) suf = *(++it), it--;\n  if(pre) upd(pre, dfnx, -1);\n  if(suf) upd(suf, dfnx, -1);\n  if(pre && suf) upd(pre, suf, 1);\n  ```\n\n $O(n\\log n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\nconst int N = 1e5 + 5;\nint n, m, q, k[N];\n\nnamespace Seg {\n    int sz, T[N], c[N*20], ls[N*20], rs[N*20];\n    #define mid ((l + r) >> 1)\n    #define lch l, mid, ls[o]\n    #define rch mid + 1, r, rs[o]\n    void upd(int oo, int p, int l, int r, int& o) {\n        c[o = ++sz] = c[oo] + 1, ls[o] = ls[oo], rs[o] = rs[oo];\n        if(p > mid) upd(rs[oo], p, rch);\n        else if(l ^ r) upd(ls[oo], p, lch);\n    }\n    int qry(int k, int l, int r, int o, int oo) {\n        if(l == r) return k > 1 ? m : l;\n        int cnt = c[ls[o]] - c[ls[oo]];\n        return k <= cnt ? qry(k, lch, ls[oo]) : qry(k - cnt, rch, rs[oo]);\n    }\n    void upd(int p, int t) {\n        upd(T[t], p, 0, m, T[t+1]);\n    }\n    int qry(int k, int l, int r) {\n        return qry(k, 0, m, T[r], T[l]);\n    }\n};\nnamespace Tree {\n    int idx, dfn[N], suf[N], rnk[N], d[N], fa[20][N];\n    vector <int> G[N]; \n    void dfs(int u) {\n        rnk[dfn[u] = ++idx] = u;\n        rep(i, 1, 19) fa[i][u] = fa[i-1][fa[i-1][u]];\n        for(int v : G[u]) if(v ^ fa[0][u])\n            fa[0][v] = u, d[v] = d[u] + 1, dfs(v);\n        suf[u] = idx;\n    }\n    int lca(int u, int v) {\n        if(d[u] < d[v]) swap(u, v);\n        per(i, 19, 0) if(d[u] - (1 << i) >= d[v]) u = fa[i][u];\n        if(u == v) return u;\n        per(i, 19, 0) if(fa[i][u] ^ fa[i][v]) u = fa[i][u], v = fa[i][v];\n        return fa[0][u];\n    }\n    \n    int Max[N], R[N], x[N], c[N], g[N];\n    vector <int> tim[N];\n    void pretreat() {\n        cin >> m;\n        rep(i, 1, m) {\n            scanf(\"%d%d\", &x[i], &c[i]), g[i] = c[i];\n            tim[dfn[x[i]]].push_back(i);\n        }\n        sort(g + 1, g + m + 1);//\n        rep(i, 1, m) c[i] = lower_bound(g + 1, g + m + 1, c[i]) - g;\n        rep(i, 1, n) {\n            R[i] = R[i-1];//R[i]  dfs  i \n            for(int t : tim[i]) Seg::upd(t, R[i]), R[i]++;\n        }\n        rep(i, 1, n) Max[i] = Seg::qry(k[i], R[dfn[i]-1], R[suf[i]]);\n    }\n    \n    int C[N];\n    void add(int i, int v) {\n        for(; i <= n; i += i & -i) C[i] += v;\n    }\n    int qry(int i, int r = 0) {\n        for(; i; i &= i - 1) r += C[i];\n        return r;\n    }\n    int Qry(int u) {\n        return qry(suf[u]) - qry(dfn[u] - 1);\n    }\n    \n    set <int> s[N];\n    void upd(int u, int v, int x) {\n        add(dfn[lca(rnk[u], rnk[v])], x);\n    }\n    void ins(int i) {//\n        int ci = c[i], dfnx = dfn[x[i]];\n        if(s[ci].count(dfnx)) return;\n        s[ci].insert(dfnx), add(dfnx, 1);\n        auto it = s[ci].find(dfnx);\n        int pre = 0, suf = 0;\n        if(it != s[ci].begin()) pre = *(--it), it++;\n        if(it != --s[ci].end()) suf = *(++it), it--;\n        if(pre) upd(pre, dfnx, -1);\n        if(suf) upd(suf, dfnx, -1);\n        if(pre && suf) upd(pre, suf, 1);\n    }\n};\n\nint x[N], u, v, ans[N]; vector <int> id[N];\nint main() {\n    cin >> n;\n    rep(i, 2, n) {\n        scanf(\"%d%d\", &u, &v);\n        Tree::G[u].push_back(v);\n        Tree::G[v].push_back(u);\n    }\n    Tree::dfs(1);\n    rep(i, 1, n) scanf(\"%d\", &k[i]);\n    Tree::pretreat();\n    cin >> q;\n    rep(i, 1, q) scanf(\"%d\", &x[i]), id[Tree::Max[x[i]]].push_back(i);\n    rep(i, 1, m) {\n        Tree::ins(i);\n        for(int j : id[i]) ans[j] = Tree::Qry(x[j]);\n    }\n    rep(i, 1, q) printf(\"%d\\n\", ans[i]);\n    return 0;\n}\n```","source":"_posts/problem.md","raw":"---\ntitle: \ndate: 2021-03-13 22:05:04\nupdated: 2021-03-13 22:05:04\ntags: []\ncategories: \n---\n>  $n$  $u$  $k_u$ $m$ ****$q$ \n>\n> $n, m, q  \\le 10^5$\n\n\n\n $Max_u$ $u$**** $Max$ $Max$ \n\n-  $Max$\n\n  $Max_u$  $u$  $k_u$  $u$  $u$  $k$ \n\n   dfs  $k$ \n\n   $Max$\n\n  ```cpp\n  rep(i, 1, m) {\n      scanf(\"%d%d\", &x[i], &c[i]);\n      tim[dfn[x[i]]].push_back(i);\n  }\n  rep(i, 1, n) {\n      R[i] = R[i-1]; //R[i]  dfs  i \n      for(int t : tim[i]) SegTree::upd(t, R[i]), R[i]++;\n  }\n  rep(i, 1, n) Max[i] = SegTree::qry(k[i], R[dfn[i]-1], R[suf[i]]);\n  ```\n\n  \n\n- \n\n   $+1$ ```dfs```  ```dfs```  ```lca```  $-1$\n\n  \n\n    ![.jpg](https://i.loli.net/2020/10/24/8mOxgRBsJMpzLI1.jpg)\n\n   $45$  ```lca```$1$  $-1$\n\n   $56$  ```lca```$1$  $-1$\n\n  ...\n\n  \n\n   ```set``` ```set```  ```dfs```  ```set```  $+1$ ```lca```  $-1$ ```lca```  $-1$ ```lca```  $+1$\n\n  ```cpp\n  int ci = c[i], dfnx = dfn[x[i]];\n  if(s[ci].count(dfnx)) return;\n  s[ci].insert(dfnx), add(dfnx, 1);\n  auto it = s[ci].find(dfnx);\n  int pre = 0, suf = 0;\n  if(it != s[ci].begin()) pre = *(--it), it++;\n  if(it != --s[ci].end()) suf = *(++it), it--;\n  if(pre) upd(pre, dfnx, -1);\n  if(suf) upd(suf, dfnx, -1);\n  if(pre && suf) upd(pre, suf, 1);\n  ```\n\n $O(n\\log n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\nconst int N = 1e5 + 5;\nint n, m, q, k[N];\n\nnamespace Seg {\n    int sz, T[N], c[N*20], ls[N*20], rs[N*20];\n    #define mid ((l + r) >> 1)\n    #define lch l, mid, ls[o]\n    #define rch mid + 1, r, rs[o]\n    void upd(int oo, int p, int l, int r, int& o) {\n        c[o = ++sz] = c[oo] + 1, ls[o] = ls[oo], rs[o] = rs[oo];\n        if(p > mid) upd(rs[oo], p, rch);\n        else if(l ^ r) upd(ls[oo], p, lch);\n    }\n    int qry(int k, int l, int r, int o, int oo) {\n        if(l == r) return k > 1 ? m : l;\n        int cnt = c[ls[o]] - c[ls[oo]];\n        return k <= cnt ? qry(k, lch, ls[oo]) : qry(k - cnt, rch, rs[oo]);\n    }\n    void upd(int p, int t) {\n        upd(T[t], p, 0, m, T[t+1]);\n    }\n    int qry(int k, int l, int r) {\n        return qry(k, 0, m, T[r], T[l]);\n    }\n};\nnamespace Tree {\n    int idx, dfn[N], suf[N], rnk[N], d[N], fa[20][N];\n    vector <int> G[N]; \n    void dfs(int u) {\n        rnk[dfn[u] = ++idx] = u;\n        rep(i, 1, 19) fa[i][u] = fa[i-1][fa[i-1][u]];\n        for(int v : G[u]) if(v ^ fa[0][u])\n            fa[0][v] = u, d[v] = d[u] + 1, dfs(v);\n        suf[u] = idx;\n    }\n    int lca(int u, int v) {\n        if(d[u] < d[v]) swap(u, v);\n        per(i, 19, 0) if(d[u] - (1 << i) >= d[v]) u = fa[i][u];\n        if(u == v) return u;\n        per(i, 19, 0) if(fa[i][u] ^ fa[i][v]) u = fa[i][u], v = fa[i][v];\n        return fa[0][u];\n    }\n    \n    int Max[N], R[N], x[N], c[N], g[N];\n    vector <int> tim[N];\n    void pretreat() {\n        cin >> m;\n        rep(i, 1, m) {\n            scanf(\"%d%d\", &x[i], &c[i]), g[i] = c[i];\n            tim[dfn[x[i]]].push_back(i);\n        }\n        sort(g + 1, g + m + 1);//\n        rep(i, 1, m) c[i] = lower_bound(g + 1, g + m + 1, c[i]) - g;\n        rep(i, 1, n) {\n            R[i] = R[i-1];//R[i]  dfs  i \n            for(int t : tim[i]) Seg::upd(t, R[i]), R[i]++;\n        }\n        rep(i, 1, n) Max[i] = Seg::qry(k[i], R[dfn[i]-1], R[suf[i]]);\n    }\n    \n    int C[N];\n    void add(int i, int v) {\n        for(; i <= n; i += i & -i) C[i] += v;\n    }\n    int qry(int i, int r = 0) {\n        for(; i; i &= i - 1) r += C[i];\n        return r;\n    }\n    int Qry(int u) {\n        return qry(suf[u]) - qry(dfn[u] - 1);\n    }\n    \n    set <int> s[N];\n    void upd(int u, int v, int x) {\n        add(dfn[lca(rnk[u], rnk[v])], x);\n    }\n    void ins(int i) {//\n        int ci = c[i], dfnx = dfn[x[i]];\n        if(s[ci].count(dfnx)) return;\n        s[ci].insert(dfnx), add(dfnx, 1);\n        auto it = s[ci].find(dfnx);\n        int pre = 0, suf = 0;\n        if(it != s[ci].begin()) pre = *(--it), it++;\n        if(it != --s[ci].end()) suf = *(++it), it--;\n        if(pre) upd(pre, dfnx, -1);\n        if(suf) upd(suf, dfnx, -1);\n        if(pre && suf) upd(pre, suf, 1);\n    }\n};\n\nint x[N], u, v, ans[N]; vector <int> id[N];\nint main() {\n    cin >> n;\n    rep(i, 2, n) {\n        scanf(\"%d%d\", &u, &v);\n        Tree::G[u].push_back(v);\n        Tree::G[v].push_back(u);\n    }\n    Tree::dfs(1);\n    rep(i, 1, n) scanf(\"%d\", &k[i]);\n    Tree::pretreat();\n    cin >> q;\n    rep(i, 1, q) scanf(\"%d\", &x[i]), id[Tree::Max[x[i]]].push_back(i);\n    rep(i, 1, m) {\n        Tree::ins(i);\n        for(int j : id[i]) ans[j] = Tree::Qry(x[j]);\n    }\n    rep(i, 1, q) printf(\"%d\\n\", ans[i]);\n    return 0;\n}\n```","slug":"problem","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0s0038ootndocp07zz","content":"<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(k_u\\)</span> <span class=\"math inline\">\\(m\\)</span> <strong></strong><span class=\"math inline\">\\(q\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n, m, q \\le 10^5\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(Max_u\\)</span> <span class=\"math inline\">\\(u\\)</span><strong></strong> <span class=\"math inline\">\\(Max\\)</span> <span class=\"math inline\">\\(Max\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(Max\\)</span></p>\r\n<p><span class=\"math inline\">\\(Max_u\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(k_u\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p> dfs  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(Max\\)</span></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;x[i], &amp;c[i]);</span><br><span class=\"line\">    tim[dfn[x[i]]].<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">    R[i] = R[i<span class=\"number\">-1</span>]; <span class=\"comment\">//R[i]  dfs  i </span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> t : tim[i]) SegTree::<span class=\"built_in\">upd</span>(t, R[i]), R[i]++;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) Max[i] = SegTree::<span class=\"built_in\">qry</span>(k[i], R[dfn[i]<span class=\"number\">-1</span>], R[suf[i]]);</span><br></pre></td></tr></table></figure></li>\r\n<li><p></p>\r\n<p> <span class=\"math inline\">\\(+1\\)</span> <code>dfs</code>  <code>dfs</code>  <code>lca</code>  <span class=\"math inline\">\\(-1\\)</span></p>\r\n<p></p>\r\n<figure>\r\n<img src=\"https://i.loli.net/2020/10/24/8mOxgRBsJMpzLI1.jpg\" alt=\".jpg\" /><figcaption aria-hidden=\"true\">.jpg</figcaption>\r\n</figure>\r\n<p> <span class=\"math inline\">\\(45\\)</span>  <code>lca</code><span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(-1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(56\\)</span>  <code>lca</code><span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(-1\\)</span></p>\r\n<p>...</p>\r\n<p></p>\r\n<p> <code>set</code> <code>set</code>  <code>dfs</code>  <code>set</code>  <span class=\"math inline\">\\(+1\\)</span> <code>lca</code>  <span class=\"math inline\">\\(-1\\)</span> <code>lca</code>  <span class=\"math inline\">\\(-1\\)</span> <code>lca</code>  <span class=\"math inline\">\\(+1\\)</span></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> ci = c[i], dfnx = dfn[x[i]];</span><br><span class=\"line\"><span class=\"keyword\">if</span>(s[ci].<span class=\"built_in\">count</span>(dfnx)) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">s[ci].<span class=\"built_in\">insert</span>(dfnx), <span class=\"built_in\">add</span>(dfnx, <span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"keyword\">auto</span> it = s[ci].<span class=\"built_in\">find</span>(dfnx);</span><br><span class=\"line\"><span class=\"keyword\">int</span> pre = <span class=\"number\">0</span>, suf = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(it != s[ci].<span class=\"built_in\">begin</span>()) pre = *(--it), it++;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(it != --s[ci].<span class=\"built_in\">end</span>()) suf = *(++it), it--;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(pre) <span class=\"built_in\">upd</span>(pre, dfnx, <span class=\"number\">-1</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(suf) <span class=\"built_in\">upd</span>(suf, dfnx, <span class=\"number\">-1</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(pre &amp;&amp; suf) <span class=\"built_in\">upd</span>(pre, suf, <span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, q, k[N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Seg &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sz, T[N], c[N*<span class=\"number\">20</span>], ls[N*<span class=\"number\">20</span>], rs[N*<span class=\"number\">20</span>];</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, ls[o]</span></span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, rs[o]</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> oo, <span class=\"keyword\">int</span> p, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span>&amp; o)</span> </span>&#123;</span><br><span class=\"line\">        c[o = ++sz] = c[oo] + <span class=\"number\">1</span>, ls[o] = ls[oo], rs[o] = rs[oo];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(p &gt; mid) <span class=\"built_in\">upd</span>(rs[oo], p, rch);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(l ^ r) <span class=\"built_in\">upd</span>(ls[oo], p, lch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> oo)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(l == r) <span class=\"keyword\">return</span> k &gt; <span class=\"number\">1</span> ? m : l;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> cnt = c[ls[o]] - c[ls[oo]];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> k &lt;= cnt ? <span class=\"built_in\">qry</span>(k, lch, ls[oo]) : <span class=\"built_in\">qry</span>(k - cnt, rch, rs[oo]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> p, <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(T[t], p, <span class=\"number\">0</span>, m, T[t+<span class=\"number\">1</span>]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">qry</span>(k, <span class=\"number\">0</span>, m, T[r], T[l]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Tree &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> idx, dfn[N], suf[N], rnk[N], d[N], fa[<span class=\"number\">20</span>][N];</span><br><span class=\"line\">    vector &lt;<span class=\"keyword\">int</span>&gt; G[N]; </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">        rnk[dfn[u] = ++idx] = u;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">19</span>) fa[i][u] = fa[i<span class=\"number\">-1</span>][fa[i<span class=\"number\">-1</span>][u]];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(v ^ fa[<span class=\"number\">0</span>][u])</span><br><span class=\"line\">            fa[<span class=\"number\">0</span>][v] = u, d[v] = d[u] + <span class=\"number\">1</span>, <span class=\"built_in\">dfs</span>(v);</span><br><span class=\"line\">        suf[u] = idx;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">lca</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(d[u] &lt; d[v]) <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(i, <span class=\"number\">19</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(d[u] - (<span class=\"number\">1</span> &lt;&lt; i) &gt;= d[v]) u = fa[i][u];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(u == v) <span class=\"keyword\">return</span> u;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(i, <span class=\"number\">19</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(fa[i][u] ^ fa[i][v]) u = fa[i][u], v = fa[i][v];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> fa[<span class=\"number\">0</span>][u];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">int</span> Max[N], R[N], x[N], c[N], g[N];</span><br><span class=\"line\">    vector &lt;<span class=\"keyword\">int</span>&gt; tim[N];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pretreat</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        cin &gt;&gt; m;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;x[i], &amp;c[i]), g[i] = c[i];</span><br><span class=\"line\">            tim[dfn[x[i]]].<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">sort</span>(g + <span class=\"number\">1</span>, g + m + <span class=\"number\">1</span>);<span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) c[i] = <span class=\"built_in\">lower_bound</span>(g + <span class=\"number\">1</span>, g + m + <span class=\"number\">1</span>, c[i]) - g;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">            R[i] = R[i<span class=\"number\">-1</span>];<span class=\"comment\">//R[i]  dfs  i </span></span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> t : tim[i]) Seg::<span class=\"built_in\">upd</span>(t, R[i]), R[i]++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) Max[i] = Seg::<span class=\"built_in\">qry</span>(k[i], R[dfn[i]<span class=\"number\">-1</span>], R[suf[i]]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">int</span> C[N];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; i &lt;= n; i += i &amp; -i) C[i] += v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> r = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; i; i &amp;= i - <span class=\"number\">1</span>) r += C[i];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">Qry</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">qry</span>(suf[u]) - <span class=\"built_in\">qry</span>(dfn[u] - <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    set &lt;<span class=\"keyword\">int</span>&gt; s[N];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">add</span>(dfn[<span class=\"built_in\">lca</span>(rnk[u], rnk[v])], x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;<span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> ci = c[i], dfnx = dfn[x[i]];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(s[ci].<span class=\"built_in\">count</span>(dfnx)) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        s[ci].<span class=\"built_in\">insert</span>(dfnx), <span class=\"built_in\">add</span>(dfnx, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> it = s[ci].<span class=\"built_in\">find</span>(dfnx);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> pre = <span class=\"number\">0</span>, suf = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(it != s[ci].<span class=\"built_in\">begin</span>()) pre = *(--it), it++;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(it != --s[ci].<span class=\"built_in\">end</span>()) suf = *(++it), it--;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(pre) <span class=\"built_in\">upd</span>(pre, dfnx, <span class=\"number\">-1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(suf) <span class=\"built_in\">upd</span>(suf, dfnx, <span class=\"number\">-1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(pre &amp;&amp; suf) <span class=\"built_in\">upd</span>(pre, suf, <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> x[N], u, v, ans[N]; vector &lt;<span class=\"keyword\">int</span>&gt; id[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class=\"line\">        Tree::G[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">        Tree::G[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    Tree::<span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;k[i]);</span><br><span class=\"line\">    Tree::<span class=\"built_in\">pretreat</span>();</span><br><span class=\"line\">    cin &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;x[i]), id[Tree::Max[x[i]]].<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        Tree::<span class=\"built_in\">ins</span>(i);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j : id[i]) ans[j] = Tree::<span class=\"built_in\">Qry</span>(x[j]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, ans[i]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":4348,"excerpt":"","more":"<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(k_u\\)</span> <span class=\"math inline\">\\(m\\)</span> <strong></strong><span class=\"math inline\">\\(q\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n, m, q \\le 10^5\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(Max_u\\)</span> <span class=\"math inline\">\\(u\\)</span><strong></strong> <span class=\"math inline\">\\(Max\\)</span> <span class=\"math inline\">\\(Max\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(Max\\)</span></p>\r\n<p><span class=\"math inline\">\\(Max_u\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(k_u\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p> dfs  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(Max\\)</span></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;x[i], &amp;c[i]);</span><br><span class=\"line\">    tim[dfn[x[i]]].<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">    R[i] = R[i<span class=\"number\">-1</span>]; <span class=\"comment\">//R[i]  dfs  i </span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> t : tim[i]) SegTree::<span class=\"built_in\">upd</span>(t, R[i]), R[i]++;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) Max[i] = SegTree::<span class=\"built_in\">qry</span>(k[i], R[dfn[i]<span class=\"number\">-1</span>], R[suf[i]]);</span><br></pre></td></tr></table></figure></li>\r\n<li><p></p>\r\n<p> <span class=\"math inline\">\\(+1\\)</span> <code>dfs</code>  <code>dfs</code>  <code>lca</code>  <span class=\"math inline\">\\(-1\\)</span></p>\r\n<p></p>\r\n<figure>\r\n<img src=\"https://i.loli.net/2020/10/24/8mOxgRBsJMpzLI1.jpg\" alt=\".jpg\" /><figcaption aria-hidden=\"true\">.jpg</figcaption>\r\n</figure>\r\n<p> <span class=\"math inline\">\\(45\\)</span>  <code>lca</code><span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(-1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(56\\)</span>  <code>lca</code><span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(-1\\)</span></p>\r\n<p>...</p>\r\n<p></p>\r\n<p> <code>set</code> <code>set</code>  <code>dfs</code>  <code>set</code>  <span class=\"math inline\">\\(+1\\)</span> <code>lca</code>  <span class=\"math inline\">\\(-1\\)</span> <code>lca</code>  <span class=\"math inline\">\\(-1\\)</span> <code>lca</code>  <span class=\"math inline\">\\(+1\\)</span></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> ci = c[i], dfnx = dfn[x[i]];</span><br><span class=\"line\"><span class=\"keyword\">if</span>(s[ci].<span class=\"built_in\">count</span>(dfnx)) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">s[ci].<span class=\"built_in\">insert</span>(dfnx), <span class=\"built_in\">add</span>(dfnx, <span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"keyword\">auto</span> it = s[ci].<span class=\"built_in\">find</span>(dfnx);</span><br><span class=\"line\"><span class=\"keyword\">int</span> pre = <span class=\"number\">0</span>, suf = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(it != s[ci].<span class=\"built_in\">begin</span>()) pre = *(--it), it++;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(it != --s[ci].<span class=\"built_in\">end</span>()) suf = *(++it), it--;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(pre) <span class=\"built_in\">upd</span>(pre, dfnx, <span class=\"number\">-1</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(suf) <span class=\"built_in\">upd</span>(suf, dfnx, <span class=\"number\">-1</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(pre &amp;&amp; suf) <span class=\"built_in\">upd</span>(pre, suf, <span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, q, k[N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Seg &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sz, T[N], c[N*<span class=\"number\">20</span>], ls[N*<span class=\"number\">20</span>], rs[N*<span class=\"number\">20</span>];</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, ls[o]</span></span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, rs[o]</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> oo, <span class=\"keyword\">int</span> p, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span>&amp; o)</span> </span>&#123;</span><br><span class=\"line\">        c[o = ++sz] = c[oo] + <span class=\"number\">1</span>, ls[o] = ls[oo], rs[o] = rs[oo];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(p &gt; mid) <span class=\"built_in\">upd</span>(rs[oo], p, rch);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(l ^ r) <span class=\"built_in\">upd</span>(ls[oo], p, lch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> oo)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(l == r) <span class=\"keyword\">return</span> k &gt; <span class=\"number\">1</span> ? m : l;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> cnt = c[ls[o]] - c[ls[oo]];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> k &lt;= cnt ? <span class=\"built_in\">qry</span>(k, lch, ls[oo]) : <span class=\"built_in\">qry</span>(k - cnt, rch, rs[oo]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> p, <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">upd</span>(T[t], p, <span class=\"number\">0</span>, m, T[t+<span class=\"number\">1</span>]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> k, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">qry</span>(k, <span class=\"number\">0</span>, m, T[r], T[l]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Tree &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> idx, dfn[N], suf[N], rnk[N], d[N], fa[<span class=\"number\">20</span>][N];</span><br><span class=\"line\">    vector &lt;<span class=\"keyword\">int</span>&gt; G[N]; </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">        rnk[dfn[u] = ++idx] = u;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">19</span>) fa[i][u] = fa[i<span class=\"number\">-1</span>][fa[i<span class=\"number\">-1</span>][u]];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(v ^ fa[<span class=\"number\">0</span>][u])</span><br><span class=\"line\">            fa[<span class=\"number\">0</span>][v] = u, d[v] = d[u] + <span class=\"number\">1</span>, <span class=\"built_in\">dfs</span>(v);</span><br><span class=\"line\">        suf[u] = idx;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">lca</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(d[u] &lt; d[v]) <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(i, <span class=\"number\">19</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(d[u] - (<span class=\"number\">1</span> &lt;&lt; i) &gt;= d[v]) u = fa[i][u];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(u == v) <span class=\"keyword\">return</span> u;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(i, <span class=\"number\">19</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(fa[i][u] ^ fa[i][v]) u = fa[i][u], v = fa[i][v];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> fa[<span class=\"number\">0</span>][u];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">int</span> Max[N], R[N], x[N], c[N], g[N];</span><br><span class=\"line\">    vector &lt;<span class=\"keyword\">int</span>&gt; tim[N];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pretreat</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        cin &gt;&gt; m;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;x[i], &amp;c[i]), g[i] = c[i];</span><br><span class=\"line\">            tim[dfn[x[i]]].<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">sort</span>(g + <span class=\"number\">1</span>, g + m + <span class=\"number\">1</span>);<span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) c[i] = <span class=\"built_in\">lower_bound</span>(g + <span class=\"number\">1</span>, g + m + <span class=\"number\">1</span>, c[i]) - g;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">            R[i] = R[i<span class=\"number\">-1</span>];<span class=\"comment\">//R[i]  dfs  i </span></span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> t : tim[i]) Seg::<span class=\"built_in\">upd</span>(t, R[i]), R[i]++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) Max[i] = Seg::<span class=\"built_in\">qry</span>(k[i], R[dfn[i]<span class=\"number\">-1</span>], R[suf[i]]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">int</span> C[N];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; i &lt;= n; i += i &amp; -i) C[i] += v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> i, <span class=\"keyword\">int</span> r = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; i; i &amp;= i - <span class=\"number\">1</span>) r += C[i];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">Qry</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">qry</span>(suf[u]) - <span class=\"built_in\">qry</span>(dfn[u] - <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    set &lt;<span class=\"keyword\">int</span>&gt; s[N];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">add</span>(dfn[<span class=\"built_in\">lca</span>(rnk[u], rnk[v])], x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;<span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> ci = c[i], dfnx = dfn[x[i]];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(s[ci].<span class=\"built_in\">count</span>(dfnx)) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        s[ci].<span class=\"built_in\">insert</span>(dfnx), <span class=\"built_in\">add</span>(dfnx, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> it = s[ci].<span class=\"built_in\">find</span>(dfnx);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> pre = <span class=\"number\">0</span>, suf = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(it != s[ci].<span class=\"built_in\">begin</span>()) pre = *(--it), it++;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(it != --s[ci].<span class=\"built_in\">end</span>()) suf = *(++it), it--;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(pre) <span class=\"built_in\">upd</span>(pre, dfnx, <span class=\"number\">-1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(suf) <span class=\"built_in\">upd</span>(suf, dfnx, <span class=\"number\">-1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(pre &amp;&amp; suf) <span class=\"built_in\">upd</span>(pre, suf, <span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> x[N], u, v, ans[N]; vector &lt;<span class=\"keyword\">int</span>&gt; id[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class=\"line\">        Tree::G[u].<span class=\"built_in\">push_back</span>(v);</span><br><span class=\"line\">        Tree::G[v].<span class=\"built_in\">push_back</span>(u);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    Tree::<span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;k[i]);</span><br><span class=\"line\">    Tree::<span class=\"built_in\">pretreat</span>();</span><br><span class=\"line\">    cin &gt;&gt; q;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;x[i]), id[Tree::Max[x[i]]].<span class=\"built_in\">push_back</span>(i);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        Tree::<span class=\"built_in\">ins</span>(i);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j : id[i]) ans[j] = Tree::<span class=\"built_in\">Qry</span>(x[j]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, q) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, ans[i]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"1","date":"2021-03-13T14:29:46.000Z","updated":"2021-03-13T14:29:46.000Z","_content":">  $n$  $a$ $q$  $[L,R]$ ,\n>\n>  $\\max\\limits_{L\\le l<r\\le R}\\dfrac{\\sum_{i=l}^ra_i}{r-l}$\n>\n> $n\\le 10^5,q\\le 3\\cdot 10^4,|a_i|\\le 10^6$\n\n\n\n $s_i=\\sum_{j=1}^ia_j,\\text{}A_i(i,s_{i-1}),\\text{}B_i(i,s_i)$\n\n$\\text{}=\\max\\limits_{L\\le i < j\\le R}\\text{Slope}_{A_i,B_j}$\n\n $L=1,R=n$ \n\n-  $A$  $B_i$ \n\n   $O(n\\log n)$\n\n- **** $A$  $B_i$ \n\n   $B_i$  $B_i$ ****\n\n  **** $E$  $A$  $A$  $F$ \n\n   $F$  $AF$,  $\\text{Slope}_{AF}<\\text{Slope}_{AB}<\\text{Slope}_{BE}$\n\n   $AF$  $BE$, $A$ \n\n  \n\n  ![](https://i.loli.net/2020/11/18/ncWZHmCtw2bokxX.png)\n\n $sz=\\sqrt n$\n\n-  $A_i,B_j$ \n\n-  $A_i,B_j$ \n\n   $pre_{i,j}=\\max\\limits_{sz\\cdot i\\le I< J \\le j}\\text{Slope}_{A_I,B_J},suf_{i,j}=\\max\\limits_{j\\le I<J\\le sz\\cdot i}\\text{Slope}_{A_I,B_J}$\n\n  \n\n   $pre_{\\lceil\\frac L{sz}\\rceil,R},suf_{\\lfloor\\frac R{sz}\\rfloor,L}$  \n\n $O(n\\sqrt n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\nconst int N = 100005, M = 125;\ntypedef long long ll;\nint read() {\n    int c = getchar(), r = 0, f = 1; \n    while(c < 48) { if(c == 45) f = -1; c = getchar(); }\n    while(c > 47) r = r * 10 + c - 48, c = getchar();\n    return r * f;\n}\nint n, Q, sz; ll a[N], maU[M][N]; int maD[M][N];// U D \nll gcd(ll a, ll b) { return b ? gcd(b, a % b) : a; }\nint l, r, x[N], D; ll y[N], U;// U/D \nvoid init() { l = 1, r = 0, U = -1e9, D = 1; }// \nvoid upd(ll u, int d) {// \n    if(d < 0) u = -u, d = -d;\n    if(u * D > U * d) U = u, D = d;\n}\nvoid ins(int X, ll Y) {// X \n    while(l < r && (y[r] - y[r-1]) * (X - x[r]) >= (Y - y[r]) * (x[r] - x[r-1])) r--;\n    x[++r] = X, y[r] = Y;\n}\nvoid qry(int X, ll Y) {// \n    if(l > r) return;\n    while(l < r && (Y - y[l]) * (X - x[l+1]) <= (Y - y[l+1]) * (X - x[l])) l++;\n    upd(Y - y[l], X - x[l]);\n}\nint main() {\n    cin >> n >> Q, sz = sqrt(n * 7);\n    For(i, 0, n) a[i] = read() + a[i-1];\n    per(i, (n - 1) / sz, 0) { // pre, suf  ma  \n        init(); For(j, i * sz, n) qry(j, a[j]), maU[i][j] = U, maD[i][j] = D, ins(j, a[j-1]);\n        init(); per(j, i * sz, 0) qry(j, a[j-1]), maU[i][j] = U, maD[i][j] = D, ins(j, a[j]);\n    }\n    int L, R;\n    while(Q--) {\n        L = read() - 1, R = read() - 1, init();\n        if(L / sz ^ R / sz) {\n            For(i, L, L / sz * sz + sz) qry(i, a[i]), ins(i, a[i-1]);\n            rep(i, R / sz * sz, R) qry(i, a[i]), ins(i, a[i-1]);\n            upd(maU[(L+sz-1)/sz][R], maD[(L+sz-1)/sz][R]);\n            upd(maU[R/sz][L], maD[R/sz][L]);\n        } else rep(i, L, R) qry(i, a[i]), ins(i, a[i-1]);\n        ll d = gcd(llabs(U), D);\n        printf(\"%lld/%lld\\n\", U / d, D / d);\n    }\n    return 0;\n}\n```","source":"_posts/problem1.md","raw":"---\ntitle: 1\ndate: 2021-03-13 22:29:46\nupdated: 2021-03-13 22:29:46\ntags: [,,]\ncategories: \n---\n>  $n$  $a$ $q$  $[L,R]$ ,\n>\n>  $\\max\\limits_{L\\le l<r\\le R}\\dfrac{\\sum_{i=l}^ra_i}{r-l}$\n>\n> $n\\le 10^5,q\\le 3\\cdot 10^4,|a_i|\\le 10^6$\n\n\n\n $s_i=\\sum_{j=1}^ia_j,\\text{}A_i(i,s_{i-1}),\\text{}B_i(i,s_i)$\n\n$\\text{}=\\max\\limits_{L\\le i < j\\le R}\\text{Slope}_{A_i,B_j}$\n\n $L=1,R=n$ \n\n-  $A$  $B_i$ \n\n   $O(n\\log n)$\n\n- **** $A$  $B_i$ \n\n   $B_i$  $B_i$ ****\n\n  **** $E$  $A$  $A$  $F$ \n\n   $F$  $AF$,  $\\text{Slope}_{AF}<\\text{Slope}_{AB}<\\text{Slope}_{BE}$\n\n   $AF$  $BE$, $A$ \n\n  \n\n  ![](https://i.loli.net/2020/11/18/ncWZHmCtw2bokxX.png)\n\n $sz=\\sqrt n$\n\n-  $A_i,B_j$ \n\n-  $A_i,B_j$ \n\n   $pre_{i,j}=\\max\\limits_{sz\\cdot i\\le I< J \\le j}\\text{Slope}_{A_I,B_J},suf_{i,j}=\\max\\limits_{j\\le I<J\\le sz\\cdot i}\\text{Slope}_{A_I,B_J}$\n\n  \n\n   $pre_{\\lceil\\frac L{sz}\\rceil,R},suf_{\\lfloor\\frac R{sz}\\rfloor,L}$  \n\n $O(n\\sqrt n)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\nconst int N = 100005, M = 125;\ntypedef long long ll;\nint read() {\n    int c = getchar(), r = 0, f = 1; \n    while(c < 48) { if(c == 45) f = -1; c = getchar(); }\n    while(c > 47) r = r * 10 + c - 48, c = getchar();\n    return r * f;\n}\nint n, Q, sz; ll a[N], maU[M][N]; int maD[M][N];// U D \nll gcd(ll a, ll b) { return b ? gcd(b, a % b) : a; }\nint l, r, x[N], D; ll y[N], U;// U/D \nvoid init() { l = 1, r = 0, U = -1e9, D = 1; }// \nvoid upd(ll u, int d) {// \n    if(d < 0) u = -u, d = -d;\n    if(u * D > U * d) U = u, D = d;\n}\nvoid ins(int X, ll Y) {// X \n    while(l < r && (y[r] - y[r-1]) * (X - x[r]) >= (Y - y[r]) * (x[r] - x[r-1])) r--;\n    x[++r] = X, y[r] = Y;\n}\nvoid qry(int X, ll Y) {// \n    if(l > r) return;\n    while(l < r && (Y - y[l]) * (X - x[l+1]) <= (Y - y[l+1]) * (X - x[l])) l++;\n    upd(Y - y[l], X - x[l]);\n}\nint main() {\n    cin >> n >> Q, sz = sqrt(n * 7);\n    For(i, 0, n) a[i] = read() + a[i-1];\n    per(i, (n - 1) / sz, 0) { // pre, suf  ma  \n        init(); For(j, i * sz, n) qry(j, a[j]), maU[i][j] = U, maD[i][j] = D, ins(j, a[j-1]);\n        init(); per(j, i * sz, 0) qry(j, a[j-1]), maU[i][j] = U, maD[i][j] = D, ins(j, a[j]);\n    }\n    int L, R;\n    while(Q--) {\n        L = read() - 1, R = read() - 1, init();\n        if(L / sz ^ R / sz) {\n            For(i, L, L / sz * sz + sz) qry(i, a[i]), ins(i, a[i-1]);\n            rep(i, R / sz * sz, R) qry(i, a[i]), ins(i, a[i-1]);\n            upd(maU[(L+sz-1)/sz][R], maD[(L+sz-1)/sz][R]);\n            upd(maU[R/sz][L], maD[R/sz][L]);\n        } else rep(i, L, R) qry(i, a[i]), ins(i, a[i-1]);\n        ll d = gcd(llabs(U), D);\n        printf(\"%lld/%lld\\n\", U / d, D / d);\n    }\n    return 0;\n}\n```","slug":"problem1","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0u003bootn3v3ddjli","content":"<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(a\\)</span> <span class=\"math inline\">\\(q\\)</span>  <span class=\"math inline\">\\([L,R]\\)</span> ,</p>\r\n<p> <span class=\"math inline\">\\(\\max\\limits_{L\\le l&lt;r\\le R}\\dfrac{\\sum_{i=l}^ra_i}{r-l}\\)</span></p>\r\n<p><span class=\"math inline\">\\(n\\le 10^5,q\\le 3\\cdot 10^4,|a_i|\\le 10^6\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(s_i=\\sum_{j=1}^ia_j,\\text{}A_i(i,s_{i-1}),\\text{}B_i(i,s_i)\\)</span></p>\r\n<p><span class=\"math inline\">\\(\\text{}=\\max\\limits_{L\\le i &lt; j\\le R}\\text{Slope}_{A_i,B_j}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(L=1,R=n\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(B_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p></li>\r\n<li><p><strong></strong> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(B_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(B_i\\)</span>  <span class=\"math inline\">\\(B_i\\)</span> <strong></strong></p>\r\n<p><strong></strong> <span class=\"math inline\">\\(E\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(F\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(F\\)</span>  <span class=\"math inline\">\\(AF\\)</span>,  <span class=\"math inline\">\\(\\text{Slope}_{AF}&lt;\\text{Slope}_{AB}&lt;\\text{Slope}_{BE}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(AF\\)</span>  <span class=\"math inline\">\\(BE\\)</span>, <span class=\"math inline\">\\(A\\)</span> </p>\r\n<p><img src=\"https://i.loli.net/2020/11/18/ncWZHmCtw2bokxX.png\" /></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(sz=\\sqrt n\\)</span></p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(A_i,B_j\\)</span> </p></li>\r\n<li><p> <span class=\"math inline\">\\(A_i,B_j\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(pre_{i,j}=\\max\\limits_{sz\\cdot i\\le I&lt; J \\le j}\\text{Slope}_{A_I,B_J},suf_{i,j}=\\max\\limits_{j\\le I&lt;J\\le sz\\cdot i}\\text{Slope}_{A_I,B_J}\\)</span></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(pre_{\\lceil\\frac L{sz}\\rceil,R},suf_{\\lfloor\\frac R{sz}\\rfloor,L}\\)</span> </p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n\\sqrt n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">100005</span>, M = <span class=\"number\">125</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> c = <span class=\"built_in\">getchar</span>(), r = <span class=\"number\">0</span>, f = <span class=\"number\">1</span>; </span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &lt; <span class=\"number\">48</span>) &#123; <span class=\"keyword\">if</span>(c == <span class=\"number\">45</span>) f = <span class=\"number\">-1</span>; c = <span class=\"built_in\">getchar</span>(); &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &gt; <span class=\"number\">47</span>) r = r * <span class=\"number\">10</span> + c - <span class=\"number\">48</span>, c = <span class=\"built_in\">getchar</span>();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r * f;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, Q, sz; ll a[N], maU[M][N]; <span class=\"keyword\">int</span> maD[M][N];<span class=\"comment\">// U D </span></span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">gcd</span><span class=\"params\">(ll a, ll b)</span> </span>&#123; <span class=\"keyword\">return</span> b ? <span class=\"built_in\">gcd</span>(b, a % b) : a; &#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> l, r, x[N], D; ll y[N], U;<span class=\"comment\">// U/D </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> </span>&#123; l = <span class=\"number\">1</span>, r = <span class=\"number\">0</span>, U = <span class=\"number\">-1e9</span>, D = <span class=\"number\">1</span>; &#125;<span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(ll u, <span class=\"keyword\">int</span> d)</span> </span>&#123;<span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(d &lt; <span class=\"number\">0</span>) u = -u, d = -d;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u * D &gt; U * d) U = u, D = d;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span> X, ll Y)</span> </span>&#123;<span class=\"comment\">// X </span></span><br><span class=\"line\">    <span class=\"keyword\">while</span>(l &lt; r &amp;&amp; (y[r] - y[r<span class=\"number\">-1</span>]) * (X - x[r]) &gt;= (Y - y[r]) * (x[r] - x[r<span class=\"number\">-1</span>])) r--;</span><br><span class=\"line\">    x[++r] = X, y[r] = Y;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> X, ll Y)</span> </span>&#123;<span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l &gt; r) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(l &lt; r &amp;&amp; (Y - y[l]) * (X - x[l+<span class=\"number\">1</span>]) &lt;= (Y - y[l+<span class=\"number\">1</span>]) * (X - x[l])) l++;</span><br><span class=\"line\">    <span class=\"built_in\">upd</span>(Y - y[l], X - x[l]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; Q, sz = <span class=\"built_in\">sqrt</span>(n * <span class=\"number\">7</span>);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, n) a[i] = <span class=\"built_in\">read</span>() + a[i<span class=\"number\">-1</span>];</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, (n - <span class=\"number\">1</span>) / sz, <span class=\"number\">0</span>) &#123; <span class=\"comment\">// pre, suf  ma  </span></span><br><span class=\"line\">        <span class=\"built_in\">init</span>(); <span class=\"built_in\">For</span>(j, i * sz, n) <span class=\"built_in\">qry</span>(j, a[j]), maU[i][j] = U, maD[i][j] = D, <span class=\"built_in\">ins</span>(j, a[j<span class=\"number\">-1</span>]);</span><br><span class=\"line\">        <span class=\"built_in\">init</span>(); <span class=\"built_in\">per</span>(j, i * sz, <span class=\"number\">0</span>) <span class=\"built_in\">qry</span>(j, a[j<span class=\"number\">-1</span>]), maU[i][j] = U, maD[i][j] = D, <span class=\"built_in\">ins</span>(j, a[j]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> L, R;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(Q--) &#123;</span><br><span class=\"line\">        L = <span class=\"built_in\">read</span>() - <span class=\"number\">1</span>, R = <span class=\"built_in\">read</span>() - <span class=\"number\">1</span>, <span class=\"built_in\">init</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(L / sz ^ R / sz) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">For</span>(i, L, L / sz * sz + sz) <span class=\"built_in\">qry</span>(i, a[i]), <span class=\"built_in\">ins</span>(i, a[i<span class=\"number\">-1</span>]);</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, R / sz * sz, R) <span class=\"built_in\">qry</span>(i, a[i]), <span class=\"built_in\">ins</span>(i, a[i<span class=\"number\">-1</span>]);</span><br><span class=\"line\">            <span class=\"built_in\">upd</span>(maU[(L+sz<span class=\"number\">-1</span>)/sz][R], maD[(L+sz<span class=\"number\">-1</span>)/sz][R]);</span><br><span class=\"line\">            <span class=\"built_in\">upd</span>(maU[R/sz][L], maD[R/sz][L]);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"built_in\">rep</span>(i, L, R) <span class=\"built_in\">qry</span>(i, a[i]), <span class=\"built_in\">ins</span>(i, a[i<span class=\"number\">-1</span>]);</span><br><span class=\"line\">        ll d = <span class=\"built_in\">gcd</span>(<span class=\"built_in\">llabs</span>(U), D);</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%lld/%lld\\n&quot;</span>, U / d, D / d);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2706,"excerpt":"","more":"<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(a\\)</span> <span class=\"math inline\">\\(q\\)</span>  <span class=\"math inline\">\\([L,R]\\)</span> ,</p>\r\n<p> <span class=\"math inline\">\\(\\max\\limits_{L\\le l&lt;r\\le R}\\dfrac{\\sum_{i=l}^ra_i}{r-l}\\)</span></p>\r\n<p><span class=\"math inline\">\\(n\\le 10^5,q\\le 3\\cdot 10^4,|a_i|\\le 10^6\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(s_i=\\sum_{j=1}^ia_j,\\text{}A_i(i,s_{i-1}),\\text{}B_i(i,s_i)\\)</span></p>\r\n<p><span class=\"math inline\">\\(\\text{}=\\max\\limits_{L\\le i &lt; j\\le R}\\text{Slope}_{A_i,B_j}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(L=1,R=n\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(B_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p></li>\r\n<li><p><strong></strong> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(B_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(B_i\\)</span>  <span class=\"math inline\">\\(B_i\\)</span> <strong></strong></p>\r\n<p><strong></strong> <span class=\"math inline\">\\(E\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(F\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(F\\)</span>  <span class=\"math inline\">\\(AF\\)</span>,  <span class=\"math inline\">\\(\\text{Slope}_{AF}&lt;\\text{Slope}_{AB}&lt;\\text{Slope}_{BE}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(AF\\)</span>  <span class=\"math inline\">\\(BE\\)</span>, <span class=\"math inline\">\\(A\\)</span> </p>\r\n<p><img src=\"https://i.loli.net/2020/11/18/ncWZHmCtw2bokxX.png\" /></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(sz=\\sqrt n\\)</span></p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(A_i,B_j\\)</span> </p></li>\r\n<li><p> <span class=\"math inline\">\\(A_i,B_j\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(pre_{i,j}=\\max\\limits_{sz\\cdot i\\le I&lt; J \\le j}\\text{Slope}_{A_I,B_J},suf_{i,j}=\\max\\limits_{j\\le I&lt;J\\le sz\\cdot i}\\text{Slope}_{A_I,B_J}\\)</span></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(pre_{\\lceil\\frac L{sz}\\rceil,R},suf_{\\lfloor\\frac R{sz}\\rfloor,L}\\)</span> </p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n\\sqrt n)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">100005</span>, M = <span class=\"number\">125</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> c = <span class=\"built_in\">getchar</span>(), r = <span class=\"number\">0</span>, f = <span class=\"number\">1</span>; </span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &lt; <span class=\"number\">48</span>) &#123; <span class=\"keyword\">if</span>(c == <span class=\"number\">45</span>) f = <span class=\"number\">-1</span>; c = <span class=\"built_in\">getchar</span>(); &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &gt; <span class=\"number\">47</span>) r = r * <span class=\"number\">10</span> + c - <span class=\"number\">48</span>, c = <span class=\"built_in\">getchar</span>();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r * f;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, Q, sz; ll a[N], maU[M][N]; <span class=\"keyword\">int</span> maD[M][N];<span class=\"comment\">// U D </span></span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">gcd</span><span class=\"params\">(ll a, ll b)</span> </span>&#123; <span class=\"keyword\">return</span> b ? <span class=\"built_in\">gcd</span>(b, a % b) : a; &#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> l, r, x[N], D; ll y[N], U;<span class=\"comment\">// U/D </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> </span>&#123; l = <span class=\"number\">1</span>, r = <span class=\"number\">0</span>, U = <span class=\"number\">-1e9</span>, D = <span class=\"number\">1</span>; &#125;<span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">upd</span><span class=\"params\">(ll u, <span class=\"keyword\">int</span> d)</span> </span>&#123;<span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(d &lt; <span class=\"number\">0</span>) u = -u, d = -d;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u * D &gt; U * d) U = u, D = d;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span> X, ll Y)</span> </span>&#123;<span class=\"comment\">// X </span></span><br><span class=\"line\">    <span class=\"keyword\">while</span>(l &lt; r &amp;&amp; (y[r] - y[r<span class=\"number\">-1</span>]) * (X - x[r]) &gt;= (Y - y[r]) * (x[r] - x[r<span class=\"number\">-1</span>])) r--;</span><br><span class=\"line\">    x[++r] = X, y[r] = Y;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> X, ll Y)</span> </span>&#123;<span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l &gt; r) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(l &lt; r &amp;&amp; (Y - y[l]) * (X - x[l+<span class=\"number\">1</span>]) &lt;= (Y - y[l+<span class=\"number\">1</span>]) * (X - x[l])) l++;</span><br><span class=\"line\">    <span class=\"built_in\">upd</span>(Y - y[l], X - x[l]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; Q, sz = <span class=\"built_in\">sqrt</span>(n * <span class=\"number\">7</span>);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, n) a[i] = <span class=\"built_in\">read</span>() + a[i<span class=\"number\">-1</span>];</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, (n - <span class=\"number\">1</span>) / sz, <span class=\"number\">0</span>) &#123; <span class=\"comment\">// pre, suf  ma  </span></span><br><span class=\"line\">        <span class=\"built_in\">init</span>(); <span class=\"built_in\">For</span>(j, i * sz, n) <span class=\"built_in\">qry</span>(j, a[j]), maU[i][j] = U, maD[i][j] = D, <span class=\"built_in\">ins</span>(j, a[j<span class=\"number\">-1</span>]);</span><br><span class=\"line\">        <span class=\"built_in\">init</span>(); <span class=\"built_in\">per</span>(j, i * sz, <span class=\"number\">0</span>) <span class=\"built_in\">qry</span>(j, a[j<span class=\"number\">-1</span>]), maU[i][j] = U, maD[i][j] = D, <span class=\"built_in\">ins</span>(j, a[j]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> L, R;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(Q--) &#123;</span><br><span class=\"line\">        L = <span class=\"built_in\">read</span>() - <span class=\"number\">1</span>, R = <span class=\"built_in\">read</span>() - <span class=\"number\">1</span>, <span class=\"built_in\">init</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(L / sz ^ R / sz) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">For</span>(i, L, L / sz * sz + sz) <span class=\"built_in\">qry</span>(i, a[i]), <span class=\"built_in\">ins</span>(i, a[i<span class=\"number\">-1</span>]);</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, R / sz * sz, R) <span class=\"built_in\">qry</span>(i, a[i]), <span class=\"built_in\">ins</span>(i, a[i<span class=\"number\">-1</span>]);</span><br><span class=\"line\">            <span class=\"built_in\">upd</span>(maU[(L+sz<span class=\"number\">-1</span>)/sz][R], maD[(L+sz<span class=\"number\">-1</span>)/sz][R]);</span><br><span class=\"line\">            <span class=\"built_in\">upd</span>(maU[R/sz][L], maD[R/sz][L]);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"built_in\">rep</span>(i, L, R) <span class=\"built_in\">qry</span>(i, a[i]), <span class=\"built_in\">ins</span>(i, a[i<span class=\"number\">-1</span>]);</span><br><span class=\"line\">        ll d = <span class=\"built_in\">gcd</span>(<span class=\"built_in\">llabs</span>(U), D);</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%lld/%lld\\n&quot;</span>, U / d, D / d);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"2","date":"2021-03-13T14:33:00.000Z","updated":"2021-03-13T14:33:00.000Z","_content":">  $n$  $A$ $A$ \n>\n> $n \\le 10^5,A_i \\le 10^{18}$\n\n $sum$  $S_1,S_2$ $S_1 \\oplus S_2 = sum$  $sum$  $i$  $1$ $i$  $sum$  $i$  $0$ $S_1,S_2$  $i$ \n\n $sum$  $0$  $S_1,S_2$  $S_1$  $S_1$  \n\nn \n\n\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\nusing namespace std;\n\nint n;\nlong long a[100005], bas[70], su, ans;\nint main() {\n    cin >> n;\n    rep(i, 1, n) scanf(\"%lld\", &a[i]), su ^= a[i];\n    rep(i, 1, n) a[i] &= ~su;\n    rep(i, 1, n) per(j, 59, 0) if(a[i] >> j & 1) {\n        if(bas[j]) a[i] ^= bas[j];\n        else {\n            per(k, j - 1, 0) if(a[i] >> k & 1) a[i] ^= bas[k];\n            rep(k, j + 1, 59) if(bas[k] >> j & 1) bas[k] ^= a[i];\n            bas[j] = a[i]; break;\n        }\n    }\n    rep(i, 1, 59) ans ^= bas[i];\n    cout << su + ans * 2;\n    return 0;\n}\n```","source":"_posts/problem2.md","raw":"---\ntitle: 2\ndate: 2021-03-13 22:33:00\nupdated: 2021-03-13 22:33:00\ntags: [,]\ncategories: \n---\n>  $n$  $A$ $A$ \n>\n> $n \\le 10^5,A_i \\le 10^{18}$\n\n $sum$  $S_1,S_2$ $S_1 \\oplus S_2 = sum$  $sum$  $i$  $1$ $i$  $sum$  $i$  $0$ $S_1,S_2$  $i$ \n\n $sum$  $0$  $S_1,S_2$  $S_1$  $S_1$  \n\nn \n\n\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\nusing namespace std;\n\nint n;\nlong long a[100005], bas[70], su, ans;\nint main() {\n    cin >> n;\n    rep(i, 1, n) scanf(\"%lld\", &a[i]), su ^= a[i];\n    rep(i, 1, n) a[i] &= ~su;\n    rep(i, 1, n) per(j, 59, 0) if(a[i] >> j & 1) {\n        if(bas[j]) a[i] ^= bas[j];\n        else {\n            per(k, j - 1, 0) if(a[i] >> k & 1) a[i] ^= bas[k];\n            rep(k, j + 1, 59) if(bas[k] >> j & 1) bas[k] ^= a[i];\n            bas[j] = a[i]; break;\n        }\n    }\n    rep(i, 1, 59) ans ^= bas[i];\n    cout << su + ans * 2;\n    return 0;\n}\n```","slug":"problem2","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0v003footnhuc2hs9o","content":"<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span> <span class=\"math inline\">\\(A\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 10^5,A_i \\le 10^{18}\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(sum\\)</span>  <span class=\"math inline\">\\(S_1,S_2\\)</span> <span class=\"math inline\">\\(S_1 \\oplus S_2 = sum\\)</span>  <span class=\"math inline\">\\(sum\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(sum\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(S_1,S_2\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(sum\\)</span>  <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(S_1,S_2\\)</span>  <span class=\"math inline\">\\(S_1\\)</span>  <span class=\"math inline\">\\(S_1\\)</span> </p>\r\n<p>n</p>\r\n<p></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n;</span><br><span class=\"line\"><span class=\"keyword\">long</span> <span class=\"keyword\">long</span> a[<span class=\"number\">100005</span>], bas[<span class=\"number\">70</span>], su, ans;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%lld&quot;</span>, &amp;a[i]), su ^= a[i];</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) a[i] &amp;= ~su;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">per</span>(j, <span class=\"number\">59</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(a[i] &gt;&gt; j &amp; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(bas[j]) a[i] ^= bas[j];</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">per</span>(k, j - <span class=\"number\">1</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(a[i] &gt;&gt; k &amp; <span class=\"number\">1</span>) a[i] ^= bas[k];</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(k, j + <span class=\"number\">1</span>, <span class=\"number\">59</span>) <span class=\"keyword\">if</span>(bas[k] &gt;&gt; j &amp; <span class=\"number\">1</span>) bas[k] ^= a[i];</span><br><span class=\"line\">            bas[j] = a[i]; <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">59</span>) ans ^= bas[i];</span><br><span class=\"line\">    cout &lt;&lt; su + ans * <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":1002,"excerpt":"","more":"<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span> <span class=\"math inline\">\\(A\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 10^5,A_i \\le 10^{18}\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(sum\\)</span>  <span class=\"math inline\">\\(S_1,S_2\\)</span> <span class=\"math inline\">\\(S_1 \\oplus S_2 = sum\\)</span>  <span class=\"math inline\">\\(sum\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(sum\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(S_1,S_2\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(sum\\)</span>  <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(S_1,S_2\\)</span>  <span class=\"math inline\">\\(S_1\\)</span>  <span class=\"math inline\">\\(S_1\\)</span> </p>\r\n<p>n</p>\r\n<p></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n;</span><br><span class=\"line\"><span class=\"keyword\">long</span> <span class=\"keyword\">long</span> a[<span class=\"number\">100005</span>], bas[<span class=\"number\">70</span>], su, ans;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%lld&quot;</span>, &amp;a[i]), su ^= a[i];</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) a[i] &amp;= ~su;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">per</span>(j, <span class=\"number\">59</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(a[i] &gt;&gt; j &amp; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(bas[j]) a[i] ^= bas[j];</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">per</span>(k, j - <span class=\"number\">1</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(a[i] &gt;&gt; k &amp; <span class=\"number\">1</span>) a[i] ^= bas[k];</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(k, j + <span class=\"number\">1</span>, <span class=\"number\">59</span>) <span class=\"keyword\">if</span>(bas[k] &gt;&gt; j &amp; <span class=\"number\">1</span>) bas[k] ^= a[i];</span><br><span class=\"line\">            bas[j] = a[i]; <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">59</span>) ans ^= bas[i];</span><br><span class=\"line\">    cout &lt;&lt; su + ans * <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"3","date":"2021-04-12T11:59:27.000Z","updated":"2021-04-12T11:59:27.000Z","_content":"> $n$  $p_i$ \n>\n>  $p_i$  $p_i$  $p_i = \\min\\{p_1,p_2,\\cdots,p_i\\}$\n>\n> -  $i < n$ $p_{i+1}$  $p_i$\n> -  $p_i$\n>\n>  $p_1$ $1$ $1$ \n>\n>  $T$ \n>\n> $n \\le 10^6,T \\le 10^5$\n\n $f_i$  $p_i$  $1$ \n\n $\\frac 1i$  $p_i = \\min\\{p_1,p_2,\\cdots,p_i\\}$ $1$ \n\n $1$  $f_{i+1}$ $1$  $\\frac in$\n\n $p_i \\ne \\min\\{p_1,p_2,\\cdots,p_i\\}$ $p_i$  $1$\n\n\n$$\nf_i = \\dfrac {\\max\\{f_{i+1},\\frac in\\} + (i-1)f_{i+1}}i\n$$\n $f_{n+1} = 0$ $f_1$\n\n $O(Tn)$ \n\n $f_i$  $\\frac in$  $f_1 > \\frac 1n,f_{n+1} < \\frac nn$\n\n $d$\n$$\n\\begin{cases}\nf_i \\ge \\frac in &(i \\le d)\\\\\nf_i < \\frac in &(i > d)\n\\end{cases}\n$$\n\n$$\nf_i = \\begin{cases}\nf_{i+1} &(i < d)\\\\\n\\dfrac {\\frac in+(i-1)f_{i+1}}i &(i \\ge d)\n\\end{cases}\n$$\n $i \\ge d$ \n$$\nf_i=\\frac {i-1}if_{i+1}+\\frac 1n\\\\\n\\frac 1{i-1}f_i=\\frac 1if_{i+1}+\\frac 1{n(i-1)}\n$$\n $g_i = \\frac 1{i-1}f_i$\n$$\n\\begin{aligned}\n&g_i=g_{i+1}+\\frac 1{n(i-1)}\\\\\n&=\\sum_{j=i-1}^n\\frac 1{nj}\\\\\n&=\\frac 1n\\sum_{j=i-1}^n\\frac 1j\n\\end{aligned}\n\\Rightarrow\nf_i=\\frac {i-1}n\\sum_{j=i-1}^n\\frac 1j\n$$\n $n$ $d$\n$$\n\\frac {d-1}n\\sum_{i=d-1}^n\\frac 1i\n$$\n $O(n_{\\max}+T)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\n\nconst int N = 1e6 + 5;\ntypedef long long ll;\nconst ll P = 998244353;\nconst double e = exp(1);\nint T, n; ll inv[N], s[N];\ndouble S[N];\nint main() {\n    inv[0] = inv[1] = 1;\n    rep(i, 2, 1000000) inv[i] = P / i * -inv[P % i] % P;\n    rep(i, 1, 1000000) S[i] = S[i - 1] + 1. / i, (s[i] += s[i - 1] + inv[i]) %= P;\n    for(cin >> T; T--;) {\n        scanf(\"%d\", &n);\n        if(n == 1) puts(\"1\");\n        else {\n            int k = upper_bound(S + 1, S + n + 1, S[n - 1] - 1) - S;\n            printf(\"%lld\\n\", ((s[n - 1] - s[k - 1]) * k % P * inv[n] % P + P) % P);\n        }\n    }\n    return 0;\n}\n```","source":"_posts/problem3.md","raw":"---\ntitle: 3\ndate: 2021-04-12 19:59:27\nupdated: 2021-04-12 19:59:27\ntags: [,,]\ncategories: \n---\n> $n$  $p_i$ \n>\n>  $p_i$  $p_i$  $p_i = \\min\\{p_1,p_2,\\cdots,p_i\\}$\n>\n> -  $i < n$ $p_{i+1}$  $p_i$\n> -  $p_i$\n>\n>  $p_1$ $1$ $1$ \n>\n>  $T$ \n>\n> $n \\le 10^6,T \\le 10^5$\n\n $f_i$  $p_i$  $1$ \n\n $\\frac 1i$  $p_i = \\min\\{p_1,p_2,\\cdots,p_i\\}$ $1$ \n\n $1$  $f_{i+1}$ $1$  $\\frac in$\n\n $p_i \\ne \\min\\{p_1,p_2,\\cdots,p_i\\}$ $p_i$  $1$\n\n\n$$\nf_i = \\dfrac {\\max\\{f_{i+1},\\frac in\\} + (i-1)f_{i+1}}i\n$$\n $f_{n+1} = 0$ $f_1$\n\n $O(Tn)$ \n\n $f_i$  $\\frac in$  $f_1 > \\frac 1n,f_{n+1} < \\frac nn$\n\n $d$\n$$\n\\begin{cases}\nf_i \\ge \\frac in &(i \\le d)\\\\\nf_i < \\frac in &(i > d)\n\\end{cases}\n$$\n\n$$\nf_i = \\begin{cases}\nf_{i+1} &(i < d)\\\\\n\\dfrac {\\frac in+(i-1)f_{i+1}}i &(i \\ge d)\n\\end{cases}\n$$\n $i \\ge d$ \n$$\nf_i=\\frac {i-1}if_{i+1}+\\frac 1n\\\\\n\\frac 1{i-1}f_i=\\frac 1if_{i+1}+\\frac 1{n(i-1)}\n$$\n $g_i = \\frac 1{i-1}f_i$\n$$\n\\begin{aligned}\n&g_i=g_{i+1}+\\frac 1{n(i-1)}\\\\\n&=\\sum_{j=i-1}^n\\frac 1{nj}\\\\\n&=\\frac 1n\\sum_{j=i-1}^n\\frac 1j\n\\end{aligned}\n\\Rightarrow\nf_i=\\frac {i-1}n\\sum_{j=i-1}^n\\frac 1j\n$$\n $n$ $d$\n$$\n\\frac {d-1}n\\sum_{i=d-1}^n\\frac 1i\n$$\n $O(n_{\\max}+T)$\n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\n\nconst int N = 1e6 + 5;\ntypedef long long ll;\nconst ll P = 998244353;\nconst double e = exp(1);\nint T, n; ll inv[N], s[N];\ndouble S[N];\nint main() {\n    inv[0] = inv[1] = 1;\n    rep(i, 2, 1000000) inv[i] = P / i * -inv[P % i] % P;\n    rep(i, 1, 1000000) S[i] = S[i - 1] + 1. / i, (s[i] += s[i - 1] + inv[i]) %= P;\n    for(cin >> T; T--;) {\n        scanf(\"%d\", &n);\n        if(n == 1) puts(\"1\");\n        else {\n            int k = upper_bound(S + 1, S + n + 1, S[n - 1] - 1) - S;\n            printf(\"%lld\\n\", ((s[n - 1] - s[k - 1]) * k % P * inv[n] % P + P) % P);\n        }\n    }\n    return 0;\n}\n```","slug":"problem3","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0w003gootnfcnb8kol","content":"<blockquote>\r\n<p><span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(p_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(p_i = \\min\\{p_1,p_2,\\cdots,p_i\\}\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i &lt; n\\)</span> <span class=\"math inline\">\\(p_{i+1}\\)</span>  <span class=\"math inline\">\\(p_i\\)</span></li>\r\n<li> <span class=\"math inline\">\\(p_i\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(p_1\\)</span> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(T\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 10^6,T \\le 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(f_i\\)</span>  <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\frac 1i\\)</span>  <span class=\"math inline\">\\(p_i = \\min\\{p_1,p_2,\\cdots,p_i\\}\\)</span> <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(f_{i+1}\\)</span> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(\\frac in\\)</span></p>\r\n<p> <span class=\"math inline\">\\(p_i \\ne \\min\\{p_1,p_2,\\cdots,p_i\\}\\)</span> <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(1\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\nf_i = \\dfrac {\\max\\{f_{i+1},\\frac in\\} + (i-1)f_{i+1}}i\r\n\\]</span>  <span class=\"math inline\">\\(f_{n+1} = 0\\)</span> <span class=\"math inline\">\\(f_1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(Tn)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(f_i\\)</span>  <span class=\"math inline\">\\(\\frac in\\)</span>  <span class=\"math inline\">\\(f_1 &gt; \\frac 1n,f_{n+1} &lt; \\frac nn\\)</span></p>\r\n<p> <span class=\"math inline\">\\(d\\)</span> <span class=\"math display\">\\[\r\n\\begin{cases}\r\nf_i \\ge \\frac in &amp;(i \\le d)\\\\\r\nf_i &lt; \\frac in &amp;(i &gt; d)\r\n\\end{cases}\r\n\\]</span>  <span class=\"math display\">\\[\r\nf_i = \\begin{cases}\r\nf_{i+1} &amp;(i &lt; d)\\\\\r\n\\dfrac {\\frac in+(i-1)f_{i+1}}i &amp;(i \\ge d)\r\n\\end{cases}\r\n\\]</span>  <span class=\"math inline\">\\(i \\ge d\\)</span>  <span class=\"math display\">\\[\r\nf_i=\\frac {i-1}if_{i+1}+\\frac 1n\\\\\r\n\\frac 1{i-1}f_i=\\frac 1if_{i+1}+\\frac 1{n(i-1)}\r\n\\]</span>  <span class=\"math inline\">\\(g_i = \\frac 1{i-1}f_i\\)</span> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;g_i=g_{i+1}+\\frac 1{n(i-1)}\\\\\r\n&amp;=\\sum_{j=i-1}^n\\frac 1{nj}\\\\\r\n&amp;=\\frac 1n\\sum_{j=i-1}^n\\frac 1j\r\n\\end{aligned}\r\n\\Rightarrow\r\nf_i=\\frac {i-1}n\\sum_{j=i-1}^n\\frac 1j\r\n\\]</span>  <span class=\"math inline\">\\(n\\)</span> <span class=\"math inline\">\\(d\\)</span> <span class=\"math display\">\\[\r\n\\frac {d-1}n\\sum_{i=d-1}^n\\frac 1i\r\n\\]</span>  <span class=\"math inline\">\\(O(n_{\\max}+T)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1e6</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> ll P = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">double</span> e = <span class=\"built_in\">exp</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"keyword\">int</span> T, n; ll inv[N], s[N];</span><br><span class=\"line\"><span class=\"keyword\">double</span> S[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    inv[<span class=\"number\">0</span>] = inv[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, <span class=\"number\">1000000</span>) inv[i] = P / i * -inv[P % i] % P;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">1000000</span>) S[i] = S[i - <span class=\"number\">1</span>] + <span class=\"number\">1.</span> / i, (s[i] += s[i - <span class=\"number\">1</span>] + inv[i]) %= P;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(cin &gt;&gt; T; T--;) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;n);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(n == <span class=\"number\">1</span>) <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> k = <span class=\"built_in\">upper_bound</span>(S + <span class=\"number\">1</span>, S + n + <span class=\"number\">1</span>, S[n - <span class=\"number\">1</span>] - <span class=\"number\">1</span>) - S;</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%lld\\n&quot;</span>, ((s[n - <span class=\"number\">1</span>] - s[k - <span class=\"number\">1</span>]) * k % P * inv[n] % P + P) % P);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2002,"excerpt":"","more":"<blockquote>\r\n<p><span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(p_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(p_i = \\min\\{p_1,p_2,\\cdots,p_i\\}\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i &lt; n\\)</span> <span class=\"math inline\">\\(p_{i+1}\\)</span>  <span class=\"math inline\">\\(p_i\\)</span></li>\r\n<li> <span class=\"math inline\">\\(p_i\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(p_1\\)</span> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(T\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 10^6,T \\le 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(f_i\\)</span>  <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\frac 1i\\)</span>  <span class=\"math inline\">\\(p_i = \\min\\{p_1,p_2,\\cdots,p_i\\}\\)</span> <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(f_{i+1}\\)</span> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(\\frac in\\)</span></p>\r\n<p> <span class=\"math inline\">\\(p_i \\ne \\min\\{p_1,p_2,\\cdots,p_i\\}\\)</span> <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(1\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\nf_i = \\dfrac {\\max\\{f_{i+1},\\frac in\\} + (i-1)f_{i+1}}i\r\n\\]</span>  <span class=\"math inline\">\\(f_{n+1} = 0\\)</span> <span class=\"math inline\">\\(f_1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(Tn)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(f_i\\)</span>  <span class=\"math inline\">\\(\\frac in\\)</span>  <span class=\"math inline\">\\(f_1 &gt; \\frac 1n,f_{n+1} &lt; \\frac nn\\)</span></p>\r\n<p> <span class=\"math inline\">\\(d\\)</span> <span class=\"math display\">\\[\r\n\\begin{cases}\r\nf_i \\ge \\frac in &amp;(i \\le d)\\\\\r\nf_i &lt; \\frac in &amp;(i &gt; d)\r\n\\end{cases}\r\n\\]</span>  <span class=\"math display\">\\[\r\nf_i = \\begin{cases}\r\nf_{i+1} &amp;(i &lt; d)\\\\\r\n\\dfrac {\\frac in+(i-1)f_{i+1}}i &amp;(i \\ge d)\r\n\\end{cases}\r\n\\]</span>  <span class=\"math inline\">\\(i \\ge d\\)</span>  <span class=\"math display\">\\[\r\nf_i=\\frac {i-1}if_{i+1}+\\frac 1n\\\\\r\n\\frac 1{i-1}f_i=\\frac 1if_{i+1}+\\frac 1{n(i-1)}\r\n\\]</span>  <span class=\"math inline\">\\(g_i = \\frac 1{i-1}f_i\\)</span> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;g_i=g_{i+1}+\\frac 1{n(i-1)}\\\\\r\n&amp;=\\sum_{j=i-1}^n\\frac 1{nj}\\\\\r\n&amp;=\\frac 1n\\sum_{j=i-1}^n\\frac 1j\r\n\\end{aligned}\r\n\\Rightarrow\r\nf_i=\\frac {i-1}n\\sum_{j=i-1}^n\\frac 1j\r\n\\]</span>  <span class=\"math inline\">\\(n\\)</span> <span class=\"math inline\">\\(d\\)</span> <span class=\"math display\">\\[\r\n\\frac {d-1}n\\sum_{i=d-1}^n\\frac 1i\r\n\\]</span>  <span class=\"math inline\">\\(O(n_{\\max}+T)\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1e6</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> ll P = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">double</span> e = <span class=\"built_in\">exp</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"keyword\">int</span> T, n; ll inv[N], s[N];</span><br><span class=\"line\"><span class=\"keyword\">double</span> S[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    inv[<span class=\"number\">0</span>] = inv[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, <span class=\"number\">1000000</span>) inv[i] = P / i * -inv[P % i] % P;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">1000000</span>) S[i] = S[i - <span class=\"number\">1</span>] + <span class=\"number\">1.</span> / i, (s[i] += s[i - <span class=\"number\">1</span>] + inv[i]) %= P;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(cin &gt;&gt; T; T--;) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;n);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(n == <span class=\"number\">1</span>) <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;1&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> k = <span class=\"built_in\">upper_bound</span>(S + <span class=\"number\">1</span>, S + n + <span class=\"number\">1</span>, S[n - <span class=\"number\">1</span>] - <span class=\"number\">1</span>) - S;</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%lld\\n&quot;</span>, ((s[n - <span class=\"number\">1</span>] - s[k - <span class=\"number\">1</span>]) * k % P * inv[n] % P + P) % P);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":" 4","date":"2021-09-04T08:01:14.000Z","updated":"2021-09-04T08:01:14.000Z","_content":">  $n$  $m$  $0$\n>\n>  $p$ \n>\n> $n \\le 10^9, m \\le 3 \\cdot 10^6$ $p$ \n\n $A$\n$$\nA_i =\n\\begin{cases}\n1 &(i \\le m \\land i \\in \\text{Prime})\\\\\n0 &(otherwise)\n\\end{cases}\n$$\n $(A^n)_0$ \n\n ```FWT``` +  $O(m \\log m\\log n)$\n\n ```FWT``` $n$  ```IFWT``` $O(m(\\log n + \\log m))$\n\n $O(m)$  ```TLE```\n\n ```FWT``` \n$$\nFWT(A)_i = \\sum_{2\\ |\\ pop(j \\& i)}A_j - \\sum_{2\\ \\not|\\ pop(j \\& i)}A_j\n$$\n $|FWT(A)_i| \\le \\sum_iA_i$ $FWT(A)_0 = \\sum_iA_i$\n\n$\\sum_iA_i$  $m$  $O(\\frac m {\\log m})$  $O(\\frac m {\\log m})$  $n$ \n\n $O(\\frac m {\\log m})$ \n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\n\ntypedef long long ll;\nconst int N = 1 << 22;\n\nint n, m; ll P;\nint pid, f[N], g[N], prm[216900], b, lim = 1;\n\nll Pow(ll a, int n, ll r = 1) {\n    for(; n; n /= 2, a = a * a % P)\n    if(n & 1) r = r * a % P;\n    return r;\n}\nvoid FWT(int a[]) {\n    For(i, 0, b) For(S, 0, lim) if(S >> i & 1) {\n        int& x = a[S ^ 1 << i], y = a[S];\n        a[S] = x - y, x += y;\n    }\n}\n\nint main() {\n    cin >> n >> m >> P;\n    if(P == 1) puts(\"0\"), exit(0);\n    while(lim <= m) lim *= 2, b++;\n    rep(i, 2, m) {\n        if(!f[i]) prm[++pid] = i;\n        for(int j = 1; i * prm[j] <= m; j++) {\n            f[i * prm[j]] = 1;\n            if(i % prm[j] == 0) break;\n        }\n    }\n    mem(f, 0);\n    rep(i, 1, pid) f[prm[i]]++, g[i] = Pow(i, n);\n    FWT(f);\n    int as = 0;\n    For(S, 0, lim) (as += (f[S] < 0 && n % 2 ? -1 : 1) * g[abs(f[S])]) %= P;\n    cout << (as + P) * Pow(P / 2 + 1, b) % P;\n    return 0;\n}\n```\n","source":"_posts/problem4.md","raw":"---\ntitle:  4\ndate: 2021-09-04 16:01:14\nupdated: 2021-09-04 16:01:14\ntags: []\ncategories: \n---\n>  $n$  $m$  $0$\n>\n>  $p$ \n>\n> $n \\le 10^9, m \\le 3 \\cdot 10^6$ $p$ \n\n $A$\n$$\nA_i =\n\\begin{cases}\n1 &(i \\le m \\land i \\in \\text{Prime})\\\\\n0 &(otherwise)\n\\end{cases}\n$$\n $(A^n)_0$ \n\n ```FWT``` +  $O(m \\log m\\log n)$\n\n ```FWT``` $n$  ```IFWT``` $O(m(\\log n + \\log m))$\n\n $O(m)$  ```TLE```\n\n ```FWT``` \n$$\nFWT(A)_i = \\sum_{2\\ |\\ pop(j \\& i)}A_j - \\sum_{2\\ \\not|\\ pop(j \\& i)}A_j\n$$\n $|FWT(A)_i| \\le \\sum_iA_i$ $FWT(A)_0 = \\sum_iA_i$\n\n$\\sum_iA_i$  $m$  $O(\\frac m {\\log m})$  $O(\\frac m {\\log m})$  $n$ \n\n $O(\\frac m {\\log m})$ \n\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\n\ntypedef long long ll;\nconst int N = 1 << 22;\n\nint n, m; ll P;\nint pid, f[N], g[N], prm[216900], b, lim = 1;\n\nll Pow(ll a, int n, ll r = 1) {\n    for(; n; n /= 2, a = a * a % P)\n    if(n & 1) r = r * a % P;\n    return r;\n}\nvoid FWT(int a[]) {\n    For(i, 0, b) For(S, 0, lim) if(S >> i & 1) {\n        int& x = a[S ^ 1 << i], y = a[S];\n        a[S] = x - y, x += y;\n    }\n}\n\nint main() {\n    cin >> n >> m >> P;\n    if(P == 1) puts(\"0\"), exit(0);\n    while(lim <= m) lim *= 2, b++;\n    rep(i, 2, m) {\n        if(!f[i]) prm[++pid] = i;\n        for(int j = 1; i * prm[j] <= m; j++) {\n            f[i * prm[j]] = 1;\n            if(i % prm[j] == 0) break;\n        }\n    }\n    mem(f, 0);\n    rep(i, 1, pid) f[prm[i]]++, g[i] = Pow(i, n);\n    FWT(f);\n    int as = 0;\n    For(S, 0, lim) (as += (f[S] < 0 && n % 2 ? -1 : 1) * g[abs(f[S])]) %= P;\n    cout << (as + P) * Pow(P / 2 + 1, b) % P;\n    return 0;\n}\n```\n","slug":"problem4","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0x003kootn9r6d62kn","content":"<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(p\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 10^9, m \\le 3 \\cdot 10^6\\)</span> <span class=\"math inline\">\\(p\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(A\\)</span> <span class=\"math display\">\\[\r\nA_i =\r\n\\begin{cases}\r\n1 &amp;(i \\le m \\land i \\in \\text{Prime})\\\\\r\n0 &amp;(otherwise)\r\n\\end{cases}\r\n\\]</span>  <span class=\"math inline\">\\((A^n)_0\\)</span> </p>\r\n<p> <code>FWT</code> +  <span class=\"math inline\">\\(O(m \\log m\\log n)\\)</span></p>\r\n<p> <code>FWT</code> <span class=\"math inline\">\\(n\\)</span>  <code>IFWT</code> <span class=\"math inline\">\\(O(m(\\log n + \\log m))\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(m)\\)</span>  <code>TLE</code></p>\r\n<p> <code>FWT</code>  <span class=\"math display\">\\[\r\nFWT(A)_i = \\sum_{2\\ |\\ pop(j \\&amp; i)}A_j - \\sum_{2\\ \\not|\\ pop(j \\&amp; i)}A_j\r\n\\]</span>  <span class=\"math inline\">\\(|FWT(A)_i| \\le \\sum_iA_i\\)</span> <span class=\"math inline\">\\(FWT(A)_0 = \\sum_iA_i\\)</span></p>\r\n<p><span class=\"math inline\">\\(\\sum_iA_i\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(O(\\frac m {\\log m})\\)</span>  <span class=\"math inline\">\\(O(\\frac m {\\log m})\\)</span>  <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(\\frac m {\\log m})\\)</span> </p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1</span> &lt;&lt; <span class=\"number\">22</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m; ll P;</span><br><span class=\"line\"><span class=\"keyword\">int</span> pid, f[N], g[N], prm[<span class=\"number\">216900</span>], b, lim = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">Pow</span><span class=\"params\">(ll a, <span class=\"keyword\">int</span> n, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a % P)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FWT</span><span class=\"params\">(<span class=\"keyword\">int</span> a[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, b) <span class=\"built_in\">For</span>(S, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(S &gt;&gt; i &amp; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>&amp; x = a[S ^ <span class=\"number\">1</span> &lt;&lt; i], y = a[S];</span><br><span class=\"line\">        a[S] = x - y, x += y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; P;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(P == <span class=\"number\">1</span>) <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;0&quot;</span>), <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(lim &lt;= m) lim *= <span class=\"number\">2</span>, b++;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, m) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!f[i]) prm[++pid] = i;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">1</span>; i * prm[j] &lt;= m; j++) &#123;</span><br><span class=\"line\">            f[i * prm[j]] = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(i % prm[j] == <span class=\"number\">0</span>) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(f, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, pid) f[prm[i]]++, g[i] = <span class=\"built_in\">Pow</span>(i, n);</span><br><span class=\"line\">    <span class=\"built_in\">FWT</span>(f);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> as = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(S, <span class=\"number\">0</span>, lim) (as += (f[S] &lt; <span class=\"number\">0</span> &amp;&amp; n % <span class=\"number\">2</span> ? <span class=\"number\">-1</span> : <span class=\"number\">1</span>) * g[<span class=\"built_in\">abs</span>(f[S])]) %= P;</span><br><span class=\"line\">    cout &lt;&lt; (as + P) * <span class=\"built_in\">Pow</span>(P / <span class=\"number\">2</span> + <span class=\"number\">1</span>, b) % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":1645,"excerpt":"","more":"<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(p\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 10^9, m \\le 3 \\cdot 10^6\\)</span> <span class=\"math inline\">\\(p\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(A\\)</span> <span class=\"math display\">\\[\r\nA_i =\r\n\\begin{cases}\r\n1 &amp;(i \\le m \\land i \\in \\text{Prime})\\\\\r\n0 &amp;(otherwise)\r\n\\end{cases}\r\n\\]</span>  <span class=\"math inline\">\\((A^n)_0\\)</span> </p>\r\n<p> <code>FWT</code> +  <span class=\"math inline\">\\(O(m \\log m\\log n)\\)</span></p>\r\n<p> <code>FWT</code> <span class=\"math inline\">\\(n\\)</span>  <code>IFWT</code> <span class=\"math inline\">\\(O(m(\\log n + \\log m))\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(m)\\)</span>  <code>TLE</code></p>\r\n<p> <code>FWT</code>  <span class=\"math display\">\\[\r\nFWT(A)_i = \\sum_{2\\ |\\ pop(j \\&amp; i)}A_j - \\sum_{2\\ \\not|\\ pop(j \\&amp; i)}A_j\r\n\\]</span>  <span class=\"math inline\">\\(|FWT(A)_i| \\le \\sum_iA_i\\)</span> <span class=\"math inline\">\\(FWT(A)_0 = \\sum_iA_i\\)</span></p>\r\n<p><span class=\"math inline\">\\(\\sum_iA_i\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(O(\\frac m {\\log m})\\)</span>  <span class=\"math inline\">\\(O(\\frac m {\\log m})\\)</span>  <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(\\frac m {\\log m})\\)</span> </p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> ll;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1</span> &lt;&lt; <span class=\"number\">22</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m; ll P;</span><br><span class=\"line\"><span class=\"keyword\">int</span> pid, f[N], g[N], prm[<span class=\"number\">216900</span>], b, lim = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">Pow</span><span class=\"params\">(ll a, <span class=\"keyword\">int</span> n, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a % P)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FWT</span><span class=\"params\">(<span class=\"keyword\">int</span> a[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, b) <span class=\"built_in\">For</span>(S, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(S &gt;&gt; i &amp; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>&amp; x = a[S ^ <span class=\"number\">1</span> &lt;&lt; i], y = a[S];</span><br><span class=\"line\">        a[S] = x - y, x += y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; P;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(P == <span class=\"number\">1</span>) <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;0&quot;</span>), <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(lim &lt;= m) lim *= <span class=\"number\">2</span>, b++;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, m) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!f[i]) prm[++pid] = i;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">1</span>; i * prm[j] &lt;= m; j++) &#123;</span><br><span class=\"line\">            f[i * prm[j]] = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(i % prm[j] == <span class=\"number\">0</span>) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(f, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, pid) f[prm[i]]++, g[i] = <span class=\"built_in\">Pow</span>(i, n);</span><br><span class=\"line\">    <span class=\"built_in\">FWT</span>(f);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> as = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(S, <span class=\"number\">0</span>, lim) (as += (f[S] &lt; <span class=\"number\">0</span> &amp;&amp; n % <span class=\"number\">2</span> ? <span class=\"number\">-1</span> : <span class=\"number\">1</span>) * g[<span class=\"built_in\">abs</span>(f[S])]) %= P;</span><br><span class=\"line\">    cout &lt;&lt; (as + P) * <span class=\"built_in\">Pow</span>(P / <span class=\"number\">2</span> + <span class=\"number\">1</span>, b) % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":" NTT","date":"2021-04-20T01:08:39.000Z","updated":"2021-04-20T01:08:39.000Z","_content":">  $n$  $A$  $m$  $B$ $A \\times B$ $p$ \n>\n> $n,m \\le 10^5$\n\n\n\n-  ```NTT``` \n\n<!-- more -->\n\n-  $M = \\lceil \\sqrt p \\rceil$ $x$  $M \\cdot \\lfloor \\frac Mx \\rfloor$  $M \\bmod x$ \n\n\n\n### \n\n\n$$\nA0_i=\\lfloor \\frac {A_i}M \\rfloor,A1_i=A_i \\bmod M\\\\B0_i=\\lfloor \\frac {B_i}M \\rfloor,B1_i=B_i \\bmod M\n$$\n\n$$\nA = M \\cdot A0 + A1\\\\B = M \\cdot B0  + B1\n$$\n\n$$\nA \\times B = M^2 \\cdot A0 \\times B0 + M(A0 \\times B1 + A1 \\times B0) + A1 \\times B1\n$$\n $A0,A1,B0,B1$  ```DFT``` $A0 \\times B0, A0 \\times B1 + A1 \\times B0,A1 \\times B1$  ```IDFT``` $7$ \n\n $10^{14}$ $w_n^k=\\cos \\frac {2k\\pi}n+i \\cdot \\sin \\frac {2k\\pi}n$  $w_n^k$ \n\n### \n\n\n\n- **** $A,B$  ```DFT```\n\n  \n  $$\n  P = A + iB\\\\\n  Q = A - iB\n  $$\n  \n  $$\n  \\text {conj}(Q(w_n^k))=P(\\text{conj}({w_n^{k}}))\n  $$\n   ```DFT```  $A,B$ \n\n- **** $A,B$  $A',B'$ $A,B$\n\n  \n  $$\n  P = A' + iB'\n  $$\n   $P$  ```IDFT```  $P'$\n  $$\n  P' = A + iB\n  $$\n   $P'$  $A$,  $B$\n\n   ```IDFT```  $A',B'$  ```IDFT``` .\n\n $7$  ```DFT```  $4$  ```DFT```\n\n\n\n```cpp\ntypedef complex <lf> cmp;\nconst lf PI = acos(-1);\nconst cmp I(0, 1);\n\nint n, m, P;\nint M, lim = 1, bit = -1, rev[N];\ncmp w[N], a0[N], a1[N], b0[N], b1[N];\n```\n\n\n\n```cpp\nvoid FFT(cmp a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(i < rev[i]) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2) for(int j = 0; j < lim; j += i * 2) For(k, j, j + i) {\n        cmp x = a[k], y = a[i + k] * w[lim / i * (k - j)];\n        a[k] = x + y, a[i + k] = x - y;\n    }\n    if(t) For(i, 0, lim) a[i] *= inv;\n}\nvoid FFT2(cmp a[], cmp b[]) {\n    For(i, 0, lim) a[i] += b[i] * I;\n    FFT(a, 0);\n    For(i, 0, lim) b[i] = conj(a[i ? lim - i : 0]);\n    For(i, 0, lim) {\n        cmp x = a[i], y = b[i];\n        a[i] = (y + x) * 0.5, b[i] = (y - x) * 0.5 * I;\n    }\n}\nll num(cmp x) { return M * ll(real(x) + 0.5) % P + ll(imag(x) + 0.5); }\n```\n\n\n\n```cpp\nM = sqrt(P);\nrep(i, 0, n) a0[i] = A[i] / M, a1[i] = A[i] % M;\nrep(i, 0, m) b0[i] = B[i] / M, b1[i] = B[i] % M;\nwhile(lim <= n + m) lim *= 2, bit++;\ninv = 1. / lim;\nFor(i, 0, lim) {\n    rev[i] = rev[i / 2] / 2 | (i & 1) << bit;\n    w[i] = cmp(cos(PI / lim * i), sin(PI / lim * i));\n}\n```\n\n\n\n```cpp\nFFT2(a0, a1), FFT2(b0, b1);\nFor(i, 0, lim) {\n    cmp t = a0[i] + I * a1[i];\n    b0[i] *= t, b1[i] *= t;\n}\nFFT(b0, 1), FFT(b1, 1);\nrep(i, 0, n + m) C[i] = (M * num(b0[i]) + num(b1[i])) % P;\n```","source":"_posts/ren-yi-mo-shu-ntt.md","raw":"---\ntitle:  NTT\ndate: 2021-04-20 09:08:39\nupdated: 2021-04-20 09:08:39\ntags: [,,]\ncategories: \n---\n>  $n$  $A$  $m$  $B$ $A \\times B$ $p$ \n>\n> $n,m \\le 10^5$\n\n\n\n-  ```NTT``` \n\n<!-- more -->\n\n-  $M = \\lceil \\sqrt p \\rceil$ $x$  $M \\cdot \\lfloor \\frac Mx \\rfloor$  $M \\bmod x$ \n\n\n\n### \n\n\n$$\nA0_i=\\lfloor \\frac {A_i}M \\rfloor,A1_i=A_i \\bmod M\\\\B0_i=\\lfloor \\frac {B_i}M \\rfloor,B1_i=B_i \\bmod M\n$$\n\n$$\nA = M \\cdot A0 + A1\\\\B = M \\cdot B0  + B1\n$$\n\n$$\nA \\times B = M^2 \\cdot A0 \\times B0 + M(A0 \\times B1 + A1 \\times B0) + A1 \\times B1\n$$\n $A0,A1,B0,B1$  ```DFT``` $A0 \\times B0, A0 \\times B1 + A1 \\times B0,A1 \\times B1$  ```IDFT``` $7$ \n\n $10^{14}$ $w_n^k=\\cos \\frac {2k\\pi}n+i \\cdot \\sin \\frac {2k\\pi}n$  $w_n^k$ \n\n### \n\n\n\n- **** $A,B$  ```DFT```\n\n  \n  $$\n  P = A + iB\\\\\n  Q = A - iB\n  $$\n  \n  $$\n  \\text {conj}(Q(w_n^k))=P(\\text{conj}({w_n^{k}}))\n  $$\n   ```DFT```  $A,B$ \n\n- **** $A,B$  $A',B'$ $A,B$\n\n  \n  $$\n  P = A' + iB'\n  $$\n   $P$  ```IDFT```  $P'$\n  $$\n  P' = A + iB\n  $$\n   $P'$  $A$,  $B$\n\n   ```IDFT```  $A',B'$  ```IDFT``` .\n\n $7$  ```DFT```  $4$  ```DFT```\n\n\n\n```cpp\ntypedef complex <lf> cmp;\nconst lf PI = acos(-1);\nconst cmp I(0, 1);\n\nint n, m, P;\nint M, lim = 1, bit = -1, rev[N];\ncmp w[N], a0[N], a1[N], b0[N], b1[N];\n```\n\n\n\n```cpp\nvoid FFT(cmp a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(i < rev[i]) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2) for(int j = 0; j < lim; j += i * 2) For(k, j, j + i) {\n        cmp x = a[k], y = a[i + k] * w[lim / i * (k - j)];\n        a[k] = x + y, a[i + k] = x - y;\n    }\n    if(t) For(i, 0, lim) a[i] *= inv;\n}\nvoid FFT2(cmp a[], cmp b[]) {\n    For(i, 0, lim) a[i] += b[i] * I;\n    FFT(a, 0);\n    For(i, 0, lim) b[i] = conj(a[i ? lim - i : 0]);\n    For(i, 0, lim) {\n        cmp x = a[i], y = b[i];\n        a[i] = (y + x) * 0.5, b[i] = (y - x) * 0.5 * I;\n    }\n}\nll num(cmp x) { return M * ll(real(x) + 0.5) % P + ll(imag(x) + 0.5); }\n```\n\n\n\n```cpp\nM = sqrt(P);\nrep(i, 0, n) a0[i] = A[i] / M, a1[i] = A[i] % M;\nrep(i, 0, m) b0[i] = B[i] / M, b1[i] = B[i] % M;\nwhile(lim <= n + m) lim *= 2, bit++;\ninv = 1. / lim;\nFor(i, 0, lim) {\n    rev[i] = rev[i / 2] / 2 | (i & 1) << bit;\n    w[i] = cmp(cos(PI / lim * i), sin(PI / lim * i));\n}\n```\n\n\n\n```cpp\nFFT2(a0, a1), FFT2(b0, b1);\nFor(i, 0, lim) {\n    cmp t = a0[i] + I * a1[i];\n    b0[i] *= t, b1[i] *= t;\n}\nFFT(b0, 1), FFT(b1, 1);\nrep(i, 0, n + m) C[i] = (M * num(b0[i]) + num(b1[i])) % P;\n```","slug":"ren-yi-mo-shu-ntt","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0y003lootn0n0l6xd2","content":"<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(B\\)</span> <span class=\"math inline\">\\(A \\times B\\)</span> <span class=\"math inline\">\\(p\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n,m \\le 10^5\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<ul>\r\n<li> <code>NTT</code> </li>\r\n</ul>\r\n<span id=\"more\"></span>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(M = \\lceil \\sqrt p \\rceil\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(M \\cdot \\lfloor \\frac Mx \\rfloor\\)</span>  <span class=\"math inline\">\\(M \\bmod x\\)</span> </li>\r\n</ul>\r\n<p></p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math display\">\\[\r\nA0_i=\\lfloor \\frac {A_i}M \\rfloor,A1_i=A_i \\bmod M\\\\B0_i=\\lfloor \\frac {B_i}M \\rfloor,B1_i=B_i \\bmod M\r\n\\]</span>  <span class=\"math display\">\\[\r\nA = M \\cdot A0 + A1\\\\B = M \\cdot B0  + B1\r\n\\]</span>  <span class=\"math display\">\\[\r\nA \\times B = M^2 \\cdot A0 \\times B0 + M(A0 \\times B1 + A1 \\times B0) + A1 \\times B1\r\n\\]</span>  <span class=\"math inline\">\\(A0,A1,B0,B1\\)</span>  <code>DFT</code> <span class=\"math inline\">\\(A0 \\times B0, A0 \\times B1 + A1 \\times B0,A1 \\times B1\\)</span>  <code>IDFT</code> <span class=\"math inline\">\\(7\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(10^{14}\\)</span> <span class=\"math inline\">\\(w_n^k=\\cos \\frac {2k\\pi}n+i \\cdot \\sin \\frac {2k\\pi}n\\)</span>  <span class=\"math inline\">\\(w_n^k\\)</span> </p>\r\n<h3 id=\"\"></h3>\r\n<p></p>\r\n<ul>\r\n<li><p><strong></strong> <span class=\"math inline\">\\(A,B\\)</span>  <code>DFT</code></p>\r\n<p> <span class=\"math display\">\\[\r\nP = A + iB\\\\\r\nQ = A - iB\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\text {conj}(Q(w_n^k))=P(\\text{conj}({w_n^{k}}))\r\n\\]</span>  <code>DFT</code>  <span class=\"math inline\">\\(A,B\\)</span> </p></li>\r\n<li><p><strong></strong> <span class=\"math inline\">\\(A,B\\)</span>  <span class=\"math inline\">\\(A&#39;,B&#39;\\)</span> <span class=\"math inline\">\\(A,B\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\nP = A&#39; + iB&#39;\r\n\\]</span>  <span class=\"math inline\">\\(P\\)</span>  <code>IDFT</code>  <span class=\"math inline\">\\(P&#39;\\)</span> <span class=\"math display\">\\[\r\nP&#39; = A + iB\r\n\\]</span>  <span class=\"math inline\">\\(P&#39;\\)</span>  <span class=\"math inline\">\\(A\\)</span>,  <span class=\"math inline\">\\(B\\)</span></p>\r\n<p> <code>IDFT</code>  <span class=\"math inline\">\\(A&#39;,B&#39;\\)</span>  <code>IDFT</code> .</p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(7\\)</span>  <code>DFT</code>  <span class=\"math inline\">\\(4\\)</span>  <code>DFT</code></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> complex &lt;lf&gt; cmp;</span><br><span class=\"line\"><span class=\"keyword\">const</span> lf PI = <span class=\"built_in\">acos</span>(<span class=\"number\">-1</span>);</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">const</span> cmp <span class=\"title\">I</span><span class=\"params\">(<span class=\"number\">0</span>, <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, P;</span><br><span class=\"line\"><span class=\"keyword\">int</span> M, lim = <span class=\"number\">1</span>, bit = <span class=\"number\">-1</span>, rev[N];</span><br><span class=\"line\">cmp w[N], a0[N], a1[N], b0[N], b1[N];</span><br></pre></td></tr></table></figure>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FFT</span><span class=\"params\">(cmp a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(i &lt; rev[i]) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">        cmp x = a[k], y = a[i + k] * w[lim / i * (k - j)];</span><br><span class=\"line\">        a[k] = x + y, a[i + k] = x - y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] *= inv;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FFT2</span><span class=\"params\">(cmp a[], cmp b[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] += b[i] * I;</span><br><span class=\"line\">    <span class=\"built_in\">FFT</span>(a, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) b[i] = <span class=\"built_in\">conj</span>(a[i ? lim - i : <span class=\"number\">0</span>]);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">        cmp x = a[i], y = b[i];</span><br><span class=\"line\">        a[i] = (y + x) * <span class=\"number\">0.5</span>, b[i] = (y - x) * <span class=\"number\">0.5</span> * I;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">num</span><span class=\"params\">(cmp x)</span> </span>&#123; <span class=\"keyword\">return</span> M * <span class=\"built_in\">ll</span>(<span class=\"built_in\">real</span>(x) + <span class=\"number\">0.5</span>) % P + <span class=\"built_in\">ll</span>(<span class=\"built_in\">imag</span>(x) + <span class=\"number\">0.5</span>); &#125;</span><br></pre></td></tr></table></figure>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">M = <span class=\"built_in\">sqrt</span>(P);</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) a0[i] = A[i] / M, a1[i] = A[i] % M;</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, m) b0[i] = B[i] / M, b1[i] = B[i] % M;</span><br><span class=\"line\"><span class=\"keyword\">while</span>(lim &lt;= n + m) lim *= <span class=\"number\">2</span>, bit++;</span><br><span class=\"line\">inv = <span class=\"number\">1.</span> / lim;</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">    rev[i] = rev[i / <span class=\"number\">2</span>] / <span class=\"number\">2</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; bit;</span><br><span class=\"line\">    w[i] = <span class=\"built_in\">cmp</span>(<span class=\"built_in\">cos</span>(PI / lim * i), <span class=\"built_in\">sin</span>(PI / lim * i));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">FFT2</span>(a0, a1), <span class=\"built_in\">FFT2</span>(b0, b1);</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">    cmp t = a0[i] + I * a1[i];</span><br><span class=\"line\">    b0[i] *= t, b1[i] *= t;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">FFT</span>(b0, <span class=\"number\">1</span>), <span class=\"built_in\">FFT</span>(b1, <span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n + m) C[i] = (M * <span class=\"built_in\">num</span>(b0[i]) + <span class=\"built_in\">num</span>(b1[i])) % P;</span><br></pre></td></tr></table></figure>\r\n","site":{"data":{}},"length":2038,"excerpt":"<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(B\\)</span> <span class=\"math inline\">\\(A \\times B\\)</span> <span class=\"math inline\">\\(p\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n,m \\le 10^5\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<ul>\r\n<li> <code>NTT</code> </li>\r\n</ul>","more":"<ul>\r\n<li> <span class=\"math inline\">\\(M = \\lceil \\sqrt p \\rceil\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(M \\cdot \\lfloor \\frac Mx \\rfloor\\)</span>  <span class=\"math inline\">\\(M \\bmod x\\)</span> </li>\r\n</ul>\r\n<p></p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math display\">\\[\r\nA0_i=\\lfloor \\frac {A_i}M \\rfloor,A1_i=A_i \\bmod M\\\\B0_i=\\lfloor \\frac {B_i}M \\rfloor,B1_i=B_i \\bmod M\r\n\\]</span>  <span class=\"math display\">\\[\r\nA = M \\cdot A0 + A1\\\\B = M \\cdot B0  + B1\r\n\\]</span>  <span class=\"math display\">\\[\r\nA \\times B = M^2 \\cdot A0 \\times B0 + M(A0 \\times B1 + A1 \\times B0) + A1 \\times B1\r\n\\]</span>  <span class=\"math inline\">\\(A0,A1,B0,B1\\)</span>  <code>DFT</code> <span class=\"math inline\">\\(A0 \\times B0, A0 \\times B1 + A1 \\times B0,A1 \\times B1\\)</span>  <code>IDFT</code> <span class=\"math inline\">\\(7\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(10^{14}\\)</span> <span class=\"math inline\">\\(w_n^k=\\cos \\frac {2k\\pi}n+i \\cdot \\sin \\frac {2k\\pi}n\\)</span>  <span class=\"math inline\">\\(w_n^k\\)</span> </p>\r\n<h3 id=\"\"></h3>\r\n<p></p>\r\n<ul>\r\n<li><p><strong></strong> <span class=\"math inline\">\\(A,B\\)</span>  <code>DFT</code></p>\r\n<p> <span class=\"math display\">\\[\r\nP = A + iB\\\\\r\nQ = A - iB\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\text {conj}(Q(w_n^k))=P(\\text{conj}({w_n^{k}}))\r\n\\]</span>  <code>DFT</code>  <span class=\"math inline\">\\(A,B\\)</span> </p></li>\r\n<li><p><strong></strong> <span class=\"math inline\">\\(A,B\\)</span>  <span class=\"math inline\">\\(A&#39;,B&#39;\\)</span> <span class=\"math inline\">\\(A,B\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\nP = A&#39; + iB&#39;\r\n\\]</span>  <span class=\"math inline\">\\(P\\)</span>  <code>IDFT</code>  <span class=\"math inline\">\\(P&#39;\\)</span> <span class=\"math display\">\\[\r\nP&#39; = A + iB\r\n\\]</span>  <span class=\"math inline\">\\(P&#39;\\)</span>  <span class=\"math inline\">\\(A\\)</span>,  <span class=\"math inline\">\\(B\\)</span></p>\r\n<p> <code>IDFT</code>  <span class=\"math inline\">\\(A&#39;,B&#39;\\)</span>  <code>IDFT</code> .</p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(7\\)</span>  <code>DFT</code>  <span class=\"math inline\">\\(4\\)</span>  <code>DFT</code></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> complex &lt;lf&gt; cmp;</span><br><span class=\"line\"><span class=\"keyword\">const</span> lf PI = <span class=\"built_in\">acos</span>(<span class=\"number\">-1</span>);</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">const</span> cmp <span class=\"title\">I</span><span class=\"params\">(<span class=\"number\">0</span>, <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, P;</span><br><span class=\"line\"><span class=\"keyword\">int</span> M, lim = <span class=\"number\">1</span>, bit = <span class=\"number\">-1</span>, rev[N];</span><br><span class=\"line\">cmp w[N], a0[N], a1[N], b0[N], b1[N];</span><br></pre></td></tr></table></figure>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FFT</span><span class=\"params\">(cmp a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(i &lt; rev[i]) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">        cmp x = a[k], y = a[i + k] * w[lim / i * (k - j)];</span><br><span class=\"line\">        a[k] = x + y, a[i + k] = x - y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] *= inv;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FFT2</span><span class=\"params\">(cmp a[], cmp b[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] += b[i] * I;</span><br><span class=\"line\">    <span class=\"built_in\">FFT</span>(a, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) b[i] = <span class=\"built_in\">conj</span>(a[i ? lim - i : <span class=\"number\">0</span>]);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">        cmp x = a[i], y = b[i];</span><br><span class=\"line\">        a[i] = (y + x) * <span class=\"number\">0.5</span>, b[i] = (y - x) * <span class=\"number\">0.5</span> * I;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">num</span><span class=\"params\">(cmp x)</span> </span>&#123; <span class=\"keyword\">return</span> M * <span class=\"built_in\">ll</span>(<span class=\"built_in\">real</span>(x) + <span class=\"number\">0.5</span>) % P + <span class=\"built_in\">ll</span>(<span class=\"built_in\">imag</span>(x) + <span class=\"number\">0.5</span>); &#125;</span><br></pre></td></tr></table></figure>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">M = <span class=\"built_in\">sqrt</span>(P);</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) a0[i] = A[i] / M, a1[i] = A[i] % M;</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, m) b0[i] = B[i] / M, b1[i] = B[i] % M;</span><br><span class=\"line\"><span class=\"keyword\">while</span>(lim &lt;= n + m) lim *= <span class=\"number\">2</span>, bit++;</span><br><span class=\"line\">inv = <span class=\"number\">1.</span> / lim;</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">    rev[i] = rev[i / <span class=\"number\">2</span>] / <span class=\"number\">2</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; bit;</span><br><span class=\"line\">    w[i] = <span class=\"built_in\">cmp</span>(<span class=\"built_in\">cos</span>(PI / lim * i), <span class=\"built_in\">sin</span>(PI / lim * i));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">FFT2</span>(a0, a1), <span class=\"built_in\">FFT2</span>(b0, b1);</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">    cmp t = a0[i] + I * a1[i];</span><br><span class=\"line\">    b0[i] *= t, b1[i] *= t;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">FFT</span>(b0, <span class=\"number\">1</span>), <span class=\"built_in\">FFT</span>(b1, <span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n + m) C[i] = (M * <span class=\"built_in\">num</span>(b0[i]) + <span class=\"built_in\">num</span>(b1[i])) % P;</span><br></pre></td></tr></table></figure>"},{"title":"","date":"2021-08-23T15:35:20.000Z","updated":"2021-08-23T15:35:20.000Z","_content":"### Barrett reduction \n\n>  $ab\\bmod m(0\\le a,b<m<2^{31})$\n\n $m$ \n\n $m^{-1}$  $\\frac 1m$\n$$\nab\\bmod m=ab-\\lfloor ab\\cdot m^{-1}\\rfloor m\n$$\n $m^{-1}$ $\\frac {m'}{2^k}\\approx m^{-1}$\n$$\n\\lfloor ab\\cdot m^{-1}\\rfloor \\approx \\lfloor \\frac{abm'}{2^k}\\rfloor\n$$\n $m'$  $k$\n\n $k=2\\lceil \\log_2 m\\rceil,m'=\\lceil \\frac{2^k}m\\rceil$\n\n-  $m'm=2^k+r(0\\le r<m)$\n-  $ab=cm+d(0\\le c,d<m)$\n- $abm'=(cm+d)m'=cm'm+dm'=c2^k+cr+dm'$\n- $cr+dm'<(m-1)^2+m'm<(m-1)^2+2^k+(m-1)=2^k+m(m-1)<2^k\\cdot 2$\n- $\\lfloor \\frac{abm'}{2^k}\\rfloor=c\\ \\text{or}\\ c+1$\n\n $ans$ $ab-\\lfloor \\frac{abm'}{2^k}\\rfloor m=ans\\ \\text{or}\\ ans-m$\n\n $c \\ge \\max(a, b^2)$$\\lfloor \\frac{a\\lfloor \\frac cb\\rfloor}c\\rfloor=\\lfloor \\frac ab\\rfloor\\ \\text{or}\\ \\lfloor \\frac ab\\rfloor+1$ \n\n $k=64$ `~0ull / m + 1`  $m'$\n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary>\n```cpp\nusing uint = unsigned int;\nusing ull = unsigned long long;\nstruct barrett {\n    uint m; ull im;\n    barrett(uint m) :m(m), im(~0ull / m + 1) {}\n    uint mul(uint a, uint b) const {\n        ull z = (ull)a * b;\n        ull x = (unsigned __int128)z * im >> 64;\n        uint v = z - x * m;\n        return m <= v ? v + m : v;\n    }\n};\n```\n</details>\n\n $[0, m)$  $10^5$  $m$ \n\n `ubuntu-21.04` `Linux`  `Barrett reduction` \n\n| \\ |  998244353  | 1000000007  | 1000000009  |  19260817   |\n| :-----------: | :---------: | :---------: | :---------: | :---------: |\n|             | 47.1s/29.6s | 45.7s/30.2s | 46.6s/30.4s | 45.8s/29.2s |\n|      -O2      | 35.8s/6.4s  | 35.2s/6.1s  | 35.0s/6.3s  | 35.4s/6.3s  |\n\n\n\n-  $ab\\bmod m$ `FFT`  $O(\\log m\\log\\log m)$  $m$  `Schnhage-Strassen`  $O(\\log m\\log\\log m\\log \\log \\log m)$ $O(\\log m\\log\\log m)$ $O(\\log^2 m)$ $m$  $O(\\log^2 m)$  $m'$ $O(\\log m\\log\\log m)$  `Miller Rabin`  $O(k\\log^2n\\log\\log n)$\n\n-  $\\gcd(a,b)$ $a,b$  $a,b\\le 10^7$ $5\\cdot 10^7$  $\\gcd$\n\n   $m$ $k=\\max(24,2\\lceil \\log_2m\\rceil)$ $m=b$ $am'$  `long long` \n\n### \n\n\n\n>  $l:y=kx+b$ $(0,0)$  $(a, l(a))$  $l$ \n>\n> $k,b,a$ \n\n $G(k,b,a)$ \n\n $(0,0)$  $(a, l(a))$  $l$ $G(k,b,a)$ $l$  $i$ $(1)$ \n$$\n\\binom {l(a)+a}a=G(k,b,a)+\\sum_{i+j=a}G(k,b,i)\\binom{kj+j-1}j\n$$\n\n $(0,0)$  $(a-1,l(a))$  $l$ $l$  $i$ $(2)$ \n$$\n\\binom {l(a)+a}{a-1}=\\sum_{i+j=a}G(k,b,i)\\binom {kj+j-1}{j-1}\n$$\n\n\n$$\n\\frac{\\binom{kj+j-1}j}{\\binom{kj+j-1}{j-1}}=\\frac{kj}j=k\n$$\n$(1)-(2)\\times k$ \n$$\nG(k,b,a)=\\binom{l(a)+a}a-k\\binom{l(a)+a}{a-1}\n$$\n\n> $l:y=kx+b$ $(0,0)$  $(x,y)$  $l$ \n>\n>$k,b,a$ $l(x) \\le y$\n\n $F(k,b,x,y)$ \n\n $i$\n$$\nF(k,b,x,y)=\\sum_{i+j=x}\\binom{l(i)+i}i\\binom{y-l(i)+j}j\n$$\n\n$$\n\\begin{aligned}\n&F(k,b,x,y)-kF(k,b,x-1,y+1)\\\\\n&=\\sum_{i+j=x}\\binom{l(i)+i}i\\binom{y-l(i)+j}j-k\\binom{l(i)+i}i\\binom{y-l(i)+j}{j-1}\\\\\n&=\\sum_{i+j=x}\\binom{l(i)+i}i\\left(\\binom{y-l(i)+j}j-k\\binom{y-l(i)+j}{j-1}\\right)\\\\\n&=\\sum_{i+j=x}\\binom{l(i)+i}iG(k,y-l(x),j)\n\\end{aligned}\n$$\n $\\binom{l(i)+i}i$  $(0,0)$  $(i,l(i))$  $G(k,y-l(x),j)$  $(x,y+1)$ **** $(i,l(i)+1)$  $l$  $(0,0)$  $(x,y+1)$  $i$   $l$ \n\n\n$$\nF(k,b,x,y)=kF(k,b,x-1,y+1)+\\binom{x+y+1}x\n$$\n $F(k,b,x+y,0)=1$\n\n\n$$\nF(k,b,x,y)=\\sum_{i+j=x}\\binom{x+y+1}ik^j\n$$\n $b$ \n\n\n\n### LucasLehmer \n\n> $M_p=2^p-1(p\\in\\text{Odd prime})$  $M_p|(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}}$\n\n\n\n $s_n=(2+\\sqrt 3)^{2^n}+(2-\\sqrt 3)^{2^n}\\bmod M_p$\n$$\ns_n=\\begin{cases}\n4&(i=0)\\\\\ns_{n-1}^2-2\\bmod M_p&(i>1)\n\\end{cases}\n$$\n `FFT`  $O(p\\log p)$\n\n$a \\bmod M_p=(a_0\\cdot 2^p+a_1)\\bmod M_p=(a_0+a_1)\\bmod M_p$\n\n$s_{n-1}^2-2$  $O(p^2\\log p)$\n\n#### \n\n $M_p$  $q$ $q^2$  $X=\\{a+b\\sqrt 3|a,b\\in\\mathbb Z_q\\}$ $\\mathbb Z_q$  $0,1,2\\cdots,q-2,q-1$ $X$ \n$$\n(a+b\\sqrt 3)(c+d\\sqrt 3)=(ac+3bd)\\bmod q+(bc+ad)\\bmod q\\sqrt3\n$$\n$X$  $X$  $X^*$ $(2+\\sqrt 3)(2+(q-1)\\sqrt 3)\\equiv 1\\pmod q$ $2+\\sqrt 3\\in X^{*}$\n\n\n$$\n(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}} \\equiv 0\\pmod {M_p}\\\\\n(2+\\sqrt 3)^{2^{p-1}}+[(2+\\sqrt 3)(2-\\sqrt 3)]^{2^{p-2}} \\equiv 0\\pmod {M_p}\\\\\n(2+\\sqrt 3)^{2^{p-1}}\\equiv -1\\pmod {M_p}\n$$\n $2 + \\sqrt 3$  $2^p$ $(2 + \\sqrt 3)^0,(2 + \\sqrt 3)^1,(2 + \\sqrt 3)^2,\\cdots,(2+\\sqrt 3)^{2^p-1}$ \n\n $2^p \\le |X*| \\le q^2 \\le M_p$ $2^p \\le M_p$ $M_p$ \n\n#### \n\n $M_p$  $M_p|(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}}$\n\n $p\\ge 3$ $2^p-1\\equiv 7\\pmod 8$  $2^p-1\\equiv 7\\pmod {12}$\n\n $p$\n\n- $2^p-1\\equiv 7\\pmod 8\\Rightarrow \\left(\\dfrac 2p\\right)=1\\Rightarrow 2^{\\frac{M_p-1}2}\\equiv 1\\pmod {M_p}$\n- $2^p-1\\equiv 7\\pmod {12}\\Rightarrow \\left(\\dfrac 3p\\right)=-1\\Rightarrow 3^{\\frac{M_p-1}2}\\equiv -1\\pmod {M_p}$\n\n\n\n $X=\\{a+b\\sqrt 3|a,b\\in\\mathbb Z_{M_p}\\}$ $X^*$\n\n> $\\forall x,y\\in X^*,(x+y)^{M_p}\\equiv x^{M_p}+y^{M_p}\\pmod{M_p}$\n\n $M_p|\\binom{M_p}i$\n\n\n$$\n\\begin{aligned}\n(6+2\\sqrt 3)^{M_p}&=6^{M_p}+2^{M_p}(\\sqrt 3)^{M_p}\\\\\n&=6+2\\sqrt 3\\cdot 3^{\\frac{M_p-1}2}\\\\\n&=6-2\\sqrt 3\n\\end{aligned}\n$$\n $2+\\sqrt 3=\\frac{(6+2\\sqrt 3)^2}{24}$\n$$\n\\begin{aligned}\n(2+\\sqrt 3)^{\\frac{M_p+1}2}&=\\frac{(6+2\\sqrt 3)^{M_p+1}}{24^{\\frac{M_p+1}2}}\\\\\n&=\\frac{(6+2\\sqrt 3)(6-2\\sqrt 3)}{24\\cdot (2^{\\frac{M_p-1}2})^3\\cdot 3^{\\frac{M_p-1}2}}\\\\\n&=-1\n\\end{aligned}\n$$\n $(2-\\sqrt 3)^{\\frac{M_p+1}4}$ $(2+\\sqrt 3)(2-\\sqrt 3)=1$\n$$\n\\begin{aligned}\n(2+\\sqrt 3)^{\\frac{M_p+1}2}(2-\\sqrt 3)^{\\frac{M_p+1}4}&=-(2-\\sqrt 3)^{\\frac{M_p+1}4}\\\\\n(2+\\sqrt 3)^{\\frac{M_p+1}4}+(2-\\sqrt 3)^{\\frac{M_p+1}4}&=0\\\\\n(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}}&=0\n\\end{aligned}\n$$\n\n### \n\n>  $2^n$  $\\bmod 2^n$\n>\n> $n \\le 10^4$\n\n $f_n=\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^n$ $n\\ge 2$\n$$\n\\begin{aligned}\nf_{n+1}&=(\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^{n+1})(\\prod_{i=1}^{2^{n-1}}2i-1+2^n\\bmod 2^{n+1})\\bmod 2^{n+1}\\\\\n&=(\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^{n+1})^2\\bmod 2^{n+1}\\\\\n\\end{aligned}\n$$\n $\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^{n+1}=f_n+k2^n(k\\in\\{0,1\\})$\n$$\n\\begin{aligned}\nf_{n+1}&=(f_n+k2^n)^2\\bmod 2^{n+1}\\\\\n&=f_n^2+k2^{n+1}+k^22^{2n}\\bmod 2^{n+1}\\\\\n&=f_n^2\\bmod 2^{n+1}\n\\end{aligned}\n$$\n `FFT`  $O(n\\log n)$ $O(n^2\\log n)$\n\n### \n\n>  $\\frac {p-1}2!\\bmod p$$p$  $p\\equiv 3\\pmod 4$\n>\n> $p \\le ???$\n\n $O(\\sqrt p\\log p)$\n\n Wilson $(p-1)!\\equiv -1\\pmod p$ $\\frac {p-1}2!\\equiv \\pm 1\\pmod p$$\\frac {p-1}2!\\equiv 1\\pmod p$ \n\n- $p\\equiv 3\\pmod 8 \\land h(-p)\\equiv 1\\pmod 4$\n\n- $p\\equiv 7\\pmod 8\\land h(-p)\\equiv 3\\pmod 4$\n\n$h(-p) \\bmod 4$ \n","source":"_posts/za-xiang.md","raw":"---\ntitle: \ndate: 2021-08-23 23:35:20\nupdated: 2021-08-23 23:35:20\ntags: []\ncategories: \n---\n### Barrett reduction \n\n>  $ab\\bmod m(0\\le a,b<m<2^{31})$\n\n $m$ \n\n $m^{-1}$  $\\frac 1m$\n$$\nab\\bmod m=ab-\\lfloor ab\\cdot m^{-1}\\rfloor m\n$$\n $m^{-1}$ $\\frac {m'}{2^k}\\approx m^{-1}$\n$$\n\\lfloor ab\\cdot m^{-1}\\rfloor \\approx \\lfloor \\frac{abm'}{2^k}\\rfloor\n$$\n $m'$  $k$\n\n $k=2\\lceil \\log_2 m\\rceil,m'=\\lceil \\frac{2^k}m\\rceil$\n\n-  $m'm=2^k+r(0\\le r<m)$\n-  $ab=cm+d(0\\le c,d<m)$\n- $abm'=(cm+d)m'=cm'm+dm'=c2^k+cr+dm'$\n- $cr+dm'<(m-1)^2+m'm<(m-1)^2+2^k+(m-1)=2^k+m(m-1)<2^k\\cdot 2$\n- $\\lfloor \\frac{abm'}{2^k}\\rfloor=c\\ \\text{or}\\ c+1$\n\n $ans$ $ab-\\lfloor \\frac{abm'}{2^k}\\rfloor m=ans\\ \\text{or}\\ ans-m$\n\n $c \\ge \\max(a, b^2)$$\\lfloor \\frac{a\\lfloor \\frac cb\\rfloor}c\\rfloor=\\lfloor \\frac ab\\rfloor\\ \\text{or}\\ \\lfloor \\frac ab\\rfloor+1$ \n\n $k=64$ `~0ull / m + 1`  $m'$\n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary>\n```cpp\nusing uint = unsigned int;\nusing ull = unsigned long long;\nstruct barrett {\n    uint m; ull im;\n    barrett(uint m) :m(m), im(~0ull / m + 1) {}\n    uint mul(uint a, uint b) const {\n        ull z = (ull)a * b;\n        ull x = (unsigned __int128)z * im >> 64;\n        uint v = z - x * m;\n        return m <= v ? v + m : v;\n    }\n};\n```\n</details>\n\n $[0, m)$  $10^5$  $m$ \n\n `ubuntu-21.04` `Linux`  `Barrett reduction` \n\n| \\ |  998244353  | 1000000007  | 1000000009  |  19260817   |\n| :-----------: | :---------: | :---------: | :---------: | :---------: |\n|             | 47.1s/29.6s | 45.7s/30.2s | 46.6s/30.4s | 45.8s/29.2s |\n|      -O2      | 35.8s/6.4s  | 35.2s/6.1s  | 35.0s/6.3s  | 35.4s/6.3s  |\n\n\n\n-  $ab\\bmod m$ `FFT`  $O(\\log m\\log\\log m)$  $m$  `Schnhage-Strassen`  $O(\\log m\\log\\log m\\log \\log \\log m)$ $O(\\log m\\log\\log m)$ $O(\\log^2 m)$ $m$  $O(\\log^2 m)$  $m'$ $O(\\log m\\log\\log m)$  `Miller Rabin`  $O(k\\log^2n\\log\\log n)$\n\n-  $\\gcd(a,b)$ $a,b$  $a,b\\le 10^7$ $5\\cdot 10^7$  $\\gcd$\n\n   $m$ $k=\\max(24,2\\lceil \\log_2m\\rceil)$ $m=b$ $am'$  `long long` \n\n### \n\n\n\n>  $l:y=kx+b$ $(0,0)$  $(a, l(a))$  $l$ \n>\n> $k,b,a$ \n\n $G(k,b,a)$ \n\n $(0,0)$  $(a, l(a))$  $l$ $G(k,b,a)$ $l$  $i$ $(1)$ \n$$\n\\binom {l(a)+a}a=G(k,b,a)+\\sum_{i+j=a}G(k,b,i)\\binom{kj+j-1}j\n$$\n\n $(0,0)$  $(a-1,l(a))$  $l$ $l$  $i$ $(2)$ \n$$\n\\binom {l(a)+a}{a-1}=\\sum_{i+j=a}G(k,b,i)\\binom {kj+j-1}{j-1}\n$$\n\n\n$$\n\\frac{\\binom{kj+j-1}j}{\\binom{kj+j-1}{j-1}}=\\frac{kj}j=k\n$$\n$(1)-(2)\\times k$ \n$$\nG(k,b,a)=\\binom{l(a)+a}a-k\\binom{l(a)+a}{a-1}\n$$\n\n> $l:y=kx+b$ $(0,0)$  $(x,y)$  $l$ \n>\n>$k,b,a$ $l(x) \\le y$\n\n $F(k,b,x,y)$ \n\n $i$\n$$\nF(k,b,x,y)=\\sum_{i+j=x}\\binom{l(i)+i}i\\binom{y-l(i)+j}j\n$$\n\n$$\n\\begin{aligned}\n&F(k,b,x,y)-kF(k,b,x-1,y+1)\\\\\n&=\\sum_{i+j=x}\\binom{l(i)+i}i\\binom{y-l(i)+j}j-k\\binom{l(i)+i}i\\binom{y-l(i)+j}{j-1}\\\\\n&=\\sum_{i+j=x}\\binom{l(i)+i}i\\left(\\binom{y-l(i)+j}j-k\\binom{y-l(i)+j}{j-1}\\right)\\\\\n&=\\sum_{i+j=x}\\binom{l(i)+i}iG(k,y-l(x),j)\n\\end{aligned}\n$$\n $\\binom{l(i)+i}i$  $(0,0)$  $(i,l(i))$  $G(k,y-l(x),j)$  $(x,y+1)$ **** $(i,l(i)+1)$  $l$  $(0,0)$  $(x,y+1)$  $i$   $l$ \n\n\n$$\nF(k,b,x,y)=kF(k,b,x-1,y+1)+\\binom{x+y+1}x\n$$\n $F(k,b,x+y,0)=1$\n\n\n$$\nF(k,b,x,y)=\\sum_{i+j=x}\\binom{x+y+1}ik^j\n$$\n $b$ \n\n\n\n### LucasLehmer \n\n> $M_p=2^p-1(p\\in\\text{Odd prime})$  $M_p|(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}}$\n\n\n\n $s_n=(2+\\sqrt 3)^{2^n}+(2-\\sqrt 3)^{2^n}\\bmod M_p$\n$$\ns_n=\\begin{cases}\n4&(i=0)\\\\\ns_{n-1}^2-2\\bmod M_p&(i>1)\n\\end{cases}\n$$\n `FFT`  $O(p\\log p)$\n\n$a \\bmod M_p=(a_0\\cdot 2^p+a_1)\\bmod M_p=(a_0+a_1)\\bmod M_p$\n\n$s_{n-1}^2-2$  $O(p^2\\log p)$\n\n#### \n\n $M_p$  $q$ $q^2$  $X=\\{a+b\\sqrt 3|a,b\\in\\mathbb Z_q\\}$ $\\mathbb Z_q$  $0,1,2\\cdots,q-2,q-1$ $X$ \n$$\n(a+b\\sqrt 3)(c+d\\sqrt 3)=(ac+3bd)\\bmod q+(bc+ad)\\bmod q\\sqrt3\n$$\n$X$  $X$  $X^*$ $(2+\\sqrt 3)(2+(q-1)\\sqrt 3)\\equiv 1\\pmod q$ $2+\\sqrt 3\\in X^{*}$\n\n\n$$\n(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}} \\equiv 0\\pmod {M_p}\\\\\n(2+\\sqrt 3)^{2^{p-1}}+[(2+\\sqrt 3)(2-\\sqrt 3)]^{2^{p-2}} \\equiv 0\\pmod {M_p}\\\\\n(2+\\sqrt 3)^{2^{p-1}}\\equiv -1\\pmod {M_p}\n$$\n $2 + \\sqrt 3$  $2^p$ $(2 + \\sqrt 3)^0,(2 + \\sqrt 3)^1,(2 + \\sqrt 3)^2,\\cdots,(2+\\sqrt 3)^{2^p-1}$ \n\n $2^p \\le |X*| \\le q^2 \\le M_p$ $2^p \\le M_p$ $M_p$ \n\n#### \n\n $M_p$  $M_p|(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}}$\n\n $p\\ge 3$ $2^p-1\\equiv 7\\pmod 8$  $2^p-1\\equiv 7\\pmod {12}$\n\n $p$\n\n- $2^p-1\\equiv 7\\pmod 8\\Rightarrow \\left(\\dfrac 2p\\right)=1\\Rightarrow 2^{\\frac{M_p-1}2}\\equiv 1\\pmod {M_p}$\n- $2^p-1\\equiv 7\\pmod {12}\\Rightarrow \\left(\\dfrac 3p\\right)=-1\\Rightarrow 3^{\\frac{M_p-1}2}\\equiv -1\\pmod {M_p}$\n\n\n\n $X=\\{a+b\\sqrt 3|a,b\\in\\mathbb Z_{M_p}\\}$ $X^*$\n\n> $\\forall x,y\\in X^*,(x+y)^{M_p}\\equiv x^{M_p}+y^{M_p}\\pmod{M_p}$\n\n $M_p|\\binom{M_p}i$\n\n\n$$\n\\begin{aligned}\n(6+2\\sqrt 3)^{M_p}&=6^{M_p}+2^{M_p}(\\sqrt 3)^{M_p}\\\\\n&=6+2\\sqrt 3\\cdot 3^{\\frac{M_p-1}2}\\\\\n&=6-2\\sqrt 3\n\\end{aligned}\n$$\n $2+\\sqrt 3=\\frac{(6+2\\sqrt 3)^2}{24}$\n$$\n\\begin{aligned}\n(2+\\sqrt 3)^{\\frac{M_p+1}2}&=\\frac{(6+2\\sqrt 3)^{M_p+1}}{24^{\\frac{M_p+1}2}}\\\\\n&=\\frac{(6+2\\sqrt 3)(6-2\\sqrt 3)}{24\\cdot (2^{\\frac{M_p-1}2})^3\\cdot 3^{\\frac{M_p-1}2}}\\\\\n&=-1\n\\end{aligned}\n$$\n $(2-\\sqrt 3)^{\\frac{M_p+1}4}$ $(2+\\sqrt 3)(2-\\sqrt 3)=1$\n$$\n\\begin{aligned}\n(2+\\sqrt 3)^{\\frac{M_p+1}2}(2-\\sqrt 3)^{\\frac{M_p+1}4}&=-(2-\\sqrt 3)^{\\frac{M_p+1}4}\\\\\n(2+\\sqrt 3)^{\\frac{M_p+1}4}+(2-\\sqrt 3)^{\\frac{M_p+1}4}&=0\\\\\n(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}}&=0\n\\end{aligned}\n$$\n\n### \n\n>  $2^n$  $\\bmod 2^n$\n>\n> $n \\le 10^4$\n\n $f_n=\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^n$ $n\\ge 2$\n$$\n\\begin{aligned}\nf_{n+1}&=(\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^{n+1})(\\prod_{i=1}^{2^{n-1}}2i-1+2^n\\bmod 2^{n+1})\\bmod 2^{n+1}\\\\\n&=(\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^{n+1})^2\\bmod 2^{n+1}\\\\\n\\end{aligned}\n$$\n $\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^{n+1}=f_n+k2^n(k\\in\\{0,1\\})$\n$$\n\\begin{aligned}\nf_{n+1}&=(f_n+k2^n)^2\\bmod 2^{n+1}\\\\\n&=f_n^2+k2^{n+1}+k^22^{2n}\\bmod 2^{n+1}\\\\\n&=f_n^2\\bmod 2^{n+1}\n\\end{aligned}\n$$\n `FFT`  $O(n\\log n)$ $O(n^2\\log n)$\n\n### \n\n>  $\\frac {p-1}2!\\bmod p$$p$  $p\\equiv 3\\pmod 4$\n>\n> $p \\le ???$\n\n $O(\\sqrt p\\log p)$\n\n Wilson $(p-1)!\\equiv -1\\pmod p$ $\\frac {p-1}2!\\equiv \\pm 1\\pmod p$$\\frac {p-1}2!\\equiv 1\\pmod p$ \n\n- $p\\equiv 3\\pmod 8 \\land h(-p)\\equiv 1\\pmod 4$\n\n- $p\\equiv 7\\pmod 8\\land h(-p)\\equiv 3\\pmod 4$\n\n$h(-p) \\bmod 4$ \n","slug":"za-xiang","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh0z003pootn0ff13dh1","content":"<h3 id=\"barrett-reduction-\">Barrett reduction </h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(ab\\bmod m(0\\le a,b&lt;m&lt;2^{31})\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(m\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(m^{-1}\\)</span>  <span class=\"math inline\">\\(\\frac 1m\\)</span> <span class=\"math display\">\\[\r\nab\\bmod m=ab-\\lfloor ab\\cdot m^{-1}\\rfloor m\r\n\\]</span>  <span class=\"math inline\">\\(m^{-1}\\)</span> <span class=\"math inline\">\\(\\frac {m&#39;}{2^k}\\approx m^{-1}\\)</span> <span class=\"math display\">\\[\r\n\\lfloor ab\\cdot m^{-1}\\rfloor \\approx \\lfloor \\frac{abm&#39;}{2^k}\\rfloor\r\n\\]</span>  <span class=\"math inline\">\\(m&#39;\\)</span>  <span class=\"math inline\">\\(k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(k=2\\lceil \\log_2 m\\rceil,m&#39;=\\lceil \\frac{2^k}m\\rceil\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(m&#39;m=2^k+r(0\\le r&lt;m)\\)</span></li>\r\n<li> <span class=\"math inline\">\\(ab=cm+d(0\\le c,d&lt;m)\\)</span></li>\r\n<li><span class=\"math inline\">\\(abm&#39;=(cm+d)m&#39;=cm&#39;m+dm&#39;=c2^k+cr+dm&#39;\\)</span></li>\r\n<li><span class=\"math inline\">\\(cr+dm&#39;&lt;(m-1)^2+m&#39;m&lt;(m-1)^2+2^k+(m-1)=2^k+m(m-1)&lt;2^k\\cdot 2\\)</span></li>\r\n<li><span class=\"math inline\">\\(\\lfloor \\frac{abm&#39;}{2^k}\\rfloor=c\\ \\text{or}\\ c+1\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(ans\\)</span> <span class=\"math inline\">\\(ab-\\lfloor \\frac{abm&#39;}{2^k}\\rfloor m=ans\\ \\text{or}\\ ans-m\\)</span></p>\r\n<p> <span class=\"math inline\">\\(c \\ge \\max(a, b^2)\\)</span><span class=\"math inline\">\\(\\lfloor \\frac{a\\lfloor \\frac cb\\rfloor}c\\rfloor=\\lfloor \\frac ab\\rfloor\\ \\text{or}\\ \\lfloor \\frac ab\\rfloor+1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(k=64\\)</span> <code>~0ull / m + 1</code>  <span class=\"math inline\">\\(m&#39;\\)</span></p>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> uint = <span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ull = <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">barrett</span> &#123;</span></span><br><span class=\"line\">    uint m; ull im;</span><br><span class=\"line\">    <span class=\"built_in\">barrett</span>(uint m) :<span class=\"built_in\">m</span>(m), <span class=\"built_in\">im</span>(~<span class=\"number\">0ull</span> / m + <span class=\"number\">1</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\">uint <span class=\"title\">mul</span><span class=\"params\">(uint a, uint b)</span> <span class=\"keyword\">const</span> </span>&#123;</span><br><span class=\"line\">        ull z = (ull)a * b;</span><br><span class=\"line\">        ull x = (<span class=\"keyword\">unsigned</span> __int128)z * im &gt;&gt; <span class=\"number\">64</span>;</span><br><span class=\"line\">        uint v = z - x * m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> m &lt;= v ? v + m : v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\r\n</details>\r\n<p> <span class=\"math inline\">\\([0, m)\\)</span>  <span class=\"math inline\">\\(10^5\\)</span>  <span class=\"math inline\">\\(m\\)</span> </p>\r\n<p> <code>ubuntu-21.04</code> <code>Linux</code>  <code>Barrett reduction</code> </p>\r\n<table>\r\n<thead>\r\n<tr class=\"header\">\r\n<th style=\"text-align: center;\"></th>\r\n<th style=\"text-align: center;\">998244353</th>\r\n<th style=\"text-align: center;\">1000000007</th>\r\n<th style=\"text-align: center;\">1000000009</th>\r\n<th style=\"text-align: center;\">19260817</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td style=\"text-align: center;\"></td>\r\n<td style=\"text-align: center;\">47.1s/29.6s</td>\r\n<td style=\"text-align: center;\">45.7s/30.2s</td>\r\n<td style=\"text-align: center;\">46.6s/30.4s</td>\r\n<td style=\"text-align: center;\">45.8s/29.2s</td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td style=\"text-align: center;\">-O2</td>\r\n<td style=\"text-align: center;\">35.8s/6.4s</td>\r\n<td style=\"text-align: center;\">35.2s/6.1s</td>\r\n<td style=\"text-align: center;\">35.0s/6.3s</td>\r\n<td style=\"text-align: center;\">35.4s/6.3s</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p></p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(ab\\bmod m\\)</span> <code>FFT</code>  <span class=\"math inline\">\\(O(\\log m\\log\\log m)\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <code>Schnhage-Strassen</code>  <span class=\"math inline\">\\(O(\\log m\\log\\log m\\log \\log \\log m)\\)</span> <span class=\"math inline\">\\(O(\\log m\\log\\log m)\\)</span> <span class=\"math inline\">\\(O(\\log^2 m)\\)</span> <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(O(\\log^2 m)\\)</span>  <span class=\"math inline\">\\(m&#39;\\)</span> <span class=\"math inline\">\\(O(\\log m\\log\\log m)\\)</span>  <code>Miller Rabin</code>  <span class=\"math inline\">\\(O(k\\log^2n\\log\\log n)\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\(\\gcd(a,b)\\)</span> <span class=\"math inline\">\\(a,b\\)</span>  <span class=\"math inline\">\\(a,b\\le 10^7\\)</span> <span class=\"math inline\">\\(5\\cdot 10^7\\)</span>  <span class=\"math inline\">\\(\\gcd\\)</span></p>\r\n<p> <span class=\"math inline\">\\(m\\)</span> <span class=\"math inline\">\\(k=\\max(24,2\\lceil \\log_2m\\rceil)\\)</span> <span class=\"math inline\">\\(m=b\\)</span> <span class=\"math inline\">\\(am&#39;\\)</span>  <code>long long</code> </p></li>\r\n</ul>\r\n<h3 id=\"\"></h3>\r\n<p></p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(l:y=kx+b\\)</span> <span class=\"math inline\">\\((0,0)\\)</span>  <span class=\"math inline\">\\((a, l(a))\\)</span>  <span class=\"math inline\">\\(l\\)</span> </p>\r\n<p><span class=\"math inline\">\\(k,b,a\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(G(k,b,a)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\((0,0)\\)</span>  <span class=\"math inline\">\\((a, l(a))\\)</span>  <span class=\"math inline\">\\(l\\)</span> <span class=\"math inline\">\\(G(k,b,a)\\)</span> <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\((1)\\)</span>  <span class=\"math display\">\\[\r\n\\binom {l(a)+a}a=G(k,b,a)+\\sum_{i+j=a}G(k,b,i)\\binom{kj+j-1}j\r\n\\]</span></p>\r\n<p> <span class=\"math inline\">\\((0,0)\\)</span>  <span class=\"math inline\">\\((a-1,l(a))\\)</span>  <span class=\"math inline\">\\(l\\)</span> <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\((2)\\)</span>  <span class=\"math display\">\\[\r\n\\binom {l(a)+a}{a-1}=\\sum_{i+j=a}G(k,b,i)\\binom {kj+j-1}{j-1}\r\n\\]</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\frac{\\binom{kj+j-1}j}{\\binom{kj+j-1}{j-1}}=\\frac{kj}j=k\r\n\\]</span> <span class=\"math inline\">\\((1)-(2)\\times k\\)</span>  <span class=\"math display\">\\[\r\nG(k,b,a)=\\binom{l(a)+a}a-k\\binom{l(a)+a}{a-1}\r\n\\]</span></p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(l:y=kx+b\\)</span> <span class=\"math inline\">\\((0,0)\\)</span>  <span class=\"math inline\">\\((x,y)\\)</span>  <span class=\"math inline\">\\(l\\)</span> </p>\r\n<p><span class=\"math inline\">\\(k,b,a\\)</span> <span class=\"math inline\">\\(l(x) \\le y\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(F(k,b,x,y)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(i\\)</span> <span class=\"math display\">\\[\r\nF(k,b,x,y)=\\sum_{i+j=x}\\binom{l(i)+i}i\\binom{y-l(i)+j}j\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;F(k,b,x,y)-kF(k,b,x-1,y+1)\\\\\r\n&amp;=\\sum_{i+j=x}\\binom{l(i)+i}i\\binom{y-l(i)+j}j-k\\binom{l(i)+i}i\\binom{y-l(i)+j}{j-1}\\\\\r\n&amp;=\\sum_{i+j=x}\\binom{l(i)+i}i\\left(\\binom{y-l(i)+j}j-k\\binom{y-l(i)+j}{j-1}\\right)\\\\\r\n&amp;=\\sum_{i+j=x}\\binom{l(i)+i}iG(k,y-l(x),j)\r\n\\end{aligned}\r\n\\]</span>  <span class=\"math inline\">\\(\\binom{l(i)+i}i\\)</span>  <span class=\"math inline\">\\((0,0)\\)</span>  <span class=\"math inline\">\\((i,l(i))\\)</span>  <span class=\"math inline\">\\(G(k,y-l(x),j)\\)</span>  <span class=\"math inline\">\\((x,y+1)\\)</span> <strong></strong> <span class=\"math inline\">\\((i,l(i)+1)\\)</span>  <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\((0,0)\\)</span>  <span class=\"math inline\">\\((x,y+1)\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(l\\)</span> </p>\r\n<p> <span class=\"math display\">\\[\r\nF(k,b,x,y)=kF(k,b,x-1,y+1)+\\binom{x+y+1}x\r\n\\]</span>  <span class=\"math inline\">\\(F(k,b,x+y,0)=1\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\nF(k,b,x,y)=\\sum_{i+j=x}\\binom{x+y+1}ik^j\r\n\\]</span>  <span class=\"math inline\">\\(b\\)</span> </p>\r\n<h3 id=\"lucaslehmer-\">LucasLehmer </h3>\r\n<blockquote>\r\n<p><span class=\"math inline\">\\(M_p=2^p-1(p\\in\\text{Odd prime})\\)</span>  <span class=\"math inline\">\\(M_p|(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}}\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(s_n=(2+\\sqrt 3)^{2^n}+(2-\\sqrt 3)^{2^n}\\bmod M_p\\)</span> <span class=\"math display\">\\[\r\ns_n=\\begin{cases}\r\n4&amp;(i=0)\\\\\r\ns_{n-1}^2-2\\bmod M_p&amp;(i&gt;1)\r\n\\end{cases}\r\n\\]</span>  <code>FFT</code>  <span class=\"math inline\">\\(O(p\\log p)\\)</span></p>\r\n<p><span class=\"math inline\">\\(a \\bmod M_p=(a_0\\cdot 2^p+a_1)\\bmod M_p=(a_0+a_1)\\bmod M_p\\)</span></p>\r\n<p><span class=\"math inline\">\\(s_{n-1}^2-2\\)</span>  <span class=\"math inline\">\\(O(p^2\\log p)\\)</span></p>\r\n<h4 id=\"\"></h4>\r\n<p> <span class=\"math inline\">\\(M_p\\)</span>  <span class=\"math inline\">\\(q\\)</span> <span class=\"math inline\">\\(q^2\\)</span>  <span class=\"math inline\">\\(X=\\{a+b\\sqrt 3|a,b\\in\\mathbb Z_q\\}\\)</span> <span class=\"math inline\">\\(\\mathbb Z_q\\)</span>  <span class=\"math inline\">\\(0,1,2\\cdots,q-2,q-1\\)</span> <span class=\"math inline\">\\(X\\)</span>  <span class=\"math display\">\\[\r\n(a+b\\sqrt 3)(c+d\\sqrt 3)=(ac+3bd)\\bmod q+(bc+ad)\\bmod q\\sqrt3\r\n\\]</span> <span class=\"math inline\">\\(X\\)</span>  <span class=\"math inline\">\\(X\\)</span>  <span class=\"math inline\">\\(X^*\\)</span> <span class=\"math inline\">\\((2+\\sqrt 3)(2+(q-1)\\sqrt 3)\\equiv 1\\pmod q\\)</span> <span class=\"math inline\">\\(2+\\sqrt 3\\in X^{*}\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\n(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}} \\equiv 0\\pmod {M_p}\\\\\r\n(2+\\sqrt 3)^{2^{p-1}}+[(2+\\sqrt 3)(2-\\sqrt 3)]^{2^{p-2}} \\equiv 0\\pmod {M_p}\\\\\r\n(2+\\sqrt 3)^{2^{p-1}}\\equiv -1\\pmod {M_p}\r\n\\]</span>  <span class=\"math inline\">\\(2 + \\sqrt 3\\)</span>  <span class=\"math inline\">\\(2^p\\)</span> <span class=\"math inline\">\\((2 + \\sqrt 3)^0,(2 + \\sqrt 3)^1,(2 + \\sqrt 3)^2,\\cdots,(2+\\sqrt 3)^{2^p-1}\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(2^p \\le |X*| \\le q^2 \\le M_p\\)</span> <span class=\"math inline\">\\(2^p \\le M_p\\)</span> <span class=\"math inline\">\\(M_p\\)</span> </p>\r\n<h4 id=\"\"></h4>\r\n<p> <span class=\"math inline\">\\(M_p\\)</span>  <span class=\"math inline\">\\(M_p|(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(p\\ge 3\\)</span> <span class=\"math inline\">\\(2^p-1\\equiv 7\\pmod 8\\)</span>  <span class=\"math inline\">\\(2^p-1\\equiv 7\\pmod {12}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(p\\)</span></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(2^p-1\\equiv 7\\pmod 8\\Rightarrow \\left(\\dfrac 2p\\right)=1\\Rightarrow 2^{\\frac{M_p-1}2}\\equiv 1\\pmod {M_p}\\)</span></li>\r\n<li><span class=\"math inline\">\\(2^p-1\\equiv 7\\pmod {12}\\Rightarrow \\left(\\dfrac 3p\\right)=-1\\Rightarrow 3^{\\frac{M_p-1}2}\\equiv -1\\pmod {M_p}\\)</span></li>\r\n</ul>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(X=\\{a+b\\sqrt 3|a,b\\in\\mathbb Z_{M_p}\\}\\)</span> <span class=\"math inline\">\\(X^*\\)</span></p>\r\n<blockquote>\r\n<p><span class=\"math inline\">\\(\\forall x,y\\in X^*,(x+y)^{M_p}\\equiv x^{M_p}+y^{M_p}\\pmod{M_p}\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(M_p|\\binom{M_p}i\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n(6+2\\sqrt 3)^{M_p}&amp;=6^{M_p}+2^{M_p}(\\sqrt 3)^{M_p}\\\\\r\n&amp;=6+2\\sqrt 3\\cdot 3^{\\frac{M_p-1}2}\\\\\r\n&amp;=6-2\\sqrt 3\r\n\\end{aligned}\r\n\\]</span>  <span class=\"math inline\">\\(2+\\sqrt 3=\\frac{(6+2\\sqrt 3)^2}{24}\\)</span> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n(2+\\sqrt 3)^{\\frac{M_p+1}2}&amp;=\\frac{(6+2\\sqrt 3)^{M_p+1}}{24^{\\frac{M_p+1}2}}\\\\\r\n&amp;=\\frac{(6+2\\sqrt 3)(6-2\\sqrt 3)}{24\\cdot (2^{\\frac{M_p-1}2})^3\\cdot 3^{\\frac{M_p-1}2}}\\\\\r\n&amp;=-1\r\n\\end{aligned}\r\n\\]</span>  <span class=\"math inline\">\\((2-\\sqrt 3)^{\\frac{M_p+1}4}\\)</span> <span class=\"math inline\">\\((2+\\sqrt 3)(2-\\sqrt 3)=1\\)</span> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n(2+\\sqrt 3)^{\\frac{M_p+1}2}(2-\\sqrt 3)^{\\frac{M_p+1}4}&amp;=-(2-\\sqrt 3)^{\\frac{M_p+1}4}\\\\\r\n(2+\\sqrt 3)^{\\frac{M_p+1}4}+(2-\\sqrt 3)^{\\frac{M_p+1}4}&amp;=0\\\\\r\n(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}}&amp;=0\r\n\\end{aligned}\r\n\\]</span></p>\r\n<h3 id=\"\"></h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(2^n\\)</span>  <span class=\"math inline\">\\(\\bmod 2^n\\)</span></p>\r\n<p><span class=\"math inline\">\\(n \\le 10^4\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(f_n=\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^n\\)</span> <span class=\"math inline\">\\(n\\ge 2\\)</span> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\nf_{n+1}&amp;=(\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^{n+1})(\\prod_{i=1}^{2^{n-1}}2i-1+2^n\\bmod 2^{n+1})\\bmod 2^{n+1}\\\\\r\n&amp;=(\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^{n+1})^2\\bmod 2^{n+1}\\\\\r\n\\end{aligned}\r\n\\]</span>  <span class=\"math inline\">\\(\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^{n+1}=f_n+k2^n(k\\in\\{0,1\\})\\)</span> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\nf_{n+1}&amp;=(f_n+k2^n)^2\\bmod 2^{n+1}\\\\\r\n&amp;=f_n^2+k2^{n+1}+k^22^{2n}\\bmod 2^{n+1}\\\\\r\n&amp;=f_n^2\\bmod 2^{n+1}\r\n\\end{aligned}\r\n\\]</span>  <code>FFT</code>  <span class=\"math inline\">\\(O(n\\log n)\\)</span> <span class=\"math inline\">\\(O(n^2\\log n)\\)</span></p>\r\n<h3 id=\"\"></h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(\\frac {p-1}2!\\bmod p\\)</span><span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(p\\equiv 3\\pmod 4\\)</span></p>\r\n<p><span class=\"math inline\">\\(p \\le ???\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(O(\\sqrt p\\log p)\\)</span></p>\r\n<p> Wilson <span class=\"math inline\">\\((p-1)!\\equiv -1\\pmod p\\)</span> <span class=\"math inline\">\\(\\frac {p-1}2!\\equiv \\pm 1\\pmod p\\)</span><span class=\"math inline\">\\(\\frac {p-1}2!\\equiv 1\\pmod p\\)</span> </p>\r\n<ul>\r\n<li><p><span class=\"math inline\">\\(p\\equiv 3\\pmod 8 \\land h(-p)\\equiv 1\\pmod 4\\)</span></p></li>\r\n<li><p><span class=\"math inline\">\\(p\\equiv 7\\pmod 8\\land h(-p)\\equiv 3\\pmod 4\\)</span></p></li>\r\n</ul>\r\n<p><span class=\"math inline\">\\(h(-p) \\bmod 4\\)</span> </p>\r\n","site":{"data":{}},"length":6567,"excerpt":"","more":"<h3 id=\"barrett-reduction-\">Barrett reduction </h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(ab\\bmod m(0\\le a,b&lt;m&lt;2^{31})\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(m\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(m^{-1}\\)</span>  <span class=\"math inline\">\\(\\frac 1m\\)</span> <span class=\"math display\">\\[\r\nab\\bmod m=ab-\\lfloor ab\\cdot m^{-1}\\rfloor m\r\n\\]</span>  <span class=\"math inline\">\\(m^{-1}\\)</span> <span class=\"math inline\">\\(\\frac {m&#39;}{2^k}\\approx m^{-1}\\)</span> <span class=\"math display\">\\[\r\n\\lfloor ab\\cdot m^{-1}\\rfloor \\approx \\lfloor \\frac{abm&#39;}{2^k}\\rfloor\r\n\\]</span>  <span class=\"math inline\">\\(m&#39;\\)</span>  <span class=\"math inline\">\\(k\\)</span></p>\r\n<p> <span class=\"math inline\">\\(k=2\\lceil \\log_2 m\\rceil,m&#39;=\\lceil \\frac{2^k}m\\rceil\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(m&#39;m=2^k+r(0\\le r&lt;m)\\)</span></li>\r\n<li> <span class=\"math inline\">\\(ab=cm+d(0\\le c,d&lt;m)\\)</span></li>\r\n<li><span class=\"math inline\">\\(abm&#39;=(cm+d)m&#39;=cm&#39;m+dm&#39;=c2^k+cr+dm&#39;\\)</span></li>\r\n<li><span class=\"math inline\">\\(cr+dm&#39;&lt;(m-1)^2+m&#39;m&lt;(m-1)^2+2^k+(m-1)=2^k+m(m-1)&lt;2^k\\cdot 2\\)</span></li>\r\n<li><span class=\"math inline\">\\(\\lfloor \\frac{abm&#39;}{2^k}\\rfloor=c\\ \\text{or}\\ c+1\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(ans\\)</span> <span class=\"math inline\">\\(ab-\\lfloor \\frac{abm&#39;}{2^k}\\rfloor m=ans\\ \\text{or}\\ ans-m\\)</span></p>\r\n<p> <span class=\"math inline\">\\(c \\ge \\max(a, b^2)\\)</span><span class=\"math inline\">\\(\\lfloor \\frac{a\\lfloor \\frac cb\\rfloor}c\\rfloor=\\lfloor \\frac ab\\rfloor\\ \\text{or}\\ \\lfloor \\frac ab\\rfloor+1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(k=64\\)</span> <code>~0ull / m + 1</code>  <span class=\"math inline\">\\(m&#39;\\)</span></p>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> uint = <span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ull = <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">barrett</span> &#123;</span></span><br><span class=\"line\">    uint m; ull im;</span><br><span class=\"line\">    <span class=\"built_in\">barrett</span>(uint m) :<span class=\"built_in\">m</span>(m), <span class=\"built_in\">im</span>(~<span class=\"number\">0ull</span> / m + <span class=\"number\">1</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\">uint <span class=\"title\">mul</span><span class=\"params\">(uint a, uint b)</span> <span class=\"keyword\">const</span> </span>&#123;</span><br><span class=\"line\">        ull z = (ull)a * b;</span><br><span class=\"line\">        ull x = (<span class=\"keyword\">unsigned</span> __int128)z * im &gt;&gt; <span class=\"number\">64</span>;</span><br><span class=\"line\">        uint v = z - x * m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> m &lt;= v ? v + m : v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\r\n</details>\r\n<p> <span class=\"math inline\">\\([0, m)\\)</span>  <span class=\"math inline\">\\(10^5\\)</span>  <span class=\"math inline\">\\(m\\)</span> </p>\r\n<p> <code>ubuntu-21.04</code> <code>Linux</code>  <code>Barrett reduction</code> </p>\r\n<table>\r\n<thead>\r\n<tr class=\"header\">\r\n<th style=\"text-align: center;\"></th>\r\n<th style=\"text-align: center;\">998244353</th>\r\n<th style=\"text-align: center;\">1000000007</th>\r\n<th style=\"text-align: center;\">1000000009</th>\r\n<th style=\"text-align: center;\">19260817</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td style=\"text-align: center;\"></td>\r\n<td style=\"text-align: center;\">47.1s/29.6s</td>\r\n<td style=\"text-align: center;\">45.7s/30.2s</td>\r\n<td style=\"text-align: center;\">46.6s/30.4s</td>\r\n<td style=\"text-align: center;\">45.8s/29.2s</td>\r\n</tr>\r\n<tr class=\"even\">\r\n<td style=\"text-align: center;\">-O2</td>\r\n<td style=\"text-align: center;\">35.8s/6.4s</td>\r\n<td style=\"text-align: center;\">35.2s/6.1s</td>\r\n<td style=\"text-align: center;\">35.0s/6.3s</td>\r\n<td style=\"text-align: center;\">35.4s/6.3s</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p></p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(ab\\bmod m\\)</span> <code>FFT</code>  <span class=\"math inline\">\\(O(\\log m\\log\\log m)\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <code>Schnhage-Strassen</code>  <span class=\"math inline\">\\(O(\\log m\\log\\log m\\log \\log \\log m)\\)</span> <span class=\"math inline\">\\(O(\\log m\\log\\log m)\\)</span> <span class=\"math inline\">\\(O(\\log^2 m)\\)</span> <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(O(\\log^2 m)\\)</span>  <span class=\"math inline\">\\(m&#39;\\)</span> <span class=\"math inline\">\\(O(\\log m\\log\\log m)\\)</span>  <code>Miller Rabin</code>  <span class=\"math inline\">\\(O(k\\log^2n\\log\\log n)\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\(\\gcd(a,b)\\)</span> <span class=\"math inline\">\\(a,b\\)</span>  <span class=\"math inline\">\\(a,b\\le 10^7\\)</span> <span class=\"math inline\">\\(5\\cdot 10^7\\)</span>  <span class=\"math inline\">\\(\\gcd\\)</span></p>\r\n<p> <span class=\"math inline\">\\(m\\)</span> <span class=\"math inline\">\\(k=\\max(24,2\\lceil \\log_2m\\rceil)\\)</span> <span class=\"math inline\">\\(m=b\\)</span> <span class=\"math inline\">\\(am&#39;\\)</span>  <code>long long</code> </p></li>\r\n</ul>\r\n<h3 id=\"\"></h3>\r\n<p></p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(l:y=kx+b\\)</span> <span class=\"math inline\">\\((0,0)\\)</span>  <span class=\"math inline\">\\((a, l(a))\\)</span>  <span class=\"math inline\">\\(l\\)</span> </p>\r\n<p><span class=\"math inline\">\\(k,b,a\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(G(k,b,a)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\((0,0)\\)</span>  <span class=\"math inline\">\\((a, l(a))\\)</span>  <span class=\"math inline\">\\(l\\)</span> <span class=\"math inline\">\\(G(k,b,a)\\)</span> <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\((1)\\)</span>  <span class=\"math display\">\\[\r\n\\binom {l(a)+a}a=G(k,b,a)+\\sum_{i+j=a}G(k,b,i)\\binom{kj+j-1}j\r\n\\]</span></p>\r\n<p> <span class=\"math inline\">\\((0,0)\\)</span>  <span class=\"math inline\">\\((a-1,l(a))\\)</span>  <span class=\"math inline\">\\(l\\)</span> <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\((2)\\)</span>  <span class=\"math display\">\\[\r\n\\binom {l(a)+a}{a-1}=\\sum_{i+j=a}G(k,b,i)\\binom {kj+j-1}{j-1}\r\n\\]</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\frac{\\binom{kj+j-1}j}{\\binom{kj+j-1}{j-1}}=\\frac{kj}j=k\r\n\\]</span> <span class=\"math inline\">\\((1)-(2)\\times k\\)</span>  <span class=\"math display\">\\[\r\nG(k,b,a)=\\binom{l(a)+a}a-k\\binom{l(a)+a}{a-1}\r\n\\]</span></p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(l:y=kx+b\\)</span> <span class=\"math inline\">\\((0,0)\\)</span>  <span class=\"math inline\">\\((x,y)\\)</span>  <span class=\"math inline\">\\(l\\)</span> </p>\r\n<p><span class=\"math inline\">\\(k,b,a\\)</span> <span class=\"math inline\">\\(l(x) \\le y\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(F(k,b,x,y)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(i\\)</span> <span class=\"math display\">\\[\r\nF(k,b,x,y)=\\sum_{i+j=x}\\binom{l(i)+i}i\\binom{y-l(i)+j}j\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;F(k,b,x,y)-kF(k,b,x-1,y+1)\\\\\r\n&amp;=\\sum_{i+j=x}\\binom{l(i)+i}i\\binom{y-l(i)+j}j-k\\binom{l(i)+i}i\\binom{y-l(i)+j}{j-1}\\\\\r\n&amp;=\\sum_{i+j=x}\\binom{l(i)+i}i\\left(\\binom{y-l(i)+j}j-k\\binom{y-l(i)+j}{j-1}\\right)\\\\\r\n&amp;=\\sum_{i+j=x}\\binom{l(i)+i}iG(k,y-l(x),j)\r\n\\end{aligned}\r\n\\]</span>  <span class=\"math inline\">\\(\\binom{l(i)+i}i\\)</span>  <span class=\"math inline\">\\((0,0)\\)</span>  <span class=\"math inline\">\\((i,l(i))\\)</span>  <span class=\"math inline\">\\(G(k,y-l(x),j)\\)</span>  <span class=\"math inline\">\\((x,y+1)\\)</span> <strong></strong> <span class=\"math inline\">\\((i,l(i)+1)\\)</span>  <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\((0,0)\\)</span>  <span class=\"math inline\">\\((x,y+1)\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(l\\)</span> </p>\r\n<p> <span class=\"math display\">\\[\r\nF(k,b,x,y)=kF(k,b,x-1,y+1)+\\binom{x+y+1}x\r\n\\]</span>  <span class=\"math inline\">\\(F(k,b,x+y,0)=1\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\nF(k,b,x,y)=\\sum_{i+j=x}\\binom{x+y+1}ik^j\r\n\\]</span>  <span class=\"math inline\">\\(b\\)</span> </p>\r\n<h3 id=\"lucaslehmer-\">LucasLehmer </h3>\r\n<blockquote>\r\n<p><span class=\"math inline\">\\(M_p=2^p-1(p\\in\\text{Odd prime})\\)</span>  <span class=\"math inline\">\\(M_p|(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}}\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(s_n=(2+\\sqrt 3)^{2^n}+(2-\\sqrt 3)^{2^n}\\bmod M_p\\)</span> <span class=\"math display\">\\[\r\ns_n=\\begin{cases}\r\n4&amp;(i=0)\\\\\r\ns_{n-1}^2-2\\bmod M_p&amp;(i&gt;1)\r\n\\end{cases}\r\n\\]</span>  <code>FFT</code>  <span class=\"math inline\">\\(O(p\\log p)\\)</span></p>\r\n<p><span class=\"math inline\">\\(a \\bmod M_p=(a_0\\cdot 2^p+a_1)\\bmod M_p=(a_0+a_1)\\bmod M_p\\)</span></p>\r\n<p><span class=\"math inline\">\\(s_{n-1}^2-2\\)</span>  <span class=\"math inline\">\\(O(p^2\\log p)\\)</span></p>\r\n<h4 id=\"\"></h4>\r\n<p> <span class=\"math inline\">\\(M_p\\)</span>  <span class=\"math inline\">\\(q\\)</span> <span class=\"math inline\">\\(q^2\\)</span>  <span class=\"math inline\">\\(X=\\{a+b\\sqrt 3|a,b\\in\\mathbb Z_q\\}\\)</span> <span class=\"math inline\">\\(\\mathbb Z_q\\)</span>  <span class=\"math inline\">\\(0,1,2\\cdots,q-2,q-1\\)</span> <span class=\"math inline\">\\(X\\)</span>  <span class=\"math display\">\\[\r\n(a+b\\sqrt 3)(c+d\\sqrt 3)=(ac+3bd)\\bmod q+(bc+ad)\\bmod q\\sqrt3\r\n\\]</span> <span class=\"math inline\">\\(X\\)</span>  <span class=\"math inline\">\\(X\\)</span>  <span class=\"math inline\">\\(X^*\\)</span> <span class=\"math inline\">\\((2+\\sqrt 3)(2+(q-1)\\sqrt 3)\\equiv 1\\pmod q\\)</span> <span class=\"math inline\">\\(2+\\sqrt 3\\in X^{*}\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\n(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}} \\equiv 0\\pmod {M_p}\\\\\r\n(2+\\sqrt 3)^{2^{p-1}}+[(2+\\sqrt 3)(2-\\sqrt 3)]^{2^{p-2}} \\equiv 0\\pmod {M_p}\\\\\r\n(2+\\sqrt 3)^{2^{p-1}}\\equiv -1\\pmod {M_p}\r\n\\]</span>  <span class=\"math inline\">\\(2 + \\sqrt 3\\)</span>  <span class=\"math inline\">\\(2^p\\)</span> <span class=\"math inline\">\\((2 + \\sqrt 3)^0,(2 + \\sqrt 3)^1,(2 + \\sqrt 3)^2,\\cdots,(2+\\sqrt 3)^{2^p-1}\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(2^p \\le |X*| \\le q^2 \\le M_p\\)</span> <span class=\"math inline\">\\(2^p \\le M_p\\)</span> <span class=\"math inline\">\\(M_p\\)</span> </p>\r\n<h4 id=\"\"></h4>\r\n<p> <span class=\"math inline\">\\(M_p\\)</span>  <span class=\"math inline\">\\(M_p|(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(p\\ge 3\\)</span> <span class=\"math inline\">\\(2^p-1\\equiv 7\\pmod 8\\)</span>  <span class=\"math inline\">\\(2^p-1\\equiv 7\\pmod {12}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(p\\)</span></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(2^p-1\\equiv 7\\pmod 8\\Rightarrow \\left(\\dfrac 2p\\right)=1\\Rightarrow 2^{\\frac{M_p-1}2}\\equiv 1\\pmod {M_p}\\)</span></li>\r\n<li><span class=\"math inline\">\\(2^p-1\\equiv 7\\pmod {12}\\Rightarrow \\left(\\dfrac 3p\\right)=-1\\Rightarrow 3^{\\frac{M_p-1}2}\\equiv -1\\pmod {M_p}\\)</span></li>\r\n</ul>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(X=\\{a+b\\sqrt 3|a,b\\in\\mathbb Z_{M_p}\\}\\)</span> <span class=\"math inline\">\\(X^*\\)</span></p>\r\n<blockquote>\r\n<p><span class=\"math inline\">\\(\\forall x,y\\in X^*,(x+y)^{M_p}\\equiv x^{M_p}+y^{M_p}\\pmod{M_p}\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(M_p|\\binom{M_p}i\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n(6+2\\sqrt 3)^{M_p}&amp;=6^{M_p}+2^{M_p}(\\sqrt 3)^{M_p}\\\\\r\n&amp;=6+2\\sqrt 3\\cdot 3^{\\frac{M_p-1}2}\\\\\r\n&amp;=6-2\\sqrt 3\r\n\\end{aligned}\r\n\\]</span>  <span class=\"math inline\">\\(2+\\sqrt 3=\\frac{(6+2\\sqrt 3)^2}{24}\\)</span> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n(2+\\sqrt 3)^{\\frac{M_p+1}2}&amp;=\\frac{(6+2\\sqrt 3)^{M_p+1}}{24^{\\frac{M_p+1}2}}\\\\\r\n&amp;=\\frac{(6+2\\sqrt 3)(6-2\\sqrt 3)}{24\\cdot (2^{\\frac{M_p-1}2})^3\\cdot 3^{\\frac{M_p-1}2}}\\\\\r\n&amp;=-1\r\n\\end{aligned}\r\n\\]</span>  <span class=\"math inline\">\\((2-\\sqrt 3)^{\\frac{M_p+1}4}\\)</span> <span class=\"math inline\">\\((2+\\sqrt 3)(2-\\sqrt 3)=1\\)</span> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n(2+\\sqrt 3)^{\\frac{M_p+1}2}(2-\\sqrt 3)^{\\frac{M_p+1}4}&amp;=-(2-\\sqrt 3)^{\\frac{M_p+1}4}\\\\\r\n(2+\\sqrt 3)^{\\frac{M_p+1}4}+(2-\\sqrt 3)^{\\frac{M_p+1}4}&amp;=0\\\\\r\n(2+\\sqrt 3)^{2^{p-2}}+(2-\\sqrt 3)^{2^{p-2}}&amp;=0\r\n\\end{aligned}\r\n\\]</span></p>\r\n<h3 id=\"\"></h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(2^n\\)</span>  <span class=\"math inline\">\\(\\bmod 2^n\\)</span></p>\r\n<p><span class=\"math inline\">\\(n \\le 10^4\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(f_n=\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^n\\)</span> <span class=\"math inline\">\\(n\\ge 2\\)</span> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\nf_{n+1}&amp;=(\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^{n+1})(\\prod_{i=1}^{2^{n-1}}2i-1+2^n\\bmod 2^{n+1})\\bmod 2^{n+1}\\\\\r\n&amp;=(\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^{n+1})^2\\bmod 2^{n+1}\\\\\r\n\\end{aligned}\r\n\\]</span>  <span class=\"math inline\">\\(\\prod_{i=1}^{2^{n-1}}2i-1\\bmod 2^{n+1}=f_n+k2^n(k\\in\\{0,1\\})\\)</span> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\nf_{n+1}&amp;=(f_n+k2^n)^2\\bmod 2^{n+1}\\\\\r\n&amp;=f_n^2+k2^{n+1}+k^22^{2n}\\bmod 2^{n+1}\\\\\r\n&amp;=f_n^2\\bmod 2^{n+1}\r\n\\end{aligned}\r\n\\]</span>  <code>FFT</code>  <span class=\"math inline\">\\(O(n\\log n)\\)</span> <span class=\"math inline\">\\(O(n^2\\log n)\\)</span></p>\r\n<h3 id=\"\"></h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(\\frac {p-1}2!\\bmod p\\)</span><span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(p\\equiv 3\\pmod 4\\)</span></p>\r\n<p><span class=\"math inline\">\\(p \\le ???\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(O(\\sqrt p\\log p)\\)</span></p>\r\n<p> Wilson <span class=\"math inline\">\\((p-1)!\\equiv -1\\pmod p\\)</span> <span class=\"math inline\">\\(\\frac {p-1}2!\\equiv \\pm 1\\pmod p\\)</span><span class=\"math inline\">\\(\\frac {p-1}2!\\equiv 1\\pmod p\\)</span> </p>\r\n<ul>\r\n<li><p><span class=\"math inline\">\\(p\\equiv 3\\pmod 8 \\land h(-p)\\equiv 1\\pmod 4\\)</span></p></li>\r\n<li><p><span class=\"math inline\">\\(p\\equiv 7\\pmod 8\\land h(-p)\\equiv 3\\pmod 4\\)</span></p></li>\r\n</ul>\r\n<p><span class=\"math inline\">\\(h(-p) \\bmod 4\\)</span> </p>\r\n"},{"title":"","date":"2021-03-13T15:15:28.000Z","updated":"2021-03-13T15:15:28.000Z","_content":"### <1> \n\n $1,2,\\cdots,m+2$ \n$$\n\\sum_{i=1}^ni^m=\\sum_{i=1}^{m+2}S_m(i)\\prod_{j\\ne i}\\frac{n-j}{i-j}\n$$\n\n$$\npre_i=\\prod_{j=1}^in-j,suf_i=\\prod_{j=i}^{m+2}n-j\n$$\n\n\n\n$$\n\\sum_{i=1}^ni^m=\\sum_{i=1}^{m+2}S_m(i)\\frac {pre_{i-1}suf_{i+1}}{(i-1)!(m+2-i)!(-1)^{m+2-i}}\n$$\n $O(m\\log P)$  $O(m)$ $i^k$\n\n\n\n### <2> ()\n\n$$\n\\sum_{i=1}^ni^{m+1}=\\sum_{k=0}^m\\binom{n+k+1}{m+2}\\sum_{r=0}^k(-1)^r\\binom{m+2}r(k+1-r)^{m+1}\n$$\n\n $O(m^2)$\n\n### <3> \n\n\n$$\n{0 \\brace 0} = 1 \\\\\n{n \\brace m} = {n - 1 \\brace m - 1} + m{n - 1 \\brace m}\n$$\n\n$$\n\\sum_{i=1}^mi^m=\\sum_{i=1}^n{m \\brace i}\\frac 1{i+1}(n+1)^{\\underline{i+1}}\n$$\n $O(m^2)$  $O(m\\log m)$ -\n\n### <4> \n\n$$\nf_i=\\sum_{j=1}^nj^i\\\\\nf_i=\\frac 1{i+1}\\left((n+1)^{i+1}-\\sum_{j=0}^{i-1}\\binom{i+1}jf_j\\right)\n$$\n\n $O(m^2)$\n\n### <5> \n\n\n$$\nB_0=1\\\\\n\\sum_{i=0}^m\\binom{m+1}iB_i=0\n$$\n\n$$\n\\sum_{i=1}^ni^m=\\frac 1{m+1}\\sum_{i=0}^m\\binom{m+1}iB_in^{m+1-i}\n$$\n\n$$\nB(x)=\\frac x{e^x-1}\n$$\n\n\n $O(m\\log m)$","source":"_posts/zi-ran-shu-deng-mi-qiu-he.md","raw":"---\ntitle: \ndate: 2021-03-13 23:15:28\nupdated: 2021-03-13 23:15:28\ntags: [,,]\ncategories: \n---\n### <1> \n\n $1,2,\\cdots,m+2$ \n$$\n\\sum_{i=1}^ni^m=\\sum_{i=1}^{m+2}S_m(i)\\prod_{j\\ne i}\\frac{n-j}{i-j}\n$$\n\n$$\npre_i=\\prod_{j=1}^in-j,suf_i=\\prod_{j=i}^{m+2}n-j\n$$\n\n\n\n$$\n\\sum_{i=1}^ni^m=\\sum_{i=1}^{m+2}S_m(i)\\frac {pre_{i-1}suf_{i+1}}{(i-1)!(m+2-i)!(-1)^{m+2-i}}\n$$\n $O(m\\log P)$  $O(m)$ $i^k$\n\n\n\n### <2> ()\n\n$$\n\\sum_{i=1}^ni^{m+1}=\\sum_{k=0}^m\\binom{n+k+1}{m+2}\\sum_{r=0}^k(-1)^r\\binom{m+2}r(k+1-r)^{m+1}\n$$\n\n $O(m^2)$\n\n### <3> \n\n\n$$\n{0 \\brace 0} = 1 \\\\\n{n \\brace m} = {n - 1 \\brace m - 1} + m{n - 1 \\brace m}\n$$\n\n$$\n\\sum_{i=1}^mi^m=\\sum_{i=1}^n{m \\brace i}\\frac 1{i+1}(n+1)^{\\underline{i+1}}\n$$\n $O(m^2)$  $O(m\\log m)$ -\n\n### <4> \n\n$$\nf_i=\\sum_{j=1}^nj^i\\\\\nf_i=\\frac 1{i+1}\\left((n+1)^{i+1}-\\sum_{j=0}^{i-1}\\binom{i+1}jf_j\\right)\n$$\n\n $O(m^2)$\n\n### <5> \n\n\n$$\nB_0=1\\\\\n\\sum_{i=0}^m\\binom{m+1}iB_i=0\n$$\n\n$$\n\\sum_{i=1}^ni^m=\\frac 1{m+1}\\sum_{i=0}^m\\binom{m+1}iB_in^{m+1-i}\n$$\n\n$$\nB(x)=\\frac x{e^x-1}\n$$\n\n\n $O(m\\log m)$","slug":"zi-ran-shu-deng-mi-qiu-he","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh1x007hootnfi8gcpa4","content":"<h3 id=\"\">&lt;1&gt; </h3>\r\n<p> <span class=\"math inline\">\\(1,2,\\cdots,m+2\\)</span>  <span class=\"math display\">\\[\r\n\\sum_{i=1}^ni^m=\\sum_{i=1}^{m+2}S_m(i)\\prod_{j\\ne i}\\frac{n-j}{i-j}\r\n\\]</span>  <span class=\"math display\">\\[\r\npre_i=\\prod_{j=1}^in-j,suf_i=\\prod_{j=i}^{m+2}n-j\r\n\\]</span> </p>\r\n<p> <span class=\"math display\">\\[\r\n\\sum_{i=1}^ni^m=\\sum_{i=1}^{m+2}S_m(i)\\frac {pre_{i-1}suf_{i+1}}{(i-1)!(m+2-i)!(-1)^{m+2-i}}\r\n\\]</span>  <span class=\"math inline\">\\(O(m\\log P)\\)</span>  <span class=\"math inline\">\\(O(m)\\)</span> <span class=\"math inline\">\\(i^k\\)</span></p>\r\n<h3 id=\"\">&lt;2&gt; ()</h3>\r\n<p><span class=\"math display\">\\[\r\n\\sum_{i=1}^ni^{m+1}=\\sum_{k=0}^m\\binom{n+k+1}{m+2}\\sum_{r=0}^k(-1)^r\\binom{m+2}r(k+1-r)^{m+1}\r\n\\]</span></p>\r\n<p> <span class=\"math inline\">\\(O(m^2)\\)</span></p>\r\n<h3 id=\"\">&lt;3&gt; </h3>\r\n<p> <span class=\"math display\">\\[\r\n{0 \\brace 0} = 1 \\\\\r\n{n \\brace m} = {n - 1 \\brace m - 1} + m{n - 1 \\brace m}\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\sum_{i=1}^mi^m=\\sum_{i=1}^n{m \\brace i}\\frac 1{i+1}(n+1)^{\\underline{i+1}}\r\n\\]</span>  <span class=\"math inline\">\\(O(m^2)\\)</span>  <span class=\"math inline\">\\(O(m\\log m)\\)</span> -</p>\r\n<h3 id=\"\">&lt;4&gt; </h3>\r\n<p><span class=\"math display\">\\[\r\nf_i=\\sum_{j=1}^nj^i\\\\\r\nf_i=\\frac 1{i+1}\\left((n+1)^{i+1}-\\sum_{j=0}^{i-1}\\binom{i+1}jf_j\\right)\r\n\\]</span></p>\r\n<p> <span class=\"math inline\">\\(O(m^2)\\)</span></p>\r\n<h3 id=\"\">&lt;5&gt; </h3>\r\n<p> <span class=\"math display\">\\[\r\nB_0=1\\\\\r\n\\sum_{i=0}^m\\binom{m+1}iB_i=0\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\sum_{i=1}^ni^m=\\frac 1{m+1}\\sum_{i=0}^m\\binom{m+1}iB_in^{m+1-i}\r\n\\]</span>  <span class=\"math display\">\\[\r\nB(x)=\\frac x{e^x-1}\r\n\\]</span> </p>\r\n<p> <span class=\"math inline\">\\(O(m\\log m)\\)</span></p>\r\n","site":{"data":{}},"length":947,"excerpt":"","more":"<h3 id=\"\">&lt;1&gt; </h3>\r\n<p> <span class=\"math inline\">\\(1,2,\\cdots,m+2\\)</span>  <span class=\"math display\">\\[\r\n\\sum_{i=1}^ni^m=\\sum_{i=1}^{m+2}S_m(i)\\prod_{j\\ne i}\\frac{n-j}{i-j}\r\n\\]</span>  <span class=\"math display\">\\[\r\npre_i=\\prod_{j=1}^in-j,suf_i=\\prod_{j=i}^{m+2}n-j\r\n\\]</span> </p>\r\n<p> <span class=\"math display\">\\[\r\n\\sum_{i=1}^ni^m=\\sum_{i=1}^{m+2}S_m(i)\\frac {pre_{i-1}suf_{i+1}}{(i-1)!(m+2-i)!(-1)^{m+2-i}}\r\n\\]</span>  <span class=\"math inline\">\\(O(m\\log P)\\)</span>  <span class=\"math inline\">\\(O(m)\\)</span> <span class=\"math inline\">\\(i^k\\)</span></p>\r\n<h3 id=\"\">&lt;2&gt; ()</h3>\r\n<p><span class=\"math display\">\\[\r\n\\sum_{i=1}^ni^{m+1}=\\sum_{k=0}^m\\binom{n+k+1}{m+2}\\sum_{r=0}^k(-1)^r\\binom{m+2}r(k+1-r)^{m+1}\r\n\\]</span></p>\r\n<p> <span class=\"math inline\">\\(O(m^2)\\)</span></p>\r\n<h3 id=\"\">&lt;3&gt; </h3>\r\n<p> <span class=\"math display\">\\[\r\n{0 \\brace 0} = 1 \\\\\r\n{n \\brace m} = {n - 1 \\brace m - 1} + m{n - 1 \\brace m}\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\sum_{i=1}^mi^m=\\sum_{i=1}^n{m \\brace i}\\frac 1{i+1}(n+1)^{\\underline{i+1}}\r\n\\]</span>  <span class=\"math inline\">\\(O(m^2)\\)</span>  <span class=\"math inline\">\\(O(m\\log m)\\)</span> -</p>\r\n<h3 id=\"\">&lt;4&gt; </h3>\r\n<p><span class=\"math display\">\\[\r\nf_i=\\sum_{j=1}^nj^i\\\\\r\nf_i=\\frac 1{i+1}\\left((n+1)^{i+1}-\\sum_{j=0}^{i-1}\\binom{i+1}jf_j\\right)\r\n\\]</span></p>\r\n<p> <span class=\"math inline\">\\(O(m^2)\\)</span></p>\r\n<h3 id=\"\">&lt;5&gt; </h3>\r\n<p> <span class=\"math display\">\\[\r\nB_0=1\\\\\r\n\\sum_{i=0}^m\\binom{m+1}iB_i=0\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\sum_{i=1}^ni^m=\\frac 1{m+1}\\sum_{i=0}^m\\binom{m+1}iB_in^{m+1-i}\r\n\\]</span>  <span class=\"math display\">\\[\r\nB(x)=\\frac x{e^x-1}\r\n\\]</span> </p>\r\n<p> <span class=\"math inline\">\\(O(m\\log m)\\)</span></p>\r\n"},{"title":"","date":"2021-04-16T08:45:41.000Z","updated":"2021-04-16T08:45:41.000Z","hidden":true,"_content":"****\n\n\n\n```cpp\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing ll = long long;\nusing lf = double;\n```\n\n# \n\n## Fast IO\n\n#### \n\n##### \n\n```cpp\nint read() {\n    const int M = 1e6;\n    static streambuf* in = cin.rdbuf();\n    #define gc (p1 == p2 && (p2 = (p1 = buf) + in -> sgetn(buf, M), p1 == p2) ? -1 : *p1++)\n    static char buf[M], *p1, *p2;\n    int c = gc, r = 0;\n    while(c < 48) c = gc;\n    while(c > 47) r = r * 10 + (c & 15), c = gc;\n    return r;\n}\nvoid wrt(int x) {\n    static streambuf* out = cout.rdbuf();\n    #define pc out -> sputc\n    static char c[11]; int sz = 0;\n    do c[++sz] = x % 10, x /= 10; while(x);\n    while(sz) pc(c[sz--] + 48);\n    pc(10);\n}\n```\n\n##### \n\n```cpp\nios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n```\n\n#### \n\n```cpp\nint read() {\n    const int M = 1e6;\n    static streambuf* in = cin.rdbuf();\n    #define gc (p1 == p2 && (p2 = (p1 = buf) + in -> sgetn(buf, M), p1 == p2) ? -1 : *p1++)\n    static char buf[M], *p1, *p2;\n    int c = gc, r = 0, f = 1;\n    while(c < 48) { if(c == 45) f = -1; c = gc; }\n    while(c > 47) r = r * 10 + (c & 15), c = gc;\n    return r * f;\n}\nvoid wrt(int x) {\n    static streambuf* out = cout.rdbuf();\n    #define pc out -> sputc\n    static char c[11]; int sz = 0;\n    if(x < 0) pc(45), x = -x;\n    do c[++sz] = x % 10, x /= 10; while(x);\n    while(sz) pc(c[sz--] + 48);\n    pc(10);\n}\n```\n\n** ```long long```  ```wrt```  ```c```  $20$**\n\n## AtCoder-modint\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\nusing uint = unsigned;\nusing ull = unsigned ll;\n\nconstexpr ll safe_mod(ll x, ll m) {\n    return x %= m, x < 0 ? x + m : x;\n}\nconstexpr ll pow_mod_constexpr(ll x, ll n, int m) {\n    if(m == 1) return 0;\n    uint _m = m;\n    ull r = 1, _x = safe_mod(x, m);\n    for(; n; n >>= 1, _x = _x * _x % _m)\n    if(n & 1) r = r * _x % m;\n    return r;\n}\nconstexpr bool is_prime_constexpr(int n) {\n    if(n <= 1) return false;\n    if(n == 2 || n == 7 || n == 61) return true;\n    if(n % 2 == 0) return false;\n    ll d = n - 1;\n    while(~d & 1) d /= 2;\n    for(ll a : {2, 7, 61}) {\n        ll t = d, y = pow_mod_constexpr(a, t, n);\n        while(t != n - 1 && y != 1 && y != n - 1)\n            y = y * y % n, t <<= 1;\n        if(y != n - 1 && t % 2 == 0) return false;\n    }\n    return true;\n}\nconstexpr pair<ll, ll> inv_gcd(ll a, ll b) {\n    a = safe_mod(a, b);\n    if(a == 0) return {b, 0};\n    ll s = b, t = a, m0 = 0, m1 = 1;\n    while(t) {\n        ll u = s / t;\n        s -= t * u, m0 -= m1 * u;\n        ll tmp = s;\n        s = t, t = tmp, tmp = m0, m0 = m1, m1 = tmp;\n    }\n    if(m0 < 0) m0 += b / s;\n    return {s, m0};\n}\nstruct barrett {\n    uint m; ull im;\n    barrett(uint m) :m(m), im(~0ull / m + 1) {}\n    uint mul(uint a, uint b) const {\n        ull z = (ull)a * b;\n        ull x = (unsigned __int128)z * im >> 64;\n        uint v = z - x * m;\n        return m <= v ? v + m : v;\n    }\n};\ntemplate<int m> struct static_modint {\n    using mint = static_modint;\n  public:\n    static mint raw(int v) {\n        mint x;\n        return x._v = v, x;\n    }\n    static_modint() : _v(0) {}\n    template<class T> static_modint(T v) {\n        ll x = v % m;\n        _v = x < 0 ? x + m : x;\n    }\n    uint val() const { return _v; }\n    mint& operator++() {\n        if(++_v == m) _v = 0;\n        return *this;\n    }\n    mint& operator--() {\n        if(!_v--) _v = m - 1;\n        return *this;\n    }\n    mint operator++(int) {\n        mint res = *this;\n        ++*this;\n        return res;\n    }\n    mint operator--(int) {\n        mint res = *this;\n        --*this;\n        return res;\n    }\n    mint& operator+=(const mint& rhs) {\n        _v += rhs._v;\n        if(_v >= m) _v -= m;\n        return *this;\n    }\n    mint& operator-=(const mint& rhs) {\n        _v -= rhs._v;\n        if(_v >= m) _v += m;\n        return *this;\n    }\n    mint& operator*=(const mint& rhs) {\n        ull z = _v;\n        z *= rhs._v, _v = z % m;\n        return *this;\n    }\n    mint& operator/=(const mint& rhs) { return *this = *this * rhs.inv(); }\n    mint operator+() const { return *this; }\n    mint operator-() const { return mint() - *this; }\n\n    mint pow(ll n) const {\n        assert(0 <= n);\n        mint x = *this, r = 1;\n        for(; n; n >>= 1, x *= x) if(n & 1) r *= x;\n        return r;\n    }\n    mint inv() const {\n        if(prime) {\n            assert(_v);\n            return pow(m - 2);\n        } else {\n            auto eg = inv_gcd(_v, m);\n            assert(eg.first == 1);\n            return eg.second;\n        }\n    }\n\n    friend mint operator+(const mint& lhs, const mint& rhs) {\n        return mint(lhs) += rhs;\n    }\n    friend mint operator-(const mint& lhs, const mint& rhs) {\n        return mint(lhs) -= rhs;\n    }\n    friend mint operator*(const mint& lhs, const mint& rhs) {\n        return mint(lhs) *= rhs;\n    }\n    friend mint operator/(const mint& lhs, const mint& rhs) {\n        return mint(lhs) /= rhs;\n    }\n    friend bool operator==(const mint& lhs, const mint& rhs) {\n        return lhs._v == rhs._v;\n    }\n    friend bool operator!=(const mint& lhs, const mint& rhs) {\n        return lhs._v != rhs._v;\n    }\n\n  private:\n    uint _v;\n    static constexpr bool prime = is_prime_constexpr(m);\n};\n\ntemplate<int id> struct dynamic_modint {\n    using mint = dynamic_modint;\n\n  public:\n    static void set_mod(int m) {\n        assert(1 <= m), bt = barrett(m);\n    }\n    static mint raw(int v) {\n        mint x;\n        return x._v = v, x;\n    }\n\n    dynamic_modint() : _v(0) {}\n    template<class T> dynamic_modint(T v) {\n        ll x = v % bt.m;\n        _v = x < 0 ? x + bt.m : x;\n    }\n\n    uint val() const { return _v; }\n\n    mint& operator++() {\n        if(++_v == bt.m) _v = 0;\n        return *this;\n    }\n    mint& operator--() {\n        if(!_v--) _v = bt.m - 1;\n        return *this;\n    }\n    mint operator++(int) {\n        mint res = *this;\n        ++*this;\n        return res;\n    }\n    mint operator--(int) {\n        mint res = *this;\n        --*this;\n        return res;\n    }\n\n    mint& operator+=(const mint& rhs) {\n        _v += rhs._v;\n        if(_v >= bt.m) _v -= bt.m;\n        return *this;\n    }\n    mint& operator-=(const mint& rhs) {\n        _v += bt.m - rhs._v;\n        if(_v >= bt.m) _v -= bt.m;\n        return *this;\n    }\n    mint& operator*=(const mint& rhs) {\n        _v = bt.mul(_v, rhs._v);\n        return *this;\n    }\n    mint& operator/=(const mint& rhs) { return *this = *this * rhs.inv(); }\n\n    mint operator+() const { return *this; }\n    mint operator-() const { return mint() - *this; }\n\n    mint pow(ll n) const {\n        assert(0 <= n);\n        mint x = *this, r = 1;\n        for(; n; n >>= 1, x *= x) if(n & 1) r *= x;\n        return r;\n    }\n    mint inv() const {\n        auto eg = inv_gcd(_v, bt.m);\n        assert(eg.first == 1);\n        return eg.second;\n    }\n\n    friend mint operator+(const mint& lhs, const mint& rhs) {\n        return mint(lhs) += rhs;\n    }\n    friend mint operator-(const mint& lhs, const mint& rhs) {\n        return mint(lhs) -= rhs;\n    }\n    friend mint operator*(const mint& lhs, const mint& rhs) {\n        return mint(lhs) *= rhs;\n    }\n    friend mint operator/(const mint& lhs, const mint& rhs) {\n        return mint(lhs) /= rhs;\n    }\n    friend bool operator==(const mint& lhs, const mint& rhs) {\n        return lhs._v == rhs._v;\n    }\n    friend bool operator!=(const mint& lhs, const mint& rhs) {\n        return lhs._v != rhs._v;\n    }\n\n  private:\n    uint _v;\n    static barrett bt;\n};\ntemplate<int id> barrett dynamic_modint<id>::bt = 998244353;\n```\n\n## \n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\nusing uint = unsigned;\nusing ull = unsigned ll;\n\nconstexpr ll safe_mod(ll x, ll m) { return x %= m, x < 0 ? x + m : x; }\nconstexpr ll pow_mod_constexpr(ll x, ll n, int m) {\n    if(m == 1) return 0;\n    uint _m = m; ull r = 1, _x = safe_mod(x, m);\n    for(; n; n >>= 1, _x = _x * _x % _m) if(n & 1) r = r * _x % m;\n    return r;\n}\nconstexpr bool is_prime_constexpr(int n) {\n    if(n <= 1) return false;\n    if(n == 2 || n == 7 || n == 61) return true;\n    if(n % 2 == 0) return false;\n    ll d = n - 1; while(~d & 1) d /= 2;\n    for(ll a : {2, 7, 61}) {\n        ll t = d, y = pow_mod_constexpr(a, t, n);\n        while(t != n - 1 && y != 1 && y != n - 1) y = y * y % n, t <<= 1;\n        if(y != n - 1 && t % 2 == 0) return false;\n    }\n    return true;\n}\nconstexpr pair<ll, ll> inv_gcd(ll a, ll b) {\n    a = safe_mod(a, b);\n    if(a == 0) return {b, 0};\n    ll s = b, t = a, m0 = 0, m1 = 1;\n    while(t) {\n        ll u = s / t; s -= t * u, m0 -= m1 * u;\n        ll tmp = s; s = t, t = tmp, tmp = m0, m0 = m1, m1 = tmp;\n    }\n    if(m0 < 0) m0 += b / s;\n    return {s, m0};\n}\nstruct barrett {\n    uint m; ull im;\n    barrett(uint m) :m(m), im(~0ull / m + 1) {}\n    uint mul(uint a, uint b) const {\n        ull z = (ull)a * b; ull x = (unsigned __int128)z * im >> 64; uint v = z - x * m;\n        return m <= v ? v + m : v;\n    }\n};\ntemplate<int m> struct static_modint {\n    using mint = static_modint;\n  public:\n    static mint raw(int v) { mint x; return x._v = v, x; }\n    static_modint() : _v(0) {}\n    template<class T> static_modint(T v) { ll x = v % m; _v = x < 0 ? x + m : x; }\n    uint val() const { return _v; }\n    mint& operator++() { if(++_v == m) _v = 0; return *this; }\n    mint& operator--() { if(!_v--) _v = m - 1; return *this; }\n    mint operator++(int) { mint res = *this; ++*this; return res; }\n    mint operator--(int) { mint res = *this; --*this; return res; }\n    mint& operator+=(const mint& rhs) { _v += rhs._v; if(_v >= m) _v -= m; return *this; }\n    mint& operator-=(const mint& rhs) { _v -= rhs._v; if(_v >= m) _v += m; return *this; }\n    mint& operator*=(const mint& rhs) { ull z = _v; z *= rhs._v, _v = z % m; return *this; }\n    mint& operator/=(const mint& rhs) { return *this = *this * rhs.inv(); }\n    mint operator+() const { return *this; }\n    mint operator-() const { return mint() - *this; }\n    mint pow(ll n) const { assert(0 <= n); mint x = *this, r = 1; for(; n; n >>= 1, x *= x) if(n & 1) r *= x; return r; }\n    mint inv() const { if(prime) { assert(_v); return pow(m - 2); } else { auto eg = inv_gcd(_v, m); assert(eg.first == 1); return eg.second; } }\n    friend mint operator+(const mint& lhs, const mint& rhs) { return mint(lhs) += rhs; }\n    friend mint operator-(const mint& lhs, const mint& rhs) { return mint(lhs) -= rhs; }\n    friend mint operator*(const mint& lhs, const mint& rhs) { return mint(lhs) *= rhs; }\n    friend mint operator/(const mint& lhs, const mint& rhs) { return mint(lhs) /= rhs; }\n    friend bool operator==(const mint& lhs, const mint& rhs) { return lhs._v == rhs._v; }\n    friend bool operator!=(const mint& lhs, const mint& rhs) { return lhs._v != rhs._v; }\n  private:\n    uint _v;\n    static constexpr bool prime = is_prime_constexpr(m);\n};\ntemplate<int id> struct dynamic_modint {\n    using mint = dynamic_modint;\n  public:\n    static void set_mod(int m) { assert(1 <= m), bt = barrett(m); }\n    static mint raw(int v) { mint x; return x._v = v, x; }\n    dynamic_modint() : _v(0) {}\n    template<class T> dynamic_modint(T v) { ll x = v % bt.m; _v = x < 0 ? x + bt.m : x; }\n    uint val() const { return _v; }\n    mint& operator++() { if(++_v == bt.m) _v = 0; return *this; }\n    mint& operator--() { if(!_v--) _v = bt.m - 1; return *this; }\n    mint operator++(int) { mint res = *this; ++*this; return res; }\n    mint operator--(int) { mint res = *this; --*this; return res; }\n    mint& operator+=(const mint& rhs) { _v += rhs._v; if(_v >= bt.m) _v -= bt.m; return *this; }\n    mint& operator-=(const mint& rhs) { _v += bt.m - rhs._v; if(_v >= bt.m) _v -= bt.m; return *this; }\n    mint& operator*=(const mint& rhs) { _v = bt.mul(_v, rhs._v); return *this; }\n    mint& operator/=(const mint& rhs) { return *this = *this * rhs.inv(); }\n    mint operator+() const { return *this; }\n    mint operator-() const { return mint() - *this; }\n    mint pow(ll n) const { assert(0 <= n); mint x = *this, r = 1; for(; n; n >>= 1, x *= x) if(n & 1) r *= x; return r; }\n    mint inv() const { auto eg = inv_gcd(_v, bt.m); assert(eg.first == 1); return eg.second; }\n    friend mint operator+(const mint& lhs, const mint& rhs) { return mint(lhs) += rhs; }\n    friend mint operator-(const mint& lhs, const mint& rhs) { return mint(lhs) -= rhs; }\n    friend mint operator*(const mint& lhs, const mint& rhs) { return mint(lhs) *= rhs; }\n    friend mint operator/(const mint& lhs, const mint& rhs) { return mint(lhs) /= rhs; }\n    friend bool operator==(const mint& lhs, const mint& rhs) { return lhs._v == rhs._v; }\n    friend bool operator!=(const mint& lhs, const mint& rhs) { return lhs._v != rhs._v; }\n  private:\n    uint _v;\n    static barrett bt;\n};\ntemplate<int id> barrett dynamic_modint<id>::bt = 998244353;\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n#define eb emplace_back\n#define fi first \n#define se second\n#define all(x) (x).begin(), (x).end()\n#define SZ(x) int((x).size())\n#define mid ((l + r) / 2)\n#define lc o * 2\n#define rc o * 2 + 1\n#define lch l, mid, lc\n#define rch mid + 1, r, rc\n#define cmi(a, b) (a = min(a, b))\n#define cma(a, b) (a = max(a, b))\n#define lb lower_bound\n#define ub upper_bound\n#define bs binary_search\n#define pop __builtin_popcount\n#define llpop __builtin_popcountll\n#define ctz __builtin_ctz\n#define llctz __builtin_ctzll\n#define clz __builtin_clz\n#define llclz __builtin_clzll\n#define par __builtin_parity\n#define llpar __builtin_parityll\n\nusing lf = double;\n// using P = pair<int, int>;\nusing V = vector<int>;\n// using cmp = complex<lf>;\n\nvoid solve() {\n    \n}\nint main() {\n    // ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n#ifdef local\n    // freopen(\".in\", \"r\", stdin);\n#endif\n    int T;\n    for(cin >> T; T--; solve());\n}\n```\n\n## \n\n### \n\n```cpp\nll gen(ll x) {\n    const ll k = 0x9ddfea08eb382d69ull;\n    rep(i, 1, 3) x *= k, x ^= x >> 47;\n    return x * k;\n}\nll rnd() {\n    static ll s = 2;\n    return (s += gen(s)) & LONG_LONG_MAX;\n}\n```\n\n##  \n\n### \n\n```cpp\nll mul(ll a, ll b, ll p) {\n    return (a * b - ll((long double)a / p * b + 0.5) * p + p) % p;\n}\n```\n\n### `bash` \n\n```bash\n#!/bin/bash\nwhile true; do\n    ./gen > in\n    ./a < in > 1\n    ./b < in > 2\n    diff 1 2\n    if [ $? -ne 0 ] ; then break; fi\ndone\n```\n\n## \n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n\nusing namespace std;\nusing ll = long long;\n\nll mul(ll a, ll b, ll p) {\n    return (a * b - ll((long double)a / p * b + 0.5) * p + p) % p;\n}\nll Pow(ll a, ll n, ll p, ll r = 1) {\n    for(; n; n /= 2, a = mul(a, a, p))\n    if(n & 1) r = mul(r, a, p);\n    return r;\n}\n\nnamespace Pollard_Rho {\n    int chk(ll n) {\n        for(ll a : {2, 3, 7, 61, 24251}) {\n            if(n == a) return 1;\n            if(Pow(a, n - 1, n) ^ 1) return 0;\n            ll k = n - 1, t;\n            while(~k & 1) k /= 2;\n            if((t = Pow(a, k, n)) == 1) continue;\n            while(t ^ 1 && t ^ n - 1) t = mul(t, t, n);\n            if(t ^ n - 1) return 0;\n        }\n        return 1;\n    }\n    ll f(ll x, ll c, ll p) { return (mul(x, x, p) + c) % p; }\n    ll PR(ll n) {\n        ll a = 0, b = 0, c = rand() % (n - 1) + 1, v = 1, g;\n        for(int k = 1; ; k *= 2, a = b, v = 1) {\n            rep(i, 1, k) {\n                b = f(b, c, n), v = mul(v, abs(a - b), n);\n                if(!(i & 127) || i == k) {\n                    g = __gcd(v, n);\n                    if(g > 1) return g;\n                }\n            }\n        }\n    }\n    ll ans[100]; int ct;\n    void solve(ll n) {\n        if(chk(n)) return void(ans[++ct] = n);\n        ll d; do d = PR(n); while(d == n);\n        solve(d), solve(n / d);\n    }\n    void work() {\n        ll n;\n        while(cin >> n) {\n            ct = 0;\n            if(chk(n)) { puts(\"Prime\"); continue; }\n            solve(n), sort(ans + 1, ans + ct + 1);\n            int t = 0;\n            rep(i, 1, ct) {\n                if(ans[i] ^ ans[i - 1]) cout << ans[i];\n                t++; if(ans[i] ^ ans[i + 1]) {\n                    if(t > 1) cout << '^' << t;\n                    putchar(32), t = 0;\n                }\n            } putchar(10);\n        }\n    }\n};\nnamespace Inv {\n    void exgcd(ll a, ll b, ll& d, ll& x, ll& y) {\n        if(b) exgcd(b, a % b, d, y, x), y -= a / b * x;\n        else d = a, x = 1, y = 0;\n    }\n    void inv(ll a, ll p) {\n        ll d, x, y; exgcd(a, p, d, x, y);\n        if(d > 1) puts(\"Non-existent!\");\n        else cout << (x % p + p) % p;\n    }\n    void work() {\n        ll a, p;\n        while(cin >> a >> p) inv(a, p);\n    }\n};\nnamespace Prime {\n    void work() {\n        ll n;\n        while(cin >> n) {\n            while(!Pollard_Rho::chk(n)) n++;\n            cout << n << endl;\n        }\n    }\n};\nnamespace Cipolla {\n    ll n, p, II;\n    struct cmp {\n        ll r, i;\n        cmp operator *(const cmp& b) {\n            return {(r * b.r + i * b.i % p * II) % p, (r * b.i + i * b.r) % p };\n        }\n    } U = { 1, 0 };\n    int pow1(ll a, int n, ll r = 1) {\n        for(; n; n /= 2, a = a * a % p)\n        if(n & 1) r = r * a % p;\n        return r;\n    }\n    cmp pow2(cmp a, int n, cmp r = U) {\n        for(; n; n /= 2, a = a * a)\n        if(n & 1) r = r * a;\n        return r;\n    }\n    void work() {\n        while(cin >> n >> p) {\n            if(!n) { puts(\"0\"); continue; }\n            if(p == 2) { cout << n << endl; continue; }\n            if(pow1(n, p / 2) ^ 1) { puts(\"Non-existent!\"); continue; }\n            ll a;\n            do a = rand() % p, II = (a * a - n + p) % p; while(!a || pow1(II, p / 2) == 1);\n            int x1 = pow2({a, 1}, p / 2 + 1).r, x2 = p - x1;\n            if(x1 > x2) swap(x1, x2);\n            printf(\"%d %d\\n\", x1, x2);\n        }\n    }\n}; \nint main() {\n    srand(time(0));\n    puts(\"Press 1 for integer factorization.\");\n    puts(\"Press 2 to calculate the modular multiplicative inverse of a number.\");\n    puts(\"Press 3 to find the first prime number greater than or equal to a number.\");\n    puts(\"Press 4 to calculate the modular square root of a number.\");\n    int op;\n    while(1) {\n        cin >> op;\n        if(op == 1) Pollard_Rho::work();\n        else if(op == 2) Inv::work();\n        else if(op == 3) Prime::work();\n        else if(op == 4) Cipolla::work();\n        else puts(\"Illegal input! Please re-enter your option.\");\n    }\n}\n```\n\n# \n\n## NTT\n\n### \n\n#### \n\n```cpp\nint lim = 1, bit = -1, rev[N];\n```\n\n#### \n\n```cpp\nll Pow(ll a, int n, ll r = 1) {\n    for(; n; n /= 2, a = a * a % P)\n    if(n & 1) r = r * a % P;\n    return r;\n}\nvoid NTT(ll a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(rev[i] < i) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2) {\n        ll wn = Pow(3, P / 2 / i);\n        for(int j = 0; j < lim; j += i * 2) {\n            ll w = 1;\n            For(k, j, j + i) {\n                ll &x = a[k], y = a[k + i] * w % P;\n                a[k + i] = (x - y) % P, (x += y) %= P, w = w * wn % P;\n            }\n        }\n    }\n    ll inv = Pow(lim, P - 2);\n    if(t) For(i, 0, lim) (a[i] *= inv) %= P;\n}\n```\n\n`modint` \n\n```cpp\nvoid NTT(mint a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(rev[i] < i) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2) {\n        mint wn = mint(3).pow(P / 2 / i);\n        for(int j = 0; j < lim; j += i * 2) {\n            mint w = 1;\n            For(k, j, j + i) {\n                mint &x = a[k], y = a[k + i] * w;\n                a[k + i] = x - y, x += y, w *= wn;\n            }\n        }\n    }\n    mint inv = mint(lim).inv();\n    if(t) For(i, 0, lim) a[i] *= inv;\n}\n```\n\n#### \n\n```cpp\nwhile(lim <= n + m) lim *= 2, bit++;\nFor(i, 0, lim) rev[i] = rev[i / 2] / 2 | (i & 1) << bit;\n```\n\n### \n\n#### \n\n```cpp\nll w[N];\nint lim = 1, bit = -1, rev[N]; \n```\n\n`modint` \n\n```cpp\nmint w[N];\nint lim = 1, bit = -1, rev[N]; \n```\n\n#### \n\n```cpp\nvoid mod(ll& x) { if(x >= P) x -= P; if(x < 0) x += P; }\nll Pow(ll a, int n, ll r = 1) {\n    for(; n; n /= 2, a = a * a % P)\n    if(n & 1) r = r * a % P;\n    return r;\n}\nvoid NTT(ll a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(rev[i] < i) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2)\n    for(int j = 0; j < lim; j += i * 2) For(k, j, j + i) {\n        ll &x = a[k], y = a[k + i] * w[lim / i * (k - j)] % P;\n        mod(a[k + i] = x - y), mod(x += y);\n    }\n    ll inv = Pow(lim, P - 2);\n    if(t) For(i, 0, lim) (a[i] *= inv) %= P;\n}\n```\n\n`modint` \n\n```cpp\nvoid NTT(mint a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(rev[i] < i) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2)\n    for(int j = 0; j < lim; j += i * 2) For(k, j, j + i) {\n        mint &x = a[k], y = a[k + i] * w[lim / i * (k - j)];\n        a[k + i] = x - y, x += y;\n    }\n    mint inv = mint(lim).inv();\n    if(t) For(i, 0, lim) a[i] *= inv;\n}\n```\n\n#### \n\n```cpp\nwhile(lim <= n + m) lim *= 2, bit++;\nll wn = Pow(3, P / 2 / lim);\nFor(i, 0, lim) {\n    rev[i] = rev[i / 2] / 2 | (i & 1) << bit;\n    w[i] = i ? w[i - 1] * wn % P : 1;\n}\n```\n\n`modint` \n\n```cpp\nwhile(lim <= n + m) lim *= 2, bit++;\nmint wn = mint(3).pow(P / 2 / lim);\nFor(i, 0, lim) {\n    rev[i] = rev[i / 2] / 2 | (i & 1) << bit;\n    w[i] = i ? w[i - 1] * wn : 1;\n}\n```\n\n##  NTT\n\n### \n\n```cpp\nusing cmp = complex<lf>;\nconst lf PI = acos(-1);\nconst cmp I(0, 1);\n\nint n, m, P;\nint M, lim = 1, bit = -1, rev[N];\ncmp w[N], a0[N], a1[N], b0[N], b1[N];\n```\n\n`modint` \n\n```cpp\nusing cmp = complex<lf>;\nconst lf PI = acos(-1);\n\nint n, m, P;\nint M, lim = 1, bit = -1, rev[N];\ncmp w[N], a0[N], a1[N], b0[N], b1[N];\n```\n\n### \n\n```cpp\nvoid FFT(cmp a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(i < rev[i]) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2) for(int j = 0; j < lim; j += i * 2) For(k, j, j + i) {\n        cmp &x = a[k], y = a[i + k] * w[lim / i * (k - j)];\n        a[i + k] = x - y, x += y;\n    }\n    lf inv = 1. / lim;\n    if(t) For(i, 0, lim) a[i] *= inv;\n}\nvoid FFT2(cmp a[], cmp b[]) {\n    For(i, 0, lim) a[i] += b[i] * I;\n    FFT(a, 0);\n    For(i, 0, lim) b[i] = conj(a[i ? lim - i : 0]);\n    For(i, 0, lim) {\n        cmp x = a[i], y = b[i];\n        a[i] = (y + x) * 0.5, b[i] = (y - x) * 0.5 * I;\n    }\n}\nll num(cmp x) { return M * ll(real(x) + 0.5) % P + ll(imag(x) + 0.5); }\n```\n\n`modint` \n\n```cpp\nvoid FFT(cmp a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(i < rev[i]) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2) for(int j = 0; j < lim; j += i * 2) For(k, j, j + i) {\n        cmp &x = a[k], y = a[i + k] * w[lim / i * (k - j)];\n        a[i + k] = x - y, x += y;\n    }\n    lf inv = 1. / lim;\n    if(t) For(i, 0, lim) a[i] *= inv;\n}\nvoid FFT2(cmp a[], cmp b[]) {\n    For(i, 0, lim) a[i] += b[i] * 1i;\n    FFT(a, 0);\n    For(i, 0, lim) b[i] = conj(a[i ? lim - i : 0]);\n    For(i, 0, lim) {\n        cmp x = a[i], y = b[i];\n        a[i] = (y + x) * 0.5, b[i] = (y - x) * 0.5i;\n    }\n}\nmint num(cmp x) { return M * (mint)ll(real(x) + 0.5) % P + (mint)ll(imag(x) + 0.5); }\n```\n\n### \n\n```cpp\nM = sqrt(P);\nrep(i, 0, n) a0[i] = A[i] / M, a1[i] = A[i] % M;\nrep(i, 0, m) b0[i] = B[i] / M, b1[i] = B[i] % M;\nwhile(lim <= n + m) lim *= 2, bit++;\nFor(i, 0, lim) {\n    rev[i] = rev[i / 2] / 2 | (i & 1) << bit;\n    w[i] = cmp(cos(PI / lim * i), sin(PI / lim * i));\n}\n```\n\n### \n\n```cpp\nFFT2(a0, a1), FFT2(b0, b1);\nFor(i, 0, lim) {\n    cmp t = a0[i] + I * a1[i];\n    b0[i] *= t, b1[i] *= t;\n}\nFFT(b0, 1), FFT(b1, 1);\nrep(i, 0, n + m) C[i] = (M * num(b0[i]) + num(b1[i])) % P;\n```\n\n`modint` \n\n```cpp\nFFT2(a0, a1), FFT2(b0, b1);\nFor(i, 0, lim) {\n    cmp t = a0[i] + I * a1[i];\n    b0[i] *= t, b1[i] *= t;\n}\nFFT(b0, 1), FFT(b1, 1);\nrep(i, 0, n + m) C[i] = M * num(b0[i]) + num(b1[i]);\n```\n\n## FWT\n\n### \n\n```cpp\nvoid FWT(ll a[]) {\n    For(i, 0, n) For(S, 0, 1 << n) if(S >> i & 1) {\n        ll& x = a[S ^ 1 << i], y = a[S];\n        a[S] = x - y, x += y;\n    }\n}\nvoid IFWT(ll a[]) {\n    For(i, 0, n) For(S, 0, 1 << n) if(S >> i & 1) {\n        ll& x = a[S ^ 1 << i], y = a[S];\n        a[S] = x - y >> 1, x = x + y >> 1;\n    }\n}\n```\n\n## \n\n### \n\n```cpp\nint n, lim, rev[N];\n```\n\n### \n\n```cpp\nll Pow(ll a, int n, ll r = 1) {\n    for(; n; n /= 2, a = a * a % P)\n    if(n & 1) r = r * a % P;\n    return r;\n}\nvoid bld(int n) {\n    lim = 1 << n--;\n    For(i, 0, lim) rev[i] = rev[i / 2] / 2 | (i & 1) << n;\n}\nvoid NTT(ll a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(i < rev[i]) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2) {\n        ll wn = Pow(g, P / 2 / i);\n        for(int j = 0; j < lim; j += i * 2) {\n            ll w = 1;\n            For(k, j, j + i) {\n                ll &x = a[k], y = a[k + i] * w % P;\n                a[k + i] = (x - y) % P, (x += y) %= P, w = w * wn % P;\n            }\n        }\n    }\n    ll inv = Pow(lim, P - 2);\n    if(t) For(i, 0, lim) (a[i] *= inv) %= P;\n}\nvoid Inv(ll a[], ll b[], int n) {\n    static ll c[N];\n    For(i, 0, 2 << n) b[i] = c[i] = 0;\n    b[0] = Pow(a[0], P - 2);\n    rep(i, 1, n) {\n        For(j, 0, 1 << i) c[j] = a[j];\n        bld(i + 1), NTT(c, 0), NTT(b, 0);\n        For(j, 0, lim) b[j] = (b[j] * 2 - b[j] * b[j] % P * c[j]) % P;\n        NTT(b, 1);\n        For(j, 1 << i, lim) b[j] = 0;\n    }\n}\n```\n\n`modint` \n\n```cpp\nvoid bld(int n) {\n    lim = 1 << n--;\n    For(i, 0, lim) rev[i] = rev[i / 2] / 2 | (i & 1) << n;\n}\nvoid NTT(mint a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(rev[i] < i) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2) {\n        mint wn = mint(3).pow(P / 2 / i);\n        for(int j = 0; j < lim; j += i * 2) {\n            mint w = 1;\n            For(k, j, j + i) {\n                mint &x = a[k], y = a[k + i] * w;\n                a[k + i] = x - y, x += y, w *= wn;\n            }\n        }\n    }\n    mint inv = mint(lim).inv();\n    if(t) For(i, 0, lim) a[i] *= inv;\n}\nvoid Inv(mint a[], mint b[], int n) {\n    static mint c[N];\n    For(i, 0, 2 << n) b[i] = c[i] = 0;\n    b[0] = a[0].inv();\n    rep(i, 1, n) {\n        For(j, 0, 1 << i) c[j] = a[j];\n        bld(i + 1), NTT(c, 0), NTT(b, 0);\n        For(j, 0, lim) b[j] = b[j] * 2 - b[j] * b[j] * c[j];\n        NTT(b, 1);\n        For(j, 1 << i, lim) b[j] = 0;\n    }\n}\n```\n\n## \n\n## \n\n## \n\n```cpp\nll mul(ll a, ll b, ll p) {\n    return (a * b - (ll)((long double)a / p * b + 0.5) * p + p) % p;\n}\nvoid exgcd(ll a, ll b, ll& d, ll& x, ll& y) {\n    if(!b) { d = a, x = 1, y = 0; return; }\n    exgcd(b, a % b, d, y, x), y -= a / b * x;\n}\nvoid exCRT(ll& b1, ll& m1, ll b2, ll m2) {\n    ll d, k1, k2; exgcd(m1, m2, d, k1, k2), m2 /= d;\n    b1 = (b1 + mul(mul(k1 % m2, (b2 - b1) / d % m2, m2), m1, m1 * m2)) % (m1 *= m2);\n}\n```\n\n## \n\n## Min-25 \n\n### \n\n```cpp\nll f1[N], f2[N];\n```\n\n### \n\n```cpp\nll min25(ll n) {\n    int lim = sqrt(n);\n    rep(i, 1, lim) f1[i] = i - 1, f2[i] = n / i - 1;\n    rep(p, 2, lim) if (f1[p] ^ f1[p - 1]) {\n        int w1 = lim / p;\n        ll x = f1[p - 1], w3 = (ll)p * p, w2 = min((ll)lim, n / w3), d = n / p;\n        rep(i, 1, w1) f2[i] -= f2[i * p] - x;\n        rep(i, w1 + 1, w2) f2[i] -= f1[d / i] - x;\n        per(i, lim, w3) f1[i] -= f1[i / p] - x;\n    }\n    return f2[1];\n}\n```\n\n## exBSGS\n\n### \n\n```cpp\nmap<int, int> mp;\n```\n\n### \n\n```cpp\nint BSGS(ll pls, ll a, ll b, ll p) {\n    pls %= p, a %= p, b %= p; mp.clear();\n    ll m = ceil(sqrt(p)), ls = 1, rs = 1;\n    For(i, 0, m) mp[ls * b % p] = i, ls = ls * a % p;\n    rep(i, 1, m) {\n        rs = rs * ls % p;\n        if(mp.count(rs * pls % p)) return i * m - mp[rs * pls % p];\n    }\n    return -1;\n}\nint exBSGS(ll a, ll b, ll p) {\n    a %= p, b %= p;\n    int pls = 1, ct = 0, g;\n    while((g = __gcd(a, p)) > 1) {\n        if(b == 1) return ct;\n        p /= g, pls = pls * a / g % p, ct++;\n        if(b % g) return -1; b /= g;\n    }\n    int ret = BSGS(pls, a, b, p);\n    return ~ret ? ret + ct : -1;\n}\n```\n\n## cipolla\n\n### \n\n```cpp\nint n; ll II;\nstruct cmp {\n    ll r, i;\n    cmp operator *(const cmp& b) {\n        return {(r * b.r + i * b.i % P * II) % P, (r * b.i + i * b.r) % P};\n    }\n} U = {1, 0};\n```\n\n`modint` \n\n```cpp\nmint n, II;\nstruct cmp {\n    mint r, i;\n    cmp operator *(const cmp& b) {\n        return {r * b.r + i * b.i * II, r * b.i + i * b.r};\n    }\n} U = {1, 0};\n```\n\n### \n\n```cpp\nint pow1(ll a, int n, ll r = 1) {\n    for(; n; n /= 2, a = a * a % P)\n    if(n & 1) r = r * a % P;\n    return r;\n}\ncmp pow2(cmp a, int n, cmp r = U) {\n    for(; n; n /= 2, a = a * a)\n    if(n & 1) r = r * a;\n    return r;\n}\nint cipolla(int n) {\n    if(!n) return 0;\n    if(P == 2) return n;\n    if(pow1(n, P / 2) ^ 1) return -1;\n    ll a;\n    do a = rand() % P, II = (a * a - n + P) % P; while(!a || pow1(II, P / 2) == 1);\n    return pow2({a, 1}, P / 2 + 1).r;\n}\n```\n\n`modint` \n\n```cpp\ncmp Pow(cmp a, int n, cmp r = U) {\n    for(; n; n /= 2, a = a * a)\n    if(n & 1) r = r * a;\n    return r;\n}\nint cipolla(mint n) {\n    if(n == 0) return 0;\n    if(P == 2) return n.val();\n    if(n.pow(P / 2) != 1) return -1;\n    mint a;\n    do a = rand(), II = a * a - n; while(a == 0 || II.pow(P / 2) == 1);\n    return Pow({a, 1}, P / 2 + 1).r.val();\n}\n```\n\n## Miller Rabin & Pollard Rho\n\n### \n\n```cpp\nvector<ll> as;\n```\n\n### \n\n```cpp\nll mul(ll a, ll b, ll p) {\n    return (a * b - ll((long double)a / p * b + 0.5) * p + p) % p;\n}\nll Pow(ll a, ll n, ll p, ll r = 1) {\n    for(; n; n /= 2, a = mul(a, a, p))\n    if(n & 1) r = mul(r, a, p);\n    return r;\n}\nint chk(ll n) {\n    for(ll a : {2, 3, 7, 61, 24251}) {\n        if(n == a) return 1;\n        if(Pow(a, n - 1, n) ^ 1) return 0;\n        ll k = n - 1, t;\n        while(~k & 1) k /= 2;\n        if((t = Pow(a, k, n)) == 1) continue;\n        while(t ^ 1 && t ^ n - 1) t = mul(t, t, n);\n        if(t ^ n - 1) return 0;\n    }\n    return 1;\n}\nll f(ll x, ll c, ll p) { return (mul(x, x, p) + c) % p; }\nll PR(ll n) {\n    ll a = 0, b = 0, c = rand() % (n - 1) + 1, v = 1, g;\n    for(int k = 1; ; k *= 2, a = b, v = 1) {\n        rep(i, 1, k) {\n            b = f(b, c, n), v = mul(v, abs(a - b), n);\n            if(!(i & 127) || i == k) {\n                g = __gcd(v, n);\n                if(g > 1) return g;\n            }\n        }\n    }\n}\nvoid solve(ll n) {\n    if(chk(n)) return as.pb(n);\n    ll d; do d = PR(n); while(d == n);\n    solve(d), solve(n / d);\n}\n```\n\n# \n\n## \n\n### \n\n#### \n\n```cpp\nint c[N][2], f[N], r[N];\n```\n\n#### \n\n```cpp\nint id(int o) { return c[f[o]][1] == o; }\nint nrt(int o) { return f[o] && c[f[o]][id(o)] == o; }\nvoid pu(int o) {\n    \n}\nvoid flip(int o) {\n    swap(c[o][0], c[o][1]), r[o] ^= 1;\n}\nvoid pd(int o) { if(r[o]) flip(c[o][0]), flip(c[o][1]), r[o] = 0; }\nvoid rot(int o, int d) {\n    int k = c[o][!d], &x = c[k][d];\n    if(nrt(o)) c[f[o]][id(o)] = k;\n    pu(x = f[c[o][!d] = x] = o), f[k] = f[o], pu(f[o] = k);\n}\nvoid dfs(int o) { if(nrt(o)) dfs(f[o]); pd(o); }\nvoid splay(int o) {\n    dfs(o);\n    for(int fa; nrt(o); rot(f[o], !id(o)))\n    if(nrt(fa = f[o])) rot(id(o) ^ id(fa) ? fa : f[fa], !id(o));\n}\nvoid acc(int o) {\n    for(int x = 0; o; o = f[x = o])\n        splay(o), c[o][1] = x, pu(o);\n}\nvoid mkrt(int o) { acc(o), splay(o), flip(o); }\nvoid link(int u, int v) {\n    mkrt(u), acc(v), splay(v), pu(f[u] = v);\n}\nvoid cut(int u, int v) {\n    mkrt(u), acc(v), splay(v), c[v][0] = f[u] = 0, pu(v);\n}\n```\n\n###  ```size``` \n\n#### \n\n```cpp\nint c[N][2], f[N], r[N], s[N], si[N];\n```\n\n#### \n\n```cpp\nint id(int o) { return c[f[o]][1] == o; }\nint nrt(int o) { return f[o] && c[f[o]][id(o)] == o; }\nvoid pu(int o) {\n    s[o] = s[c[o][0]] + s[c[o][1]] + si[o] + 1;\n}\nvoid flip(int o) {\n    swap(c[o][0], c[o][1]), r[o] ^= 1;\n}\nvoid pd(int o) { if(r[o]) flip(c[o][0]), flip(c[o][1]), r[o] = 0; }\nvoid rot(int o, int d) {\n    int k = c[o][!d], &x = c[k][d];\n    if(nrt(o)) c[f[o]][id(o)] = k;\n    pu(x = f[c[o][!d] = x] = o), f[k] = f[o], pu(f[o] = k);\n}\nvoid dfs(int o) { if(nrt(o)) dfs(f[o]); pd(o); }\nvoid splay(int o) {\n    dfs(o);\n    for(int fa; nrt(o); rot(f[o], !id(o)))\n    if(nrt(fa = f[o])) rot(id(o) ^ id(fa) ? fa : f[fa], !id(o));\n}\nvoid acc(int o) {\n    for(int x = 0; o; o = f[x = o])\n        splay(o), si[o] += s[c[o][1]] - s[x], c[o][1] = x, pu(o);\n}\nvoid mkrt(int o) { acc(o), splay(o), flip(o); }\nvoid link(int u, int v) {\n    mkrt(u), acc(v), splay(v), si[v] += s[u], pu(f[u] = v);\n}\nvoid cut(int u, int v) {\n    mkrt(u), acc(v), splay(v), c[v][0] = f[u] = 0, pu(v);\n}\n```\n\n## RBS \n\n### \n\n#### \n\n```cpp\nint rt, sz, ls[N], rs[N], c[N], s[N];\n```\n\n#### \n\n```cpp\nll gen(ll x) {\n    const ll k = 0x9ddfea08eb382d69ull;\n    rep(i, 1, 3) x *= k, x ^= x >> 47;\n    return x * k;\n}\nint rnd() {\n    static ll s = 2;\n    return (s += gen(s)) & INT_MAX;\n}\nint pu(int o) { s[o] = s[ls[o]] + s[rs[o]] + 1; return o; }\nvoid bld(int l, int r, int& o) {\n    if(l > r) return;\n    int mid = l + r >> 1;\n    c[o = ++sz] = a[mid];\n    bld(l, mid - 1, ls[o]), bld(mid + 1, r, rs[o]), pu(o); \n}\nvoid spt(int o, int x, int& u, int& v) {\n    if(!o) u = v = 0;\n    else if(x < c[o]) spt(ls[v = o], x, u, ls[o]), pu(o);\n    else spt(rs[u = o], x, rs[o], v), pu(o);\n}\nint mrg(int u, int v) {\n    if(!u || !v) return u + v;\n    if(rnd() % (s[u] + s[v]) < s[u])\n        return rs[u] = mrg(rs[u], v), pu(u);\n    return ls[v] = mrg(u, ls[v]), pu(v);\n}\nvoid ins(int& o, int x) {\n    if(rnd() % (s[o] + 1) == 0)\n        c[++sz] = x, spt(o, x, ls[sz], rs[sz]), pu(o = sz);\n    else ins(x < c[o] ? ls[o] : rs[o], x), pu(o);\n}\nvoid rmv(int& o, int x) {\n    int t1, t2, t3;\n    spt(o, x, t1, t3), spt(t1, x - 1, t1, t2);\n    o = mrg(mrg(t1, mrg(ls[t2], rs[t2])), t3);\n}\nint rk(int o, int x, int re = 1) {\n    while(o) o = x > c[o] ? re += s[ls[o]] + 1, rs[o] : ls[o]; \n    return re;\n}\nint kth(int o, int k) {\n    while(k != s[ls[o]] + 1)\n        o = k > s[ls[o]] ? k -= s[ls[o]] + 1, rs[o] : ls[o];\n    return c[o];\n}\nint pre(int o, int x, int re = -Inf) {\n    while(o) o = x > c[o] ? re = max(re, c[o]), rs[o] : ls[o];\n    return re;\n}\nint suf(int o, int x, int re = Inf) {\n    while(o) o = x < c[o] ? re = min(re, c[o]), ls[o] : rs[o];\n    return re;\n}\n```\n\n### \n\n```cpp\n#include <cstdio>\n#include <limits>\n#include <vector>\nusing namespace std;\n\ntypedef long long int64;\n\ninline int64 Fingerprint(int64 x) {\n    const int64 kMul = 0x9ddfea08eb382d69ULL;\n    x *= kMul, x ^= x >> 47;\n    x *= kMul, x ^= x >> 47;\n    x *= kMul, x ^= x >> 47;\n    return x * kMul;\n}\n\ninline int64 Random() {\n    static int64 Seed = 2;\n    Seed += Fingerprint(Seed);\n    return Seed & numeric_limits<int64>::max();\n}\n\ntypedef int DataType;\n\nstruct RBST {\n    RBST *ChildL, *ChildR;\n    int Size;\n    DataType Data;\n\n    RBST() { ChildL = ChildR = 0; }\n};\n\nint GetSize(const RBST* root) { return root ? root->Size : 0; }\n\nint LowerBoundIndex(const RBST* root, DataType x) {\n    if (!root) return 0;\n    if (x <= root->Data) return LowerBoundIndex(root->ChildL, x);\n    int sizeL = GetSize(root->ChildL);\n    return LowerBoundIndex(root->ChildR, x) + sizeL + 1;\n}\n\nDataType Select(const RBST* root, int index) {\n    int sizeL = GetSize(root->ChildL);\n    if (index == sizeL) return root->Data;\n    if (index < sizeL) return Select(root->ChildL, index);\n    return Select(root->ChildR, index - sizeL - 1);\n}\n\nRBST* SetSize(RBST* root) {\n    root->Size = GetSize(root->ChildL) + GetSize(root->ChildR) + 1;\n    return root;\n}\n\nstruct RBSTree {\n    vector<RBST*> Nodes;\n\n    RBST* NewNode(RBST* node) {\n        Nodes.push_back(new RBST(*node));\n        return Nodes.back();\n    }\n\n    void Split(RBST* root, DataType x, RBST*& treeL, RBST*& treeR) {\n        if (!root) {\n            treeL = treeR = 0;\n        } else if (x <= root->Data) {\n            RBST *newRoot = NewNode(root);\n            Split(root->ChildL, x, treeL, newRoot->ChildL);\n            treeR = SetSize(newRoot);\n        } else {\n            RBST* newRoot = NewNode(root);\n            Split(root->ChildR, x, newRoot->ChildR, treeR);\n            treeL = SetSize(newRoot);\n        }\n    }\n\n    RBST* Join(RBST* treeL, RBST* treeR) {\n        int sizeL = GetSize(treeL);\n        int sizeR = GetSize(treeR);\n        int size = sizeL + sizeR;\n        if (size == 0) return 0;\n        if (Random() % size < sizeL) {\n            RBST* newRoot = NewNode(treeL);\n            newRoot->ChildR = Join(treeL->ChildR, treeR);\n            return SetSize(newRoot);\n        } else {\n            RBST* newRoot = NewNode(treeR);\n            newRoot->ChildL = Join(treeL, treeR->ChildL);\n            return SetSize(newRoot);\n        }\n    }\n\n    RBST* InsertAsRoot(RBST* root, DataType item) {\n        Nodes.push_back(new RBST);\n        RBST *newRoot = Nodes.back();\n        newRoot->Data = item;\n        Split(root, item + 1, newRoot->ChildL, newRoot->ChildR);\n        return SetSize(newRoot);\n    }\n\n    RBST* Insert(RBST* root, DataType item) {\n        if (Random() % (GetSize(root) + 1) == 0) {\n            return InsertAsRoot(root, item);\n        } else if (item < root->Data) {\n            RBST *newRoot = NewNode(root);\n            newRoot->ChildL = Insert(root->ChildL, item);\n            return SetSize(newRoot);\n        } else {\n            RBST *newRoot = NewNode(root);\n            newRoot->ChildR = Insert(root->ChildR, item);\n            return SetSize(newRoot);\n        }\n    }\n\n    RBST* Remove(RBST* root, DataType item) {\n        RBST *tree1, *tree2, *tree3, *tree4 = 0;\n        Split(root, item, tree1, tree2);\n        Split(tree2, item + 1, tree2, tree3);\n        if (tree2) tree4 = Join(tree2->ChildL, tree2->ChildR);\n        return Join(Join(tree1, tree4), tree3);\n    }\n\n    void Destroy() {\n        for (int i = 0; i < Nodes.size(); ++i) delete Nodes[i];\n    }\n};\n```\n\n## K-D \n\n### \n\n```cpp\n#define mid ((l + r) / 2)\n#define lc o * 2\n#define rc o * 2 + 1\n#define lch l, mid, lc\n#define rch mid + 1, r, rc\n\nint D, L[N * 4][K], R[N * 4][K];\nstruct node {\n    int x[K];\n    void read() { For(i, 0, K) scanf(\"%d\", &x[i]); }\n    bool operator <(const node& b)const {\n        return x[D] < b.x[D];\n    }\n} a[N];\n```\n\n### \n\n```cpp\nlf sq(lf x) { return x * x; }\nvoid pu(int o) {\n    rep(i, 0, 1) {\n        L[o][i] = min(L[lc][i], L[rc][i]);\n        R[o][i] = max(R[lc][i], R[rc][i]);\n    }\n}\nvoid bld(int l, int r, int o) {\n    if(l == r) {\n        For(i, 0, K) L[o][i] = R[o][i] = a[l].x[i];\n        return;\n    }\n    lf va[K] = {};\n    For(i, 0, K) {\n        lf av = 0;\n        rep(j, l, r) av += a[j].x[i];\n        av /= r - l + 1;\n        rep(j, l, r) va[i] += sq(a[j].x[i] - av);\n    }\n    D = max_element(va, va + K) - va;\n    nth_element(a + l, a + mid, a + r + 1);\n    bld(lch), bld(rch), pu(o);\n}\n```\n\n### \n\n```cpp\nll sq(int x) { return 1ll * x * x; }\nll mine(int o, int x[], ll re = 0) {\n    For(i, 0, K) re += sq(max(L[o][i] - x[i], 0)) + sq(max(x[i] - R[o][i], 0));\n    return re;\n}\nll maxe(int o, int x[], ll re = 0) {\n    For(i, 0, K) re += max(sq(x[i] - L[o][i]), sq(x[i] - R[o][i]));\n    return re;\n}\n```\n\n### \n\n```cpp\nint minm(int o, int x[], int re = 0) {\n    For(i, 0, K) re += max(L[o][i] - x[i], 0) + max(x[i] - R[o][i], 0);\n    return re;\n}\nint maxm(int o, int x[], int re = 0) {\n    For(i, 0, K) re += max(abs(x[i] - L[o][i]), abs(x[i] - R[o][i]));\n    return re;\n}\n```\n\n### \n\n```cpp\nint minc(int o, int x[], int re = Inf) {\n    For(i, 0, K) re = max(re, max(L[o][i] - x[i], 0) + max(x[i] - R[o][i], 0));\n    return re;\n}\nint maxc(int o, int x[], int re = 0) {\n    For(i, 0, K) re = max({re, abs(x[i] - L[o][i]), abs(x[i] - R[o][i])});\n    return re;\n}\n```\n\n### \n\n#### \n\n```cpp\nll res;\n```\n\n#### \n\n```cpp\nvoid qry(int x[], int l, int r, int o) {\n    if(l == r) return void(res = mine(o, x));\n    ll dl = mine(lc, x), dr = mine(rc, x);\n    if(dl < dr) {\n        if(dl < res) qry(x, lch);\n        if(dr < res) qry(x, rch);\n    } else {\n        if(dr < res) qry(x, rch);\n        if(dl < res) qry(x, lch);\n    }\n}\n```\n\n#### \n\n```cpp\nres = Inf;\n```\n### \n\n#### \n\n```cpp\nll res;\n```\n\n#### \n\n```cpp\nvoid qry(int x[], int l, int r, int o) {\n    if(l == r) return void(res = maxe(o, x));\n    ll dl = maxe(lc, x), dr = maxe(rc, x);\n    if(dl > dr) {\n        if(dl > res) qry(x, lch);\n        if(dr > res) qry(x, rch);\n    } else {\n        if(dr > res) qry(x, rch);\n        if(dl > res) qry(x, lch);\n    }\n}\n```\n\n#### \n\n```cpp\nres = 0;\n```\n\n### \n\n#### \n\n```cpp\nint chk1(int l[], int r[], int o, int re = 1) {\n    For(i, 0, K) re &= l[i] <= L[o][i] && R[o][i] <= r[i];\n    return re;\n}\n```\n\n#### \n\n```cpp\nint chk2(int l[], int r[], int o, int re = 1) {\n    For(i, 0, K) re &= max(l[i], L[o][i]) <= min(r[i], R[o][i]);\n    return re;\n}\n```\n\n### \n\n#### \n\n```cpp\nint chk1(int x[], int r, int o) {\n    return maxe(x, o) <= 1ll * r * r;\n}\n```\n\n#### \n\n```cpp\nint chk2(int x[], int r, int o) {\n    return mine(x, o) <= 1ll * r * r;\n}\n```\n\n# \n\n## \n\n### `vector` \n\n#### \n\n```cpp\nint n, a[N], tp, stk[N];\nint idx, dfn[N], d[N], fa[20][N];\nvector<int> G[N], T[N];\n```\n\n#### \n\n```cpp\nvoid dfs(int u) {\n    dfn[u] = ++idx;\n    rep(i, 1, 19) fa[i][u] = fa[i - 1][fa[i - 1][u]];\n    for(int v : G[u]) if(v ^ fa[0][u])\n        d[v] = d[u] + 1, fa[0][v] = u, dfs(v);\n}\nint lca(int u, int v) {\n    if(d[u] < d[v]) swap(u, v);\n    rep(i, 0, 19) if(d[u] - d[v] >> i & 1) u = fa[i][u];\n    if(u == v) return u;\n    per(i, 19, 0) if(fa[i][u] ^ fa[i][v]) u = fa[i][u], v = fa[i][v];\n    return fa[0][u];\n}\nvoid bld(int k) {\n    sort(a + 1, a + k + 1, [](int a, int b) { return dfn[a] < dfn[b]; });\n    stk[++tp] = 1;\n    rep(i, 1, k) if(a[i] > 1) {\n        int x = lca(a[i], stk[tp]);\n        while(d[stk[tp]] > d[x]) tp--, T[d[stk[tp]] > d[x] ? stk[tp] : x].pb(stk[tp + 1]);\n        if(stk[tp] ^ x) stk[++tp] = x;\n        stk[++tp] = a[i];\n    }\n    while(--tp) T[stk[tp]].pb(stk[tp + 1]);\n}\nvoid clr(int u) {\n    for(int v : G[u]) clr(v); T[u].clear();\n}\n```\n\n### \n\n#### \n\n```cpp\nint n, a[N], p, stk[N];\nint d[N], fa[N], sz[N], son[N], tp[N], idx, dfn[N];\nvector<int> G[N];\nint eid, he[N];\nstruct edge { int v, nx; } e[N * 2];\n```\n\n#### \n\n```cpp\nvoid dfs(int u) {\n    sz[u] = 1;\n    for(int v : G[u]) {\n        d[v] = d[u] + 1, dfs(v), sz[u] += sz[v];\n        if(sz[v] > sz[son[u]]) son[u] = v;\n    }\n}\nvoid Dfs(int u, int top) {\n    tp[u] = top, dfn[u] = ++idx;\n    if(son[u]) Dfs(son[u], top);\n    for(int v : G[u]) if(v ^ son[u]) Dfs(v, v);\n}\nint lca(int u, int v) {\n    for(; tp[u] ^ tp[v]; d[tp[u]] > d[tp[v]] ? u = fa[tp[u]] : v = fa[tp[v]]);\n    return d[u] < d[v] ? u : v;\n}\nvoid add(int u, int v, int t = 1) {\n    e[++eid] = {v, h1[u]}, h1[u] = eid;\n}\nvoid bld(int k) {\n    sort(a + 1, a + k + 1, [](int a, int b) { return dfn[a] < dfn[b]; });\n    stk[++p] = 1;\n    rep(i, 1, k) if(a[i] > 1) {\n        int x = lca(a[i], stk[p]);\n        while(d[stk[p]] > d[x])\n            p--, add(d[stk[p]] > d[x] ? stk[p] : x, stk[p + 1]);\n        if(stk[p] ^ x) stk[++p] = x;\n        stk[++p] = a[i];\n    }\n    while(--p) add(stk[p], stk[p + 1]);\n}\n```\n\n##  ```LCA```\n\n### \n\n```cpp\nint dl[N], dr[N], fa[20][N];\n```\n\n### \n\n```cpp\nint lca(int u, int v) {\n    if(dl[u] < dl[v]) swap(u, v);\n    if(dl[v] <= dl[u] && dl[u] < dr[v]) return v;\n    per(i, 19, 0) {\n        int x = fa[i][u];\n        if(x && dl[x] > dl[v]) u = x;\n    }\n    return fa[0][u];\n}\n```\n\n## \n\n### ```int``` \n\n#### \n\n```cpp\nint n, m, s, t;\nint eid = 1, he[N], nw[N], d[N], q[N];\nstruct edge { int v, nx, c; } e[M * 2];\n```\n\n#### \n\n```cpp\nvoid add(int u, int v, int c) {\n    e[++eid] = {v, he[u], c}, he[u] = eid;\n    e[++eid] = {u, he[v], 0}, he[v] = eid;\n}\nint bfs() {\n    mem(d, 0), memcpy(nw, he, sizeof he);\n    q[1] = s, d[s] = 1;\n    for(int l = 1, r = 1; l <= r; l++) {\n        int u = q[l];\n        for(int i = he[u], v; v = e[i].v; i = e[i].nx)\n        if(e[i].c && !d[v]) q[++r] = v, d[v] = d[u] + 1;\n    }\n    return d[t];\n}\nint dfs(int u, int lim, int re = 0) {\n    if(u == t) return lim;\n    for(int& i = nw[u], v; v = e[i].v; i = e[i].nx)\n    if(e[i].c && d[v] == d[u] + 1) {\n        int t = dfs(v, min(e[i].c, lim));\n        e[i].c -= t, e[i ^ 1].c += t, re += t, lim -= t;\n        if(!lim) break;\n    }\n    if(lim) d[u] = 0;\n    return re;\n}\n```\n\n#### \n\n```cpp\nint flow = 0;\nwhile(bfs()) flow += dfs(s, Inf);\n```\n\n### ```long long``` \n\n```cpp\nint bfs() {\n    mem(d, 0), memcpy(nw, he, sizeof he);\n    q[1] = s, d[s] = 1;\n    for(int l = 1, r = 1; l <= r; l++) {\n        int u = q[l];\n        for(int i = he[u], v; v = e[i].v; i = e[i].nx)\n        if(e[i].c && !d[v]) q[++r] = v, d[v] = d[u] + 1;\n    }\n    return d[t];\n}\nll dfs(int u, ll lim, ll re = 0) {\n    if(u == t) return lim;\n    for(int& i = nw[u], v; v = e[i].v; i = e[i].nx)\n    if(e[i].c && d[v] == d[u] + 1) {\n        ll t = dfs(v, min((ll)e[i].c, lim));\n        e[i].c -= t, e[i ^ 1].c += t, re += t, lim -= t;\n        if(!lim) break;\n    }\n    if(lim) d[u] = 0;\n    return re;\n}\n```\n\n## \n\n### SSP \n\n#### \n\n```cpp\nint n, m, s, t, flow, cost;\nint eid = 1, he[N], nw[N], q[N], d[N], vs[N];\nstruct edge { int v, nx, c, w; } e[M * 2];\n```\n\n#### \n\n```cpp\nvoid add(int u, int v, int c, int w) {\n    e[++eid] = {v, he[u], c, w}, he[u] = eid;\n    e[++eid] = {u, he[v], 0, -w}, he[v] = eid;\n}\nint spfa() {\n    mem(d, 63), memcpy(nw, he, sizeof he);\n    q[0] = s, d[s] = 0, vs[s] = 1;\n    for(int l = 0, r = 0; l <= r; l++) {\n        int u = q[l % N]; vs[u] = 0;\n        for(int i = he[u], v; v = e[i].v; i = e[i].nx)\n        if(e[i].c && d[u] + e[i].w < d[v]) {\n            d[v] = d[u] + e[i].w;\n            if(!vs[v]) q[++r % N] = v, vs[v] = 1;\n        }\n    }\n    return d[t] < d[0];\n}\nint dfs(int u, int lim, int re = 0) {\n    if(u == t) return lim;\n    vs[u] = 1;\n    for(int& i = nw[u], v; v = e[i].v; i = e[i].nx)\n    if(!vs[v] && e[i].c && d[v] == d[u] + e[i].w) {\n        int t = dfs(v, min(lim, e[i].c));\n        e[i].c -= t, e[i ^ 1].c += t, re += t, lim -= t, cost += t * e[i].w;\n        if(!lim) break;\n    }\n    if(lim) d[u] = d[0];\n    vs[u] = 0;\n    return re;\n}\n```\n\n#### \n\n```cpp\nwhile(spfa()) flow += dfs(s, 1e9);\n```\n\n### Primal-Dual \n\n#### \n\n```cpp\nint n, m, s, t, flow, cost;\nint eid = 1, he[N], d[N], pre[N];\nstruct edge { int v, nx, c, w; } e[M * 2];\nstruct node {\n    int d, u;\n    bool operator <(const node& b)const {\n        return d > b.d;\n    }\n};\n```\n\n#### \n\n```cpp\nvoid add(int u, int v, int c, int w) {\n    e[++eid] = {v, he[u], c, w}, he[u] = eid;\n    e[++eid] = {u, he[v], 0, -w}, he[v] = eid;\n}\nint dji() {\n    priority_queue<node> q;\n    mem(d, 63), q.push({d[s] = 0, s});\n    while(q.size()) {\n        auto [dis, u] = q.top(); q.pop();\n        if(dis > d[u]) continue;\n        for(int i = he[u], v; v = e[i].v; i = e[i].nx) if(e[i].c) {\n            int w = d[u] + e[i].w - h[v] + h[u];\n            if(w < d[v]) pre[v] = i ^ 1, q.push({d[v] = w, v});\n        }\n    }\n    rep(i, 1, n) h[i] += d[i];\n    return d[t] < d[0];\n}\n```\n\n#### \n\n```cpp\nwhile(dji()) {\n    int mi = Inf;\n    for(int u = t, i; i = pre[u]; u = e[i].v) mi = min(mi, e[i ^ 1].c);\n    for(int u = t, i; i = pre[u]; u = e[i].v) e[i].c += mi, e[i ^ 1].c -= mi;\n    flow += mi, cost += mi * h[t];\n}\n```\n\n## \n\n### \n\n```cpp\nint n, m, vs[N], mch[N];\nvector<int> G[N];\n```\n\n### \n\n```cpp\nint dfs(int u, int s) {\n    if(vs[u] == s) return 0;\n    vs[u] = s;\n    for(int v : G[u]) if(!mch[v] || dfs(mch[v], s)) return mch[v] = u;\n    return 0;\n}\n```\n\n### \n\n```cpp\nint as = 0;\nrep(i, 1, n) if(dfs(i, i)) as++;\n```\n\n## 2-SAT \n\n### \n\n```cpp\nint n, m, co[N * 2], stk[N * 2], tp;\nvector<int> G[N * 2];\n```\n\n### \n\n```cpp\nvoid add(int u, int a, int v, int b) {\n    G[u * 2 + !a].pb(v * 2 + b);\n    G[v * 2 + !b].pb(u * 2 + a);\n}\nint dfs(int u) {\n    if(co[u] | co[u ^ 1]) return co[u];\n    co[u] = 1, stk[++tp] = u;\n    for(int v : G[u]) if(!dfs(v)) return 0;\n    return 1;\n}\nint twoSat() {\n    rep(i, 1, n) {\n        if(!co[i * 2] && !co[i * 2 + 1] && !dfs(i * 2)) {\n            while(tp) co[stk[tp--]] = 0;\n            if(!dfs(i * 2 + 1)) return 0;\n        }\n        tp = 0;\n    }\n    return 1;\n}\n```\n\n# \n\n## manacher \n\n```cpp\nrep(i, 1, n) {\n    int& j = ma > i ? min(R[p * 2 - i], ma - i) : 0;\n    while(s[i - j] == s[i + j + 1]) j++;\n    if(i + j > ma) ma = i + j, p = i;\n}\n```\n\n## \n\n### \n\n#### \n\n```cpp\nchar s[N];\nint n, sz = 1, nw, len[N], f[N], ch[N][26];\n```\n\n#### \n```cpp\nvoid ins(int i) {\n    auto jmp = [&](int o) {\n        while(s[i - len[o] - 1] != s[i]) o = f[o];\n        return o;\n    };\n    int o = jmp(nw), c = s[i] - 97;\n    if(!ch[o][c]]) {\n        f[++sz] = ch[jmp(f[o])][c];\n        len[ch[o][c] = sz] = len[o] + 2;\n    }\n    nw = ch[o][c];\n}\n```\n\n#### \n\n```cpp\nlen[1] = -1, f[0] = 1;\n```\n\n### \n\n#### \n\n```cpp\nvoid ins(int i) {\n    auto jmp = [&](int o) {\n        while(o && s[i - len[o] - 1] != s[i]) o = f[o];\n        return o;\n    };\n    int o = jmp(nw), c = s[i] - 97;\n    if(!ch[o][c]]) {\n        f[++sz] = ch[jmp(f[o])][c];\n        len[ch[o][c] = sz] = len[o] + 2;\n    }\n    nw = ch[o][c];\n}\n```\n\n#### \n\n```cpp\nrep(i, 0, 25) ch[0][i] = 1;\n```\n\n## \n\n### \n\n```cpp\nint n, m = 128, sa[N], rk[N], tp[N], buc[N];\nint h[20][N];\nchar s[N];\n```\n\n### \n\n```cpp\nvoid SA() {\n    rep(i, 1, n) buc[rk[i] = s[i]]++;\n    rep(i, 1, m) buc[i] += buc[i - 1];\n    per(i, n, 1) sa[buc[rk[i]]--] = i;\n    for(int k = 1, p; memset(buc, p = 0, m * 4 + 4); k *= 2) {\n        rep(i, n - k + 1, n) tp[++p] = i;\n        rep(i, 1, n) if(sa[i] > k) tp[++p] = sa[i] - k;\n        rep(i, 1, n) buc[rk[i]]++;\n        rep(i, 1, m) buc[i] += buc[i - 1];\n        per(i, n, 1) sa[buc[rk[tp[i]]]--] = tp[i];\n        memcpy(tp, rk, n * 4 + 4), p = 0;\n        rep(i, 1, n) rk[sa[i]] = p += tp[sa[i]] ^ tp[sa[i - 1]] || tp[sa[i] + k] ^ tp[sa[i - 1] + k];\n        if((m = p) >= n) break;\n    }\n}\nvoid height() {\n    int k = 0;\n    rep(i, 1, n) {\n        for(k ? k-- : 0; s[i + k] == s[sa[rk[i] - 1] + k]; k++);\n        h[0][rk[i]] = k;\n    }\n    rep(i, 1, 19) rep(j, 1, n - (1 << i) + 1)\n        h[i][j] = min(h[i - 1][j], h[i - 1][j + (1 << (i - 1))]);\n}\n```\n\n## \n\n### \n\n```cpp\nchar s[N];\nint n, sz = 1, nw = 1, f[N], len[N], ch[N][26];\n```\n\n### \n\n```cpp\nvoid ins(int c) {\n    int u = ++sz;\n    len[u] = len[nw] + 1;\n    while(nw && !ch[nw][c]) ch[nw][c] = u, nw = f[nw];\n    if(!nw) f[u] = 1;\n    else {\n        int v = ch[nw][c];\n        if(len[v] > len[nw] + 1) {\n            f[++sz] = f[v], memcpy(ch[sz], ch[v], sizeof ch[v]);\n            f[v] = f[u] = sz, len[sz] = len[nw] + 1;\n            for(int x = nw; ch[x][c] == v; x = f[x]) ch[x][c] = sz;\n        } else f[u] = v;\n    }\n    nw = u;\n}\n```\n\n## \n\n### \n\n```cpp\nint calc(char s[]) {\n    int i = 0, j = 1, k = 0;\n    while(i < n && j < n && k < n)\n    if(s[(i + k) % n] == s[(j + k) % n]) k++;\n    else {\n        if(s[(i + k) % n] > s[(j + k) % n]) swap(i, j);\n        j += k + 1, k = 0;\n        if(i == j) i++;\n    }\n    return min(i, j);\n}\n```\n","source":"_posts/template.md","raw":"---\ntitle: \ndate: 2021-04-16 16:45:41\nupdated: 2021-04-16 16:45:41\ntags: [,]\nhidden: true\n---\n****\n\n\n\n```cpp\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing ll = long long;\nusing lf = double;\n```\n\n# \n\n## Fast IO\n\n#### \n\n##### \n\n```cpp\nint read() {\n    const int M = 1e6;\n    static streambuf* in = cin.rdbuf();\n    #define gc (p1 == p2 && (p2 = (p1 = buf) + in -> sgetn(buf, M), p1 == p2) ? -1 : *p1++)\n    static char buf[M], *p1, *p2;\n    int c = gc, r = 0;\n    while(c < 48) c = gc;\n    while(c > 47) r = r * 10 + (c & 15), c = gc;\n    return r;\n}\nvoid wrt(int x) {\n    static streambuf* out = cout.rdbuf();\n    #define pc out -> sputc\n    static char c[11]; int sz = 0;\n    do c[++sz] = x % 10, x /= 10; while(x);\n    while(sz) pc(c[sz--] + 48);\n    pc(10);\n}\n```\n\n##### \n\n```cpp\nios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n```\n\n#### \n\n```cpp\nint read() {\n    const int M = 1e6;\n    static streambuf* in = cin.rdbuf();\n    #define gc (p1 == p2 && (p2 = (p1 = buf) + in -> sgetn(buf, M), p1 == p2) ? -1 : *p1++)\n    static char buf[M], *p1, *p2;\n    int c = gc, r = 0, f = 1;\n    while(c < 48) { if(c == 45) f = -1; c = gc; }\n    while(c > 47) r = r * 10 + (c & 15), c = gc;\n    return r * f;\n}\nvoid wrt(int x) {\n    static streambuf* out = cout.rdbuf();\n    #define pc out -> sputc\n    static char c[11]; int sz = 0;\n    if(x < 0) pc(45), x = -x;\n    do c[++sz] = x % 10, x /= 10; while(x);\n    while(sz) pc(c[sz--] + 48);\n    pc(10);\n}\n```\n\n** ```long long```  ```wrt```  ```c```  $20$**\n\n## AtCoder-modint\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\nusing uint = unsigned;\nusing ull = unsigned ll;\n\nconstexpr ll safe_mod(ll x, ll m) {\n    return x %= m, x < 0 ? x + m : x;\n}\nconstexpr ll pow_mod_constexpr(ll x, ll n, int m) {\n    if(m == 1) return 0;\n    uint _m = m;\n    ull r = 1, _x = safe_mod(x, m);\n    for(; n; n >>= 1, _x = _x * _x % _m)\n    if(n & 1) r = r * _x % m;\n    return r;\n}\nconstexpr bool is_prime_constexpr(int n) {\n    if(n <= 1) return false;\n    if(n == 2 || n == 7 || n == 61) return true;\n    if(n % 2 == 0) return false;\n    ll d = n - 1;\n    while(~d & 1) d /= 2;\n    for(ll a : {2, 7, 61}) {\n        ll t = d, y = pow_mod_constexpr(a, t, n);\n        while(t != n - 1 && y != 1 && y != n - 1)\n            y = y * y % n, t <<= 1;\n        if(y != n - 1 && t % 2 == 0) return false;\n    }\n    return true;\n}\nconstexpr pair<ll, ll> inv_gcd(ll a, ll b) {\n    a = safe_mod(a, b);\n    if(a == 0) return {b, 0};\n    ll s = b, t = a, m0 = 0, m1 = 1;\n    while(t) {\n        ll u = s / t;\n        s -= t * u, m0 -= m1 * u;\n        ll tmp = s;\n        s = t, t = tmp, tmp = m0, m0 = m1, m1 = tmp;\n    }\n    if(m0 < 0) m0 += b / s;\n    return {s, m0};\n}\nstruct barrett {\n    uint m; ull im;\n    barrett(uint m) :m(m), im(~0ull / m + 1) {}\n    uint mul(uint a, uint b) const {\n        ull z = (ull)a * b;\n        ull x = (unsigned __int128)z * im >> 64;\n        uint v = z - x * m;\n        return m <= v ? v + m : v;\n    }\n};\ntemplate<int m> struct static_modint {\n    using mint = static_modint;\n  public:\n    static mint raw(int v) {\n        mint x;\n        return x._v = v, x;\n    }\n    static_modint() : _v(0) {}\n    template<class T> static_modint(T v) {\n        ll x = v % m;\n        _v = x < 0 ? x + m : x;\n    }\n    uint val() const { return _v; }\n    mint& operator++() {\n        if(++_v == m) _v = 0;\n        return *this;\n    }\n    mint& operator--() {\n        if(!_v--) _v = m - 1;\n        return *this;\n    }\n    mint operator++(int) {\n        mint res = *this;\n        ++*this;\n        return res;\n    }\n    mint operator--(int) {\n        mint res = *this;\n        --*this;\n        return res;\n    }\n    mint& operator+=(const mint& rhs) {\n        _v += rhs._v;\n        if(_v >= m) _v -= m;\n        return *this;\n    }\n    mint& operator-=(const mint& rhs) {\n        _v -= rhs._v;\n        if(_v >= m) _v += m;\n        return *this;\n    }\n    mint& operator*=(const mint& rhs) {\n        ull z = _v;\n        z *= rhs._v, _v = z % m;\n        return *this;\n    }\n    mint& operator/=(const mint& rhs) { return *this = *this * rhs.inv(); }\n    mint operator+() const { return *this; }\n    mint operator-() const { return mint() - *this; }\n\n    mint pow(ll n) const {\n        assert(0 <= n);\n        mint x = *this, r = 1;\n        for(; n; n >>= 1, x *= x) if(n & 1) r *= x;\n        return r;\n    }\n    mint inv() const {\n        if(prime) {\n            assert(_v);\n            return pow(m - 2);\n        } else {\n            auto eg = inv_gcd(_v, m);\n            assert(eg.first == 1);\n            return eg.second;\n        }\n    }\n\n    friend mint operator+(const mint& lhs, const mint& rhs) {\n        return mint(lhs) += rhs;\n    }\n    friend mint operator-(const mint& lhs, const mint& rhs) {\n        return mint(lhs) -= rhs;\n    }\n    friend mint operator*(const mint& lhs, const mint& rhs) {\n        return mint(lhs) *= rhs;\n    }\n    friend mint operator/(const mint& lhs, const mint& rhs) {\n        return mint(lhs) /= rhs;\n    }\n    friend bool operator==(const mint& lhs, const mint& rhs) {\n        return lhs._v == rhs._v;\n    }\n    friend bool operator!=(const mint& lhs, const mint& rhs) {\n        return lhs._v != rhs._v;\n    }\n\n  private:\n    uint _v;\n    static constexpr bool prime = is_prime_constexpr(m);\n};\n\ntemplate<int id> struct dynamic_modint {\n    using mint = dynamic_modint;\n\n  public:\n    static void set_mod(int m) {\n        assert(1 <= m), bt = barrett(m);\n    }\n    static mint raw(int v) {\n        mint x;\n        return x._v = v, x;\n    }\n\n    dynamic_modint() : _v(0) {}\n    template<class T> dynamic_modint(T v) {\n        ll x = v % bt.m;\n        _v = x < 0 ? x + bt.m : x;\n    }\n\n    uint val() const { return _v; }\n\n    mint& operator++() {\n        if(++_v == bt.m) _v = 0;\n        return *this;\n    }\n    mint& operator--() {\n        if(!_v--) _v = bt.m - 1;\n        return *this;\n    }\n    mint operator++(int) {\n        mint res = *this;\n        ++*this;\n        return res;\n    }\n    mint operator--(int) {\n        mint res = *this;\n        --*this;\n        return res;\n    }\n\n    mint& operator+=(const mint& rhs) {\n        _v += rhs._v;\n        if(_v >= bt.m) _v -= bt.m;\n        return *this;\n    }\n    mint& operator-=(const mint& rhs) {\n        _v += bt.m - rhs._v;\n        if(_v >= bt.m) _v -= bt.m;\n        return *this;\n    }\n    mint& operator*=(const mint& rhs) {\n        _v = bt.mul(_v, rhs._v);\n        return *this;\n    }\n    mint& operator/=(const mint& rhs) { return *this = *this * rhs.inv(); }\n\n    mint operator+() const { return *this; }\n    mint operator-() const { return mint() - *this; }\n\n    mint pow(ll n) const {\n        assert(0 <= n);\n        mint x = *this, r = 1;\n        for(; n; n >>= 1, x *= x) if(n & 1) r *= x;\n        return r;\n    }\n    mint inv() const {\n        auto eg = inv_gcd(_v, bt.m);\n        assert(eg.first == 1);\n        return eg.second;\n    }\n\n    friend mint operator+(const mint& lhs, const mint& rhs) {\n        return mint(lhs) += rhs;\n    }\n    friend mint operator-(const mint& lhs, const mint& rhs) {\n        return mint(lhs) -= rhs;\n    }\n    friend mint operator*(const mint& lhs, const mint& rhs) {\n        return mint(lhs) *= rhs;\n    }\n    friend mint operator/(const mint& lhs, const mint& rhs) {\n        return mint(lhs) /= rhs;\n    }\n    friend bool operator==(const mint& lhs, const mint& rhs) {\n        return lhs._v == rhs._v;\n    }\n    friend bool operator!=(const mint& lhs, const mint& rhs) {\n        return lhs._v != rhs._v;\n    }\n\n  private:\n    uint _v;\n    static barrett bt;\n};\ntemplate<int id> barrett dynamic_modint<id>::bt = 998244353;\n```\n\n## \n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\nusing uint = unsigned;\nusing ull = unsigned ll;\n\nconstexpr ll safe_mod(ll x, ll m) { return x %= m, x < 0 ? x + m : x; }\nconstexpr ll pow_mod_constexpr(ll x, ll n, int m) {\n    if(m == 1) return 0;\n    uint _m = m; ull r = 1, _x = safe_mod(x, m);\n    for(; n; n >>= 1, _x = _x * _x % _m) if(n & 1) r = r * _x % m;\n    return r;\n}\nconstexpr bool is_prime_constexpr(int n) {\n    if(n <= 1) return false;\n    if(n == 2 || n == 7 || n == 61) return true;\n    if(n % 2 == 0) return false;\n    ll d = n - 1; while(~d & 1) d /= 2;\n    for(ll a : {2, 7, 61}) {\n        ll t = d, y = pow_mod_constexpr(a, t, n);\n        while(t != n - 1 && y != 1 && y != n - 1) y = y * y % n, t <<= 1;\n        if(y != n - 1 && t % 2 == 0) return false;\n    }\n    return true;\n}\nconstexpr pair<ll, ll> inv_gcd(ll a, ll b) {\n    a = safe_mod(a, b);\n    if(a == 0) return {b, 0};\n    ll s = b, t = a, m0 = 0, m1 = 1;\n    while(t) {\n        ll u = s / t; s -= t * u, m0 -= m1 * u;\n        ll tmp = s; s = t, t = tmp, tmp = m0, m0 = m1, m1 = tmp;\n    }\n    if(m0 < 0) m0 += b / s;\n    return {s, m0};\n}\nstruct barrett {\n    uint m; ull im;\n    barrett(uint m) :m(m), im(~0ull / m + 1) {}\n    uint mul(uint a, uint b) const {\n        ull z = (ull)a * b; ull x = (unsigned __int128)z * im >> 64; uint v = z - x * m;\n        return m <= v ? v + m : v;\n    }\n};\ntemplate<int m> struct static_modint {\n    using mint = static_modint;\n  public:\n    static mint raw(int v) { mint x; return x._v = v, x; }\n    static_modint() : _v(0) {}\n    template<class T> static_modint(T v) { ll x = v % m; _v = x < 0 ? x + m : x; }\n    uint val() const { return _v; }\n    mint& operator++() { if(++_v == m) _v = 0; return *this; }\n    mint& operator--() { if(!_v--) _v = m - 1; return *this; }\n    mint operator++(int) { mint res = *this; ++*this; return res; }\n    mint operator--(int) { mint res = *this; --*this; return res; }\n    mint& operator+=(const mint& rhs) { _v += rhs._v; if(_v >= m) _v -= m; return *this; }\n    mint& operator-=(const mint& rhs) { _v -= rhs._v; if(_v >= m) _v += m; return *this; }\n    mint& operator*=(const mint& rhs) { ull z = _v; z *= rhs._v, _v = z % m; return *this; }\n    mint& operator/=(const mint& rhs) { return *this = *this * rhs.inv(); }\n    mint operator+() const { return *this; }\n    mint operator-() const { return mint() - *this; }\n    mint pow(ll n) const { assert(0 <= n); mint x = *this, r = 1; for(; n; n >>= 1, x *= x) if(n & 1) r *= x; return r; }\n    mint inv() const { if(prime) { assert(_v); return pow(m - 2); } else { auto eg = inv_gcd(_v, m); assert(eg.first == 1); return eg.second; } }\n    friend mint operator+(const mint& lhs, const mint& rhs) { return mint(lhs) += rhs; }\n    friend mint operator-(const mint& lhs, const mint& rhs) { return mint(lhs) -= rhs; }\n    friend mint operator*(const mint& lhs, const mint& rhs) { return mint(lhs) *= rhs; }\n    friend mint operator/(const mint& lhs, const mint& rhs) { return mint(lhs) /= rhs; }\n    friend bool operator==(const mint& lhs, const mint& rhs) { return lhs._v == rhs._v; }\n    friend bool operator!=(const mint& lhs, const mint& rhs) { return lhs._v != rhs._v; }\n  private:\n    uint _v;\n    static constexpr bool prime = is_prime_constexpr(m);\n};\ntemplate<int id> struct dynamic_modint {\n    using mint = dynamic_modint;\n  public:\n    static void set_mod(int m) { assert(1 <= m), bt = barrett(m); }\n    static mint raw(int v) { mint x; return x._v = v, x; }\n    dynamic_modint() : _v(0) {}\n    template<class T> dynamic_modint(T v) { ll x = v % bt.m; _v = x < 0 ? x + bt.m : x; }\n    uint val() const { return _v; }\n    mint& operator++() { if(++_v == bt.m) _v = 0; return *this; }\n    mint& operator--() { if(!_v--) _v = bt.m - 1; return *this; }\n    mint operator++(int) { mint res = *this; ++*this; return res; }\n    mint operator--(int) { mint res = *this; --*this; return res; }\n    mint& operator+=(const mint& rhs) { _v += rhs._v; if(_v >= bt.m) _v -= bt.m; return *this; }\n    mint& operator-=(const mint& rhs) { _v += bt.m - rhs._v; if(_v >= bt.m) _v -= bt.m; return *this; }\n    mint& operator*=(const mint& rhs) { _v = bt.mul(_v, rhs._v); return *this; }\n    mint& operator/=(const mint& rhs) { return *this = *this * rhs.inv(); }\n    mint operator+() const { return *this; }\n    mint operator-() const { return mint() - *this; }\n    mint pow(ll n) const { assert(0 <= n); mint x = *this, r = 1; for(; n; n >>= 1, x *= x) if(n & 1) r *= x; return r; }\n    mint inv() const { auto eg = inv_gcd(_v, bt.m); assert(eg.first == 1); return eg.second; }\n    friend mint operator+(const mint& lhs, const mint& rhs) { return mint(lhs) += rhs; }\n    friend mint operator-(const mint& lhs, const mint& rhs) { return mint(lhs) -= rhs; }\n    friend mint operator*(const mint& lhs, const mint& rhs) { return mint(lhs) *= rhs; }\n    friend mint operator/(const mint& lhs, const mint& rhs) { return mint(lhs) /= rhs; }\n    friend bool operator==(const mint& lhs, const mint& rhs) { return lhs._v == rhs._v; }\n    friend bool operator!=(const mint& lhs, const mint& rhs) { return lhs._v != rhs._v; }\n  private:\n    uint _v;\n    static barrett bt;\n};\ntemplate<int id> barrett dynamic_modint<id>::bt = 998244353;\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n#define eb emplace_back\n#define fi first \n#define se second\n#define all(x) (x).begin(), (x).end()\n#define SZ(x) int((x).size())\n#define mid ((l + r) / 2)\n#define lc o * 2\n#define rc o * 2 + 1\n#define lch l, mid, lc\n#define rch mid + 1, r, rc\n#define cmi(a, b) (a = min(a, b))\n#define cma(a, b) (a = max(a, b))\n#define lb lower_bound\n#define ub upper_bound\n#define bs binary_search\n#define pop __builtin_popcount\n#define llpop __builtin_popcountll\n#define ctz __builtin_ctz\n#define llctz __builtin_ctzll\n#define clz __builtin_clz\n#define llclz __builtin_clzll\n#define par __builtin_parity\n#define llpar __builtin_parityll\n\nusing lf = double;\n// using P = pair<int, int>;\nusing V = vector<int>;\n// using cmp = complex<lf>;\n\nvoid solve() {\n    \n}\nint main() {\n    // ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n#ifdef local\n    // freopen(\".in\", \"r\", stdin);\n#endif\n    int T;\n    for(cin >> T; T--; solve());\n}\n```\n\n## \n\n### \n\n```cpp\nll gen(ll x) {\n    const ll k = 0x9ddfea08eb382d69ull;\n    rep(i, 1, 3) x *= k, x ^= x >> 47;\n    return x * k;\n}\nll rnd() {\n    static ll s = 2;\n    return (s += gen(s)) & LONG_LONG_MAX;\n}\n```\n\n##  \n\n### \n\n```cpp\nll mul(ll a, ll b, ll p) {\n    return (a * b - ll((long double)a / p * b + 0.5) * p + p) % p;\n}\n```\n\n### `bash` \n\n```bash\n#!/bin/bash\nwhile true; do\n    ./gen > in\n    ./a < in > 1\n    ./b < in > 2\n    diff 1 2\n    if [ $? -ne 0 ] ; then break; fi\ndone\n```\n\n## \n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n\nusing namespace std;\nusing ll = long long;\n\nll mul(ll a, ll b, ll p) {\n    return (a * b - ll((long double)a / p * b + 0.5) * p + p) % p;\n}\nll Pow(ll a, ll n, ll p, ll r = 1) {\n    for(; n; n /= 2, a = mul(a, a, p))\n    if(n & 1) r = mul(r, a, p);\n    return r;\n}\n\nnamespace Pollard_Rho {\n    int chk(ll n) {\n        for(ll a : {2, 3, 7, 61, 24251}) {\n            if(n == a) return 1;\n            if(Pow(a, n - 1, n) ^ 1) return 0;\n            ll k = n - 1, t;\n            while(~k & 1) k /= 2;\n            if((t = Pow(a, k, n)) == 1) continue;\n            while(t ^ 1 && t ^ n - 1) t = mul(t, t, n);\n            if(t ^ n - 1) return 0;\n        }\n        return 1;\n    }\n    ll f(ll x, ll c, ll p) { return (mul(x, x, p) + c) % p; }\n    ll PR(ll n) {\n        ll a = 0, b = 0, c = rand() % (n - 1) + 1, v = 1, g;\n        for(int k = 1; ; k *= 2, a = b, v = 1) {\n            rep(i, 1, k) {\n                b = f(b, c, n), v = mul(v, abs(a - b), n);\n                if(!(i & 127) || i == k) {\n                    g = __gcd(v, n);\n                    if(g > 1) return g;\n                }\n            }\n        }\n    }\n    ll ans[100]; int ct;\n    void solve(ll n) {\n        if(chk(n)) return void(ans[++ct] = n);\n        ll d; do d = PR(n); while(d == n);\n        solve(d), solve(n / d);\n    }\n    void work() {\n        ll n;\n        while(cin >> n) {\n            ct = 0;\n            if(chk(n)) { puts(\"Prime\"); continue; }\n            solve(n), sort(ans + 1, ans + ct + 1);\n            int t = 0;\n            rep(i, 1, ct) {\n                if(ans[i] ^ ans[i - 1]) cout << ans[i];\n                t++; if(ans[i] ^ ans[i + 1]) {\n                    if(t > 1) cout << '^' << t;\n                    putchar(32), t = 0;\n                }\n            } putchar(10);\n        }\n    }\n};\nnamespace Inv {\n    void exgcd(ll a, ll b, ll& d, ll& x, ll& y) {\n        if(b) exgcd(b, a % b, d, y, x), y -= a / b * x;\n        else d = a, x = 1, y = 0;\n    }\n    void inv(ll a, ll p) {\n        ll d, x, y; exgcd(a, p, d, x, y);\n        if(d > 1) puts(\"Non-existent!\");\n        else cout << (x % p + p) % p;\n    }\n    void work() {\n        ll a, p;\n        while(cin >> a >> p) inv(a, p);\n    }\n};\nnamespace Prime {\n    void work() {\n        ll n;\n        while(cin >> n) {\n            while(!Pollard_Rho::chk(n)) n++;\n            cout << n << endl;\n        }\n    }\n};\nnamespace Cipolla {\n    ll n, p, II;\n    struct cmp {\n        ll r, i;\n        cmp operator *(const cmp& b) {\n            return {(r * b.r + i * b.i % p * II) % p, (r * b.i + i * b.r) % p };\n        }\n    } U = { 1, 0 };\n    int pow1(ll a, int n, ll r = 1) {\n        for(; n; n /= 2, a = a * a % p)\n        if(n & 1) r = r * a % p;\n        return r;\n    }\n    cmp pow2(cmp a, int n, cmp r = U) {\n        for(; n; n /= 2, a = a * a)\n        if(n & 1) r = r * a;\n        return r;\n    }\n    void work() {\n        while(cin >> n >> p) {\n            if(!n) { puts(\"0\"); continue; }\n            if(p == 2) { cout << n << endl; continue; }\n            if(pow1(n, p / 2) ^ 1) { puts(\"Non-existent!\"); continue; }\n            ll a;\n            do a = rand() % p, II = (a * a - n + p) % p; while(!a || pow1(II, p / 2) == 1);\n            int x1 = pow2({a, 1}, p / 2 + 1).r, x2 = p - x1;\n            if(x1 > x2) swap(x1, x2);\n            printf(\"%d %d\\n\", x1, x2);\n        }\n    }\n}; \nint main() {\n    srand(time(0));\n    puts(\"Press 1 for integer factorization.\");\n    puts(\"Press 2 to calculate the modular multiplicative inverse of a number.\");\n    puts(\"Press 3 to find the first prime number greater than or equal to a number.\");\n    puts(\"Press 4 to calculate the modular square root of a number.\");\n    int op;\n    while(1) {\n        cin >> op;\n        if(op == 1) Pollard_Rho::work();\n        else if(op == 2) Inv::work();\n        else if(op == 3) Prime::work();\n        else if(op == 4) Cipolla::work();\n        else puts(\"Illegal input! Please re-enter your option.\");\n    }\n}\n```\n\n# \n\n## NTT\n\n### \n\n#### \n\n```cpp\nint lim = 1, bit = -1, rev[N];\n```\n\n#### \n\n```cpp\nll Pow(ll a, int n, ll r = 1) {\n    for(; n; n /= 2, a = a * a % P)\n    if(n & 1) r = r * a % P;\n    return r;\n}\nvoid NTT(ll a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(rev[i] < i) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2) {\n        ll wn = Pow(3, P / 2 / i);\n        for(int j = 0; j < lim; j += i * 2) {\n            ll w = 1;\n            For(k, j, j + i) {\n                ll &x = a[k], y = a[k + i] * w % P;\n                a[k + i] = (x - y) % P, (x += y) %= P, w = w * wn % P;\n            }\n        }\n    }\n    ll inv = Pow(lim, P - 2);\n    if(t) For(i, 0, lim) (a[i] *= inv) %= P;\n}\n```\n\n`modint` \n\n```cpp\nvoid NTT(mint a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(rev[i] < i) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2) {\n        mint wn = mint(3).pow(P / 2 / i);\n        for(int j = 0; j < lim; j += i * 2) {\n            mint w = 1;\n            For(k, j, j + i) {\n                mint &x = a[k], y = a[k + i] * w;\n                a[k + i] = x - y, x += y, w *= wn;\n            }\n        }\n    }\n    mint inv = mint(lim).inv();\n    if(t) For(i, 0, lim) a[i] *= inv;\n}\n```\n\n#### \n\n```cpp\nwhile(lim <= n + m) lim *= 2, bit++;\nFor(i, 0, lim) rev[i] = rev[i / 2] / 2 | (i & 1) << bit;\n```\n\n### \n\n#### \n\n```cpp\nll w[N];\nint lim = 1, bit = -1, rev[N]; \n```\n\n`modint` \n\n```cpp\nmint w[N];\nint lim = 1, bit = -1, rev[N]; \n```\n\n#### \n\n```cpp\nvoid mod(ll& x) { if(x >= P) x -= P; if(x < 0) x += P; }\nll Pow(ll a, int n, ll r = 1) {\n    for(; n; n /= 2, a = a * a % P)\n    if(n & 1) r = r * a % P;\n    return r;\n}\nvoid NTT(ll a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(rev[i] < i) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2)\n    for(int j = 0; j < lim; j += i * 2) For(k, j, j + i) {\n        ll &x = a[k], y = a[k + i] * w[lim / i * (k - j)] % P;\n        mod(a[k + i] = x - y), mod(x += y);\n    }\n    ll inv = Pow(lim, P - 2);\n    if(t) For(i, 0, lim) (a[i] *= inv) %= P;\n}\n```\n\n`modint` \n\n```cpp\nvoid NTT(mint a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(rev[i] < i) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2)\n    for(int j = 0; j < lim; j += i * 2) For(k, j, j + i) {\n        mint &x = a[k], y = a[k + i] * w[lim / i * (k - j)];\n        a[k + i] = x - y, x += y;\n    }\n    mint inv = mint(lim).inv();\n    if(t) For(i, 0, lim) a[i] *= inv;\n}\n```\n\n#### \n\n```cpp\nwhile(lim <= n + m) lim *= 2, bit++;\nll wn = Pow(3, P / 2 / lim);\nFor(i, 0, lim) {\n    rev[i] = rev[i / 2] / 2 | (i & 1) << bit;\n    w[i] = i ? w[i - 1] * wn % P : 1;\n}\n```\n\n`modint` \n\n```cpp\nwhile(lim <= n + m) lim *= 2, bit++;\nmint wn = mint(3).pow(P / 2 / lim);\nFor(i, 0, lim) {\n    rev[i] = rev[i / 2] / 2 | (i & 1) << bit;\n    w[i] = i ? w[i - 1] * wn : 1;\n}\n```\n\n##  NTT\n\n### \n\n```cpp\nusing cmp = complex<lf>;\nconst lf PI = acos(-1);\nconst cmp I(0, 1);\n\nint n, m, P;\nint M, lim = 1, bit = -1, rev[N];\ncmp w[N], a0[N], a1[N], b0[N], b1[N];\n```\n\n`modint` \n\n```cpp\nusing cmp = complex<lf>;\nconst lf PI = acos(-1);\n\nint n, m, P;\nint M, lim = 1, bit = -1, rev[N];\ncmp w[N], a0[N], a1[N], b0[N], b1[N];\n```\n\n### \n\n```cpp\nvoid FFT(cmp a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(i < rev[i]) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2) for(int j = 0; j < lim; j += i * 2) For(k, j, j + i) {\n        cmp &x = a[k], y = a[i + k] * w[lim / i * (k - j)];\n        a[i + k] = x - y, x += y;\n    }\n    lf inv = 1. / lim;\n    if(t) For(i, 0, lim) a[i] *= inv;\n}\nvoid FFT2(cmp a[], cmp b[]) {\n    For(i, 0, lim) a[i] += b[i] * I;\n    FFT(a, 0);\n    For(i, 0, lim) b[i] = conj(a[i ? lim - i : 0]);\n    For(i, 0, lim) {\n        cmp x = a[i], y = b[i];\n        a[i] = (y + x) * 0.5, b[i] = (y - x) * 0.5 * I;\n    }\n}\nll num(cmp x) { return M * ll(real(x) + 0.5) % P + ll(imag(x) + 0.5); }\n```\n\n`modint` \n\n```cpp\nvoid FFT(cmp a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(i < rev[i]) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2) for(int j = 0; j < lim; j += i * 2) For(k, j, j + i) {\n        cmp &x = a[k], y = a[i + k] * w[lim / i * (k - j)];\n        a[i + k] = x - y, x += y;\n    }\n    lf inv = 1. / lim;\n    if(t) For(i, 0, lim) a[i] *= inv;\n}\nvoid FFT2(cmp a[], cmp b[]) {\n    For(i, 0, lim) a[i] += b[i] * 1i;\n    FFT(a, 0);\n    For(i, 0, lim) b[i] = conj(a[i ? lim - i : 0]);\n    For(i, 0, lim) {\n        cmp x = a[i], y = b[i];\n        a[i] = (y + x) * 0.5, b[i] = (y - x) * 0.5i;\n    }\n}\nmint num(cmp x) { return M * (mint)ll(real(x) + 0.5) % P + (mint)ll(imag(x) + 0.5); }\n```\n\n### \n\n```cpp\nM = sqrt(P);\nrep(i, 0, n) a0[i] = A[i] / M, a1[i] = A[i] % M;\nrep(i, 0, m) b0[i] = B[i] / M, b1[i] = B[i] % M;\nwhile(lim <= n + m) lim *= 2, bit++;\nFor(i, 0, lim) {\n    rev[i] = rev[i / 2] / 2 | (i & 1) << bit;\n    w[i] = cmp(cos(PI / lim * i), sin(PI / lim * i));\n}\n```\n\n### \n\n```cpp\nFFT2(a0, a1), FFT2(b0, b1);\nFor(i, 0, lim) {\n    cmp t = a0[i] + I * a1[i];\n    b0[i] *= t, b1[i] *= t;\n}\nFFT(b0, 1), FFT(b1, 1);\nrep(i, 0, n + m) C[i] = (M * num(b0[i]) + num(b1[i])) % P;\n```\n\n`modint` \n\n```cpp\nFFT2(a0, a1), FFT2(b0, b1);\nFor(i, 0, lim) {\n    cmp t = a0[i] + I * a1[i];\n    b0[i] *= t, b1[i] *= t;\n}\nFFT(b0, 1), FFT(b1, 1);\nrep(i, 0, n + m) C[i] = M * num(b0[i]) + num(b1[i]);\n```\n\n## FWT\n\n### \n\n```cpp\nvoid FWT(ll a[]) {\n    For(i, 0, n) For(S, 0, 1 << n) if(S >> i & 1) {\n        ll& x = a[S ^ 1 << i], y = a[S];\n        a[S] = x - y, x += y;\n    }\n}\nvoid IFWT(ll a[]) {\n    For(i, 0, n) For(S, 0, 1 << n) if(S >> i & 1) {\n        ll& x = a[S ^ 1 << i], y = a[S];\n        a[S] = x - y >> 1, x = x + y >> 1;\n    }\n}\n```\n\n## \n\n### \n\n```cpp\nint n, lim, rev[N];\n```\n\n### \n\n```cpp\nll Pow(ll a, int n, ll r = 1) {\n    for(; n; n /= 2, a = a * a % P)\n    if(n & 1) r = r * a % P;\n    return r;\n}\nvoid bld(int n) {\n    lim = 1 << n--;\n    For(i, 0, lim) rev[i] = rev[i / 2] / 2 | (i & 1) << n;\n}\nvoid NTT(ll a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(i < rev[i]) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2) {\n        ll wn = Pow(g, P / 2 / i);\n        for(int j = 0; j < lim; j += i * 2) {\n            ll w = 1;\n            For(k, j, j + i) {\n                ll &x = a[k], y = a[k + i] * w % P;\n                a[k + i] = (x - y) % P, (x += y) %= P, w = w * wn % P;\n            }\n        }\n    }\n    ll inv = Pow(lim, P - 2);\n    if(t) For(i, 0, lim) (a[i] *= inv) %= P;\n}\nvoid Inv(ll a[], ll b[], int n) {\n    static ll c[N];\n    For(i, 0, 2 << n) b[i] = c[i] = 0;\n    b[0] = Pow(a[0], P - 2);\n    rep(i, 1, n) {\n        For(j, 0, 1 << i) c[j] = a[j];\n        bld(i + 1), NTT(c, 0), NTT(b, 0);\n        For(j, 0, lim) b[j] = (b[j] * 2 - b[j] * b[j] % P * c[j]) % P;\n        NTT(b, 1);\n        For(j, 1 << i, lim) b[j] = 0;\n    }\n}\n```\n\n`modint` \n\n```cpp\nvoid bld(int n) {\n    lim = 1 << n--;\n    For(i, 0, lim) rev[i] = rev[i / 2] / 2 | (i & 1) << n;\n}\nvoid NTT(mint a[], int t) {\n    if(t) reverse(a + 1, a + lim);\n    For(i, 0, lim) if(rev[i] < i) swap(a[i], a[rev[i]]);\n    for(int i = 1; i < lim; i *= 2) {\n        mint wn = mint(3).pow(P / 2 / i);\n        for(int j = 0; j < lim; j += i * 2) {\n            mint w = 1;\n            For(k, j, j + i) {\n                mint &x = a[k], y = a[k + i] * w;\n                a[k + i] = x - y, x += y, w *= wn;\n            }\n        }\n    }\n    mint inv = mint(lim).inv();\n    if(t) For(i, 0, lim) a[i] *= inv;\n}\nvoid Inv(mint a[], mint b[], int n) {\n    static mint c[N];\n    For(i, 0, 2 << n) b[i] = c[i] = 0;\n    b[0] = a[0].inv();\n    rep(i, 1, n) {\n        For(j, 0, 1 << i) c[j] = a[j];\n        bld(i + 1), NTT(c, 0), NTT(b, 0);\n        For(j, 0, lim) b[j] = b[j] * 2 - b[j] * b[j] * c[j];\n        NTT(b, 1);\n        For(j, 1 << i, lim) b[j] = 0;\n    }\n}\n```\n\n## \n\n## \n\n## \n\n```cpp\nll mul(ll a, ll b, ll p) {\n    return (a * b - (ll)((long double)a / p * b + 0.5) * p + p) % p;\n}\nvoid exgcd(ll a, ll b, ll& d, ll& x, ll& y) {\n    if(!b) { d = a, x = 1, y = 0; return; }\n    exgcd(b, a % b, d, y, x), y -= a / b * x;\n}\nvoid exCRT(ll& b1, ll& m1, ll b2, ll m2) {\n    ll d, k1, k2; exgcd(m1, m2, d, k1, k2), m2 /= d;\n    b1 = (b1 + mul(mul(k1 % m2, (b2 - b1) / d % m2, m2), m1, m1 * m2)) % (m1 *= m2);\n}\n```\n\n## \n\n## Min-25 \n\n### \n\n```cpp\nll f1[N], f2[N];\n```\n\n### \n\n```cpp\nll min25(ll n) {\n    int lim = sqrt(n);\n    rep(i, 1, lim) f1[i] = i - 1, f2[i] = n / i - 1;\n    rep(p, 2, lim) if (f1[p] ^ f1[p - 1]) {\n        int w1 = lim / p;\n        ll x = f1[p - 1], w3 = (ll)p * p, w2 = min((ll)lim, n / w3), d = n / p;\n        rep(i, 1, w1) f2[i] -= f2[i * p] - x;\n        rep(i, w1 + 1, w2) f2[i] -= f1[d / i] - x;\n        per(i, lim, w3) f1[i] -= f1[i / p] - x;\n    }\n    return f2[1];\n}\n```\n\n## exBSGS\n\n### \n\n```cpp\nmap<int, int> mp;\n```\n\n### \n\n```cpp\nint BSGS(ll pls, ll a, ll b, ll p) {\n    pls %= p, a %= p, b %= p; mp.clear();\n    ll m = ceil(sqrt(p)), ls = 1, rs = 1;\n    For(i, 0, m) mp[ls * b % p] = i, ls = ls * a % p;\n    rep(i, 1, m) {\n        rs = rs * ls % p;\n        if(mp.count(rs * pls % p)) return i * m - mp[rs * pls % p];\n    }\n    return -1;\n}\nint exBSGS(ll a, ll b, ll p) {\n    a %= p, b %= p;\n    int pls = 1, ct = 0, g;\n    while((g = __gcd(a, p)) > 1) {\n        if(b == 1) return ct;\n        p /= g, pls = pls * a / g % p, ct++;\n        if(b % g) return -1; b /= g;\n    }\n    int ret = BSGS(pls, a, b, p);\n    return ~ret ? ret + ct : -1;\n}\n```\n\n## cipolla\n\n### \n\n```cpp\nint n; ll II;\nstruct cmp {\n    ll r, i;\n    cmp operator *(const cmp& b) {\n        return {(r * b.r + i * b.i % P * II) % P, (r * b.i + i * b.r) % P};\n    }\n} U = {1, 0};\n```\n\n`modint` \n\n```cpp\nmint n, II;\nstruct cmp {\n    mint r, i;\n    cmp operator *(const cmp& b) {\n        return {r * b.r + i * b.i * II, r * b.i + i * b.r};\n    }\n} U = {1, 0};\n```\n\n### \n\n```cpp\nint pow1(ll a, int n, ll r = 1) {\n    for(; n; n /= 2, a = a * a % P)\n    if(n & 1) r = r * a % P;\n    return r;\n}\ncmp pow2(cmp a, int n, cmp r = U) {\n    for(; n; n /= 2, a = a * a)\n    if(n & 1) r = r * a;\n    return r;\n}\nint cipolla(int n) {\n    if(!n) return 0;\n    if(P == 2) return n;\n    if(pow1(n, P / 2) ^ 1) return -1;\n    ll a;\n    do a = rand() % P, II = (a * a - n + P) % P; while(!a || pow1(II, P / 2) == 1);\n    return pow2({a, 1}, P / 2 + 1).r;\n}\n```\n\n`modint` \n\n```cpp\ncmp Pow(cmp a, int n, cmp r = U) {\n    for(; n; n /= 2, a = a * a)\n    if(n & 1) r = r * a;\n    return r;\n}\nint cipolla(mint n) {\n    if(n == 0) return 0;\n    if(P == 2) return n.val();\n    if(n.pow(P / 2) != 1) return -1;\n    mint a;\n    do a = rand(), II = a * a - n; while(a == 0 || II.pow(P / 2) == 1);\n    return Pow({a, 1}, P / 2 + 1).r.val();\n}\n```\n\n## Miller Rabin & Pollard Rho\n\n### \n\n```cpp\nvector<ll> as;\n```\n\n### \n\n```cpp\nll mul(ll a, ll b, ll p) {\n    return (a * b - ll((long double)a / p * b + 0.5) * p + p) % p;\n}\nll Pow(ll a, ll n, ll p, ll r = 1) {\n    for(; n; n /= 2, a = mul(a, a, p))\n    if(n & 1) r = mul(r, a, p);\n    return r;\n}\nint chk(ll n) {\n    for(ll a : {2, 3, 7, 61, 24251}) {\n        if(n == a) return 1;\n        if(Pow(a, n - 1, n) ^ 1) return 0;\n        ll k = n - 1, t;\n        while(~k & 1) k /= 2;\n        if((t = Pow(a, k, n)) == 1) continue;\n        while(t ^ 1 && t ^ n - 1) t = mul(t, t, n);\n        if(t ^ n - 1) return 0;\n    }\n    return 1;\n}\nll f(ll x, ll c, ll p) { return (mul(x, x, p) + c) % p; }\nll PR(ll n) {\n    ll a = 0, b = 0, c = rand() % (n - 1) + 1, v = 1, g;\n    for(int k = 1; ; k *= 2, a = b, v = 1) {\n        rep(i, 1, k) {\n            b = f(b, c, n), v = mul(v, abs(a - b), n);\n            if(!(i & 127) || i == k) {\n                g = __gcd(v, n);\n                if(g > 1) return g;\n            }\n        }\n    }\n}\nvoid solve(ll n) {\n    if(chk(n)) return as.pb(n);\n    ll d; do d = PR(n); while(d == n);\n    solve(d), solve(n / d);\n}\n```\n\n# \n\n## \n\n### \n\n#### \n\n```cpp\nint c[N][2], f[N], r[N];\n```\n\n#### \n\n```cpp\nint id(int o) { return c[f[o]][1] == o; }\nint nrt(int o) { return f[o] && c[f[o]][id(o)] == o; }\nvoid pu(int o) {\n    \n}\nvoid flip(int o) {\n    swap(c[o][0], c[o][1]), r[o] ^= 1;\n}\nvoid pd(int o) { if(r[o]) flip(c[o][0]), flip(c[o][1]), r[o] = 0; }\nvoid rot(int o, int d) {\n    int k = c[o][!d], &x = c[k][d];\n    if(nrt(o)) c[f[o]][id(o)] = k;\n    pu(x = f[c[o][!d] = x] = o), f[k] = f[o], pu(f[o] = k);\n}\nvoid dfs(int o) { if(nrt(o)) dfs(f[o]); pd(o); }\nvoid splay(int o) {\n    dfs(o);\n    for(int fa; nrt(o); rot(f[o], !id(o)))\n    if(nrt(fa = f[o])) rot(id(o) ^ id(fa) ? fa : f[fa], !id(o));\n}\nvoid acc(int o) {\n    for(int x = 0; o; o = f[x = o])\n        splay(o), c[o][1] = x, pu(o);\n}\nvoid mkrt(int o) { acc(o), splay(o), flip(o); }\nvoid link(int u, int v) {\n    mkrt(u), acc(v), splay(v), pu(f[u] = v);\n}\nvoid cut(int u, int v) {\n    mkrt(u), acc(v), splay(v), c[v][0] = f[u] = 0, pu(v);\n}\n```\n\n###  ```size``` \n\n#### \n\n```cpp\nint c[N][2], f[N], r[N], s[N], si[N];\n```\n\n#### \n\n```cpp\nint id(int o) { return c[f[o]][1] == o; }\nint nrt(int o) { return f[o] && c[f[o]][id(o)] == o; }\nvoid pu(int o) {\n    s[o] = s[c[o][0]] + s[c[o][1]] + si[o] + 1;\n}\nvoid flip(int o) {\n    swap(c[o][0], c[o][1]), r[o] ^= 1;\n}\nvoid pd(int o) { if(r[o]) flip(c[o][0]), flip(c[o][1]), r[o] = 0; }\nvoid rot(int o, int d) {\n    int k = c[o][!d], &x = c[k][d];\n    if(nrt(o)) c[f[o]][id(o)] = k;\n    pu(x = f[c[o][!d] = x] = o), f[k] = f[o], pu(f[o] = k);\n}\nvoid dfs(int o) { if(nrt(o)) dfs(f[o]); pd(o); }\nvoid splay(int o) {\n    dfs(o);\n    for(int fa; nrt(o); rot(f[o], !id(o)))\n    if(nrt(fa = f[o])) rot(id(o) ^ id(fa) ? fa : f[fa], !id(o));\n}\nvoid acc(int o) {\n    for(int x = 0; o; o = f[x = o])\n        splay(o), si[o] += s[c[o][1]] - s[x], c[o][1] = x, pu(o);\n}\nvoid mkrt(int o) { acc(o), splay(o), flip(o); }\nvoid link(int u, int v) {\n    mkrt(u), acc(v), splay(v), si[v] += s[u], pu(f[u] = v);\n}\nvoid cut(int u, int v) {\n    mkrt(u), acc(v), splay(v), c[v][0] = f[u] = 0, pu(v);\n}\n```\n\n## RBS \n\n### \n\n#### \n\n```cpp\nint rt, sz, ls[N], rs[N], c[N], s[N];\n```\n\n#### \n\n```cpp\nll gen(ll x) {\n    const ll k = 0x9ddfea08eb382d69ull;\n    rep(i, 1, 3) x *= k, x ^= x >> 47;\n    return x * k;\n}\nint rnd() {\n    static ll s = 2;\n    return (s += gen(s)) & INT_MAX;\n}\nint pu(int o) { s[o] = s[ls[o]] + s[rs[o]] + 1; return o; }\nvoid bld(int l, int r, int& o) {\n    if(l > r) return;\n    int mid = l + r >> 1;\n    c[o = ++sz] = a[mid];\n    bld(l, mid - 1, ls[o]), bld(mid + 1, r, rs[o]), pu(o); \n}\nvoid spt(int o, int x, int& u, int& v) {\n    if(!o) u = v = 0;\n    else if(x < c[o]) spt(ls[v = o], x, u, ls[o]), pu(o);\n    else spt(rs[u = o], x, rs[o], v), pu(o);\n}\nint mrg(int u, int v) {\n    if(!u || !v) return u + v;\n    if(rnd() % (s[u] + s[v]) < s[u])\n        return rs[u] = mrg(rs[u], v), pu(u);\n    return ls[v] = mrg(u, ls[v]), pu(v);\n}\nvoid ins(int& o, int x) {\n    if(rnd() % (s[o] + 1) == 0)\n        c[++sz] = x, spt(o, x, ls[sz], rs[sz]), pu(o = sz);\n    else ins(x < c[o] ? ls[o] : rs[o], x), pu(o);\n}\nvoid rmv(int& o, int x) {\n    int t1, t2, t3;\n    spt(o, x, t1, t3), spt(t1, x - 1, t1, t2);\n    o = mrg(mrg(t1, mrg(ls[t2], rs[t2])), t3);\n}\nint rk(int o, int x, int re = 1) {\n    while(o) o = x > c[o] ? re += s[ls[o]] + 1, rs[o] : ls[o]; \n    return re;\n}\nint kth(int o, int k) {\n    while(k != s[ls[o]] + 1)\n        o = k > s[ls[o]] ? k -= s[ls[o]] + 1, rs[o] : ls[o];\n    return c[o];\n}\nint pre(int o, int x, int re = -Inf) {\n    while(o) o = x > c[o] ? re = max(re, c[o]), rs[o] : ls[o];\n    return re;\n}\nint suf(int o, int x, int re = Inf) {\n    while(o) o = x < c[o] ? re = min(re, c[o]), ls[o] : rs[o];\n    return re;\n}\n```\n\n### \n\n```cpp\n#include <cstdio>\n#include <limits>\n#include <vector>\nusing namespace std;\n\ntypedef long long int64;\n\ninline int64 Fingerprint(int64 x) {\n    const int64 kMul = 0x9ddfea08eb382d69ULL;\n    x *= kMul, x ^= x >> 47;\n    x *= kMul, x ^= x >> 47;\n    x *= kMul, x ^= x >> 47;\n    return x * kMul;\n}\n\ninline int64 Random() {\n    static int64 Seed = 2;\n    Seed += Fingerprint(Seed);\n    return Seed & numeric_limits<int64>::max();\n}\n\ntypedef int DataType;\n\nstruct RBST {\n    RBST *ChildL, *ChildR;\n    int Size;\n    DataType Data;\n\n    RBST() { ChildL = ChildR = 0; }\n};\n\nint GetSize(const RBST* root) { return root ? root->Size : 0; }\n\nint LowerBoundIndex(const RBST* root, DataType x) {\n    if (!root) return 0;\n    if (x <= root->Data) return LowerBoundIndex(root->ChildL, x);\n    int sizeL = GetSize(root->ChildL);\n    return LowerBoundIndex(root->ChildR, x) + sizeL + 1;\n}\n\nDataType Select(const RBST* root, int index) {\n    int sizeL = GetSize(root->ChildL);\n    if (index == sizeL) return root->Data;\n    if (index < sizeL) return Select(root->ChildL, index);\n    return Select(root->ChildR, index - sizeL - 1);\n}\n\nRBST* SetSize(RBST* root) {\n    root->Size = GetSize(root->ChildL) + GetSize(root->ChildR) + 1;\n    return root;\n}\n\nstruct RBSTree {\n    vector<RBST*> Nodes;\n\n    RBST* NewNode(RBST* node) {\n        Nodes.push_back(new RBST(*node));\n        return Nodes.back();\n    }\n\n    void Split(RBST* root, DataType x, RBST*& treeL, RBST*& treeR) {\n        if (!root) {\n            treeL = treeR = 0;\n        } else if (x <= root->Data) {\n            RBST *newRoot = NewNode(root);\n            Split(root->ChildL, x, treeL, newRoot->ChildL);\n            treeR = SetSize(newRoot);\n        } else {\n            RBST* newRoot = NewNode(root);\n            Split(root->ChildR, x, newRoot->ChildR, treeR);\n            treeL = SetSize(newRoot);\n        }\n    }\n\n    RBST* Join(RBST* treeL, RBST* treeR) {\n        int sizeL = GetSize(treeL);\n        int sizeR = GetSize(treeR);\n        int size = sizeL + sizeR;\n        if (size == 0) return 0;\n        if (Random() % size < sizeL) {\n            RBST* newRoot = NewNode(treeL);\n            newRoot->ChildR = Join(treeL->ChildR, treeR);\n            return SetSize(newRoot);\n        } else {\n            RBST* newRoot = NewNode(treeR);\n            newRoot->ChildL = Join(treeL, treeR->ChildL);\n            return SetSize(newRoot);\n        }\n    }\n\n    RBST* InsertAsRoot(RBST* root, DataType item) {\n        Nodes.push_back(new RBST);\n        RBST *newRoot = Nodes.back();\n        newRoot->Data = item;\n        Split(root, item + 1, newRoot->ChildL, newRoot->ChildR);\n        return SetSize(newRoot);\n    }\n\n    RBST* Insert(RBST* root, DataType item) {\n        if (Random() % (GetSize(root) + 1) == 0) {\n            return InsertAsRoot(root, item);\n        } else if (item < root->Data) {\n            RBST *newRoot = NewNode(root);\n            newRoot->ChildL = Insert(root->ChildL, item);\n            return SetSize(newRoot);\n        } else {\n            RBST *newRoot = NewNode(root);\n            newRoot->ChildR = Insert(root->ChildR, item);\n            return SetSize(newRoot);\n        }\n    }\n\n    RBST* Remove(RBST* root, DataType item) {\n        RBST *tree1, *tree2, *tree3, *tree4 = 0;\n        Split(root, item, tree1, tree2);\n        Split(tree2, item + 1, tree2, tree3);\n        if (tree2) tree4 = Join(tree2->ChildL, tree2->ChildR);\n        return Join(Join(tree1, tree4), tree3);\n    }\n\n    void Destroy() {\n        for (int i = 0; i < Nodes.size(); ++i) delete Nodes[i];\n    }\n};\n```\n\n## K-D \n\n### \n\n```cpp\n#define mid ((l + r) / 2)\n#define lc o * 2\n#define rc o * 2 + 1\n#define lch l, mid, lc\n#define rch mid + 1, r, rc\n\nint D, L[N * 4][K], R[N * 4][K];\nstruct node {\n    int x[K];\n    void read() { For(i, 0, K) scanf(\"%d\", &x[i]); }\n    bool operator <(const node& b)const {\n        return x[D] < b.x[D];\n    }\n} a[N];\n```\n\n### \n\n```cpp\nlf sq(lf x) { return x * x; }\nvoid pu(int o) {\n    rep(i, 0, 1) {\n        L[o][i] = min(L[lc][i], L[rc][i]);\n        R[o][i] = max(R[lc][i], R[rc][i]);\n    }\n}\nvoid bld(int l, int r, int o) {\n    if(l == r) {\n        For(i, 0, K) L[o][i] = R[o][i] = a[l].x[i];\n        return;\n    }\n    lf va[K] = {};\n    For(i, 0, K) {\n        lf av = 0;\n        rep(j, l, r) av += a[j].x[i];\n        av /= r - l + 1;\n        rep(j, l, r) va[i] += sq(a[j].x[i] - av);\n    }\n    D = max_element(va, va + K) - va;\n    nth_element(a + l, a + mid, a + r + 1);\n    bld(lch), bld(rch), pu(o);\n}\n```\n\n### \n\n```cpp\nll sq(int x) { return 1ll * x * x; }\nll mine(int o, int x[], ll re = 0) {\n    For(i, 0, K) re += sq(max(L[o][i] - x[i], 0)) + sq(max(x[i] - R[o][i], 0));\n    return re;\n}\nll maxe(int o, int x[], ll re = 0) {\n    For(i, 0, K) re += max(sq(x[i] - L[o][i]), sq(x[i] - R[o][i]));\n    return re;\n}\n```\n\n### \n\n```cpp\nint minm(int o, int x[], int re = 0) {\n    For(i, 0, K) re += max(L[o][i] - x[i], 0) + max(x[i] - R[o][i], 0);\n    return re;\n}\nint maxm(int o, int x[], int re = 0) {\n    For(i, 0, K) re += max(abs(x[i] - L[o][i]), abs(x[i] - R[o][i]));\n    return re;\n}\n```\n\n### \n\n```cpp\nint minc(int o, int x[], int re = Inf) {\n    For(i, 0, K) re = max(re, max(L[o][i] - x[i], 0) + max(x[i] - R[o][i], 0));\n    return re;\n}\nint maxc(int o, int x[], int re = 0) {\n    For(i, 0, K) re = max({re, abs(x[i] - L[o][i]), abs(x[i] - R[o][i])});\n    return re;\n}\n```\n\n### \n\n#### \n\n```cpp\nll res;\n```\n\n#### \n\n```cpp\nvoid qry(int x[], int l, int r, int o) {\n    if(l == r) return void(res = mine(o, x));\n    ll dl = mine(lc, x), dr = mine(rc, x);\n    if(dl < dr) {\n        if(dl < res) qry(x, lch);\n        if(dr < res) qry(x, rch);\n    } else {\n        if(dr < res) qry(x, rch);\n        if(dl < res) qry(x, lch);\n    }\n}\n```\n\n#### \n\n```cpp\nres = Inf;\n```\n### \n\n#### \n\n```cpp\nll res;\n```\n\n#### \n\n```cpp\nvoid qry(int x[], int l, int r, int o) {\n    if(l == r) return void(res = maxe(o, x));\n    ll dl = maxe(lc, x), dr = maxe(rc, x);\n    if(dl > dr) {\n        if(dl > res) qry(x, lch);\n        if(dr > res) qry(x, rch);\n    } else {\n        if(dr > res) qry(x, rch);\n        if(dl > res) qry(x, lch);\n    }\n}\n```\n\n#### \n\n```cpp\nres = 0;\n```\n\n### \n\n#### \n\n```cpp\nint chk1(int l[], int r[], int o, int re = 1) {\n    For(i, 0, K) re &= l[i] <= L[o][i] && R[o][i] <= r[i];\n    return re;\n}\n```\n\n#### \n\n```cpp\nint chk2(int l[], int r[], int o, int re = 1) {\n    For(i, 0, K) re &= max(l[i], L[o][i]) <= min(r[i], R[o][i]);\n    return re;\n}\n```\n\n### \n\n#### \n\n```cpp\nint chk1(int x[], int r, int o) {\n    return maxe(x, o) <= 1ll * r * r;\n}\n```\n\n#### \n\n```cpp\nint chk2(int x[], int r, int o) {\n    return mine(x, o) <= 1ll * r * r;\n}\n```\n\n# \n\n## \n\n### `vector` \n\n#### \n\n```cpp\nint n, a[N], tp, stk[N];\nint idx, dfn[N], d[N], fa[20][N];\nvector<int> G[N], T[N];\n```\n\n#### \n\n```cpp\nvoid dfs(int u) {\n    dfn[u] = ++idx;\n    rep(i, 1, 19) fa[i][u] = fa[i - 1][fa[i - 1][u]];\n    for(int v : G[u]) if(v ^ fa[0][u])\n        d[v] = d[u] + 1, fa[0][v] = u, dfs(v);\n}\nint lca(int u, int v) {\n    if(d[u] < d[v]) swap(u, v);\n    rep(i, 0, 19) if(d[u] - d[v] >> i & 1) u = fa[i][u];\n    if(u == v) return u;\n    per(i, 19, 0) if(fa[i][u] ^ fa[i][v]) u = fa[i][u], v = fa[i][v];\n    return fa[0][u];\n}\nvoid bld(int k) {\n    sort(a + 1, a + k + 1, [](int a, int b) { return dfn[a] < dfn[b]; });\n    stk[++tp] = 1;\n    rep(i, 1, k) if(a[i] > 1) {\n        int x = lca(a[i], stk[tp]);\n        while(d[stk[tp]] > d[x]) tp--, T[d[stk[tp]] > d[x] ? stk[tp] : x].pb(stk[tp + 1]);\n        if(stk[tp] ^ x) stk[++tp] = x;\n        stk[++tp] = a[i];\n    }\n    while(--tp) T[stk[tp]].pb(stk[tp + 1]);\n}\nvoid clr(int u) {\n    for(int v : G[u]) clr(v); T[u].clear();\n}\n```\n\n### \n\n#### \n\n```cpp\nint n, a[N], p, stk[N];\nint d[N], fa[N], sz[N], son[N], tp[N], idx, dfn[N];\nvector<int> G[N];\nint eid, he[N];\nstruct edge { int v, nx; } e[N * 2];\n```\n\n#### \n\n```cpp\nvoid dfs(int u) {\n    sz[u] = 1;\n    for(int v : G[u]) {\n        d[v] = d[u] + 1, dfs(v), sz[u] += sz[v];\n        if(sz[v] > sz[son[u]]) son[u] = v;\n    }\n}\nvoid Dfs(int u, int top) {\n    tp[u] = top, dfn[u] = ++idx;\n    if(son[u]) Dfs(son[u], top);\n    for(int v : G[u]) if(v ^ son[u]) Dfs(v, v);\n}\nint lca(int u, int v) {\n    for(; tp[u] ^ tp[v]; d[tp[u]] > d[tp[v]] ? u = fa[tp[u]] : v = fa[tp[v]]);\n    return d[u] < d[v] ? u : v;\n}\nvoid add(int u, int v, int t = 1) {\n    e[++eid] = {v, h1[u]}, h1[u] = eid;\n}\nvoid bld(int k) {\n    sort(a + 1, a + k + 1, [](int a, int b) { return dfn[a] < dfn[b]; });\n    stk[++p] = 1;\n    rep(i, 1, k) if(a[i] > 1) {\n        int x = lca(a[i], stk[p]);\n        while(d[stk[p]] > d[x])\n            p--, add(d[stk[p]] > d[x] ? stk[p] : x, stk[p + 1]);\n        if(stk[p] ^ x) stk[++p] = x;\n        stk[++p] = a[i];\n    }\n    while(--p) add(stk[p], stk[p + 1]);\n}\n```\n\n##  ```LCA```\n\n### \n\n```cpp\nint dl[N], dr[N], fa[20][N];\n```\n\n### \n\n```cpp\nint lca(int u, int v) {\n    if(dl[u] < dl[v]) swap(u, v);\n    if(dl[v] <= dl[u] && dl[u] < dr[v]) return v;\n    per(i, 19, 0) {\n        int x = fa[i][u];\n        if(x && dl[x] > dl[v]) u = x;\n    }\n    return fa[0][u];\n}\n```\n\n## \n\n### ```int``` \n\n#### \n\n```cpp\nint n, m, s, t;\nint eid = 1, he[N], nw[N], d[N], q[N];\nstruct edge { int v, nx, c; } e[M * 2];\n```\n\n#### \n\n```cpp\nvoid add(int u, int v, int c) {\n    e[++eid] = {v, he[u], c}, he[u] = eid;\n    e[++eid] = {u, he[v], 0}, he[v] = eid;\n}\nint bfs() {\n    mem(d, 0), memcpy(nw, he, sizeof he);\n    q[1] = s, d[s] = 1;\n    for(int l = 1, r = 1; l <= r; l++) {\n        int u = q[l];\n        for(int i = he[u], v; v = e[i].v; i = e[i].nx)\n        if(e[i].c && !d[v]) q[++r] = v, d[v] = d[u] + 1;\n    }\n    return d[t];\n}\nint dfs(int u, int lim, int re = 0) {\n    if(u == t) return lim;\n    for(int& i = nw[u], v; v = e[i].v; i = e[i].nx)\n    if(e[i].c && d[v] == d[u] + 1) {\n        int t = dfs(v, min(e[i].c, lim));\n        e[i].c -= t, e[i ^ 1].c += t, re += t, lim -= t;\n        if(!lim) break;\n    }\n    if(lim) d[u] = 0;\n    return re;\n}\n```\n\n#### \n\n```cpp\nint flow = 0;\nwhile(bfs()) flow += dfs(s, Inf);\n```\n\n### ```long long``` \n\n```cpp\nint bfs() {\n    mem(d, 0), memcpy(nw, he, sizeof he);\n    q[1] = s, d[s] = 1;\n    for(int l = 1, r = 1; l <= r; l++) {\n        int u = q[l];\n        for(int i = he[u], v; v = e[i].v; i = e[i].nx)\n        if(e[i].c && !d[v]) q[++r] = v, d[v] = d[u] + 1;\n    }\n    return d[t];\n}\nll dfs(int u, ll lim, ll re = 0) {\n    if(u == t) return lim;\n    for(int& i = nw[u], v; v = e[i].v; i = e[i].nx)\n    if(e[i].c && d[v] == d[u] + 1) {\n        ll t = dfs(v, min((ll)e[i].c, lim));\n        e[i].c -= t, e[i ^ 1].c += t, re += t, lim -= t;\n        if(!lim) break;\n    }\n    if(lim) d[u] = 0;\n    return re;\n}\n```\n\n## \n\n### SSP \n\n#### \n\n```cpp\nint n, m, s, t, flow, cost;\nint eid = 1, he[N], nw[N], q[N], d[N], vs[N];\nstruct edge { int v, nx, c, w; } e[M * 2];\n```\n\n#### \n\n```cpp\nvoid add(int u, int v, int c, int w) {\n    e[++eid] = {v, he[u], c, w}, he[u] = eid;\n    e[++eid] = {u, he[v], 0, -w}, he[v] = eid;\n}\nint spfa() {\n    mem(d, 63), memcpy(nw, he, sizeof he);\n    q[0] = s, d[s] = 0, vs[s] = 1;\n    for(int l = 0, r = 0; l <= r; l++) {\n        int u = q[l % N]; vs[u] = 0;\n        for(int i = he[u], v; v = e[i].v; i = e[i].nx)\n        if(e[i].c && d[u] + e[i].w < d[v]) {\n            d[v] = d[u] + e[i].w;\n            if(!vs[v]) q[++r % N] = v, vs[v] = 1;\n        }\n    }\n    return d[t] < d[0];\n}\nint dfs(int u, int lim, int re = 0) {\n    if(u == t) return lim;\n    vs[u] = 1;\n    for(int& i = nw[u], v; v = e[i].v; i = e[i].nx)\n    if(!vs[v] && e[i].c && d[v] == d[u] + e[i].w) {\n        int t = dfs(v, min(lim, e[i].c));\n        e[i].c -= t, e[i ^ 1].c += t, re += t, lim -= t, cost += t * e[i].w;\n        if(!lim) break;\n    }\n    if(lim) d[u] = d[0];\n    vs[u] = 0;\n    return re;\n}\n```\n\n#### \n\n```cpp\nwhile(spfa()) flow += dfs(s, 1e9);\n```\n\n### Primal-Dual \n\n#### \n\n```cpp\nint n, m, s, t, flow, cost;\nint eid = 1, he[N], d[N], pre[N];\nstruct edge { int v, nx, c, w; } e[M * 2];\nstruct node {\n    int d, u;\n    bool operator <(const node& b)const {\n        return d > b.d;\n    }\n};\n```\n\n#### \n\n```cpp\nvoid add(int u, int v, int c, int w) {\n    e[++eid] = {v, he[u], c, w}, he[u] = eid;\n    e[++eid] = {u, he[v], 0, -w}, he[v] = eid;\n}\nint dji() {\n    priority_queue<node> q;\n    mem(d, 63), q.push({d[s] = 0, s});\n    while(q.size()) {\n        auto [dis, u] = q.top(); q.pop();\n        if(dis > d[u]) continue;\n        for(int i = he[u], v; v = e[i].v; i = e[i].nx) if(e[i].c) {\n            int w = d[u] + e[i].w - h[v] + h[u];\n            if(w < d[v]) pre[v] = i ^ 1, q.push({d[v] = w, v});\n        }\n    }\n    rep(i, 1, n) h[i] += d[i];\n    return d[t] < d[0];\n}\n```\n\n#### \n\n```cpp\nwhile(dji()) {\n    int mi = Inf;\n    for(int u = t, i; i = pre[u]; u = e[i].v) mi = min(mi, e[i ^ 1].c);\n    for(int u = t, i; i = pre[u]; u = e[i].v) e[i].c += mi, e[i ^ 1].c -= mi;\n    flow += mi, cost += mi * h[t];\n}\n```\n\n## \n\n### \n\n```cpp\nint n, m, vs[N], mch[N];\nvector<int> G[N];\n```\n\n### \n\n```cpp\nint dfs(int u, int s) {\n    if(vs[u] == s) return 0;\n    vs[u] = s;\n    for(int v : G[u]) if(!mch[v] || dfs(mch[v], s)) return mch[v] = u;\n    return 0;\n}\n```\n\n### \n\n```cpp\nint as = 0;\nrep(i, 1, n) if(dfs(i, i)) as++;\n```\n\n## 2-SAT \n\n### \n\n```cpp\nint n, m, co[N * 2], stk[N * 2], tp;\nvector<int> G[N * 2];\n```\n\n### \n\n```cpp\nvoid add(int u, int a, int v, int b) {\n    G[u * 2 + !a].pb(v * 2 + b);\n    G[v * 2 + !b].pb(u * 2 + a);\n}\nint dfs(int u) {\n    if(co[u] | co[u ^ 1]) return co[u];\n    co[u] = 1, stk[++tp] = u;\n    for(int v : G[u]) if(!dfs(v)) return 0;\n    return 1;\n}\nint twoSat() {\n    rep(i, 1, n) {\n        if(!co[i * 2] && !co[i * 2 + 1] && !dfs(i * 2)) {\n            while(tp) co[stk[tp--]] = 0;\n            if(!dfs(i * 2 + 1)) return 0;\n        }\n        tp = 0;\n    }\n    return 1;\n}\n```\n\n# \n\n## manacher \n\n```cpp\nrep(i, 1, n) {\n    int& j = ma > i ? min(R[p * 2 - i], ma - i) : 0;\n    while(s[i - j] == s[i + j + 1]) j++;\n    if(i + j > ma) ma = i + j, p = i;\n}\n```\n\n## \n\n### \n\n#### \n\n```cpp\nchar s[N];\nint n, sz = 1, nw, len[N], f[N], ch[N][26];\n```\n\n#### \n```cpp\nvoid ins(int i) {\n    auto jmp = [&](int o) {\n        while(s[i - len[o] - 1] != s[i]) o = f[o];\n        return o;\n    };\n    int o = jmp(nw), c = s[i] - 97;\n    if(!ch[o][c]]) {\n        f[++sz] = ch[jmp(f[o])][c];\n        len[ch[o][c] = sz] = len[o] + 2;\n    }\n    nw = ch[o][c];\n}\n```\n\n#### \n\n```cpp\nlen[1] = -1, f[0] = 1;\n```\n\n### \n\n#### \n\n```cpp\nvoid ins(int i) {\n    auto jmp = [&](int o) {\n        while(o && s[i - len[o] - 1] != s[i]) o = f[o];\n        return o;\n    };\n    int o = jmp(nw), c = s[i] - 97;\n    if(!ch[o][c]]) {\n        f[++sz] = ch[jmp(f[o])][c];\n        len[ch[o][c] = sz] = len[o] + 2;\n    }\n    nw = ch[o][c];\n}\n```\n\n#### \n\n```cpp\nrep(i, 0, 25) ch[0][i] = 1;\n```\n\n## \n\n### \n\n```cpp\nint n, m = 128, sa[N], rk[N], tp[N], buc[N];\nint h[20][N];\nchar s[N];\n```\n\n### \n\n```cpp\nvoid SA() {\n    rep(i, 1, n) buc[rk[i] = s[i]]++;\n    rep(i, 1, m) buc[i] += buc[i - 1];\n    per(i, n, 1) sa[buc[rk[i]]--] = i;\n    for(int k = 1, p; memset(buc, p = 0, m * 4 + 4); k *= 2) {\n        rep(i, n - k + 1, n) tp[++p] = i;\n        rep(i, 1, n) if(sa[i] > k) tp[++p] = sa[i] - k;\n        rep(i, 1, n) buc[rk[i]]++;\n        rep(i, 1, m) buc[i] += buc[i - 1];\n        per(i, n, 1) sa[buc[rk[tp[i]]]--] = tp[i];\n        memcpy(tp, rk, n * 4 + 4), p = 0;\n        rep(i, 1, n) rk[sa[i]] = p += tp[sa[i]] ^ tp[sa[i - 1]] || tp[sa[i] + k] ^ tp[sa[i - 1] + k];\n        if((m = p) >= n) break;\n    }\n}\nvoid height() {\n    int k = 0;\n    rep(i, 1, n) {\n        for(k ? k-- : 0; s[i + k] == s[sa[rk[i] - 1] + k]; k++);\n        h[0][rk[i]] = k;\n    }\n    rep(i, 1, 19) rep(j, 1, n - (1 << i) + 1)\n        h[i][j] = min(h[i - 1][j], h[i - 1][j + (1 << (i - 1))]);\n}\n```\n\n## \n\n### \n\n```cpp\nchar s[N];\nint n, sz = 1, nw = 1, f[N], len[N], ch[N][26];\n```\n\n### \n\n```cpp\nvoid ins(int c) {\n    int u = ++sz;\n    len[u] = len[nw] + 1;\n    while(nw && !ch[nw][c]) ch[nw][c] = u, nw = f[nw];\n    if(!nw) f[u] = 1;\n    else {\n        int v = ch[nw][c];\n        if(len[v] > len[nw] + 1) {\n            f[++sz] = f[v], memcpy(ch[sz], ch[v], sizeof ch[v]);\n            f[v] = f[u] = sz, len[sz] = len[nw] + 1;\n            for(int x = nw; ch[x][c] == v; x = f[x]) ch[x][c] = sz;\n        } else f[u] = v;\n    }\n    nw = u;\n}\n```\n\n## \n\n### \n\n```cpp\nint calc(char s[]) {\n    int i = 0, j = 1, k = 0;\n    while(i < n && j < n && k < n)\n    if(s[(i + k) % n] == s[(j + k) % n]) k++;\n    else {\n        if(s[(i + k) % n] > s[(j + k) % n]) swap(i, j);\n        j += k + 1, k = 0;\n        if(i == j) i++;\n    }\n    return min(i, j);\n}\n```\n","slug":"template","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh2o007mootn92qa0hgs","content":"<p><strong></strong></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> lf = <span class=\"keyword\">double</span>;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"\"></h1>\r\n<h2 id=\"fast-io\">Fast IO</h2>\r\n<h4 id=\"\"></h4>\r\n<h5 id=\"\"></h5>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">int</span> M = <span class=\"number\">1e6</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* in = cin.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> gc (p1 == p2 &amp;&amp; (p2 = (p1 = buf) + in -&gt; sgetn(buf, M), p1 == p2) ? -1 : *p1++)</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> buf[M], *p1, *p2;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> c = gc, r = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &lt; <span class=\"number\">48</span>) c = gc;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &gt; <span class=\"number\">47</span>) r = r * <span class=\"number\">10</span> + (c &amp; <span class=\"number\">15</span>), c = gc;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">wrt</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* out = cout.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> pc out -&gt; sputc</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> c[<span class=\"number\">11</span>]; <span class=\"keyword\">int</span> sz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> c[++sz] = x % <span class=\"number\">10</span>, x /= <span class=\"number\">10</span>; <span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(sz) <span class=\"built_in\">pc</span>(c[sz--] + <span class=\"number\">48</span>);</span><br><span class=\"line\">    <span class=\"built_in\">pc</span>(<span class=\"number\">10</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h5 id=\"\"></h5>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>), cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>), cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">int</span> M = <span class=\"number\">1e6</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* in = cin.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> gc (p1 == p2 &amp;&amp; (p2 = (p1 = buf) + in -&gt; sgetn(buf, M), p1 == p2) ? -1 : *p1++)</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> buf[M], *p1, *p2;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> c = gc, r = <span class=\"number\">0</span>, f = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &lt; <span class=\"number\">48</span>) &#123; <span class=\"keyword\">if</span>(c == <span class=\"number\">45</span>) f = <span class=\"number\">-1</span>; c = gc; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &gt; <span class=\"number\">47</span>) r = r * <span class=\"number\">10</span> + (c &amp; <span class=\"number\">15</span>), c = gc;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r * f;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">wrt</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* out = cout.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> pc out -&gt; sputc</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> c[<span class=\"number\">11</span>]; <span class=\"keyword\">int</span> sz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(x &lt; <span class=\"number\">0</span>) <span class=\"built_in\">pc</span>(<span class=\"number\">45</span>), x = -x;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> c[++sz] = x % <span class=\"number\">10</span>, x /= <span class=\"number\">10</span>; <span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(sz) <span class=\"built_in\">pc</span>(c[sz--] + <span class=\"number\">48</span>);</span><br><span class=\"line\">    <span class=\"built_in\">pc</span>(<span class=\"number\">10</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><strong> <code>long long</code>  <code>wrt</code>  <code>c</code>  <span class=\"math inline\">\\(20\\)</span></strong></p>\r\n<h2 id=\"atcoder-modint\">AtCoder-modint</h2>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> uint = <span class=\"keyword\">unsigned</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ull = <span class=\"keyword\">unsigned</span> ll;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> ll <span class=\"title\">safe_mod</span><span class=\"params\">(ll x, ll m)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x %= m, x &lt; <span class=\"number\">0</span> ? x + m : x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> ll <span class=\"title\">pow_mod_constexpr</span><span class=\"params\">(ll x, ll n, <span class=\"keyword\">int</span> m)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(m == <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    uint _m = m;</span><br><span class=\"line\">    ull r = <span class=\"number\">1</span>, _x = <span class=\"built_in\">safe_mod</span>(x, m);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n &gt;&gt;= <span class=\"number\">1</span>, _x = _x * _x % _m)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * _x % m;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"keyword\">bool</span> <span class=\"title\">is_prime_constexpr</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &lt;= <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n == <span class=\"number\">2</span> || n == <span class=\"number\">7</span> || n == <span class=\"number\">61</span>) <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n % <span class=\"number\">2</span> == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    ll d = n - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(~d &amp; <span class=\"number\">1</span>) d /= <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(ll a : &#123;<span class=\"number\">2</span>, <span class=\"number\">7</span>, <span class=\"number\">61</span>&#125;) &#123;</span><br><span class=\"line\">        ll t = d, y = <span class=\"built_in\">pow_mod_constexpr</span>(a, t, n);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(t != n - <span class=\"number\">1</span> &amp;&amp; y != <span class=\"number\">1</span> &amp;&amp; y != n - <span class=\"number\">1</span>)</span><br><span class=\"line\">            y = y * y % n, t &lt;&lt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(y != n - <span class=\"number\">1</span> &amp;&amp; t % <span class=\"number\">2</span> == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> pair&lt;ll, ll&gt; <span class=\"title\">inv_gcd</span><span class=\"params\">(ll a, ll b)</span> </span>&#123;</span><br><span class=\"line\">    a = <span class=\"built_in\">safe_mod</span>(a, b);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(a == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> &#123;b, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    ll s = b, t = a, m0 = <span class=\"number\">0</span>, m1 = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(t) &#123;</span><br><span class=\"line\">        ll u = s / t;</span><br><span class=\"line\">        s -= t * u, m0 -= m1 * u;</span><br><span class=\"line\">        ll tmp = s;</span><br><span class=\"line\">        s = t, t = tmp, tmp = m0, m0 = m1, m1 = tmp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(m0 &lt; <span class=\"number\">0</span>) m0 += b / s;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;s, m0&#125;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">barrett</span> &#123;</span></span><br><span class=\"line\">    uint m; ull im;</span><br><span class=\"line\">    <span class=\"built_in\">barrett</span>(uint m) :<span class=\"built_in\">m</span>(m), <span class=\"built_in\">im</span>(~<span class=\"number\">0ull</span> / m + <span class=\"number\">1</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\">uint <span class=\"title\">mul</span><span class=\"params\">(uint a, uint b)</span> <span class=\"keyword\">const</span> </span>&#123;</span><br><span class=\"line\">        ull z = (ull)a * b;</span><br><span class=\"line\">        ull x = (<span class=\"keyword\">unsigned</span> __int128)z * im &gt;&gt; <span class=\"number\">64</span>;</span><br><span class=\"line\">        uint v = z - x * m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> m &lt;= v ? v + m : v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">int</span> m&gt; <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">static_modint</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">using</span> mint = static_modint;</span><br><span class=\"line\">  <span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> mint <span class=\"title\">raw</span><span class=\"params\">(<span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">        mint x;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x._v = v, x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">static_modint</span>() : _v(<span class=\"number\">0</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">template</span>&lt;class T&gt; <span class=\"title\">static_modint</span><span class=\"params\">(T v)</span> </span>&#123;</span><br><span class=\"line\">        ll x = v % m;</span><br><span class=\"line\">        _v = x &lt; <span class=\"number\">0</span> ? x + m : x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">uint <span class=\"title\">val</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"keyword\">return</span> _v; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>++() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(++_v == m) _v = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>--() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!_v--) _v = m - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>++(<span class=\"keyword\">int</span>) &#123;</span><br><span class=\"line\">        mint res = *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        ++*<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>--(<span class=\"keyword\">int</span>) &#123;</span><br><span class=\"line\">        mint res = *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        --*<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>+=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        _v += rhs._v;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(_v &gt;= m) _v -= m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>-=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        _v -= rhs._v;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(_v &gt;= m) _v += m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>*=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        ull z = _v;</span><br><span class=\"line\">        z *= rhs._v, _v = z % m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>/=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span> = *<span class=\"keyword\">this</span> * rhs.<span class=\"built_in\">inv</span>(); &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>+() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>-() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>() - *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">pow</span><span class=\"params\">(ll n)</span> <span class=\"keyword\">const</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= n);</span><br><span class=\"line\">        mint x = *<span class=\"keyword\">this</span>, r = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; n; n &gt;&gt;= <span class=\"number\">1</span>, x *= x) <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r *= x;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">inv</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(prime) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(_v);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">pow</span>(m - <span class=\"number\">2</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">auto</span> eg = <span class=\"built_in\">inv_gcd</span>(_v, m);</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(eg.first == <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> eg.second;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>+(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) += rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>-(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) -= rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>*(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) *= rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>/(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) /= rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>==(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lhs._v == rhs._v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>!=(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lhs._v != rhs._v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span>:</span><br><span class=\"line\">    uint _v;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">constexpr</span> <span class=\"keyword\">bool</span> prime = <span class=\"built_in\">is_prime_constexpr</span>(m);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">int</span> id&gt; <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">dynamic_modint</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">using</span> mint = dynamic_modint;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">set_mod</span><span class=\"params\">(<span class=\"keyword\">int</span> m)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(<span class=\"number\">1</span> &lt;= m), bt = <span class=\"built_in\">barrett</span>(m);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> mint <span class=\"title\">raw</span><span class=\"params\">(<span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">        mint x;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x._v = v, x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">dynamic_modint</span>() : _v(<span class=\"number\">0</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">template</span>&lt;class T&gt; <span class=\"title\">dynamic_modint</span><span class=\"params\">(T v)</span> </span>&#123;</span><br><span class=\"line\">        ll x = v % bt.m;</span><br><span class=\"line\">        _v = x &lt; <span class=\"number\">0</span> ? x + bt.m : x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">uint <span class=\"title\">val</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"keyword\">return</span> _v; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>++() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(++_v == bt.m) _v = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>--() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!_v--) _v = bt.m - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>++(<span class=\"keyword\">int</span>) &#123;</span><br><span class=\"line\">        mint res = *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        ++*<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>--(<span class=\"keyword\">int</span>) &#123;</span><br><span class=\"line\">        mint res = *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        --*<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>+=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        _v += rhs._v;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(_v &gt;= bt.m) _v -= bt.m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>-=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        _v += bt.m - rhs._v;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(_v &gt;= bt.m) _v -= bt.m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>*=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        _v = bt.<span class=\"built_in\">mul</span>(_v, rhs._v);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>/=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span> = *<span class=\"keyword\">this</span> * rhs.<span class=\"built_in\">inv</span>(); &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>+() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>-() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>() - *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">pow</span><span class=\"params\">(ll n)</span> <span class=\"keyword\">const</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= n);</span><br><span class=\"line\">        mint x = *<span class=\"keyword\">this</span>, r = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; n; n &gt;&gt;= <span class=\"number\">1</span>, x *= x) <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r *= x;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">inv</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> eg = <span class=\"built_in\">inv_gcd</span>(_v, bt.m);</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(eg.first == <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> eg.second;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>+(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) += rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>-(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) -= rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>*(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) *= rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>/(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) /= rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>==(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lhs._v == rhs._v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>!=(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lhs._v != rhs._v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span>:</span><br><span class=\"line\">    uint _v;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> barrett bt;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">int</span> id&gt; barrett dynamic_modint&lt;id&gt;::bt = <span class=\"number\">998244353</span>;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> uint = <span class=\"keyword\">unsigned</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ull = <span class=\"keyword\">unsigned</span> ll;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> ll <span class=\"title\">safe_mod</span><span class=\"params\">(ll x, ll m)</span> </span>&#123; <span class=\"keyword\">return</span> x %= m, x &lt; <span class=\"number\">0</span> ? x + m : x; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> ll <span class=\"title\">pow_mod_constexpr</span><span class=\"params\">(ll x, ll n, <span class=\"keyword\">int</span> m)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(m == <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    uint _m = m; ull r = <span class=\"number\">1</span>, _x = <span class=\"built_in\">safe_mod</span>(x, m);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n &gt;&gt;= <span class=\"number\">1</span>, _x = _x * _x % _m) <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * _x % m;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"keyword\">bool</span> <span class=\"title\">is_prime_constexpr</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &lt;= <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n == <span class=\"number\">2</span> || n == <span class=\"number\">7</span> || n == <span class=\"number\">61</span>) <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n % <span class=\"number\">2</span> == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    ll d = n - <span class=\"number\">1</span>; <span class=\"keyword\">while</span>(~d &amp; <span class=\"number\">1</span>) d /= <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(ll a : &#123;<span class=\"number\">2</span>, <span class=\"number\">7</span>, <span class=\"number\">61</span>&#125;) &#123;</span><br><span class=\"line\">        ll t = d, y = <span class=\"built_in\">pow_mod_constexpr</span>(a, t, n);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(t != n - <span class=\"number\">1</span> &amp;&amp; y != <span class=\"number\">1</span> &amp;&amp; y != n - <span class=\"number\">1</span>) y = y * y % n, t &lt;&lt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(y != n - <span class=\"number\">1</span> &amp;&amp; t % <span class=\"number\">2</span> == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> pair&lt;ll, ll&gt; <span class=\"title\">inv_gcd</span><span class=\"params\">(ll a, ll b)</span> </span>&#123;</span><br><span class=\"line\">    a = <span class=\"built_in\">safe_mod</span>(a, b);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(a == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> &#123;b, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    ll s = b, t = a, m0 = <span class=\"number\">0</span>, m1 = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(t) &#123;</span><br><span class=\"line\">        ll u = s / t; s -= t * u, m0 -= m1 * u;</span><br><span class=\"line\">        ll tmp = s; s = t, t = tmp, tmp = m0, m0 = m1, m1 = tmp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(m0 &lt; <span class=\"number\">0</span>) m0 += b / s;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;s, m0&#125;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">barrett</span> &#123;</span></span><br><span class=\"line\">    uint m; ull im;</span><br><span class=\"line\">    <span class=\"built_in\">barrett</span>(uint m) :<span class=\"built_in\">m</span>(m), <span class=\"built_in\">im</span>(~<span class=\"number\">0ull</span> / m + <span class=\"number\">1</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\">uint <span class=\"title\">mul</span><span class=\"params\">(uint a, uint b)</span> <span class=\"keyword\">const</span> </span>&#123;</span><br><span class=\"line\">        ull z = (ull)a * b; ull x = (<span class=\"keyword\">unsigned</span> __int128)z * im &gt;&gt; <span class=\"number\">64</span>; uint v = z - x * m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> m &lt;= v ? v + m : v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">int</span> m&gt; <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">static_modint</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">using</span> mint = static_modint;</span><br><span class=\"line\">  <span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> mint <span class=\"title\">raw</span><span class=\"params\">(<span class=\"keyword\">int</span> v)</span> </span>&#123; mint x; <span class=\"keyword\">return</span> x._v = v, x; &#125;</span><br><span class=\"line\">    <span class=\"built_in\">static_modint</span>() : _v(<span class=\"number\">0</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">template</span>&lt;class T&gt; <span class=\"title\">static_modint</span><span class=\"params\">(T v)</span> </span>&#123; ll x = v % m; _v = x &lt; <span class=\"number\">0</span> ? x + m : x; &#125;</span><br><span class=\"line\">    <span class=\"function\">uint <span class=\"title\">val</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"keyword\">return</span> _v; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>++() &#123; <span class=\"keyword\">if</span>(++_v == m) _v = <span class=\"number\">0</span>; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>--() &#123; <span class=\"keyword\">if</span>(!_v--) _v = m - <span class=\"number\">1</span>; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>++(<span class=\"keyword\">int</span>) &#123; mint res = *<span class=\"keyword\">this</span>; ++*<span class=\"keyword\">this</span>; <span class=\"keyword\">return</span> res; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>--(<span class=\"keyword\">int</span>) &#123; mint res = *<span class=\"keyword\">this</span>; --*<span class=\"keyword\">this</span>; <span class=\"keyword\">return</span> res; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>+=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; _v += rhs._v; <span class=\"keyword\">if</span>(_v &gt;= m) _v -= m; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>-=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; _v -= rhs._v; <span class=\"keyword\">if</span>(_v &gt;= m) _v += m; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>*=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; ull z = _v; z *= rhs._v, _v = z % m; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>/=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span> = *<span class=\"keyword\">this</span> * rhs.<span class=\"built_in\">inv</span>(); &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>+() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>-() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>() - *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">pow</span><span class=\"params\">(ll n)</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= n); mint x = *<span class=\"keyword\">this</span>, r = <span class=\"number\">1</span>; <span class=\"keyword\">for</span>(; n; n &gt;&gt;= <span class=\"number\">1</span>, x *= x) <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r *= x; <span class=\"keyword\">return</span> r; &#125;</span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">inv</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"keyword\">if</span>(prime) &#123; <span class=\"built_in\">assert</span>(_v); <span class=\"keyword\">return</span> <span class=\"built_in\">pow</span>(m - <span class=\"number\">2</span>); &#125; <span class=\"keyword\">else</span> &#123; <span class=\"keyword\">auto</span> eg = <span class=\"built_in\">inv_gcd</span>(_v, m); <span class=\"built_in\">assert</span>(eg.first == <span class=\"number\">1</span>); <span class=\"keyword\">return</span> eg.second; &#125; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>+(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) += rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>-(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) -= rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>*(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) *= rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>/(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) /= rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>==(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> lhs._v == rhs._v; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>!=(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> lhs._v != rhs._v; &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span>:</span><br><span class=\"line\">    uint _v;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">constexpr</span> <span class=\"keyword\">bool</span> prime = <span class=\"built_in\">is_prime_constexpr</span>(m);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">int</span> id&gt; <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">dynamic_modint</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">using</span> mint = dynamic_modint;</span><br><span class=\"line\">  <span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">set_mod</span><span class=\"params\">(<span class=\"keyword\">int</span> m)</span> </span>&#123; <span class=\"built_in\">assert</span>(<span class=\"number\">1</span> &lt;= m), bt = <span class=\"built_in\">barrett</span>(m); &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> mint <span class=\"title\">raw</span><span class=\"params\">(<span class=\"keyword\">int</span> v)</span> </span>&#123; mint x; <span class=\"keyword\">return</span> x._v = v, x; &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dynamic_modint</span>() : _v(<span class=\"number\">0</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">template</span>&lt;class T&gt; <span class=\"title\">dynamic_modint</span><span class=\"params\">(T v)</span> </span>&#123; ll x = v % bt.m; _v = x &lt; <span class=\"number\">0</span> ? x + bt.m : x; &#125;</span><br><span class=\"line\">    <span class=\"function\">uint <span class=\"title\">val</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"keyword\">return</span> _v; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>++() &#123; <span class=\"keyword\">if</span>(++_v == bt.m) _v = <span class=\"number\">0</span>; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>--() &#123; <span class=\"keyword\">if</span>(!_v--) _v = bt.m - <span class=\"number\">1</span>; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>++(<span class=\"keyword\">int</span>) &#123; mint res = *<span class=\"keyword\">this</span>; ++*<span class=\"keyword\">this</span>; <span class=\"keyword\">return</span> res; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>--(<span class=\"keyword\">int</span>) &#123; mint res = *<span class=\"keyword\">this</span>; --*<span class=\"keyword\">this</span>; <span class=\"keyword\">return</span> res; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>+=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; _v += rhs._v; <span class=\"keyword\">if</span>(_v &gt;= bt.m) _v -= bt.m; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>-=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; _v += bt.m - rhs._v; <span class=\"keyword\">if</span>(_v &gt;= bt.m) _v -= bt.m; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>*=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; _v = bt.<span class=\"built_in\">mul</span>(_v, rhs._v); <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>/=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span> = *<span class=\"keyword\">this</span> * rhs.<span class=\"built_in\">inv</span>(); &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>+() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>-() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>() - *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">pow</span><span class=\"params\">(ll n)</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= n); mint x = *<span class=\"keyword\">this</span>, r = <span class=\"number\">1</span>; <span class=\"keyword\">for</span>(; n; n &gt;&gt;= <span class=\"number\">1</span>, x *= x) <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r *= x; <span class=\"keyword\">return</span> r; &#125;</span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">inv</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"keyword\">auto</span> eg = <span class=\"built_in\">inv_gcd</span>(_v, bt.m); <span class=\"built_in\">assert</span>(eg.first == <span class=\"number\">1</span>); <span class=\"keyword\">return</span> eg.second; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>+(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) += rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>-(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) -= rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>*(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) *= rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>/(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) /= rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>==(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> lhs._v == rhs._v; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>!=(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> lhs._v != rhs._v; &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span>:</span><br><span class=\"line\">    uint _v;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> barrett bt;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">int</span> id&gt; barrett dynamic_modint&lt;id&gt;::bt = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> eb emplace_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> fi first </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> se second</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> all(x) (x).begin(), (x).end()</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> SZ(x) int((x).size())</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) / 2)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lc o * 2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rc o * 2 + 1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, lc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, rc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> cmi(a, b) (a = min(a, b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> cma(a, b) (a = max(a, b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lb lower_bound</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ub upper_bound</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> bs binary_search</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pop __builtin_popcount</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llpop __builtin_popcountll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ctz __builtin_ctz</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llctz __builtin_ctzll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> clz __builtin_clz</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llclz __builtin_clzll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> par __builtin_parity</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llpar __builtin_parityll</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> lf = <span class=\"keyword\">double</span>;</span><br><span class=\"line\"><span class=\"comment\">// using P = pair&lt;int, int&gt;;</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> V = vector&lt;<span class=\"keyword\">int</span>&gt;;</span><br><span class=\"line\"><span class=\"comment\">// using cmp = complex&lt;lf&gt;;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> local</span></span><br><span class=\"line\">    <span class=\"comment\">// freopen(&quot;.in&quot;, &quot;r&quot;, stdin);</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> T;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(cin &gt;&gt; T; T--; <span class=\"built_in\">solve</span>());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-1\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">gen</span><span class=\"params\">(ll x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> ll k = <span class=\"number\">0x9ddfea08eb382d69</span>ull;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">3</span>) x *= k, x ^= x &gt;&gt; <span class=\"number\">47</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * k;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">rnd</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> ll s = <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (s += <span class=\"built_in\">gen</span>(s)) &amp; LONG_LONG_MAX;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-2\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">mul</span><span class=\"params\">(ll a, ll b, ll p)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (a * b - <span class=\"built_in\">ll</span>((<span class=\"keyword\">long</span> <span class=\"keyword\">double</span>)a / p * b + <span class=\"number\">0.5</span>) * p + p) % p;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"bash-\"><code>bash</code> </h3>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"literal\">true</span>; <span class=\"keyword\">do</span></span><br><span class=\"line\">    ./gen &gt; <span class=\"keyword\">in</span></span><br><span class=\"line\">    ./a &lt; <span class=\"keyword\">in</span> &gt; 1</span><br><span class=\"line\">    ./b &lt; <span class=\"keyword\">in</span> &gt; 2</span><br><span class=\"line\">    diff 1 2</span><br><span class=\"line\">    <span class=\"keyword\">if</span> [ $? -ne 0 ] ; <span class=\"keyword\">then</span> <span class=\"built_in\">break</span>; <span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">mul</span><span class=\"params\">(ll a, ll b, ll p)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (a * b - <span class=\"built_in\">ll</span>((<span class=\"keyword\">long</span> <span class=\"keyword\">double</span>)a / p * b + <span class=\"number\">0.5</span>) * p + p) % p;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">Pow</span><span class=\"params\">(ll a, ll n, ll p, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = <span class=\"built_in\">mul</span>(a, a, p))</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = <span class=\"built_in\">mul</span>(r, a, p);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Pollard_Rho &#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">chk</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(ll a : &#123;<span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">7</span>, <span class=\"number\">61</span>, <span class=\"number\">24251</span>&#125;) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(n == a) <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(<span class=\"built_in\">Pow</span>(a, n - <span class=\"number\">1</span>, n) ^ <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            ll k = n - <span class=\"number\">1</span>, t;</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(~k &amp; <span class=\"number\">1</span>) k /= <span class=\"number\">2</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>((t = <span class=\"built_in\">Pow</span>(a, k, n)) == <span class=\"number\">1</span>) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(t ^ <span class=\"number\">1</span> &amp;&amp; t ^ n - <span class=\"number\">1</span>) t = <span class=\"built_in\">mul</span>(t, t, n);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(t ^ n - <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">f</span><span class=\"params\">(ll x, ll c, ll p)</span> </span>&#123; <span class=\"keyword\">return</span> (<span class=\"built_in\">mul</span>(x, x, p) + c) % p; &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">PR</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">        ll a = <span class=\"number\">0</span>, b = <span class=\"number\">0</span>, c = <span class=\"built_in\">rand</span>() % (n - <span class=\"number\">1</span>) + <span class=\"number\">1</span>, v = <span class=\"number\">1</span>, g;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> k = <span class=\"number\">1</span>; ; k *= <span class=\"number\">2</span>, a = b, v = <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, k) &#123;</span><br><span class=\"line\">                b = <span class=\"built_in\">f</span>(b, c, n), v = <span class=\"built_in\">mul</span>(v, <span class=\"built_in\">abs</span>(a - b), n);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(!(i &amp; <span class=\"number\">127</span>) || i == k) &#123;</span><br><span class=\"line\">                    g = __gcd(v, n);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(g &gt; <span class=\"number\">1</span>) <span class=\"keyword\">return</span> g;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ll ans[<span class=\"number\">100</span>]; <span class=\"keyword\">int</span> ct;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"built_in\">chk</span>(n)) <span class=\"keyword\">return</span> <span class=\"built_in\"><span class=\"keyword\">void</span></span>(ans[++ct] = n);</span><br><span class=\"line\">        ll d; <span class=\"keyword\">do</span> d = <span class=\"built_in\">PR</span>(n); <span class=\"keyword\">while</span>(d == n);</span><br><span class=\"line\">        <span class=\"built_in\">solve</span>(d), <span class=\"built_in\">solve</span>(n / d);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">work</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        ll n;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(cin &gt;&gt; n) &#123;</span><br><span class=\"line\">            ct = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(<span class=\"built_in\">chk</span>(n)) &#123; <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Prime&quot;</span>); <span class=\"keyword\">continue</span>; &#125;</span><br><span class=\"line\">            <span class=\"built_in\">solve</span>(n), <span class=\"built_in\">sort</span>(ans + <span class=\"number\">1</span>, ans + ct + <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> t = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, ct) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(ans[i] ^ ans[i - <span class=\"number\">1</span>]) cout &lt;&lt; ans[i];</span><br><span class=\"line\">                t++; <span class=\"keyword\">if</span>(ans[i] ^ ans[i + <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(t &gt; <span class=\"number\">1</span>) cout &lt;&lt; <span class=\"string\">&#x27;^&#x27;</span> &lt;&lt; t;</span><br><span class=\"line\">                    <span class=\"built_in\">putchar</span>(<span class=\"number\">32</span>), t = <span class=\"number\">0</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"built_in\">putchar</span>(<span class=\"number\">10</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Inv &#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">exgcd</span><span class=\"params\">(ll a, ll b, ll&amp; d, ll&amp; x, ll&amp; y)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(b) <span class=\"built_in\">exgcd</span>(b, a % b, d, y, x), y -= a / b * x;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> d = a, x = <span class=\"number\">1</span>, y = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">inv</span><span class=\"params\">(ll a, ll p)</span> </span>&#123;</span><br><span class=\"line\">        ll d, x, y; <span class=\"built_in\">exgcd</span>(a, p, d, x, y);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(d &gt; <span class=\"number\">1</span>) <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Non-existent!&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> cout &lt;&lt; (x % p + p) % p;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">work</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        ll a, p;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(cin &gt;&gt; a &gt;&gt; p) <span class=\"built_in\">inv</span>(a, p);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Prime &#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">work</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        ll n;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(cin &gt;&gt; n) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(!Pollard_Rho::<span class=\"built_in\">chk</span>(n)) n++;</span><br><span class=\"line\">            cout &lt;&lt; n &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Cipolla &#123;</span><br><span class=\"line\">    ll n, p, II;</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">cmp</span> &#123;</span></span><br><span class=\"line\">        ll r, i;</span><br><span class=\"line\">        cmp <span class=\"keyword\">operator</span> *(<span class=\"keyword\">const</span> cmp&amp; b) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;(r * b.r + i * b.i % p * II) % p, (r * b.i + i * b.r) % p &#125;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; U = &#123; <span class=\"number\">1</span>, <span class=\"number\">0</span> &#125;;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">pow1</span><span class=\"params\">(ll a, <span class=\"keyword\">int</span> n, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a % p)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a % p;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">cmp <span class=\"title\">pow2</span><span class=\"params\">(cmp a, <span class=\"keyword\">int</span> n, cmp r = U)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">work</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(cin &gt;&gt; n &gt;&gt; p) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!n) &#123; <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;0&quot;</span>); <span class=\"keyword\">continue</span>; &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(p == <span class=\"number\">2</span>) &#123; cout &lt;&lt; n &lt;&lt; endl; <span class=\"keyword\">continue</span>; &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(<span class=\"built_in\">pow1</span>(n, p / <span class=\"number\">2</span>) ^ <span class=\"number\">1</span>) &#123; <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Non-existent!&quot;</span>); <span class=\"keyword\">continue</span>; &#125;</span><br><span class=\"line\">            ll a;</span><br><span class=\"line\">            <span class=\"keyword\">do</span> a = <span class=\"built_in\">rand</span>() % p, II = (a * a - n + p) % p; <span class=\"keyword\">while</span>(!a || <span class=\"built_in\">pow1</span>(II, p / <span class=\"number\">2</span>) == <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> x1 = <span class=\"built_in\">pow2</span>(&#123;a, <span class=\"number\">1</span>&#125;, p / <span class=\"number\">2</span> + <span class=\"number\">1</span>).r, x2 = p - x1;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(x1 &gt; x2) <span class=\"built_in\">swap</span>(x1, x2);</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d %d\\n&quot;</span>, x1, x2);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;; </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">srand</span>(<span class=\"built_in\">time</span>(<span class=\"number\">0</span>));</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Press 1 for integer factorization.&quot;</span>);</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Press 2 to calculate the modular multiplicative inverse of a number.&quot;</span>);</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Press 3 to find the first prime number greater than or equal to a number.&quot;</span>);</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Press 4 to calculate the modular square root of a number.&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> op;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        cin &gt;&gt; op;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op == <span class=\"number\">1</span>) Pollard_Rho::<span class=\"built_in\">work</span>();</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(op == <span class=\"number\">2</span>) Inv::<span class=\"built_in\">work</span>();</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(op == <span class=\"number\">3</span>) Prime::<span class=\"built_in\">work</span>();</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(op == <span class=\"number\">4</span>) Cipolla::<span class=\"built_in\">work</span>();</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Illegal input! Please re-enter your option.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"\"></h1>\r\n<h2 id=\"ntt\">NTT</h2>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> lim = <span class=\"number\">1</span>, bit = <span class=\"number\">-1</span>, rev[N];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-3\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">Pow</span><span class=\"params\">(ll a, <span class=\"keyword\">int</span> n, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a % P)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(ll a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(rev[i] &lt; i) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">        ll wn = <span class=\"built_in\">Pow</span>(<span class=\"number\">3</span>, P / <span class=\"number\">2</span> / i);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            ll w = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">                ll &amp;x = a[k], y = a[k + i] * w % P;</span><br><span class=\"line\">                a[k + i] = (x - y) % P, (x += y) %= P, w = w * wn % P;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ll inv = <span class=\"built_in\">Pow</span>(lim, P - <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) (a[i] *= inv) %= P;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(mint a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(rev[i] &lt; i) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">        mint wn = <span class=\"built_in\">mint</span>(<span class=\"number\">3</span>).<span class=\"built_in\">pow</span>(P / <span class=\"number\">2</span> / i);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            mint w = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">                mint &amp;x = a[k], y = a[k + i] * w;</span><br><span class=\"line\">                a[k + i] = x - y, x += y, w *= wn;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint inv = <span class=\"built_in\">mint</span>(lim).<span class=\"built_in\">inv</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] *= inv;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-1\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span>(lim &lt;= n + m) lim *= <span class=\"number\">2</span>, bit++;</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) rev[i] = rev[i / <span class=\"number\">2</span>] / <span class=\"number\">2</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; bit;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"-1\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ll w[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> lim = <span class=\"number\">1</span>, bit = <span class=\"number\">-1</span>, rev[N]; </span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mint w[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> lim = <span class=\"number\">1</span>, bit = <span class=\"number\">-1</span>, rev[N]; </span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-4\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">mod</span><span class=\"params\">(ll&amp; x)</span> </span>&#123; <span class=\"keyword\">if</span>(x &gt;= P) x -= P; <span class=\"keyword\">if</span>(x &lt; <span class=\"number\">0</span>) x += P; &#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">Pow</span><span class=\"params\">(ll a, <span class=\"keyword\">int</span> n, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a % P)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(ll a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(rev[i] &lt; i) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">        ll &amp;x = a[k], y = a[k + i] * w[lim / i * (k - j)] % P;</span><br><span class=\"line\">        <span class=\"built_in\">mod</span>(a[k + i] = x - y), <span class=\"built_in\">mod</span>(x += y);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ll inv = <span class=\"built_in\">Pow</span>(lim, P - <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) (a[i] *= inv) %= P;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(mint a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(rev[i] &lt; i) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">        mint &amp;x = a[k], y = a[k + i] * w[lim / i * (k - j)];</span><br><span class=\"line\">        a[k + i] = x - y, x += y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint inv = <span class=\"built_in\">mint</span>(lim).<span class=\"built_in\">inv</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] *= inv;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-2\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span>(lim &lt;= n + m) lim *= <span class=\"number\">2</span>, bit++;</span><br><span class=\"line\">ll wn = <span class=\"built_in\">Pow</span>(<span class=\"number\">3</span>, P / <span class=\"number\">2</span> / lim);</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">    rev[i] = rev[i / <span class=\"number\">2</span>] / <span class=\"number\">2</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; bit;</span><br><span class=\"line\">    w[i] = i ? w[i - <span class=\"number\">1</span>] * wn % P : <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span>(lim &lt;= n + m) lim *= <span class=\"number\">2</span>, bit++;</span><br><span class=\"line\">mint wn = <span class=\"built_in\">mint</span>(<span class=\"number\">3</span>).<span class=\"built_in\">pow</span>(P / <span class=\"number\">2</span> / lim);</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">    rev[i] = rev[i / <span class=\"number\">2</span>] / <span class=\"number\">2</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; bit;</span><br><span class=\"line\">    w[i] = i ? w[i - <span class=\"number\">1</span>] * wn : <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"-ntt\"> NTT</h2>\r\n<h3 id=\"-2\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> cmp = complex&lt;lf&gt;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> lf PI = <span class=\"built_in\">acos</span>(<span class=\"number\">-1</span>);</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">const</span> cmp <span class=\"title\">I</span><span class=\"params\">(<span class=\"number\">0</span>, <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, P;</span><br><span class=\"line\"><span class=\"keyword\">int</span> M, lim = <span class=\"number\">1</span>, bit = <span class=\"number\">-1</span>, rev[N];</span><br><span class=\"line\">cmp w[N], a0[N], a1[N], b0[N], b1[N];</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> cmp = complex&lt;lf&gt;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> lf PI = <span class=\"built_in\">acos</span>(<span class=\"number\">-1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, P;</span><br><span class=\"line\"><span class=\"keyword\">int</span> M, lim = <span class=\"number\">1</span>, bit = <span class=\"number\">-1</span>, rev[N];</span><br><span class=\"line\">cmp w[N], a0[N], a1[N], b0[N], b1[N];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-5\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FFT</span><span class=\"params\">(cmp a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(i &lt; rev[i]) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">        cmp &amp;x = a[k], y = a[i + k] * w[lim / i * (k - j)];</span><br><span class=\"line\">        a[i + k] = x - y, x += y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    lf inv = <span class=\"number\">1.</span> / lim;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] *= inv;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FFT2</span><span class=\"params\">(cmp a[], cmp b[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] += b[i] * I;</span><br><span class=\"line\">    <span class=\"built_in\">FFT</span>(a, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) b[i] = <span class=\"built_in\">conj</span>(a[i ? lim - i : <span class=\"number\">0</span>]);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">        cmp x = a[i], y = b[i];</span><br><span class=\"line\">        a[i] = (y + x) * <span class=\"number\">0.5</span>, b[i] = (y - x) * <span class=\"number\">0.5</span> * I;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">num</span><span class=\"params\">(cmp x)</span> </span>&#123; <span class=\"keyword\">return</span> M * <span class=\"built_in\">ll</span>(<span class=\"built_in\">real</span>(x) + <span class=\"number\">0.5</span>) % P + <span class=\"built_in\">ll</span>(<span class=\"built_in\">imag</span>(x) + <span class=\"number\">0.5</span>); &#125;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FFT</span><span class=\"params\">(cmp a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(i &lt; rev[i]) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">        cmp &amp;x = a[k], y = a[i + k] * w[lim / i * (k - j)];</span><br><span class=\"line\">        a[i + k] = x - y, x += y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    lf inv = <span class=\"number\">1.</span> / lim;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] *= inv;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FFT2</span><span class=\"params\">(cmp a[], cmp b[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] += b[i] * <span class=\"number\">1</span>i;</span><br><span class=\"line\">    <span class=\"built_in\">FFT</span>(a, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) b[i] = <span class=\"built_in\">conj</span>(a[i ? lim - i : <span class=\"number\">0</span>]);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">        cmp x = a[i], y = b[i];</span><br><span class=\"line\">        a[i] = (y + x) * <span class=\"number\">0.5</span>, b[i] = (y - x) * <span class=\"number\">0.5</span>i;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">mint <span class=\"title\">num</span><span class=\"params\">(cmp x)</span> </span>&#123; <span class=\"keyword\">return</span> M * (mint)<span class=\"built_in\">ll</span>(<span class=\"built_in\">real</span>(x) + <span class=\"number\">0.5</span>) % P + (mint)<span class=\"built_in\">ll</span>(<span class=\"built_in\">imag</span>(x) + <span class=\"number\">0.5</span>); &#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-3\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">M = <span class=\"built_in\">sqrt</span>(P);</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) a0[i] = A[i] / M, a1[i] = A[i] % M;</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, m) b0[i] = B[i] / M, b1[i] = B[i] % M;</span><br><span class=\"line\"><span class=\"keyword\">while</span>(lim &lt;= n + m) lim *= <span class=\"number\">2</span>, bit++;</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">    rev[i] = rev[i / <span class=\"number\">2</span>] / <span class=\"number\">2</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; bit;</span><br><span class=\"line\">    w[i] = <span class=\"built_in\">cmp</span>(<span class=\"built_in\">cos</span>(PI / lim * i), <span class=\"built_in\">sin</span>(PI / lim * i));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">FFT2</span>(a0, a1), <span class=\"built_in\">FFT2</span>(b0, b1);</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">    cmp t = a0[i] + I * a1[i];</span><br><span class=\"line\">    b0[i] *= t, b1[i] *= t;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">FFT</span>(b0, <span class=\"number\">1</span>), <span class=\"built_in\">FFT</span>(b1, <span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n + m) C[i] = (M * <span class=\"built_in\">num</span>(b0[i]) + <span class=\"built_in\">num</span>(b1[i])) % P;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">FFT2</span>(a0, a1), <span class=\"built_in\">FFT2</span>(b0, b1);</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">    cmp t = a0[i] + I * a1[i];</span><br><span class=\"line\">    b0[i] *= t, b1[i] *= t;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">FFT</span>(b0, <span class=\"number\">1</span>), <span class=\"built_in\">FFT</span>(b1, <span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n + m) C[i] = M * <span class=\"built_in\">num</span>(b0[i]) + <span class=\"built_in\">num</span>(b1[i]);</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"fwt\">FWT</h2>\r\n<h3 id=\"-6\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FWT</span><span class=\"params\">(ll a[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, n) <span class=\"built_in\">For</span>(S, <span class=\"number\">0</span>, <span class=\"number\">1</span> &lt;&lt; n) <span class=\"keyword\">if</span>(S &gt;&gt; i &amp; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        ll&amp; x = a[S ^ <span class=\"number\">1</span> &lt;&lt; i], y = a[S];</span><br><span class=\"line\">        a[S] = x - y, x += y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">IFWT</span><span class=\"params\">(ll a[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, n) <span class=\"built_in\">For</span>(S, <span class=\"number\">0</span>, <span class=\"number\">1</span> &lt;&lt; n) <span class=\"keyword\">if</span>(S &gt;&gt; i &amp; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        ll&amp; x = a[S ^ <span class=\"number\">1</span> &lt;&lt; i], y = a[S];</span><br><span class=\"line\">        a[S] = x - y &gt;&gt; <span class=\"number\">1</span>, x = x + y &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-3\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, lim, rev[N];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-7\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">Pow</span><span class=\"params\">(ll a, <span class=\"keyword\">int</span> n, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a % P)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">bld</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    lim = <span class=\"number\">1</span> &lt;&lt; n--;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) rev[i] = rev[i / <span class=\"number\">2</span>] / <span class=\"number\">2</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; n;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(ll a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(i &lt; rev[i]) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">        ll wn = <span class=\"built_in\">Pow</span>(g, P / <span class=\"number\">2</span> / i);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            ll w = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">                ll &amp;x = a[k], y = a[k + i] * w % P;</span><br><span class=\"line\">                a[k + i] = (x - y) % P, (x += y) %= P, w = w * wn % P;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ll inv = <span class=\"built_in\">Pow</span>(lim, P - <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) (a[i] *= inv) %= P;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Inv</span><span class=\"params\">(ll a[], ll b[], <span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> ll c[N];</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, <span class=\"number\">2</span> &lt;&lt; n) b[i] = c[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    b[<span class=\"number\">0</span>] = <span class=\"built_in\">Pow</span>(a[<span class=\"number\">0</span>], P - <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(j, <span class=\"number\">0</span>, <span class=\"number\">1</span> &lt;&lt; i) c[j] = a[j];</span><br><span class=\"line\">        <span class=\"built_in\">bld</span>(i + <span class=\"number\">1</span>), <span class=\"built_in\">NTT</span>(c, <span class=\"number\">0</span>), <span class=\"built_in\">NTT</span>(b, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(j, <span class=\"number\">0</span>, lim) b[j] = (b[j] * <span class=\"number\">2</span> - b[j] * b[j] % P * c[j]) % P;</span><br><span class=\"line\">        <span class=\"built_in\">NTT</span>(b, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(j, <span class=\"number\">1</span> &lt;&lt; i, lim) b[j] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">bld</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    lim = <span class=\"number\">1</span> &lt;&lt; n--;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) rev[i] = rev[i / <span class=\"number\">2</span>] / <span class=\"number\">2</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; n;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(mint a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(rev[i] &lt; i) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">        mint wn = <span class=\"built_in\">mint</span>(<span class=\"number\">3</span>).<span class=\"built_in\">pow</span>(P / <span class=\"number\">2</span> / i);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            mint w = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">                mint &amp;x = a[k], y = a[k + i] * w;</span><br><span class=\"line\">                a[k + i] = x - y, x += y, w *= wn;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint inv = <span class=\"built_in\">mint</span>(lim).<span class=\"built_in\">inv</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] *= inv;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Inv</span><span class=\"params\">(mint a[], mint b[], <span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> mint c[N];</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, <span class=\"number\">2</span> &lt;&lt; n) b[i] = c[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    b[<span class=\"number\">0</span>] = a[<span class=\"number\">0</span>].<span class=\"built_in\">inv</span>();</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(j, <span class=\"number\">0</span>, <span class=\"number\">1</span> &lt;&lt; i) c[j] = a[j];</span><br><span class=\"line\">        <span class=\"built_in\">bld</span>(i + <span class=\"number\">1</span>), <span class=\"built_in\">NTT</span>(c, <span class=\"number\">0</span>), <span class=\"built_in\">NTT</span>(b, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(j, <span class=\"number\">0</span>, lim) b[j] = b[j] * <span class=\"number\">2</span> - b[j] * b[j] * c[j];</span><br><span class=\"line\">        <span class=\"built_in\">NTT</span>(b, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(j, <span class=\"number\">1</span> &lt;&lt; i, lim) b[j] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h2 id=\"\"></h2>\r\n<h2 id=\"\"></h2>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">mul</span><span class=\"params\">(ll a, ll b, ll p)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (a * b - (ll)((<span class=\"keyword\">long</span> <span class=\"keyword\">double</span>)a / p * b + <span class=\"number\">0.5</span>) * p + p) % p;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">exgcd</span><span class=\"params\">(ll a, ll b, ll&amp; d, ll&amp; x, ll&amp; y)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!b) &#123; d = a, x = <span class=\"number\">1</span>, y = <span class=\"number\">0</span>; <span class=\"keyword\">return</span>; &#125;</span><br><span class=\"line\">    <span class=\"built_in\">exgcd</span>(b, a % b, d, y, x), y -= a / b * x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">exCRT</span><span class=\"params\">(ll&amp; b1, ll&amp; m1, ll b2, ll m2)</span> </span>&#123;</span><br><span class=\"line\">    ll d, k1, k2; <span class=\"built_in\">exgcd</span>(m1, m2, d, k1, k2), m2 /= d;</span><br><span class=\"line\">    b1 = (b1 + <span class=\"built_in\">mul</span>(<span class=\"built_in\">mul</span>(k1 % m2, (b2 - b1) / d % m2, m2), m1, m1 * m2)) % (m1 *= m2);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h2 id=\"min-25-\">Min-25 </h2>\r\n<h3 id=\"-4\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ll f1[N], f2[N];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-8\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">min25</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> lim = <span class=\"built_in\">sqrt</span>(n);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, lim) f1[i] = i - <span class=\"number\">1</span>, f2[i] = n / i - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(p, <span class=\"number\">2</span>, lim) <span class=\"keyword\">if</span> (f1[p] ^ f1[p - <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> w1 = lim / p;</span><br><span class=\"line\">        ll x = f1[p - <span class=\"number\">1</span>], w3 = (ll)p * p, w2 = <span class=\"built_in\">min</span>((ll)lim, n / w3), d = n / p;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, w1) f2[i] -= f2[i * p] - x;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, w1 + <span class=\"number\">1</span>, w2) f2[i] -= f1[d / i] - x;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(i, lim, w3) f1[i] -= f1[i / p] - x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> f2[<span class=\"number\">1</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"exbsgs\">exBSGS</h2>\r\n<h3 id=\"-5\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">map&lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt; mp;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-9\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">BSGS</span><span class=\"params\">(ll pls, ll a, ll b, ll p)</span> </span>&#123;</span><br><span class=\"line\">    pls %= p, a %= p, b %= p; mp.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">    ll m = <span class=\"built_in\">ceil</span>(<span class=\"built_in\">sqrt</span>(p)), ls = <span class=\"number\">1</span>, rs = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, m) mp[ls * b % p] = i, ls = ls * a % p;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        rs = rs * ls % p;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(mp.<span class=\"built_in\">count</span>(rs * pls % p)) <span class=\"keyword\">return</span> i * m - mp[rs * pls % p];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">exBSGS</span><span class=\"params\">(ll a, ll b, ll p)</span> </span>&#123;</span><br><span class=\"line\">    a %= p, b %= p;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> pls = <span class=\"number\">1</span>, ct = <span class=\"number\">0</span>, g;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>((g = __gcd(a, p)) &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(b == <span class=\"number\">1</span>) <span class=\"keyword\">return</span> ct;</span><br><span class=\"line\">        p /= g, pls = pls * a / g % p, ct++;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(b % g) <span class=\"keyword\">return</span> <span class=\"number\">-1</span>; b /= g;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> ret = <span class=\"built_in\">BSGS</span>(pls, a, b, p);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ~ret ? ret + ct : <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"cipolla\">cipolla</h2>\r\n<h3 id=\"-6\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n; ll II;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">cmp</span> &#123;</span></span><br><span class=\"line\">    ll r, i;</span><br><span class=\"line\">    cmp <span class=\"keyword\">operator</span> *(<span class=\"keyword\">const</span> cmp&amp; b) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;(r * b.r + i * b.i % P * II) % P, (r * b.i + i * b.r) % P&#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; U = &#123;<span class=\"number\">1</span>, <span class=\"number\">0</span>&#125;;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mint n, II;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">cmp</span> &#123;</span></span><br><span class=\"line\">    mint r, i;</span><br><span class=\"line\">    cmp <span class=\"keyword\">operator</span> *(<span class=\"keyword\">const</span> cmp&amp; b) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;r * b.r + i * b.i * II, r * b.i + i * b.r&#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; U = &#123;<span class=\"number\">1</span>, <span class=\"number\">0</span>&#125;;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-10\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">pow1</span><span class=\"params\">(ll a, <span class=\"keyword\">int</span> n, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a % P)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">cmp <span class=\"title\">pow2</span><span class=\"params\">(cmp a, <span class=\"keyword\">int</span> n, cmp r = U)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">cipolla</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!n) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(P == <span class=\"number\">2</span>) <span class=\"keyword\">return</span> n;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">pow1</span>(n, P / <span class=\"number\">2</span>) ^ <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">    ll a;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> a = <span class=\"built_in\">rand</span>() % P, II = (a * a - n + P) % P; <span class=\"keyword\">while</span>(!a || <span class=\"built_in\">pow1</span>(II, P / <span class=\"number\">2</span>) == <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">pow2</span>(&#123;a, <span class=\"number\">1</span>&#125;, P / <span class=\"number\">2</span> + <span class=\"number\">1</span>).r;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">cmp <span class=\"title\">Pow</span><span class=\"params\">(cmp a, <span class=\"keyword\">int</span> n, cmp r = U)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">cipolla</span><span class=\"params\">(mint n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(P == <span class=\"number\">2</span>) <span class=\"keyword\">return</span> n.<span class=\"built_in\">val</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n.<span class=\"built_in\">pow</span>(P / <span class=\"number\">2</span>) != <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">    mint a;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> a = <span class=\"built_in\">rand</span>(), II = a * a - n; <span class=\"keyword\">while</span>(a == <span class=\"number\">0</span> || II.<span class=\"built_in\">pow</span>(P / <span class=\"number\">2</span>) == <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">Pow</span>(&#123;a, <span class=\"number\">1</span>&#125;, P / <span class=\"number\">2</span> + <span class=\"number\">1</span>).r.<span class=\"built_in\">val</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"miller-rabin-pollard-rho\">Miller Rabin &amp; Pollard Rho</h2>\r\n<h3 id=\"-7\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vector&lt;ll&gt; as;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-11\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">mul</span><span class=\"params\">(ll a, ll b, ll p)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (a * b - <span class=\"built_in\">ll</span>((<span class=\"keyword\">long</span> <span class=\"keyword\">double</span>)a / p * b + <span class=\"number\">0.5</span>) * p + p) % p;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">Pow</span><span class=\"params\">(ll a, ll n, ll p, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = <span class=\"built_in\">mul</span>(a, a, p))</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = <span class=\"built_in\">mul</span>(r, a, p);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">chk</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(ll a : &#123;<span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">7</span>, <span class=\"number\">61</span>, <span class=\"number\">24251</span>&#125;) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(n == a) <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"built_in\">Pow</span>(a, n - <span class=\"number\">1</span>, n) ^ <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        ll k = n - <span class=\"number\">1</span>, t;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(~k &amp; <span class=\"number\">1</span>) k /= <span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((t = <span class=\"built_in\">Pow</span>(a, k, n)) == <span class=\"number\">1</span>) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(t ^ <span class=\"number\">1</span> &amp;&amp; t ^ n - <span class=\"number\">1</span>) t = <span class=\"built_in\">mul</span>(t, t, n);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(t ^ n - <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">f</span><span class=\"params\">(ll x, ll c, ll p)</span> </span>&#123; <span class=\"keyword\">return</span> (<span class=\"built_in\">mul</span>(x, x, p) + c) % p; &#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">PR</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">    ll a = <span class=\"number\">0</span>, b = <span class=\"number\">0</span>, c = <span class=\"built_in\">rand</span>() % (n - <span class=\"number\">1</span>) + <span class=\"number\">1</span>, v = <span class=\"number\">1</span>, g;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> k = <span class=\"number\">1</span>; ; k *= <span class=\"number\">2</span>, a = b, v = <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, k) &#123;</span><br><span class=\"line\">            b = <span class=\"built_in\">f</span>(b, c, n), v = <span class=\"built_in\">mul</span>(v, <span class=\"built_in\">abs</span>(a - b), n);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!(i &amp; <span class=\"number\">127</span>) || i == k) &#123;</span><br><span class=\"line\">                g = __gcd(v, n);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(g &gt; <span class=\"number\">1</span>) <span class=\"keyword\">return</span> g;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">chk</span>(n)) <span class=\"keyword\">return</span> as.<span class=\"built_in\">pb</span>(n);</span><br><span class=\"line\">    ll d; <span class=\"keyword\">do</span> d = <span class=\"built_in\">PR</span>(n); <span class=\"keyword\">while</span>(d == n);</span><br><span class=\"line\">    <span class=\"built_in\">solve</span>(d), <span class=\"built_in\">solve</span>(n / d);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"\"></h1>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-1\"></h3>\r\n<h4 id=\"-8\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> c[N][<span class=\"number\">2</span>], f[N], r[N];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-12\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">id</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">return</span> c[f[o]][<span class=\"number\">1</span>] == o; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">nrt</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">return</span> f[o] &amp;&amp; c[f[o]][<span class=\"built_in\">id</span>(o)] == o; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pu</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">flip</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">swap</span>(c[o][<span class=\"number\">0</span>], c[o][<span class=\"number\">1</span>]), r[o] ^= <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pd</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">if</span>(r[o]) <span class=\"built_in\">flip</span>(c[o][<span class=\"number\">0</span>]), <span class=\"built_in\">flip</span>(c[o][<span class=\"number\">1</span>]), r[o] = <span class=\"number\">0</span>; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">rot</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> d)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> k = c[o][!d], &amp;x = c[k][d];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">nrt</span>(o)) c[f[o]][<span class=\"built_in\">id</span>(o)] = k;</span><br><span class=\"line\">    <span class=\"built_in\">pu</span>(x = f[c[o][!d] = x] = o), f[k] = f[o], <span class=\"built_in\">pu</span>(f[o] = k);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">if</span>(<span class=\"built_in\">nrt</span>(o)) <span class=\"built_in\">dfs</span>(f[o]); <span class=\"built_in\">pd</span>(o); &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">splay</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(o);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> fa; <span class=\"built_in\">nrt</span>(o); <span class=\"built_in\">rot</span>(f[o], !<span class=\"built_in\">id</span>(o)))</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">nrt</span>(fa = f[o])) <span class=\"built_in\">rot</span>(<span class=\"built_in\">id</span>(o) ^ <span class=\"built_in\">id</span>(fa) ? fa : f[fa], !<span class=\"built_in\">id</span>(o));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">acc</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> x = <span class=\"number\">0</span>; o; o = f[x = o])</span><br><span class=\"line\">        <span class=\"built_in\">splay</span>(o), c[o][<span class=\"number\">1</span>] = x, <span class=\"built_in\">pu</span>(o);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">mkrt</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"built_in\">acc</span>(o), <span class=\"built_in\">splay</span>(o), <span class=\"built_in\">flip</span>(o); &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">link</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mkrt</span>(u), <span class=\"built_in\">acc</span>(v), <span class=\"built_in\">splay</span>(v), <span class=\"built_in\">pu</span>(f[u] = v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">cut</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mkrt</span>(u), <span class=\"built_in\">acc</span>(v), <span class=\"built_in\">splay</span>(v), c[v][<span class=\"number\">0</span>] = f[u] = <span class=\"number\">0</span>, <span class=\"built_in\">pu</span>(v);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-size-\"> <code>size</code> </h3>\r\n<h4 id=\"-9\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> c[N][<span class=\"number\">2</span>], f[N], r[N], s[N], si[N];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-13\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">id</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">return</span> c[f[o]][<span class=\"number\">1</span>] == o; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">nrt</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">return</span> f[o] &amp;&amp; c[f[o]][<span class=\"built_in\">id</span>(o)] == o; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pu</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    s[o] = s[c[o][<span class=\"number\">0</span>]] + s[c[o][<span class=\"number\">1</span>]] + si[o] + <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">flip</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">swap</span>(c[o][<span class=\"number\">0</span>], c[o][<span class=\"number\">1</span>]), r[o] ^= <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pd</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">if</span>(r[o]) <span class=\"built_in\">flip</span>(c[o][<span class=\"number\">0</span>]), <span class=\"built_in\">flip</span>(c[o][<span class=\"number\">1</span>]), r[o] = <span class=\"number\">0</span>; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">rot</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> d)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> k = c[o][!d], &amp;x = c[k][d];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">nrt</span>(o)) c[f[o]][<span class=\"built_in\">id</span>(o)] = k;</span><br><span class=\"line\">    <span class=\"built_in\">pu</span>(x = f[c[o][!d] = x] = o), f[k] = f[o], <span class=\"built_in\">pu</span>(f[o] = k);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">if</span>(<span class=\"built_in\">nrt</span>(o)) <span class=\"built_in\">dfs</span>(f[o]); <span class=\"built_in\">pd</span>(o); &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">splay</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(o);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> fa; <span class=\"built_in\">nrt</span>(o); <span class=\"built_in\">rot</span>(f[o], !<span class=\"built_in\">id</span>(o)))</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">nrt</span>(fa = f[o])) <span class=\"built_in\">rot</span>(<span class=\"built_in\">id</span>(o) ^ <span class=\"built_in\">id</span>(fa) ? fa : f[fa], !<span class=\"built_in\">id</span>(o));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">acc</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> x = <span class=\"number\">0</span>; o; o = f[x = o])</span><br><span class=\"line\">        <span class=\"built_in\">splay</span>(o), si[o] += s[c[o][<span class=\"number\">1</span>]] - s[x], c[o][<span class=\"number\">1</span>] = x, <span class=\"built_in\">pu</span>(o);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">mkrt</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"built_in\">acc</span>(o), <span class=\"built_in\">splay</span>(o), <span class=\"built_in\">flip</span>(o); &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">link</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mkrt</span>(u), <span class=\"built_in\">acc</span>(v), <span class=\"built_in\">splay</span>(v), si[v] += s[u], <span class=\"built_in\">pu</span>(f[u] = v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">cut</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mkrt</span>(u), <span class=\"built_in\">acc</span>(v), <span class=\"built_in\">splay</span>(v), c[v][<span class=\"number\">0</span>] = f[u] = <span class=\"number\">0</span>, <span class=\"built_in\">pu</span>(v);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"rbs-\">RBS </h2>\r\n<h3 id=\"-2\"></h3>\r\n<h4 id=\"-10\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> rt, sz, ls[N], rs[N], c[N], s[N];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-14\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">gen</span><span class=\"params\">(ll x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> ll k = <span class=\"number\">0x9ddfea08eb382d69</span>ull;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">3</span>) x *= k, x ^= x &gt;&gt; <span class=\"number\">47</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * k;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">rnd</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> ll s = <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (s += <span class=\"built_in\">gen</span>(s)) &amp; INT_MAX;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">pu</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; s[o] = s[ls[o]] + s[rs[o]] + <span class=\"number\">1</span>; <span class=\"keyword\">return</span> o; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">bld</span><span class=\"params\">(<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span>&amp; o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l &gt; r) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> mid = l + r &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    c[o = ++sz] = a[mid];</span><br><span class=\"line\">    <span class=\"built_in\">bld</span>(l, mid - <span class=\"number\">1</span>, ls[o]), <span class=\"built_in\">bld</span>(mid + <span class=\"number\">1</span>, r, rs[o]), <span class=\"built_in\">pu</span>(o); </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">spt</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span>&amp; u, <span class=\"keyword\">int</span>&amp; v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!o) u = v = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(x &lt; c[o]) <span class=\"built_in\">spt</span>(ls[v = o], x, u, ls[o]), <span class=\"built_in\">pu</span>(o);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">spt</span>(rs[u = o], x, rs[o], v), <span class=\"built_in\">pu</span>(o);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">mrg</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!u || !v) <span class=\"keyword\">return</span> u + v;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">rnd</span>() % (s[u] + s[v]) &lt; s[u])</span><br><span class=\"line\">        <span class=\"keyword\">return</span> rs[u] = <span class=\"built_in\">mrg</span>(rs[u], v), <span class=\"built_in\">pu</span>(u);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ls[v] = <span class=\"built_in\">mrg</span>(u, ls[v]), <span class=\"built_in\">pu</span>(v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span>&amp; o, <span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">rnd</span>() % (s[o] + <span class=\"number\">1</span>) == <span class=\"number\">0</span>)</span><br><span class=\"line\">        c[++sz] = x, <span class=\"built_in\">spt</span>(o, x, ls[sz], rs[sz]), <span class=\"built_in\">pu</span>(o = sz);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">ins</span>(x &lt; c[o] ? ls[o] : rs[o], x), <span class=\"built_in\">pu</span>(o);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">rmv</span><span class=\"params\">(<span class=\"keyword\">int</span>&amp; o, <span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> t1, t2, t3;</span><br><span class=\"line\">    <span class=\"built_in\">spt</span>(o, x, t1, t3), <span class=\"built_in\">spt</span>(t1, x - <span class=\"number\">1</span>, t1, t2);</span><br><span class=\"line\">    o = <span class=\"built_in\">mrg</span>(<span class=\"built_in\">mrg</span>(t1, <span class=\"built_in\">mrg</span>(ls[t2], rs[t2])), t3);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">rk</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> re = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(o) o = x &gt; c[o] ? re += s[ls[o]] + <span class=\"number\">1</span>, rs[o] : ls[o]; </span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">kth</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(k != s[ls[o]] + <span class=\"number\">1</span>)</span><br><span class=\"line\">        o = k &gt; s[ls[o]] ? k -= s[ls[o]] + <span class=\"number\">1</span>, rs[o] : ls[o];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> c[o];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">pre</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> re = -Inf)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(o) o = x &gt; c[o] ? re = <span class=\"built_in\">max</span>(re, c[o]), rs[o] : ls[o];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">suf</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> re = Inf)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(o) o = x &lt; c[o] ? re = <span class=\"built_in\">min</span>(re, c[o]), ls[o] : rs[o];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;limits&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;vector&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> int64;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> int64 <span class=\"title\">Fingerprint</span><span class=\"params\">(int64 x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> int64 kMul = <span class=\"number\">0x9ddfea08eb382d69</span>ULL;</span><br><span class=\"line\">    x *= kMul, x ^= x &gt;&gt; <span class=\"number\">47</span>;</span><br><span class=\"line\">    x *= kMul, x ^= x &gt;&gt; <span class=\"number\">47</span>;</span><br><span class=\"line\">    x *= kMul, x ^= x &gt;&gt; <span class=\"number\">47</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * kMul;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> int64 <span class=\"title\">Random</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> int64 Seed = <span class=\"number\">2</span>;</span><br><span class=\"line\">    Seed += <span class=\"built_in\">Fingerprint</span>(Seed);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> Seed &amp; numeric_limits&lt;int64&gt;::<span class=\"built_in\">max</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">int</span> DataType;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">RBST</span> &#123;</span></span><br><span class=\"line\">    RBST *ChildL, *ChildR;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> Size;</span><br><span class=\"line\">    DataType Data;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">RBST</span>() &#123; ChildL = ChildR = <span class=\"number\">0</span>; &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">GetSize</span><span class=\"params\">(<span class=\"keyword\">const</span> RBST* root)</span> </span>&#123; <span class=\"keyword\">return</span> root ? root-&gt;Size : <span class=\"number\">0</span>; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">LowerBoundIndex</span><span class=\"params\">(<span class=\"keyword\">const</span> RBST* root, DataType x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!root) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &lt;= root-&gt;Data) <span class=\"keyword\">return</span> <span class=\"built_in\">LowerBoundIndex</span>(root-&gt;ChildL, x);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sizeL = <span class=\"built_in\">GetSize</span>(root-&gt;ChildL);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">LowerBoundIndex</span>(root-&gt;ChildR, x) + sizeL + <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">DataType <span class=\"title\">Select</span><span class=\"params\">(<span class=\"keyword\">const</span> RBST* root, <span class=\"keyword\">int</span> index)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sizeL = <span class=\"built_in\">GetSize</span>(root-&gt;ChildL);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index == sizeL) <span class=\"keyword\">return</span> root-&gt;Data;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index &lt; sizeL) <span class=\"keyword\">return</span> <span class=\"built_in\">Select</span>(root-&gt;ChildL, index);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">Select</span>(root-&gt;ChildR, index - sizeL - <span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">RBST* <span class=\"title\">SetSize</span><span class=\"params\">(RBST* root)</span> </span>&#123;</span><br><span class=\"line\">    root-&gt;Size = <span class=\"built_in\">GetSize</span>(root-&gt;ChildL) + <span class=\"built_in\">GetSize</span>(root-&gt;ChildR) + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> root;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">RBSTree</span> &#123;</span></span><br><span class=\"line\">    vector&lt;RBST*&gt; Nodes;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">RBST* <span class=\"title\">NewNode</span><span class=\"params\">(RBST* node)</span> </span>&#123;</span><br><span class=\"line\">        Nodes.<span class=\"built_in\">push_back</span>(<span class=\"keyword\">new</span> <span class=\"built_in\">RBST</span>(*node));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Nodes.<span class=\"built_in\">back</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Split</span><span class=\"params\">(RBST* root, DataType x, RBST*&amp; treeL, RBST*&amp; treeR)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!root) &#123;</span><br><span class=\"line\">            treeL = treeR = <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (x &lt;= root-&gt;Data) &#123;</span><br><span class=\"line\">            RBST *newRoot = <span class=\"built_in\">NewNode</span>(root);</span><br><span class=\"line\">            <span class=\"built_in\">Split</span>(root-&gt;ChildL, x, treeL, newRoot-&gt;ChildL);</span><br><span class=\"line\">            treeR = <span class=\"built_in\">SetSize</span>(newRoot);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            RBST* newRoot = <span class=\"built_in\">NewNode</span>(root);</span><br><span class=\"line\">            <span class=\"built_in\">Split</span>(root-&gt;ChildR, x, newRoot-&gt;ChildR, treeR);</span><br><span class=\"line\">            treeL = <span class=\"built_in\">SetSize</span>(newRoot);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">RBST* <span class=\"title\">Join</span><span class=\"params\">(RBST* treeL, RBST* treeR)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> sizeL = <span class=\"built_in\">GetSize</span>(treeL);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> sizeR = <span class=\"built_in\">GetSize</span>(treeR);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> size = sizeL + sizeR;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (size == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">Random</span>() % size &lt; sizeL) &#123;</span><br><span class=\"line\">            RBST* newRoot = <span class=\"built_in\">NewNode</span>(treeL);</span><br><span class=\"line\">            newRoot-&gt;ChildR = <span class=\"built_in\">Join</span>(treeL-&gt;ChildR, treeR);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">SetSize</span>(newRoot);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            RBST* newRoot = <span class=\"built_in\">NewNode</span>(treeR);</span><br><span class=\"line\">            newRoot-&gt;ChildL = <span class=\"built_in\">Join</span>(treeL, treeR-&gt;ChildL);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">SetSize</span>(newRoot);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">RBST* <span class=\"title\">InsertAsRoot</span><span class=\"params\">(RBST* root, DataType item)</span> </span>&#123;</span><br><span class=\"line\">        Nodes.<span class=\"built_in\">push_back</span>(<span class=\"keyword\">new</span> RBST);</span><br><span class=\"line\">        RBST *newRoot = Nodes.<span class=\"built_in\">back</span>();</span><br><span class=\"line\">        newRoot-&gt;Data = item;</span><br><span class=\"line\">        <span class=\"built_in\">Split</span>(root, item + <span class=\"number\">1</span>, newRoot-&gt;ChildL, newRoot-&gt;ChildR);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">SetSize</span>(newRoot);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">RBST* <span class=\"title\">Insert</span><span class=\"params\">(RBST* root, DataType item)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">Random</span>() % (<span class=\"built_in\">GetSize</span>(root) + <span class=\"number\">1</span>) == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">InsertAsRoot</span>(root, item);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (item &lt; root-&gt;Data) &#123;</span><br><span class=\"line\">            RBST *newRoot = <span class=\"built_in\">NewNode</span>(root);</span><br><span class=\"line\">            newRoot-&gt;ChildL = <span class=\"built_in\">Insert</span>(root-&gt;ChildL, item);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">SetSize</span>(newRoot);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            RBST *newRoot = <span class=\"built_in\">NewNode</span>(root);</span><br><span class=\"line\">            newRoot-&gt;ChildR = <span class=\"built_in\">Insert</span>(root-&gt;ChildR, item);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">SetSize</span>(newRoot);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">RBST* <span class=\"title\">Remove</span><span class=\"params\">(RBST* root, DataType item)</span> </span>&#123;</span><br><span class=\"line\">        RBST *tree1, *tree2, *tree3, *tree4 = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">Split</span>(root, item, tree1, tree2);</span><br><span class=\"line\">        <span class=\"built_in\">Split</span>(tree2, item + <span class=\"number\">1</span>, tree2, tree3);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree2) tree4 = <span class=\"built_in\">Join</span>(tree2-&gt;ChildL, tree2-&gt;ChildR);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">Join</span>(<span class=\"built_in\">Join</span>(tree1, tree4), tree3);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Destroy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; Nodes.<span class=\"built_in\">size</span>(); ++i) <span class=\"keyword\">delete</span> Nodes[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"k-d-\">K-D </h2>\r\n<h3 id=\"-11\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) / 2)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lc o * 2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rc o * 2 + 1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, lc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, rc</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> D, L[N * <span class=\"number\">4</span>][K], R[N * <span class=\"number\">4</span>][K];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> x[K];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123; <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;x[i]); &#125;</span><br><span class=\"line\">    <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span> &lt;(<span class=\"keyword\">const</span> node&amp; b)<span class=\"keyword\">const</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x[D] &lt; b.x[D];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; a[N];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-15\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">lf <span class=\"title\">sq</span><span class=\"params\">(lf x)</span> </span>&#123; <span class=\"keyword\">return</span> x * x; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pu</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        L[o][i] = <span class=\"built_in\">min</span>(L[lc][i], L[rc][i]);</span><br><span class=\"line\">        R[o][i] = <span class=\"built_in\">max</span>(R[lc][i], R[rc][i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">bld</span><span class=\"params\">(<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l == r) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) L[o][i] = R[o][i] = a[l].x[i];</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    lf va[K] = &#123;&#125;;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) &#123;</span><br><span class=\"line\">        lf av = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, l, r) av += a[j].x[i];</span><br><span class=\"line\">        av /= r - l + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, l, r) va[i] += <span class=\"built_in\">sq</span>(a[j].x[i] - av);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    D = <span class=\"built_in\">max_element</span>(va, va + K) - va;</span><br><span class=\"line\">    <span class=\"built_in\">nth_element</span>(a + l, a + mid, a + r + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">bld</span>(lch), <span class=\"built_in\">bld</span>(rch), <span class=\"built_in\">pu</span>(o);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">sq</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123; <span class=\"keyword\">return</span> <span class=\"number\">1ll</span> * x * x; &#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">mine</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x[], ll re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re += <span class=\"built_in\">sq</span>(<span class=\"built_in\">max</span>(L[o][i] - x[i], <span class=\"number\">0</span>)) + <span class=\"built_in\">sq</span>(<span class=\"built_in\">max</span>(x[i] - R[o][i], <span class=\"number\">0</span>));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">maxe</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x[], ll re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re += <span class=\"built_in\">max</span>(<span class=\"built_in\">sq</span>(x[i] - L[o][i]), <span class=\"built_in\">sq</span>(x[i] - R[o][i]));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">minm</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re += <span class=\"built_in\">max</span>(L[o][i] - x[i], <span class=\"number\">0</span>) + <span class=\"built_in\">max</span>(x[i] - R[o][i], <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">maxm</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re += <span class=\"built_in\">max</span>(<span class=\"built_in\">abs</span>(x[i] - L[o][i]), <span class=\"built_in\">abs</span>(x[i] - R[o][i]));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">minc</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> re = Inf)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re = <span class=\"built_in\">max</span>(re, <span class=\"built_in\">max</span>(L[o][i] - x[i], <span class=\"number\">0</span>) + <span class=\"built_in\">max</span>(x[i] - R[o][i], <span class=\"number\">0</span>));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">maxc</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re = <span class=\"built_in\">max</span>(&#123;re, <span class=\"built_in\">abs</span>(x[i] - L[o][i]), <span class=\"built_in\">abs</span>(x[i] - R[o][i])&#125;);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"-12\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ll res;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-16\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l == r) <span class=\"keyword\">return</span> <span class=\"built_in\"><span class=\"keyword\">void</span></span>(res = <span class=\"built_in\">mine</span>(o, x));</span><br><span class=\"line\">    ll dl = <span class=\"built_in\">mine</span>(lc, x), dr = <span class=\"built_in\">mine</span>(rc, x);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(dl &lt; dr) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dl &lt; res) <span class=\"built_in\">qry</span>(x, lch);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dr &lt; res) <span class=\"built_in\">qry</span>(x, rch);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dr &lt; res) <span class=\"built_in\">qry</span>(x, rch);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dl &lt; res) <span class=\"built_in\">qry</span>(x, lch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res = Inf;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"-13\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ll res;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-17\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l == r) <span class=\"keyword\">return</span> <span class=\"built_in\"><span class=\"keyword\">void</span></span>(res = <span class=\"built_in\">maxe</span>(o, x));</span><br><span class=\"line\">    ll dl = <span class=\"built_in\">maxe</span>(lc, x), dr = <span class=\"built_in\">maxe</span>(rc, x);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(dl &gt; dr) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dl &gt; res) <span class=\"built_in\">qry</span>(x, lch);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dr &gt; res) <span class=\"built_in\">qry</span>(x, rch);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dr &gt; res) <span class=\"built_in\">qry</span>(x, rch);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dl &gt; res) <span class=\"built_in\">qry</span>(x, lch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-1\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res = <span class=\"number\">0</span>;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">chk1</span><span class=\"params\">(<span class=\"keyword\">int</span> l[], <span class=\"keyword\">int</span> r[], <span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> re = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re &amp;= l[i] &lt;= L[o][i] &amp;&amp; R[o][i] &lt;= r[i];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">chk2</span><span class=\"params\">(<span class=\"keyword\">int</span> l[], <span class=\"keyword\">int</span> r[], <span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> re = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re &amp;= <span class=\"built_in\">max</span>(l[i], L[o][i]) &lt;= <span class=\"built_in\">min</span>(r[i], R[o][i]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">chk1</span><span class=\"params\">(<span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">maxe</span>(x, o) &lt;= <span class=\"number\">1ll</span> * r * r;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">chk2</span><span class=\"params\">(<span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">mine</span>(x, o) &lt;= <span class=\"number\">1ll</span> * r * r;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"\"></h1>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"vector-\"><code>vector</code> </h3>\r\n<h4 id=\"-14\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, a[N], tp, stk[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> idx, dfn[N], d[N], fa[<span class=\"number\">20</span>][N];</span><br><span class=\"line\">vector&lt;<span class=\"keyword\">int</span>&gt; G[N], T[N];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-18\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    dfn[u] = ++idx;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">19</span>) fa[i][u] = fa[i - <span class=\"number\">1</span>][fa[i - <span class=\"number\">1</span>][u]];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(v ^ fa[<span class=\"number\">0</span>][u])</span><br><span class=\"line\">        d[v] = d[u] + <span class=\"number\">1</span>, fa[<span class=\"number\">0</span>][v] = u, <span class=\"built_in\">dfs</span>(v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">lca</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(d[u] &lt; d[v]) <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, <span class=\"number\">19</span>) <span class=\"keyword\">if</span>(d[u] - d[v] &gt;&gt; i &amp; <span class=\"number\">1</span>) u = fa[i][u];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u == v) <span class=\"keyword\">return</span> u;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, <span class=\"number\">19</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(fa[i][u] ^ fa[i][v]) u = fa[i][u], v = fa[i][v];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> fa[<span class=\"number\">0</span>][u];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">bld</span><span class=\"params\">(<span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(a + <span class=\"number\">1</span>, a + k + <span class=\"number\">1</span>, [](<span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> b) &#123; <span class=\"keyword\">return</span> dfn[a] &lt; dfn[b]; &#125;);</span><br><span class=\"line\">    stk[++tp] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, k) <span class=\"keyword\">if</span>(a[i] &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> x = <span class=\"built_in\">lca</span>(a[i], stk[tp]);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(d[stk[tp]] &gt; d[x]) tp--, T[d[stk[tp]] &gt; d[x] ? stk[tp] : x].<span class=\"built_in\">pb</span>(stk[tp + <span class=\"number\">1</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(stk[tp] ^ x) stk[++tp] = x;</span><br><span class=\"line\">        stk[++tp] = a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(--tp) T[stk[tp]].<span class=\"built_in\">pb</span>(stk[tp + <span class=\"number\">1</span>]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">clr</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"built_in\">clr</span>(v); T[u].<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"-15\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, a[N], p, stk[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> d[N], fa[N], sz[N], son[N], tp[N], idx, dfn[N];</span><br><span class=\"line\">vector&lt;<span class=\"keyword\">int</span>&gt; G[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> eid, he[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">edge</span> &#123;</span> <span class=\"keyword\">int</span> v, nx; &#125; e[N * <span class=\"number\">2</span>];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-19\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    sz[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) &#123;</span><br><span class=\"line\">        d[v] = d[u] + <span class=\"number\">1</span>, <span class=\"built_in\">dfs</span>(v), sz[u] += sz[v];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sz[v] &gt; sz[son[u]]) son[u] = v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> top)</span> </span>&#123;</span><br><span class=\"line\">    tp[u] = top, dfn[u] = ++idx;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(son[u]) <span class=\"built_in\">Dfs</span>(son[u], top);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(v ^ son[u]) <span class=\"built_in\">Dfs</span>(v, v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">lca</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; tp[u] ^ tp[v]; d[tp[u]] &gt; d[tp[v]] ? u = fa[tp[u]] : v = fa[tp[v]]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> d[u] &lt; d[v] ? u : v;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> t = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    e[++eid] = &#123;v, h1[u]&#125;, h1[u] = eid;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">bld</span><span class=\"params\">(<span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(a + <span class=\"number\">1</span>, a + k + <span class=\"number\">1</span>, [](<span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> b) &#123; <span class=\"keyword\">return</span> dfn[a] &lt; dfn[b]; &#125;);</span><br><span class=\"line\">    stk[++p] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, k) <span class=\"keyword\">if</span>(a[i] &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> x = <span class=\"built_in\">lca</span>(a[i], stk[p]);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(d[stk[p]] &gt; d[x])</span><br><span class=\"line\">            p--, <span class=\"built_in\">add</span>(d[stk[p]] &gt; d[x] ? stk[p] : x, stk[p + <span class=\"number\">1</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(stk[p] ^ x) stk[++p] = x;</span><br><span class=\"line\">        stk[++p] = a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(--p) <span class=\"built_in\">add</span>(stk[p], stk[p + <span class=\"number\">1</span>]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"-lca\"> <code>LCA</code></h2>\r\n<h3 id=\"-16\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> dl[N], dr[N], fa[<span class=\"number\">20</span>][N];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-20\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">lca</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(dl[u] &lt; dl[v]) <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(dl[v] &lt;= dl[u] &amp;&amp; dl[u] &lt; dr[v]) <span class=\"keyword\">return</span> v;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, <span class=\"number\">19</span>, <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> x = fa[i][u];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(x &amp;&amp; dl[x] &gt; dl[v]) u = x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> fa[<span class=\"number\">0</span>][u];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"int-\"><code>int</code> </h3>\r\n<h4 id=\"-17\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, m, s, t;</span><br><span class=\"line\"><span class=\"keyword\">int</span> eid = <span class=\"number\">1</span>, he[N], nw[N], d[N], q[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">edge</span> &#123;</span> <span class=\"keyword\">int</span> v, nx, c; &#125; e[M * <span class=\"number\">2</span>];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-21\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> c)</span> </span>&#123;</span><br><span class=\"line\">    e[++eid] = &#123;v, he[u], c&#125;, he[u] = eid;</span><br><span class=\"line\">    e[++eid] = &#123;u, he[v], <span class=\"number\">0</span>&#125;, he[v] = eid;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">bfs</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(d, <span class=\"number\">0</span>), <span class=\"built_in\">memcpy</span>(nw, he, <span class=\"keyword\">sizeof</span> he);</span><br><span class=\"line\">    q[<span class=\"number\">1</span>] = s, d[s] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> l = <span class=\"number\">1</span>, r = <span class=\"number\">1</span>; l &lt;= r; l++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> u = q[l];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = he[u], v; v = e[i].v; i = e[i].nx)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(e[i].c &amp;&amp; !d[v]) q[++r] = v, d[v] = d[u] + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> d[t];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> lim, <span class=\"keyword\">int</span> re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u == t) <span class=\"keyword\">return</span> lim;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span>&amp; i = nw[u], v; v = e[i].v; i = e[i].nx)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(e[i].c &amp;&amp; d[v] == d[u] + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> t = <span class=\"built_in\">dfs</span>(v, <span class=\"built_in\">min</span>(e[i].c, lim));</span><br><span class=\"line\">        e[i].c -= t, e[i ^ <span class=\"number\">1</span>].c += t, re += t, lim -= t;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!lim) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(lim) d[u] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-1\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> flow = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">while</span>(<span class=\"built_in\">bfs</span>()) flow += <span class=\"built_in\">dfs</span>(s, Inf);</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"long-long-\"><code>long long</code> </h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">bfs</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(d, <span class=\"number\">0</span>), <span class=\"built_in\">memcpy</span>(nw, he, <span class=\"keyword\">sizeof</span> he);</span><br><span class=\"line\">    q[<span class=\"number\">1</span>] = s, d[s] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> l = <span class=\"number\">1</span>, r = <span class=\"number\">1</span>; l &lt;= r; l++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> u = q[l];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = he[u], v; v = e[i].v; i = e[i].nx)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(e[i].c &amp;&amp; !d[v]) q[++r] = v, d[v] = d[u] + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> d[t];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, ll lim, ll re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u == t) <span class=\"keyword\">return</span> lim;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span>&amp; i = nw[u], v; v = e[i].v; i = e[i].nx)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(e[i].c &amp;&amp; d[v] == d[u] + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        ll t = <span class=\"built_in\">dfs</span>(v, <span class=\"built_in\">min</span>((ll)e[i].c, lim));</span><br><span class=\"line\">        e[i].c -= t, e[i ^ <span class=\"number\">1</span>].c += t, re += t, lim -= t;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!lim) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(lim) d[u] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"ssp-\">SSP </h3>\r\n<h4 id=\"-18\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, m, s, t, flow, cost;</span><br><span class=\"line\"><span class=\"keyword\">int</span> eid = <span class=\"number\">1</span>, he[N], nw[N], q[N], d[N], vs[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">edge</span> &#123;</span> <span class=\"keyword\">int</span> v, nx, c, w; &#125; e[M * <span class=\"number\">2</span>];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-22\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> c, <span class=\"keyword\">int</span> w)</span> </span>&#123;</span><br><span class=\"line\">    e[++eid] = &#123;v, he[u], c, w&#125;, he[u] = eid;</span><br><span class=\"line\">    e[++eid] = &#123;u, he[v], <span class=\"number\">0</span>, -w&#125;, he[v] = eid;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">spfa</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(d, <span class=\"number\">63</span>), <span class=\"built_in\">memcpy</span>(nw, he, <span class=\"keyword\">sizeof</span> he);</span><br><span class=\"line\">    q[<span class=\"number\">0</span>] = s, d[s] = <span class=\"number\">0</span>, vs[s] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> l = <span class=\"number\">0</span>, r = <span class=\"number\">0</span>; l &lt;= r; l++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> u = q[l % N]; vs[u] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = he[u], v; v = e[i].v; i = e[i].nx)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(e[i].c &amp;&amp; d[u] + e[i].w &lt; d[v]) &#123;</span><br><span class=\"line\">            d[v] = d[u] + e[i].w;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!vs[v]) q[++r % N] = v, vs[v] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> d[t] &lt; d[<span class=\"number\">0</span>];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> lim, <span class=\"keyword\">int</span> re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u == t) <span class=\"keyword\">return</span> lim;</span><br><span class=\"line\">    vs[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span>&amp; i = nw[u], v; v = e[i].v; i = e[i].nx)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!vs[v] &amp;&amp; e[i].c &amp;&amp; d[v] == d[u] + e[i].w) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> t = <span class=\"built_in\">dfs</span>(v, <span class=\"built_in\">min</span>(lim, e[i].c));</span><br><span class=\"line\">        e[i].c -= t, e[i ^ <span class=\"number\">1</span>].c += t, re += t, lim -= t, cost += t * e[i].w;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!lim) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(lim) d[u] = d[<span class=\"number\">0</span>];</span><br><span class=\"line\">    vs[u] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-2\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span>(<span class=\"built_in\">spfa</span>()) flow += <span class=\"built_in\">dfs</span>(s, <span class=\"number\">1e9</span>);</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"primal-dual-\">Primal-Dual </h3>\r\n<h4 id=\"-19\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, m, s, t, flow, cost;</span><br><span class=\"line\"><span class=\"keyword\">int</span> eid = <span class=\"number\">1</span>, he[N], d[N], pre[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">edge</span> &#123;</span> <span class=\"keyword\">int</span> v, nx, c, w; &#125; e[M * <span class=\"number\">2</span>];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> d, u;</span><br><span class=\"line\">    <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span> &lt;(<span class=\"keyword\">const</span> node&amp; b)<span class=\"keyword\">const</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> d &gt; b.d;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-23\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> c, <span class=\"keyword\">int</span> w)</span> </span>&#123;</span><br><span class=\"line\">    e[++eid] = &#123;v, he[u], c, w&#125;, he[u] = eid;</span><br><span class=\"line\">    e[++eid] = &#123;u, he[v], <span class=\"number\">0</span>, -w&#125;, he[v] = eid;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dji</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    priority_queue&lt;node&gt; q;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(d, <span class=\"number\">63</span>), q.<span class=\"built_in\">push</span>(&#123;d[s] = <span class=\"number\">0</span>, s&#125;);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(q.<span class=\"built_in\">size</span>()) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> [dis, u] = q.<span class=\"built_in\">top</span>(); q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dis &gt; d[u]) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = he[u], v; v = e[i].v; i = e[i].nx) <span class=\"keyword\">if</span>(e[i].c) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> w = d[u] + e[i].w - h[v] + h[u];</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(w &lt; d[v]) pre[v] = i ^ <span class=\"number\">1</span>, q.<span class=\"built_in\">push</span>(&#123;d[v] = w, v&#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) h[i] += d[i];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> d[t] &lt; d[<span class=\"number\">0</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-3\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span>(<span class=\"built_in\">dji</span>()) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> mi = Inf;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> u = t, i; i = pre[u]; u = e[i].v) mi = <span class=\"built_in\">min</span>(mi, e[i ^ <span class=\"number\">1</span>].c);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> u = t, i; i = pre[u]; u = e[i].v) e[i].c += mi, e[i ^ <span class=\"number\">1</span>].c -= mi;</span><br><span class=\"line\">    flow += mi, cost += mi * h[t];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-20\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, m, vs[N], mch[N];</span><br><span class=\"line\">vector&lt;<span class=\"keyword\">int</span>&gt; G[N];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-24\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> s)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(vs[u] == s) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    vs[u] = s;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(!mch[v] || <span class=\"built_in\">dfs</span>(mch[v], s)) <span class=\"keyword\">return</span> mch[v] = u;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-4\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> as = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(<span class=\"built_in\">dfs</span>(i, i)) as++;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"sat-\">2-SAT </h2>\r\n<h3 id=\"-21\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, m, co[N * <span class=\"number\">2</span>], stk[N * <span class=\"number\">2</span>], tp;</span><br><span class=\"line\">vector&lt;<span class=\"keyword\">int</span>&gt; G[N * <span class=\"number\">2</span>];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-25\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> b)</span> </span>&#123;</span><br><span class=\"line\">    G[u * <span class=\"number\">2</span> + !a].<span class=\"built_in\">pb</span>(v * <span class=\"number\">2</span> + b);</span><br><span class=\"line\">    G[v * <span class=\"number\">2</span> + !b].<span class=\"built_in\">pb</span>(u * <span class=\"number\">2</span> + a);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(co[u] | co[u ^ <span class=\"number\">1</span>]) <span class=\"keyword\">return</span> co[u];</span><br><span class=\"line\">    co[u] = <span class=\"number\">1</span>, stk[++tp] = u;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(!<span class=\"built_in\">dfs</span>(v)) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">twoSat</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!co[i * <span class=\"number\">2</span>] &amp;&amp; !co[i * <span class=\"number\">2</span> + <span class=\"number\">1</span>] &amp;&amp; !<span class=\"built_in\">dfs</span>(i * <span class=\"number\">2</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(tp) co[stk[tp--]] = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!<span class=\"built_in\">dfs</span>(i * <span class=\"number\">2</span> + <span class=\"number\">1</span>)) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        tp = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"\"></h1>\r\n<h2 id=\"manacher-\">manacher </h2>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span>&amp; j = ma &gt; i ? <span class=\"built_in\">min</span>(R[p * <span class=\"number\">2</span> - i], ma - i) : <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(s[i - j] == s[i + j + <span class=\"number\">1</span>]) j++;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i + j &gt; ma) ma = i + j, p = i;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-3\"></h3>\r\n<h4 id=\"-22\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">char</span> s[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, sz = <span class=\"number\">1</span>, nw, len[N], f[N], ch[N][<span class=\"number\">26</span>];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-26\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> jmp = [&amp;](<span class=\"keyword\">int</span> o) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(s[i - len[o] - <span class=\"number\">1</span>] != s[i]) o = f[o];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> o;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> o = <span class=\"built_in\">jmp</span>(nw), c = s[i] - <span class=\"number\">97</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!ch[o][c]]) &#123;</span><br><span class=\"line\">        f[++sz] = ch[<span class=\"built_in\">jmp</span>(f[o])][c];</span><br><span class=\"line\">        len[ch[o][c] = sz] = len[o] + <span class=\"number\">2</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    nw = ch[o][c];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-4\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">len[<span class=\"number\">1</span>] = <span class=\"number\">-1</span>, f[<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"-27\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> jmp = [&amp;](<span class=\"keyword\">int</span> o) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(o &amp;&amp; s[i - len[o] - <span class=\"number\">1</span>] != s[i]) o = f[o];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> o;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> o = <span class=\"built_in\">jmp</span>(nw), c = s[i] - <span class=\"number\">97</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!ch[o][c]]) &#123;</span><br><span class=\"line\">        f[++sz] = ch[<span class=\"built_in\">jmp</span>(f[o])][c];</span><br><span class=\"line\">        len[ch[o][c] = sz] = len[o] + <span class=\"number\">2</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    nw = ch[o][c];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-5\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, <span class=\"number\">25</span>) ch[<span class=\"number\">0</span>][i] = <span class=\"number\">1</span>;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-23\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, m = <span class=\"number\">128</span>, sa[N], rk[N], tp[N], buc[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> h[<span class=\"number\">20</span>][N];</span><br><span class=\"line\"><span class=\"keyword\">char</span> s[N];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-28\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">SA</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) buc[rk[i] = s[i]]++;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) buc[i] += buc[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, n, <span class=\"number\">1</span>) sa[buc[rk[i]]--] = i;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> k = <span class=\"number\">1</span>, p; <span class=\"built_in\">memset</span>(buc, p = <span class=\"number\">0</span>, m * <span class=\"number\">4</span> + <span class=\"number\">4</span>); k *= <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, n - k + <span class=\"number\">1</span>, n) tp[++p] = i;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(sa[i] &gt; k) tp[++p] = sa[i] - k;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) buc[rk[i]]++;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) buc[i] += buc[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(i, n, <span class=\"number\">1</span>) sa[buc[rk[tp[i]]]--] = tp[i];</span><br><span class=\"line\">        <span class=\"built_in\">memcpy</span>(tp, rk, n * <span class=\"number\">4</span> + <span class=\"number\">4</span>), p = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) rk[sa[i]] = p += tp[sa[i]] ^ tp[sa[i - <span class=\"number\">1</span>]] || tp[sa[i] + k] ^ tp[sa[i - <span class=\"number\">1</span>] + k];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((m = p) &gt;= n) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">height</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> k = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(k ? k-- : <span class=\"number\">0</span>; s[i + k] == s[sa[rk[i] - <span class=\"number\">1</span>] + k]; k++);</span><br><span class=\"line\">        h[<span class=\"number\">0</span>][rk[i]] = k;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">19</span>) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, n - (<span class=\"number\">1</span> &lt;&lt; i) + <span class=\"number\">1</span>)</span><br><span class=\"line\">        h[i][j] = <span class=\"built_in\">min</span>(h[i - <span class=\"number\">1</span>][j], h[i - <span class=\"number\">1</span>][j + (<span class=\"number\">1</span> &lt;&lt; (i - <span class=\"number\">1</span>))]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-24\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">char</span> s[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, sz = <span class=\"number\">1</span>, nw = <span class=\"number\">1</span>, f[N], len[N], ch[N][<span class=\"number\">26</span>];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-29\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span> c)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> u = ++sz;</span><br><span class=\"line\">    len[u] = len[nw] + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(nw &amp;&amp; !ch[nw][c]) ch[nw][c] = u, nw = f[nw];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!nw) f[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> v = ch[nw][c];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(len[v] &gt; len[nw] + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            f[++sz] = f[v], <span class=\"built_in\">memcpy</span>(ch[sz], ch[v], <span class=\"keyword\">sizeof</span> ch[v]);</span><br><span class=\"line\">            f[v] = f[u] = sz, len[sz] = len[nw] + <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> x = nw; ch[x][c] == v; x = f[x]) ch[x][c] = sz;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> f[u] = v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    nw = u;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-30\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">calc</span><span class=\"params\">(<span class=\"keyword\">char</span> s[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i = <span class=\"number\">0</span>, j = <span class=\"number\">1</span>, k = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(i &lt; n &amp;&amp; j &lt; n &amp;&amp; k &lt; n)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(s[(i + k) % n] == s[(j + k) % n]) k++;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(s[(i + k) % n] &gt; s[(j + k) % n]) <span class=\"built_in\">swap</span>(i, j);</span><br><span class=\"line\">        j += k + <span class=\"number\">1</span>, k = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i == j) i++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">min</span>(i, j);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<!-- flag of hidden posts -->","site":{"data":{}},"length":42331,"excerpt":"","more":"<p><strong></strong></p>\r\n<p></p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> lf = <span class=\"keyword\">double</span>;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"\"></h1>\r\n<h2 id=\"fast-io\">Fast IO</h2>\r\n<h4 id=\"\"></h4>\r\n<h5 id=\"\"></h5>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">int</span> M = <span class=\"number\">1e6</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* in = cin.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> gc (p1 == p2 &amp;&amp; (p2 = (p1 = buf) + in -&gt; sgetn(buf, M), p1 == p2) ? -1 : *p1++)</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> buf[M], *p1, *p2;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> c = gc, r = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &lt; <span class=\"number\">48</span>) c = gc;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &gt; <span class=\"number\">47</span>) r = r * <span class=\"number\">10</span> + (c &amp; <span class=\"number\">15</span>), c = gc;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">wrt</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* out = cout.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> pc out -&gt; sputc</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> c[<span class=\"number\">11</span>]; <span class=\"keyword\">int</span> sz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> c[++sz] = x % <span class=\"number\">10</span>, x /= <span class=\"number\">10</span>; <span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(sz) <span class=\"built_in\">pc</span>(c[sz--] + <span class=\"number\">48</span>);</span><br><span class=\"line\">    <span class=\"built_in\">pc</span>(<span class=\"number\">10</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h5 id=\"\"></h5>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>), cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>), cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">int</span> M = <span class=\"number\">1e6</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* in = cin.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> gc (p1 == p2 &amp;&amp; (p2 = (p1 = buf) + in -&gt; sgetn(buf, M), p1 == p2) ? -1 : *p1++)</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> buf[M], *p1, *p2;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> c = gc, r = <span class=\"number\">0</span>, f = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &lt; <span class=\"number\">48</span>) &#123; <span class=\"keyword\">if</span>(c == <span class=\"number\">45</span>) f = <span class=\"number\">-1</span>; c = gc; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c &gt; <span class=\"number\">47</span>) r = r * <span class=\"number\">10</span> + (c &amp; <span class=\"number\">15</span>), c = gc;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r * f;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">wrt</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* out = cout.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> pc out -&gt; sputc</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> c[<span class=\"number\">11</span>]; <span class=\"keyword\">int</span> sz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(x &lt; <span class=\"number\">0</span>) <span class=\"built_in\">pc</span>(<span class=\"number\">45</span>), x = -x;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> c[++sz] = x % <span class=\"number\">10</span>, x /= <span class=\"number\">10</span>; <span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(sz) <span class=\"built_in\">pc</span>(c[sz--] + <span class=\"number\">48</span>);</span><br><span class=\"line\">    <span class=\"built_in\">pc</span>(<span class=\"number\">10</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><strong> <code>long long</code>  <code>wrt</code>  <code>c</code>  <span class=\"math inline\">\\(20\\)</span></strong></p>\r\n<h2 id=\"atcoder-modint\">AtCoder-modint</h2>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> uint = <span class=\"keyword\">unsigned</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ull = <span class=\"keyword\">unsigned</span> ll;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> ll <span class=\"title\">safe_mod</span><span class=\"params\">(ll x, ll m)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x %= m, x &lt; <span class=\"number\">0</span> ? x + m : x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> ll <span class=\"title\">pow_mod_constexpr</span><span class=\"params\">(ll x, ll n, <span class=\"keyword\">int</span> m)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(m == <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    uint _m = m;</span><br><span class=\"line\">    ull r = <span class=\"number\">1</span>, _x = <span class=\"built_in\">safe_mod</span>(x, m);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n &gt;&gt;= <span class=\"number\">1</span>, _x = _x * _x % _m)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * _x % m;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"keyword\">bool</span> <span class=\"title\">is_prime_constexpr</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &lt;= <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n == <span class=\"number\">2</span> || n == <span class=\"number\">7</span> || n == <span class=\"number\">61</span>) <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n % <span class=\"number\">2</span> == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    ll d = n - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(~d &amp; <span class=\"number\">1</span>) d /= <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(ll a : &#123;<span class=\"number\">2</span>, <span class=\"number\">7</span>, <span class=\"number\">61</span>&#125;) &#123;</span><br><span class=\"line\">        ll t = d, y = <span class=\"built_in\">pow_mod_constexpr</span>(a, t, n);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(t != n - <span class=\"number\">1</span> &amp;&amp; y != <span class=\"number\">1</span> &amp;&amp; y != n - <span class=\"number\">1</span>)</span><br><span class=\"line\">            y = y * y % n, t &lt;&lt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(y != n - <span class=\"number\">1</span> &amp;&amp; t % <span class=\"number\">2</span> == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> pair&lt;ll, ll&gt; <span class=\"title\">inv_gcd</span><span class=\"params\">(ll a, ll b)</span> </span>&#123;</span><br><span class=\"line\">    a = <span class=\"built_in\">safe_mod</span>(a, b);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(a == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> &#123;b, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    ll s = b, t = a, m0 = <span class=\"number\">0</span>, m1 = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(t) &#123;</span><br><span class=\"line\">        ll u = s / t;</span><br><span class=\"line\">        s -= t * u, m0 -= m1 * u;</span><br><span class=\"line\">        ll tmp = s;</span><br><span class=\"line\">        s = t, t = tmp, tmp = m0, m0 = m1, m1 = tmp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(m0 &lt; <span class=\"number\">0</span>) m0 += b / s;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;s, m0&#125;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">barrett</span> &#123;</span></span><br><span class=\"line\">    uint m; ull im;</span><br><span class=\"line\">    <span class=\"built_in\">barrett</span>(uint m) :<span class=\"built_in\">m</span>(m), <span class=\"built_in\">im</span>(~<span class=\"number\">0ull</span> / m + <span class=\"number\">1</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\">uint <span class=\"title\">mul</span><span class=\"params\">(uint a, uint b)</span> <span class=\"keyword\">const</span> </span>&#123;</span><br><span class=\"line\">        ull z = (ull)a * b;</span><br><span class=\"line\">        ull x = (<span class=\"keyword\">unsigned</span> __int128)z * im &gt;&gt; <span class=\"number\">64</span>;</span><br><span class=\"line\">        uint v = z - x * m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> m &lt;= v ? v + m : v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">int</span> m&gt; <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">static_modint</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">using</span> mint = static_modint;</span><br><span class=\"line\">  <span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> mint <span class=\"title\">raw</span><span class=\"params\">(<span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">        mint x;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x._v = v, x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">static_modint</span>() : _v(<span class=\"number\">0</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">template</span>&lt;class T&gt; <span class=\"title\">static_modint</span><span class=\"params\">(T v)</span> </span>&#123;</span><br><span class=\"line\">        ll x = v % m;</span><br><span class=\"line\">        _v = x &lt; <span class=\"number\">0</span> ? x + m : x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">uint <span class=\"title\">val</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"keyword\">return</span> _v; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>++() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(++_v == m) _v = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>--() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!_v--) _v = m - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>++(<span class=\"keyword\">int</span>) &#123;</span><br><span class=\"line\">        mint res = *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        ++*<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>--(<span class=\"keyword\">int</span>) &#123;</span><br><span class=\"line\">        mint res = *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        --*<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>+=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        _v += rhs._v;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(_v &gt;= m) _v -= m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>-=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        _v -= rhs._v;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(_v &gt;= m) _v += m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>*=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        ull z = _v;</span><br><span class=\"line\">        z *= rhs._v, _v = z % m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>/=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span> = *<span class=\"keyword\">this</span> * rhs.<span class=\"built_in\">inv</span>(); &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>+() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>-() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>() - *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">pow</span><span class=\"params\">(ll n)</span> <span class=\"keyword\">const</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= n);</span><br><span class=\"line\">        mint x = *<span class=\"keyword\">this</span>, r = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; n; n &gt;&gt;= <span class=\"number\">1</span>, x *= x) <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r *= x;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">inv</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(prime) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(_v);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">pow</span>(m - <span class=\"number\">2</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">auto</span> eg = <span class=\"built_in\">inv_gcd</span>(_v, m);</span><br><span class=\"line\">            <span class=\"built_in\">assert</span>(eg.first == <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> eg.second;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>+(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) += rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>-(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) -= rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>*(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) *= rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>/(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) /= rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>==(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lhs._v == rhs._v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>!=(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lhs._v != rhs._v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span>:</span><br><span class=\"line\">    uint _v;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">constexpr</span> <span class=\"keyword\">bool</span> prime = <span class=\"built_in\">is_prime_constexpr</span>(m);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">int</span> id&gt; <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">dynamic_modint</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">using</span> mint = dynamic_modint;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">set_mod</span><span class=\"params\">(<span class=\"keyword\">int</span> m)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(<span class=\"number\">1</span> &lt;= m), bt = <span class=\"built_in\">barrett</span>(m);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> mint <span class=\"title\">raw</span><span class=\"params\">(<span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">        mint x;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x._v = v, x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">dynamic_modint</span>() : _v(<span class=\"number\">0</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">template</span>&lt;class T&gt; <span class=\"title\">dynamic_modint</span><span class=\"params\">(T v)</span> </span>&#123;</span><br><span class=\"line\">        ll x = v % bt.m;</span><br><span class=\"line\">        _v = x &lt; <span class=\"number\">0</span> ? x + bt.m : x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">uint <span class=\"title\">val</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"keyword\">return</span> _v; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>++() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(++_v == bt.m) _v = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>--() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!_v--) _v = bt.m - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>++(<span class=\"keyword\">int</span>) &#123;</span><br><span class=\"line\">        mint res = *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        ++*<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>--(<span class=\"keyword\">int</span>) &#123;</span><br><span class=\"line\">        mint res = *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        --*<span class=\"keyword\">this</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>+=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        _v += rhs._v;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(_v &gt;= bt.m) _v -= bt.m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>-=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        _v += bt.m - rhs._v;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(_v &gt;= bt.m) _v -= bt.m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>*=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        _v = bt.<span class=\"built_in\">mul</span>(_v, rhs._v);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>/=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span> = *<span class=\"keyword\">this</span> * rhs.<span class=\"built_in\">inv</span>(); &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>+() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>-() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>() - *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">pow</span><span class=\"params\">(ll n)</span> <span class=\"keyword\">const</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= n);</span><br><span class=\"line\">        mint x = *<span class=\"keyword\">this</span>, r = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; n; n &gt;&gt;= <span class=\"number\">1</span>, x *= x) <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r *= x;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">inv</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> eg = <span class=\"built_in\">inv_gcd</span>(_v, bt.m);</span><br><span class=\"line\">        <span class=\"built_in\">assert</span>(eg.first == <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> eg.second;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>+(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) += rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>-(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) -= rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>*(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) *= rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>/(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) /= rhs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>==(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lhs._v == rhs._v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>!=(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lhs._v != rhs._v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">private</span>:</span><br><span class=\"line\">    uint _v;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> barrett bt;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">int</span> id&gt; barrett dynamic_modint&lt;id&gt;::bt = <span class=\"number\">998244353</span>;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> uint = <span class=\"keyword\">unsigned</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ull = <span class=\"keyword\">unsigned</span> ll;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> ll <span class=\"title\">safe_mod</span><span class=\"params\">(ll x, ll m)</span> </span>&#123; <span class=\"keyword\">return</span> x %= m, x &lt; <span class=\"number\">0</span> ? x + m : x; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> ll <span class=\"title\">pow_mod_constexpr</span><span class=\"params\">(ll x, ll n, <span class=\"keyword\">int</span> m)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(m == <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    uint _m = m; ull r = <span class=\"number\">1</span>, _x = <span class=\"built_in\">safe_mod</span>(x, m);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n &gt;&gt;= <span class=\"number\">1</span>, _x = _x * _x % _m) <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * _x % m;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> <span class=\"keyword\">bool</span> <span class=\"title\">is_prime_constexpr</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &lt;= <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n == <span class=\"number\">2</span> || n == <span class=\"number\">7</span> || n == <span class=\"number\">61</span>) <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n % <span class=\"number\">2</span> == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    ll d = n - <span class=\"number\">1</span>; <span class=\"keyword\">while</span>(~d &amp; <span class=\"number\">1</span>) d /= <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(ll a : &#123;<span class=\"number\">2</span>, <span class=\"number\">7</span>, <span class=\"number\">61</span>&#125;) &#123;</span><br><span class=\"line\">        ll t = d, y = <span class=\"built_in\">pow_mod_constexpr</span>(a, t, n);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(t != n - <span class=\"number\">1</span> &amp;&amp; y != <span class=\"number\">1</span> &amp;&amp; y != n - <span class=\"number\">1</span>) y = y * y % n, t &lt;&lt;= <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(y != n - <span class=\"number\">1</span> &amp;&amp; t % <span class=\"number\">2</span> == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">constexpr</span> pair&lt;ll, ll&gt; <span class=\"title\">inv_gcd</span><span class=\"params\">(ll a, ll b)</span> </span>&#123;</span><br><span class=\"line\">    a = <span class=\"built_in\">safe_mod</span>(a, b);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(a == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> &#123;b, <span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    ll s = b, t = a, m0 = <span class=\"number\">0</span>, m1 = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(t) &#123;</span><br><span class=\"line\">        ll u = s / t; s -= t * u, m0 -= m1 * u;</span><br><span class=\"line\">        ll tmp = s; s = t, t = tmp, tmp = m0, m0 = m1, m1 = tmp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(m0 &lt; <span class=\"number\">0</span>) m0 += b / s;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;s, m0&#125;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">barrett</span> &#123;</span></span><br><span class=\"line\">    uint m; ull im;</span><br><span class=\"line\">    <span class=\"built_in\">barrett</span>(uint m) :<span class=\"built_in\">m</span>(m), <span class=\"built_in\">im</span>(~<span class=\"number\">0ull</span> / m + <span class=\"number\">1</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\">uint <span class=\"title\">mul</span><span class=\"params\">(uint a, uint b)</span> <span class=\"keyword\">const</span> </span>&#123;</span><br><span class=\"line\">        ull z = (ull)a * b; ull x = (<span class=\"keyword\">unsigned</span> __int128)z * im &gt;&gt; <span class=\"number\">64</span>; uint v = z - x * m;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> m &lt;= v ? v + m : v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">int</span> m&gt; <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">static_modint</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">using</span> mint = static_modint;</span><br><span class=\"line\">  <span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> mint <span class=\"title\">raw</span><span class=\"params\">(<span class=\"keyword\">int</span> v)</span> </span>&#123; mint x; <span class=\"keyword\">return</span> x._v = v, x; &#125;</span><br><span class=\"line\">    <span class=\"built_in\">static_modint</span>() : _v(<span class=\"number\">0</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">template</span>&lt;class T&gt; <span class=\"title\">static_modint</span><span class=\"params\">(T v)</span> </span>&#123; ll x = v % m; _v = x &lt; <span class=\"number\">0</span> ? x + m : x; &#125;</span><br><span class=\"line\">    <span class=\"function\">uint <span class=\"title\">val</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"keyword\">return</span> _v; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>++() &#123; <span class=\"keyword\">if</span>(++_v == m) _v = <span class=\"number\">0</span>; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>--() &#123; <span class=\"keyword\">if</span>(!_v--) _v = m - <span class=\"number\">1</span>; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>++(<span class=\"keyword\">int</span>) &#123; mint res = *<span class=\"keyword\">this</span>; ++*<span class=\"keyword\">this</span>; <span class=\"keyword\">return</span> res; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>--(<span class=\"keyword\">int</span>) &#123; mint res = *<span class=\"keyword\">this</span>; --*<span class=\"keyword\">this</span>; <span class=\"keyword\">return</span> res; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>+=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; _v += rhs._v; <span class=\"keyword\">if</span>(_v &gt;= m) _v -= m; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>-=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; _v -= rhs._v; <span class=\"keyword\">if</span>(_v &gt;= m) _v += m; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>*=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; ull z = _v; z *= rhs._v, _v = z % m; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>/=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span> = *<span class=\"keyword\">this</span> * rhs.<span class=\"built_in\">inv</span>(); &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>+() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>-() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>() - *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">pow</span><span class=\"params\">(ll n)</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= n); mint x = *<span class=\"keyword\">this</span>, r = <span class=\"number\">1</span>; <span class=\"keyword\">for</span>(; n; n &gt;&gt;= <span class=\"number\">1</span>, x *= x) <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r *= x; <span class=\"keyword\">return</span> r; &#125;</span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">inv</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"keyword\">if</span>(prime) &#123; <span class=\"built_in\">assert</span>(_v); <span class=\"keyword\">return</span> <span class=\"built_in\">pow</span>(m - <span class=\"number\">2</span>); &#125; <span class=\"keyword\">else</span> &#123; <span class=\"keyword\">auto</span> eg = <span class=\"built_in\">inv_gcd</span>(_v, m); <span class=\"built_in\">assert</span>(eg.first == <span class=\"number\">1</span>); <span class=\"keyword\">return</span> eg.second; &#125; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>+(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) += rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>-(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) -= rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>*(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) *= rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>/(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) /= rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>==(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> lhs._v == rhs._v; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>!=(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> lhs._v != rhs._v; &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span>:</span><br><span class=\"line\">    uint _v;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">constexpr</span> <span class=\"keyword\">bool</span> prime = <span class=\"built_in\">is_prime_constexpr</span>(m);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">int</span> id&gt; <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">dynamic_modint</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">using</span> mint = dynamic_modint;</span><br><span class=\"line\">  <span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">set_mod</span><span class=\"params\">(<span class=\"keyword\">int</span> m)</span> </span>&#123; <span class=\"built_in\">assert</span>(<span class=\"number\">1</span> &lt;= m), bt = <span class=\"built_in\">barrett</span>(m); &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">static</span> mint <span class=\"title\">raw</span><span class=\"params\">(<span class=\"keyword\">int</span> v)</span> </span>&#123; mint x; <span class=\"keyword\">return</span> x._v = v, x; &#125;</span><br><span class=\"line\">    <span class=\"built_in\">dynamic_modint</span>() : _v(<span class=\"number\">0</span>) &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">template</span>&lt;class T&gt; <span class=\"title\">dynamic_modint</span><span class=\"params\">(T v)</span> </span>&#123; ll x = v % bt.m; _v = x &lt; <span class=\"number\">0</span> ? x + bt.m : x; &#125;</span><br><span class=\"line\">    <span class=\"function\">uint <span class=\"title\">val</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"keyword\">return</span> _v; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>++() &#123; <span class=\"keyword\">if</span>(++_v == bt.m) _v = <span class=\"number\">0</span>; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>--() &#123; <span class=\"keyword\">if</span>(!_v--) _v = bt.m - <span class=\"number\">1</span>; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>++(<span class=\"keyword\">int</span>) &#123; mint res = *<span class=\"keyword\">this</span>; ++*<span class=\"keyword\">this</span>; <span class=\"keyword\">return</span> res; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>--(<span class=\"keyword\">int</span>) &#123; mint res = *<span class=\"keyword\">this</span>; --*<span class=\"keyword\">this</span>; <span class=\"keyword\">return</span> res; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>+=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; _v += rhs._v; <span class=\"keyword\">if</span>(_v &gt;= bt.m) _v -= bt.m; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>-=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; _v += bt.m - rhs._v; <span class=\"keyword\">if</span>(_v &gt;= bt.m) _v -= bt.m; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>*=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; _v = bt.<span class=\"built_in\">mul</span>(_v, rhs._v); <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint&amp; <span class=\"keyword\">operator</span>/=(<span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span> = *<span class=\"keyword\">this</span> * rhs.<span class=\"built_in\">inv</span>(); &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>+() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    mint <span class=\"keyword\">operator</span>-() <span class=\"keyword\">const</span> &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>() - *<span class=\"keyword\">this</span>; &#125;</span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">pow</span><span class=\"params\">(ll n)</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"built_in\">assert</span>(<span class=\"number\">0</span> &lt;= n); mint x = *<span class=\"keyword\">this</span>, r = <span class=\"number\">1</span>; <span class=\"keyword\">for</span>(; n; n &gt;&gt;= <span class=\"number\">1</span>, x *= x) <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r *= x; <span class=\"keyword\">return</span> r; &#125;</span><br><span class=\"line\">    <span class=\"function\">mint <span class=\"title\">inv</span><span class=\"params\">()</span> <span class=\"keyword\">const</span> </span>&#123; <span class=\"keyword\">auto</span> eg = <span class=\"built_in\">inv_gcd</span>(_v, bt.m); <span class=\"built_in\">assert</span>(eg.first == <span class=\"number\">1</span>); <span class=\"keyword\">return</span> eg.second; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>+(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) += rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>-(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) -= rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>*(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) *= rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> mint <span class=\"keyword\">operator</span>/(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> <span class=\"built_in\">mint</span>(lhs) /= rhs; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>==(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> lhs._v == rhs._v; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">friend</span> <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span>!=(<span class=\"keyword\">const</span> mint&amp; lhs, <span class=\"keyword\">const</span> mint&amp; rhs) &#123; <span class=\"keyword\">return</span> lhs._v != rhs._v; &#125;</span><br><span class=\"line\">  <span class=\"keyword\">private</span>:</span><br><span class=\"line\">    uint _v;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> barrett bt;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"keyword\">int</span> id&gt; barrett dynamic_modint&lt;id&gt;::bt = <span class=\"number\">998244353</span>;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> eb emplace_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> fi first </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> se second</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> all(x) (x).begin(), (x).end()</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> SZ(x) int((x).size())</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) / 2)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lc o * 2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rc o * 2 + 1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, lc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, rc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> cmi(a, b) (a = min(a, b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> cma(a, b) (a = max(a, b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lb lower_bound</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ub upper_bound</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> bs binary_search</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pop __builtin_popcount</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llpop __builtin_popcountll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ctz __builtin_ctz</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llctz __builtin_ctzll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> clz __builtin_clz</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llclz __builtin_clzll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> par __builtin_parity</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llpar __builtin_parityll</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> lf = <span class=\"keyword\">double</span>;</span><br><span class=\"line\"><span class=\"comment\">// using P = pair&lt;int, int&gt;;</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> V = vector&lt;<span class=\"keyword\">int</span>&gt;;</span><br><span class=\"line\"><span class=\"comment\">// using cmp = complex&lt;lf&gt;;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> local</span></span><br><span class=\"line\">    <span class=\"comment\">// freopen(&quot;.in&quot;, &quot;r&quot;, stdin);</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> T;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(cin &gt;&gt; T; T--; <span class=\"built_in\">solve</span>());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-1\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">gen</span><span class=\"params\">(ll x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> ll k = <span class=\"number\">0x9ddfea08eb382d69</span>ull;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">3</span>) x *= k, x ^= x &gt;&gt; <span class=\"number\">47</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * k;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">rnd</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> ll s = <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (s += <span class=\"built_in\">gen</span>(s)) &amp; LONG_LONG_MAX;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-2\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">mul</span><span class=\"params\">(ll a, ll b, ll p)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (a * b - <span class=\"built_in\">ll</span>((<span class=\"keyword\">long</span> <span class=\"keyword\">double</span>)a / p * b + <span class=\"number\">0.5</span>) * p + p) % p;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"bash-\"><code>bash</code> </h3>\r\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"literal\">true</span>; <span class=\"keyword\">do</span></span><br><span class=\"line\">    ./gen &gt; <span class=\"keyword\">in</span></span><br><span class=\"line\">    ./a &lt; <span class=\"keyword\">in</span> &gt; 1</span><br><span class=\"line\">    ./b &lt; <span class=\"keyword\">in</span> &gt; 2</span><br><span class=\"line\">    diff 1 2</span><br><span class=\"line\">    <span class=\"keyword\">if</span> [ $? -ne 0 ] ; <span class=\"keyword\">then</span> <span class=\"built_in\">break</span>; <span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">mul</span><span class=\"params\">(ll a, ll b, ll p)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (a * b - <span class=\"built_in\">ll</span>((<span class=\"keyword\">long</span> <span class=\"keyword\">double</span>)a / p * b + <span class=\"number\">0.5</span>) * p + p) % p;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">Pow</span><span class=\"params\">(ll a, ll n, ll p, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = <span class=\"built_in\">mul</span>(a, a, p))</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = <span class=\"built_in\">mul</span>(r, a, p);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Pollard_Rho &#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">chk</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(ll a : &#123;<span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">7</span>, <span class=\"number\">61</span>, <span class=\"number\">24251</span>&#125;) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(n == a) <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(<span class=\"built_in\">Pow</span>(a, n - <span class=\"number\">1</span>, n) ^ <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            ll k = n - <span class=\"number\">1</span>, t;</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(~k &amp; <span class=\"number\">1</span>) k /= <span class=\"number\">2</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>((t = <span class=\"built_in\">Pow</span>(a, k, n)) == <span class=\"number\">1</span>) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(t ^ <span class=\"number\">1</span> &amp;&amp; t ^ n - <span class=\"number\">1</span>) t = <span class=\"built_in\">mul</span>(t, t, n);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(t ^ n - <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">f</span><span class=\"params\">(ll x, ll c, ll p)</span> </span>&#123; <span class=\"keyword\">return</span> (<span class=\"built_in\">mul</span>(x, x, p) + c) % p; &#125;</span><br><span class=\"line\">    <span class=\"function\">ll <span class=\"title\">PR</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">        ll a = <span class=\"number\">0</span>, b = <span class=\"number\">0</span>, c = <span class=\"built_in\">rand</span>() % (n - <span class=\"number\">1</span>) + <span class=\"number\">1</span>, v = <span class=\"number\">1</span>, g;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> k = <span class=\"number\">1</span>; ; k *= <span class=\"number\">2</span>, a = b, v = <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, k) &#123;</span><br><span class=\"line\">                b = <span class=\"built_in\">f</span>(b, c, n), v = <span class=\"built_in\">mul</span>(v, <span class=\"built_in\">abs</span>(a - b), n);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(!(i &amp; <span class=\"number\">127</span>) || i == k) &#123;</span><br><span class=\"line\">                    g = __gcd(v, n);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(g &gt; <span class=\"number\">1</span>) <span class=\"keyword\">return</span> g;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ll ans[<span class=\"number\">100</span>]; <span class=\"keyword\">int</span> ct;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"built_in\">chk</span>(n)) <span class=\"keyword\">return</span> <span class=\"built_in\"><span class=\"keyword\">void</span></span>(ans[++ct] = n);</span><br><span class=\"line\">        ll d; <span class=\"keyword\">do</span> d = <span class=\"built_in\">PR</span>(n); <span class=\"keyword\">while</span>(d == n);</span><br><span class=\"line\">        <span class=\"built_in\">solve</span>(d), <span class=\"built_in\">solve</span>(n / d);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">work</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        ll n;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(cin &gt;&gt; n) &#123;</span><br><span class=\"line\">            ct = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(<span class=\"built_in\">chk</span>(n)) &#123; <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Prime&quot;</span>); <span class=\"keyword\">continue</span>; &#125;</span><br><span class=\"line\">            <span class=\"built_in\">solve</span>(n), <span class=\"built_in\">sort</span>(ans + <span class=\"number\">1</span>, ans + ct + <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> t = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, ct) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(ans[i] ^ ans[i - <span class=\"number\">1</span>]) cout &lt;&lt; ans[i];</span><br><span class=\"line\">                t++; <span class=\"keyword\">if</span>(ans[i] ^ ans[i + <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(t &gt; <span class=\"number\">1</span>) cout &lt;&lt; <span class=\"string\">&#x27;^&#x27;</span> &lt;&lt; t;</span><br><span class=\"line\">                    <span class=\"built_in\">putchar</span>(<span class=\"number\">32</span>), t = <span class=\"number\">0</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"built_in\">putchar</span>(<span class=\"number\">10</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Inv &#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">exgcd</span><span class=\"params\">(ll a, ll b, ll&amp; d, ll&amp; x, ll&amp; y)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(b) <span class=\"built_in\">exgcd</span>(b, a % b, d, y, x), y -= a / b * x;</span><br><span class=\"line\">        <span class=\"keyword\">else</span> d = a, x = <span class=\"number\">1</span>, y = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">inv</span><span class=\"params\">(ll a, ll p)</span> </span>&#123;</span><br><span class=\"line\">        ll d, x, y; <span class=\"built_in\">exgcd</span>(a, p, d, x, y);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(d &gt; <span class=\"number\">1</span>) <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Non-existent!&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> cout &lt;&lt; (x % p + p) % p;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">work</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        ll a, p;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(cin &gt;&gt; a &gt;&gt; p) <span class=\"built_in\">inv</span>(a, p);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Prime &#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">work</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        ll n;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(cin &gt;&gt; n) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(!Pollard_Rho::<span class=\"built_in\">chk</span>(n)) n++;</span><br><span class=\"line\">            cout &lt;&lt; n &lt;&lt; endl;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">namespace</span> Cipolla &#123;</span><br><span class=\"line\">    ll n, p, II;</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">cmp</span> &#123;</span></span><br><span class=\"line\">        ll r, i;</span><br><span class=\"line\">        cmp <span class=\"keyword\">operator</span> *(<span class=\"keyword\">const</span> cmp&amp; b) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> &#123;(r * b.r + i * b.i % p * II) % p, (r * b.i + i * b.r) % p &#125;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; U = &#123; <span class=\"number\">1</span>, <span class=\"number\">0</span> &#125;;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">pow1</span><span class=\"params\">(ll a, <span class=\"keyword\">int</span> n, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a % p)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a % p;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\">cmp <span class=\"title\">pow2</span><span class=\"params\">(cmp a, <span class=\"keyword\">int</span> n, cmp r = U)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">work</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(cin &gt;&gt; n &gt;&gt; p) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!n) &#123; <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;0&quot;</span>); <span class=\"keyword\">continue</span>; &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(p == <span class=\"number\">2</span>) &#123; cout &lt;&lt; n &lt;&lt; endl; <span class=\"keyword\">continue</span>; &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(<span class=\"built_in\">pow1</span>(n, p / <span class=\"number\">2</span>) ^ <span class=\"number\">1</span>) &#123; <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Non-existent!&quot;</span>); <span class=\"keyword\">continue</span>; &#125;</span><br><span class=\"line\">            ll a;</span><br><span class=\"line\">            <span class=\"keyword\">do</span> a = <span class=\"built_in\">rand</span>() % p, II = (a * a - n + p) % p; <span class=\"keyword\">while</span>(!a || <span class=\"built_in\">pow1</span>(II, p / <span class=\"number\">2</span>) == <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> x1 = <span class=\"built_in\">pow2</span>(&#123;a, <span class=\"number\">1</span>&#125;, p / <span class=\"number\">2</span> + <span class=\"number\">1</span>).r, x2 = p - x1;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(x1 &gt; x2) <span class=\"built_in\">swap</span>(x1, x2);</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d %d\\n&quot;</span>, x1, x2);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;; </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">srand</span>(<span class=\"built_in\">time</span>(<span class=\"number\">0</span>));</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Press 1 for integer factorization.&quot;</span>);</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Press 2 to calculate the modular multiplicative inverse of a number.&quot;</span>);</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Press 3 to find the first prime number greater than or equal to a number.&quot;</span>);</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Press 4 to calculate the modular square root of a number.&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> op;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        cin &gt;&gt; op;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(op == <span class=\"number\">1</span>) Pollard_Rho::<span class=\"built_in\">work</span>();</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(op == <span class=\"number\">2</span>) Inv::<span class=\"built_in\">work</span>();</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(op == <span class=\"number\">3</span>) Prime::<span class=\"built_in\">work</span>();</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(op == <span class=\"number\">4</span>) Cipolla::<span class=\"built_in\">work</span>();</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;Illegal input! Please re-enter your option.&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"\"></h1>\r\n<h2 id=\"ntt\">NTT</h2>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> lim = <span class=\"number\">1</span>, bit = <span class=\"number\">-1</span>, rev[N];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-3\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">Pow</span><span class=\"params\">(ll a, <span class=\"keyword\">int</span> n, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a % P)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(ll a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(rev[i] &lt; i) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">        ll wn = <span class=\"built_in\">Pow</span>(<span class=\"number\">3</span>, P / <span class=\"number\">2</span> / i);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            ll w = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">                ll &amp;x = a[k], y = a[k + i] * w % P;</span><br><span class=\"line\">                a[k + i] = (x - y) % P, (x += y) %= P, w = w * wn % P;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ll inv = <span class=\"built_in\">Pow</span>(lim, P - <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) (a[i] *= inv) %= P;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(mint a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(rev[i] &lt; i) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">        mint wn = <span class=\"built_in\">mint</span>(<span class=\"number\">3</span>).<span class=\"built_in\">pow</span>(P / <span class=\"number\">2</span> / i);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            mint w = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">                mint &amp;x = a[k], y = a[k + i] * w;</span><br><span class=\"line\">                a[k + i] = x - y, x += y, w *= wn;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint inv = <span class=\"built_in\">mint</span>(lim).<span class=\"built_in\">inv</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] *= inv;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-1\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span>(lim &lt;= n + m) lim *= <span class=\"number\">2</span>, bit++;</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) rev[i] = rev[i / <span class=\"number\">2</span>] / <span class=\"number\">2</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; bit;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"-1\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ll w[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> lim = <span class=\"number\">1</span>, bit = <span class=\"number\">-1</span>, rev[N]; </span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mint w[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> lim = <span class=\"number\">1</span>, bit = <span class=\"number\">-1</span>, rev[N]; </span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-4\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">mod</span><span class=\"params\">(ll&amp; x)</span> </span>&#123; <span class=\"keyword\">if</span>(x &gt;= P) x -= P; <span class=\"keyword\">if</span>(x &lt; <span class=\"number\">0</span>) x += P; &#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">Pow</span><span class=\"params\">(ll a, <span class=\"keyword\">int</span> n, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a % P)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(ll a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(rev[i] &lt; i) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">        ll &amp;x = a[k], y = a[k + i] * w[lim / i * (k - j)] % P;</span><br><span class=\"line\">        <span class=\"built_in\">mod</span>(a[k + i] = x - y), <span class=\"built_in\">mod</span>(x += y);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ll inv = <span class=\"built_in\">Pow</span>(lim, P - <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) (a[i] *= inv) %= P;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(mint a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(rev[i] &lt; i) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">        mint &amp;x = a[k], y = a[k + i] * w[lim / i * (k - j)];</span><br><span class=\"line\">        a[k + i] = x - y, x += y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint inv = <span class=\"built_in\">mint</span>(lim).<span class=\"built_in\">inv</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] *= inv;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-2\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span>(lim &lt;= n + m) lim *= <span class=\"number\">2</span>, bit++;</span><br><span class=\"line\">ll wn = <span class=\"built_in\">Pow</span>(<span class=\"number\">3</span>, P / <span class=\"number\">2</span> / lim);</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">    rev[i] = rev[i / <span class=\"number\">2</span>] / <span class=\"number\">2</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; bit;</span><br><span class=\"line\">    w[i] = i ? w[i - <span class=\"number\">1</span>] * wn % P : <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span>(lim &lt;= n + m) lim *= <span class=\"number\">2</span>, bit++;</span><br><span class=\"line\">mint wn = <span class=\"built_in\">mint</span>(<span class=\"number\">3</span>).<span class=\"built_in\">pow</span>(P / <span class=\"number\">2</span> / lim);</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">    rev[i] = rev[i / <span class=\"number\">2</span>] / <span class=\"number\">2</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; bit;</span><br><span class=\"line\">    w[i] = i ? w[i - <span class=\"number\">1</span>] * wn : <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"-ntt\"> NTT</h2>\r\n<h3 id=\"-2\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> cmp = complex&lt;lf&gt;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> lf PI = <span class=\"built_in\">acos</span>(<span class=\"number\">-1</span>);</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">const</span> cmp <span class=\"title\">I</span><span class=\"params\">(<span class=\"number\">0</span>, <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, P;</span><br><span class=\"line\"><span class=\"keyword\">int</span> M, lim = <span class=\"number\">1</span>, bit = <span class=\"number\">-1</span>, rev[N];</span><br><span class=\"line\">cmp w[N], a0[N], a1[N], b0[N], b1[N];</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> cmp = complex&lt;lf&gt;;</span><br><span class=\"line\"><span class=\"keyword\">const</span> lf PI = <span class=\"built_in\">acos</span>(<span class=\"number\">-1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m, P;</span><br><span class=\"line\"><span class=\"keyword\">int</span> M, lim = <span class=\"number\">1</span>, bit = <span class=\"number\">-1</span>, rev[N];</span><br><span class=\"line\">cmp w[N], a0[N], a1[N], b0[N], b1[N];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-5\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FFT</span><span class=\"params\">(cmp a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(i &lt; rev[i]) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">        cmp &amp;x = a[k], y = a[i + k] * w[lim / i * (k - j)];</span><br><span class=\"line\">        a[i + k] = x - y, x += y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    lf inv = <span class=\"number\">1.</span> / lim;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] *= inv;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FFT2</span><span class=\"params\">(cmp a[], cmp b[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] += b[i] * I;</span><br><span class=\"line\">    <span class=\"built_in\">FFT</span>(a, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) b[i] = <span class=\"built_in\">conj</span>(a[i ? lim - i : <span class=\"number\">0</span>]);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">        cmp x = a[i], y = b[i];</span><br><span class=\"line\">        a[i] = (y + x) * <span class=\"number\">0.5</span>, b[i] = (y - x) * <span class=\"number\">0.5</span> * I;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">num</span><span class=\"params\">(cmp x)</span> </span>&#123; <span class=\"keyword\">return</span> M * <span class=\"built_in\">ll</span>(<span class=\"built_in\">real</span>(x) + <span class=\"number\">0.5</span>) % P + <span class=\"built_in\">ll</span>(<span class=\"built_in\">imag</span>(x) + <span class=\"number\">0.5</span>); &#125;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FFT</span><span class=\"params\">(cmp a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(i &lt; rev[i]) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">        cmp &amp;x = a[k], y = a[i + k] * w[lim / i * (k - j)];</span><br><span class=\"line\">        a[i + k] = x - y, x += y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    lf inv = <span class=\"number\">1.</span> / lim;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] *= inv;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FFT2</span><span class=\"params\">(cmp a[], cmp b[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] += b[i] * <span class=\"number\">1</span>i;</span><br><span class=\"line\">    <span class=\"built_in\">FFT</span>(a, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) b[i] = <span class=\"built_in\">conj</span>(a[i ? lim - i : <span class=\"number\">0</span>]);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">        cmp x = a[i], y = b[i];</span><br><span class=\"line\">        a[i] = (y + x) * <span class=\"number\">0.5</span>, b[i] = (y - x) * <span class=\"number\">0.5</span>i;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">mint <span class=\"title\">num</span><span class=\"params\">(cmp x)</span> </span>&#123; <span class=\"keyword\">return</span> M * (mint)<span class=\"built_in\">ll</span>(<span class=\"built_in\">real</span>(x) + <span class=\"number\">0.5</span>) % P + (mint)<span class=\"built_in\">ll</span>(<span class=\"built_in\">imag</span>(x) + <span class=\"number\">0.5</span>); &#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-3\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">M = <span class=\"built_in\">sqrt</span>(P);</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n) a0[i] = A[i] / M, a1[i] = A[i] % M;</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, m) b0[i] = B[i] / M, b1[i] = B[i] % M;</span><br><span class=\"line\"><span class=\"keyword\">while</span>(lim &lt;= n + m) lim *= <span class=\"number\">2</span>, bit++;</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">    rev[i] = rev[i / <span class=\"number\">2</span>] / <span class=\"number\">2</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; bit;</span><br><span class=\"line\">    w[i] = <span class=\"built_in\">cmp</span>(<span class=\"built_in\">cos</span>(PI / lim * i), <span class=\"built_in\">sin</span>(PI / lim * i));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">FFT2</span>(a0, a1), <span class=\"built_in\">FFT2</span>(b0, b1);</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">    cmp t = a0[i] + I * a1[i];</span><br><span class=\"line\">    b0[i] *= t, b1[i] *= t;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">FFT</span>(b0, <span class=\"number\">1</span>), <span class=\"built_in\">FFT</span>(b1, <span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n + m) C[i] = (M * <span class=\"built_in\">num</span>(b0[i]) + <span class=\"built_in\">num</span>(b1[i])) % P;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">FFT2</span>(a0, a1), <span class=\"built_in\">FFT2</span>(b0, b1);</span><br><span class=\"line\"><span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) &#123;</span><br><span class=\"line\">    cmp t = a0[i] + I * a1[i];</span><br><span class=\"line\">    b0[i] *= t, b1[i] *= t;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">FFT</span>(b0, <span class=\"number\">1</span>), <span class=\"built_in\">FFT</span>(b1, <span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, n + m) C[i] = M * <span class=\"built_in\">num</span>(b0[i]) + <span class=\"built_in\">num</span>(b1[i]);</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"fwt\">FWT</h2>\r\n<h3 id=\"-6\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">FWT</span><span class=\"params\">(ll a[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, n) <span class=\"built_in\">For</span>(S, <span class=\"number\">0</span>, <span class=\"number\">1</span> &lt;&lt; n) <span class=\"keyword\">if</span>(S &gt;&gt; i &amp; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        ll&amp; x = a[S ^ <span class=\"number\">1</span> &lt;&lt; i], y = a[S];</span><br><span class=\"line\">        a[S] = x - y, x += y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">IFWT</span><span class=\"params\">(ll a[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, n) <span class=\"built_in\">For</span>(S, <span class=\"number\">0</span>, <span class=\"number\">1</span> &lt;&lt; n) <span class=\"keyword\">if</span>(S &gt;&gt; i &amp; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        ll&amp; x = a[S ^ <span class=\"number\">1</span> &lt;&lt; i], y = a[S];</span><br><span class=\"line\">        a[S] = x - y &gt;&gt; <span class=\"number\">1</span>, x = x + y &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-3\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, lim, rev[N];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-7\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">Pow</span><span class=\"params\">(ll a, <span class=\"keyword\">int</span> n, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a % P)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">bld</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    lim = <span class=\"number\">1</span> &lt;&lt; n--;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) rev[i] = rev[i / <span class=\"number\">2</span>] / <span class=\"number\">2</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; n;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(ll a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(i &lt; rev[i]) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">        ll wn = <span class=\"built_in\">Pow</span>(g, P / <span class=\"number\">2</span> / i);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            ll w = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">                ll &amp;x = a[k], y = a[k + i] * w % P;</span><br><span class=\"line\">                a[k + i] = (x - y) % P, (x += y) %= P, w = w * wn % P;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ll inv = <span class=\"built_in\">Pow</span>(lim, P - <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) (a[i] *= inv) %= P;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Inv</span><span class=\"params\">(ll a[], ll b[], <span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> ll c[N];</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, <span class=\"number\">2</span> &lt;&lt; n) b[i] = c[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    b[<span class=\"number\">0</span>] = <span class=\"built_in\">Pow</span>(a[<span class=\"number\">0</span>], P - <span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(j, <span class=\"number\">0</span>, <span class=\"number\">1</span> &lt;&lt; i) c[j] = a[j];</span><br><span class=\"line\">        <span class=\"built_in\">bld</span>(i + <span class=\"number\">1</span>), <span class=\"built_in\">NTT</span>(c, <span class=\"number\">0</span>), <span class=\"built_in\">NTT</span>(b, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(j, <span class=\"number\">0</span>, lim) b[j] = (b[j] * <span class=\"number\">2</span> - b[j] * b[j] % P * c[j]) % P;</span><br><span class=\"line\">        <span class=\"built_in\">NTT</span>(b, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(j, <span class=\"number\">1</span> &lt;&lt; i, lim) b[j] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">bld</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    lim = <span class=\"number\">1</span> &lt;&lt; n--;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) rev[i] = rev[i / <span class=\"number\">2</span>] / <span class=\"number\">2</span> | (i &amp; <span class=\"number\">1</span>) &lt;&lt; n;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">NTT</span><span class=\"params\">(mint a[], <span class=\"keyword\">int</span> t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">reverse</span>(a + <span class=\"number\">1</span>, a + lim);</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) <span class=\"keyword\">if</span>(rev[i] &lt; i) <span class=\"built_in\">swap</span>(a[i], a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; lim; i *= <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">        mint wn = <span class=\"built_in\">mint</span>(<span class=\"number\">3</span>).<span class=\"built_in\">pow</span>(P / <span class=\"number\">2</span> / i);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; lim; j += i * <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            mint w = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"built_in\">For</span>(k, j, j + i) &#123;</span><br><span class=\"line\">                mint &amp;x = a[k], y = a[k + i] * w;</span><br><span class=\"line\">                a[k + i] = x - y, x += y, w *= wn;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    mint inv = <span class=\"built_in\">mint</span>(lim).<span class=\"built_in\">inv</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(t) <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, lim) a[i] *= inv;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Inv</span><span class=\"params\">(mint a[], mint b[], <span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> mint c[N];</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, <span class=\"number\">2</span> &lt;&lt; n) b[i] = c[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    b[<span class=\"number\">0</span>] = a[<span class=\"number\">0</span>].<span class=\"built_in\">inv</span>();</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(j, <span class=\"number\">0</span>, <span class=\"number\">1</span> &lt;&lt; i) c[j] = a[j];</span><br><span class=\"line\">        <span class=\"built_in\">bld</span>(i + <span class=\"number\">1</span>), <span class=\"built_in\">NTT</span>(c, <span class=\"number\">0</span>), <span class=\"built_in\">NTT</span>(b, <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(j, <span class=\"number\">0</span>, lim) b[j] = b[j] * <span class=\"number\">2</span> - b[j] * b[j] * c[j];</span><br><span class=\"line\">        <span class=\"built_in\">NTT</span>(b, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(j, <span class=\"number\">1</span> &lt;&lt; i, lim) b[j] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h2 id=\"\"></h2>\r\n<h2 id=\"\"></h2>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">mul</span><span class=\"params\">(ll a, ll b, ll p)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (a * b - (ll)((<span class=\"keyword\">long</span> <span class=\"keyword\">double</span>)a / p * b + <span class=\"number\">0.5</span>) * p + p) % p;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">exgcd</span><span class=\"params\">(ll a, ll b, ll&amp; d, ll&amp; x, ll&amp; y)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!b) &#123; d = a, x = <span class=\"number\">1</span>, y = <span class=\"number\">0</span>; <span class=\"keyword\">return</span>; &#125;</span><br><span class=\"line\">    <span class=\"built_in\">exgcd</span>(b, a % b, d, y, x), y -= a / b * x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">exCRT</span><span class=\"params\">(ll&amp; b1, ll&amp; m1, ll b2, ll m2)</span> </span>&#123;</span><br><span class=\"line\">    ll d, k1, k2; <span class=\"built_in\">exgcd</span>(m1, m2, d, k1, k2), m2 /= d;</span><br><span class=\"line\">    b1 = (b1 + <span class=\"built_in\">mul</span>(<span class=\"built_in\">mul</span>(k1 % m2, (b2 - b1) / d % m2, m2), m1, m1 * m2)) % (m1 *= m2);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h2 id=\"min-25-\">Min-25 </h2>\r\n<h3 id=\"-4\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ll f1[N], f2[N];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-8\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">min25</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> lim = <span class=\"built_in\">sqrt</span>(n);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, lim) f1[i] = i - <span class=\"number\">1</span>, f2[i] = n / i - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(p, <span class=\"number\">2</span>, lim) <span class=\"keyword\">if</span> (f1[p] ^ f1[p - <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> w1 = lim / p;</span><br><span class=\"line\">        ll x = f1[p - <span class=\"number\">1</span>], w3 = (ll)p * p, w2 = <span class=\"built_in\">min</span>((ll)lim, n / w3), d = n / p;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, w1) f2[i] -= f2[i * p] - x;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, w1 + <span class=\"number\">1</span>, w2) f2[i] -= f1[d / i] - x;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(i, lim, w3) f1[i] -= f1[i / p] - x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> f2[<span class=\"number\">1</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"exbsgs\">exBSGS</h2>\r\n<h3 id=\"-5\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">map&lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt; mp;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-9\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">BSGS</span><span class=\"params\">(ll pls, ll a, ll b, ll p)</span> </span>&#123;</span><br><span class=\"line\">    pls %= p, a %= p, b %= p; mp.<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">    ll m = <span class=\"built_in\">ceil</span>(<span class=\"built_in\">sqrt</span>(p)), ls = <span class=\"number\">1</span>, rs = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, m) mp[ls * b % p] = i, ls = ls * a % p;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">        rs = rs * ls % p;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(mp.<span class=\"built_in\">count</span>(rs * pls % p)) <span class=\"keyword\">return</span> i * m - mp[rs * pls % p];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">exBSGS</span><span class=\"params\">(ll a, ll b, ll p)</span> </span>&#123;</span><br><span class=\"line\">    a %= p, b %= p;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> pls = <span class=\"number\">1</span>, ct = <span class=\"number\">0</span>, g;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>((g = __gcd(a, p)) &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(b == <span class=\"number\">1</span>) <span class=\"keyword\">return</span> ct;</span><br><span class=\"line\">        p /= g, pls = pls * a / g % p, ct++;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(b % g) <span class=\"keyword\">return</span> <span class=\"number\">-1</span>; b /= g;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> ret = <span class=\"built_in\">BSGS</span>(pls, a, b, p);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ~ret ? ret + ct : <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"cipolla\">cipolla</h2>\r\n<h3 id=\"-6\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n; ll II;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">cmp</span> &#123;</span></span><br><span class=\"line\">    ll r, i;</span><br><span class=\"line\">    cmp <span class=\"keyword\">operator</span> *(<span class=\"keyword\">const</span> cmp&amp; b) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;(r * b.r + i * b.i % P * II) % P, (r * b.i + i * b.r) % P&#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; U = &#123;<span class=\"number\">1</span>, <span class=\"number\">0</span>&#125;;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mint n, II;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">cmp</span> &#123;</span></span><br><span class=\"line\">    mint r, i;</span><br><span class=\"line\">    cmp <span class=\"keyword\">operator</span> *(<span class=\"keyword\">const</span> cmp&amp; b) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> &#123;r * b.r + i * b.i * II, r * b.i + i * b.r&#125;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; U = &#123;<span class=\"number\">1</span>, <span class=\"number\">0</span>&#125;;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-10\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">pow1</span><span class=\"params\">(ll a, <span class=\"keyword\">int</span> n, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a % P)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a % P;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">cmp <span class=\"title\">pow2</span><span class=\"params\">(cmp a, <span class=\"keyword\">int</span> n, cmp r = U)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">cipolla</span><span class=\"params\">(<span class=\"keyword\">int</span> n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!n) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(P == <span class=\"number\">2</span>) <span class=\"keyword\">return</span> n;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">pow1</span>(n, P / <span class=\"number\">2</span>) ^ <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">    ll a;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> a = <span class=\"built_in\">rand</span>() % P, II = (a * a - n + P) % P; <span class=\"keyword\">while</span>(!a || <span class=\"built_in\">pow1</span>(II, P / <span class=\"number\">2</span>) == <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">pow2</span>(&#123;a, <span class=\"number\">1</span>&#125;, P / <span class=\"number\">2</span> + <span class=\"number\">1</span>).r;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<p><code>modint</code> </p>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">cmp <span class=\"title\">Pow</span><span class=\"params\">(cmp a, <span class=\"keyword\">int</span> n, cmp r = U)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = a * a)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = r * a;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">cipolla</span><span class=\"params\">(mint n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(P == <span class=\"number\">2</span>) <span class=\"keyword\">return</span> n.<span class=\"built_in\">val</span>();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n.<span class=\"built_in\">pow</span>(P / <span class=\"number\">2</span>) != <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">    mint a;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> a = <span class=\"built_in\">rand</span>(), II = a * a - n; <span class=\"keyword\">while</span>(a == <span class=\"number\">0</span> || II.<span class=\"built_in\">pow</span>(P / <span class=\"number\">2</span>) == <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">Pow</span>(&#123;a, <span class=\"number\">1</span>&#125;, P / <span class=\"number\">2</span> + <span class=\"number\">1</span>).r.<span class=\"built_in\">val</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"miller-rabin-pollard-rho\">Miller Rabin &amp; Pollard Rho</h2>\r\n<h3 id=\"-7\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vector&lt;ll&gt; as;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-11\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">mul</span><span class=\"params\">(ll a, ll b, ll p)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (a * b - <span class=\"built_in\">ll</span>((<span class=\"keyword\">long</span> <span class=\"keyword\">double</span>)a / p * b + <span class=\"number\">0.5</span>) * p + p) % p;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">Pow</span><span class=\"params\">(ll a, ll n, ll p, ll r = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; n; n /= <span class=\"number\">2</span>, a = <span class=\"built_in\">mul</span>(a, a, p))</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n &amp; <span class=\"number\">1</span>) r = <span class=\"built_in\">mul</span>(r, a, p);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">chk</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(ll a : &#123;<span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">7</span>, <span class=\"number\">61</span>, <span class=\"number\">24251</span>&#125;) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(n == a) <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"built_in\">Pow</span>(a, n - <span class=\"number\">1</span>, n) ^ <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        ll k = n - <span class=\"number\">1</span>, t;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(~k &amp; <span class=\"number\">1</span>) k /= <span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((t = <span class=\"built_in\">Pow</span>(a, k, n)) == <span class=\"number\">1</span>) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(t ^ <span class=\"number\">1</span> &amp;&amp; t ^ n - <span class=\"number\">1</span>) t = <span class=\"built_in\">mul</span>(t, t, n);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(t ^ n - <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">f</span><span class=\"params\">(ll x, ll c, ll p)</span> </span>&#123; <span class=\"keyword\">return</span> (<span class=\"built_in\">mul</span>(x, x, p) + c) % p; &#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">PR</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">    ll a = <span class=\"number\">0</span>, b = <span class=\"number\">0</span>, c = <span class=\"built_in\">rand</span>() % (n - <span class=\"number\">1</span>) + <span class=\"number\">1</span>, v = <span class=\"number\">1</span>, g;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> k = <span class=\"number\">1</span>; ; k *= <span class=\"number\">2</span>, a = b, v = <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, k) &#123;</span><br><span class=\"line\">            b = <span class=\"built_in\">f</span>(b, c, n), v = <span class=\"built_in\">mul</span>(v, <span class=\"built_in\">abs</span>(a - b), n);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!(i &amp; <span class=\"number\">127</span>) || i == k) &#123;</span><br><span class=\"line\">                g = __gcd(v, n);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(g &gt; <span class=\"number\">1</span>) <span class=\"keyword\">return</span> g;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">(ll n)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">chk</span>(n)) <span class=\"keyword\">return</span> as.<span class=\"built_in\">pb</span>(n);</span><br><span class=\"line\">    ll d; <span class=\"keyword\">do</span> d = <span class=\"built_in\">PR</span>(n); <span class=\"keyword\">while</span>(d == n);</span><br><span class=\"line\">    <span class=\"built_in\">solve</span>(d), <span class=\"built_in\">solve</span>(n / d);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"\"></h1>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-1\"></h3>\r\n<h4 id=\"-8\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> c[N][<span class=\"number\">2</span>], f[N], r[N];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-12\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">id</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">return</span> c[f[o]][<span class=\"number\">1</span>] == o; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">nrt</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">return</span> f[o] &amp;&amp; c[f[o]][<span class=\"built_in\">id</span>(o)] == o; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pu</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">flip</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">swap</span>(c[o][<span class=\"number\">0</span>], c[o][<span class=\"number\">1</span>]), r[o] ^= <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pd</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">if</span>(r[o]) <span class=\"built_in\">flip</span>(c[o][<span class=\"number\">0</span>]), <span class=\"built_in\">flip</span>(c[o][<span class=\"number\">1</span>]), r[o] = <span class=\"number\">0</span>; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">rot</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> d)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> k = c[o][!d], &amp;x = c[k][d];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">nrt</span>(o)) c[f[o]][<span class=\"built_in\">id</span>(o)] = k;</span><br><span class=\"line\">    <span class=\"built_in\">pu</span>(x = f[c[o][!d] = x] = o), f[k] = f[o], <span class=\"built_in\">pu</span>(f[o] = k);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">if</span>(<span class=\"built_in\">nrt</span>(o)) <span class=\"built_in\">dfs</span>(f[o]); <span class=\"built_in\">pd</span>(o); &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">splay</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(o);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> fa; <span class=\"built_in\">nrt</span>(o); <span class=\"built_in\">rot</span>(f[o], !<span class=\"built_in\">id</span>(o)))</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">nrt</span>(fa = f[o])) <span class=\"built_in\">rot</span>(<span class=\"built_in\">id</span>(o) ^ <span class=\"built_in\">id</span>(fa) ? fa : f[fa], !<span class=\"built_in\">id</span>(o));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">acc</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> x = <span class=\"number\">0</span>; o; o = f[x = o])</span><br><span class=\"line\">        <span class=\"built_in\">splay</span>(o), c[o][<span class=\"number\">1</span>] = x, <span class=\"built_in\">pu</span>(o);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">mkrt</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"built_in\">acc</span>(o), <span class=\"built_in\">splay</span>(o), <span class=\"built_in\">flip</span>(o); &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">link</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mkrt</span>(u), <span class=\"built_in\">acc</span>(v), <span class=\"built_in\">splay</span>(v), <span class=\"built_in\">pu</span>(f[u] = v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">cut</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mkrt</span>(u), <span class=\"built_in\">acc</span>(v), <span class=\"built_in\">splay</span>(v), c[v][<span class=\"number\">0</span>] = f[u] = <span class=\"number\">0</span>, <span class=\"built_in\">pu</span>(v);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-size-\"> <code>size</code> </h3>\r\n<h4 id=\"-9\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> c[N][<span class=\"number\">2</span>], f[N], r[N], s[N], si[N];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-13\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">id</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">return</span> c[f[o]][<span class=\"number\">1</span>] == o; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">nrt</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">return</span> f[o] &amp;&amp; c[f[o]][<span class=\"built_in\">id</span>(o)] == o; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pu</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    s[o] = s[c[o][<span class=\"number\">0</span>]] + s[c[o][<span class=\"number\">1</span>]] + si[o] + <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">flip</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">swap</span>(c[o][<span class=\"number\">0</span>], c[o][<span class=\"number\">1</span>]), r[o] ^= <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pd</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">if</span>(r[o]) <span class=\"built_in\">flip</span>(c[o][<span class=\"number\">0</span>]), <span class=\"built_in\">flip</span>(c[o][<span class=\"number\">1</span>]), r[o] = <span class=\"number\">0</span>; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">rot</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> d)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> k = c[o][!d], &amp;x = c[k][d];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">nrt</span>(o)) c[f[o]][<span class=\"built_in\">id</span>(o)] = k;</span><br><span class=\"line\">    <span class=\"built_in\">pu</span>(x = f[c[o][!d] = x] = o), f[k] = f[o], <span class=\"built_in\">pu</span>(f[o] = k);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"keyword\">if</span>(<span class=\"built_in\">nrt</span>(o)) <span class=\"built_in\">dfs</span>(f[o]); <span class=\"built_in\">pd</span>(o); &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">splay</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">dfs</span>(o);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> fa; <span class=\"built_in\">nrt</span>(o); <span class=\"built_in\">rot</span>(f[o], !<span class=\"built_in\">id</span>(o)))</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">nrt</span>(fa = f[o])) <span class=\"built_in\">rot</span>(<span class=\"built_in\">id</span>(o) ^ <span class=\"built_in\">id</span>(fa) ? fa : f[fa], !<span class=\"built_in\">id</span>(o));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">acc</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> x = <span class=\"number\">0</span>; o; o = f[x = o])</span><br><span class=\"line\">        <span class=\"built_in\">splay</span>(o), si[o] += s[c[o][<span class=\"number\">1</span>]] - s[x], c[o][<span class=\"number\">1</span>] = x, <span class=\"built_in\">pu</span>(o);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">mkrt</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; <span class=\"built_in\">acc</span>(o), <span class=\"built_in\">splay</span>(o), <span class=\"built_in\">flip</span>(o); &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">link</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mkrt</span>(u), <span class=\"built_in\">acc</span>(v), <span class=\"built_in\">splay</span>(v), si[v] += s[u], <span class=\"built_in\">pu</span>(f[u] = v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">cut</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mkrt</span>(u), <span class=\"built_in\">acc</span>(v), <span class=\"built_in\">splay</span>(v), c[v][<span class=\"number\">0</span>] = f[u] = <span class=\"number\">0</span>, <span class=\"built_in\">pu</span>(v);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"rbs-\">RBS </h2>\r\n<h3 id=\"-2\"></h3>\r\n<h4 id=\"-10\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> rt, sz, ls[N], rs[N], c[N], s[N];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-14\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">gen</span><span class=\"params\">(ll x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> ll k = <span class=\"number\">0x9ddfea08eb382d69</span>ull;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">3</span>) x *= k, x ^= x &gt;&gt; <span class=\"number\">47</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * k;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">rnd</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> ll s = <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (s += <span class=\"built_in\">gen</span>(s)) &amp; INT_MAX;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">pu</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123; s[o] = s[ls[o]] + s[rs[o]] + <span class=\"number\">1</span>; <span class=\"keyword\">return</span> o; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">bld</span><span class=\"params\">(<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span>&amp; o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l &gt; r) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> mid = l + r &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    c[o = ++sz] = a[mid];</span><br><span class=\"line\">    <span class=\"built_in\">bld</span>(l, mid - <span class=\"number\">1</span>, ls[o]), <span class=\"built_in\">bld</span>(mid + <span class=\"number\">1</span>, r, rs[o]), <span class=\"built_in\">pu</span>(o); </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">spt</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span>&amp; u, <span class=\"keyword\">int</span>&amp; v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!o) u = v = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(x &lt; c[o]) <span class=\"built_in\">spt</span>(ls[v = o], x, u, ls[o]), <span class=\"built_in\">pu</span>(o);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">spt</span>(rs[u = o], x, rs[o], v), <span class=\"built_in\">pu</span>(o);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">mrg</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!u || !v) <span class=\"keyword\">return</span> u + v;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">rnd</span>() % (s[u] + s[v]) &lt; s[u])</span><br><span class=\"line\">        <span class=\"keyword\">return</span> rs[u] = <span class=\"built_in\">mrg</span>(rs[u], v), <span class=\"built_in\">pu</span>(u);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ls[v] = <span class=\"built_in\">mrg</span>(u, ls[v]), <span class=\"built_in\">pu</span>(v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span>&amp; o, <span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">rnd</span>() % (s[o] + <span class=\"number\">1</span>) == <span class=\"number\">0</span>)</span><br><span class=\"line\">        c[++sz] = x, <span class=\"built_in\">spt</span>(o, x, ls[sz], rs[sz]), <span class=\"built_in\">pu</span>(o = sz);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">ins</span>(x &lt; c[o] ? ls[o] : rs[o], x), <span class=\"built_in\">pu</span>(o);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">rmv</span><span class=\"params\">(<span class=\"keyword\">int</span>&amp; o, <span class=\"keyword\">int</span> x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> t1, t2, t3;</span><br><span class=\"line\">    <span class=\"built_in\">spt</span>(o, x, t1, t3), <span class=\"built_in\">spt</span>(t1, x - <span class=\"number\">1</span>, t1, t2);</span><br><span class=\"line\">    o = <span class=\"built_in\">mrg</span>(<span class=\"built_in\">mrg</span>(t1, <span class=\"built_in\">mrg</span>(ls[t2], rs[t2])), t3);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">rk</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> re = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(o) o = x &gt; c[o] ? re += s[ls[o]] + <span class=\"number\">1</span>, rs[o] : ls[o]; </span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">kth</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(k != s[ls[o]] + <span class=\"number\">1</span>)</span><br><span class=\"line\">        o = k &gt; s[ls[o]] ? k -= s[ls[o]] + <span class=\"number\">1</span>, rs[o] : ls[o];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> c[o];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">pre</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> re = -Inf)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(o) o = x &gt; c[o] ? re = <span class=\"built_in\">max</span>(re, c[o]), rs[o] : ls[o];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">suf</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> re = Inf)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(o) o = x &lt; c[o] ? re = <span class=\"built_in\">min</span>(re, c[o]), ls[o] : rs[o];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;limits&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;vector&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> int64;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> int64 <span class=\"title\">Fingerprint</span><span class=\"params\">(int64 x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> int64 kMul = <span class=\"number\">0x9ddfea08eb382d69</span>ULL;</span><br><span class=\"line\">    x *= kMul, x ^= x &gt;&gt; <span class=\"number\">47</span>;</span><br><span class=\"line\">    x *= kMul, x ^= x &gt;&gt; <span class=\"number\">47</span>;</span><br><span class=\"line\">    x *= kMul, x ^= x &gt;&gt; <span class=\"number\">47</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * kMul;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> int64 <span class=\"title\">Random</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> int64 Seed = <span class=\"number\">2</span>;</span><br><span class=\"line\">    Seed += <span class=\"built_in\">Fingerprint</span>(Seed);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> Seed &amp; numeric_limits&lt;int64&gt;::<span class=\"built_in\">max</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">int</span> DataType;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">RBST</span> &#123;</span></span><br><span class=\"line\">    RBST *ChildL, *ChildR;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> Size;</span><br><span class=\"line\">    DataType Data;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">RBST</span>() &#123; ChildL = ChildR = <span class=\"number\">0</span>; &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">GetSize</span><span class=\"params\">(<span class=\"keyword\">const</span> RBST* root)</span> </span>&#123; <span class=\"keyword\">return</span> root ? root-&gt;Size : <span class=\"number\">0</span>; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">LowerBoundIndex</span><span class=\"params\">(<span class=\"keyword\">const</span> RBST* root, DataType x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!root) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &lt;= root-&gt;Data) <span class=\"keyword\">return</span> <span class=\"built_in\">LowerBoundIndex</span>(root-&gt;ChildL, x);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sizeL = <span class=\"built_in\">GetSize</span>(root-&gt;ChildL);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">LowerBoundIndex</span>(root-&gt;ChildR, x) + sizeL + <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">DataType <span class=\"title\">Select</span><span class=\"params\">(<span class=\"keyword\">const</span> RBST* root, <span class=\"keyword\">int</span> index)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sizeL = <span class=\"built_in\">GetSize</span>(root-&gt;ChildL);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index == sizeL) <span class=\"keyword\">return</span> root-&gt;Data;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index &lt; sizeL) <span class=\"keyword\">return</span> <span class=\"built_in\">Select</span>(root-&gt;ChildL, index);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">Select</span>(root-&gt;ChildR, index - sizeL - <span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">RBST* <span class=\"title\">SetSize</span><span class=\"params\">(RBST* root)</span> </span>&#123;</span><br><span class=\"line\">    root-&gt;Size = <span class=\"built_in\">GetSize</span>(root-&gt;ChildL) + <span class=\"built_in\">GetSize</span>(root-&gt;ChildR) + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> root;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">RBSTree</span> &#123;</span></span><br><span class=\"line\">    vector&lt;RBST*&gt; Nodes;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">RBST* <span class=\"title\">NewNode</span><span class=\"params\">(RBST* node)</span> </span>&#123;</span><br><span class=\"line\">        Nodes.<span class=\"built_in\">push_back</span>(<span class=\"keyword\">new</span> <span class=\"built_in\">RBST</span>(*node));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Nodes.<span class=\"built_in\">back</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Split</span><span class=\"params\">(RBST* root, DataType x, RBST*&amp; treeL, RBST*&amp; treeR)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!root) &#123;</span><br><span class=\"line\">            treeL = treeR = <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (x &lt;= root-&gt;Data) &#123;</span><br><span class=\"line\">            RBST *newRoot = <span class=\"built_in\">NewNode</span>(root);</span><br><span class=\"line\">            <span class=\"built_in\">Split</span>(root-&gt;ChildL, x, treeL, newRoot-&gt;ChildL);</span><br><span class=\"line\">            treeR = <span class=\"built_in\">SetSize</span>(newRoot);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            RBST* newRoot = <span class=\"built_in\">NewNode</span>(root);</span><br><span class=\"line\">            <span class=\"built_in\">Split</span>(root-&gt;ChildR, x, newRoot-&gt;ChildR, treeR);</span><br><span class=\"line\">            treeL = <span class=\"built_in\">SetSize</span>(newRoot);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">RBST* <span class=\"title\">Join</span><span class=\"params\">(RBST* treeL, RBST* treeR)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> sizeL = <span class=\"built_in\">GetSize</span>(treeL);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> sizeR = <span class=\"built_in\">GetSize</span>(treeR);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> size = sizeL + sizeR;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (size == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">Random</span>() % size &lt; sizeL) &#123;</span><br><span class=\"line\">            RBST* newRoot = <span class=\"built_in\">NewNode</span>(treeL);</span><br><span class=\"line\">            newRoot-&gt;ChildR = <span class=\"built_in\">Join</span>(treeL-&gt;ChildR, treeR);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">SetSize</span>(newRoot);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            RBST* newRoot = <span class=\"built_in\">NewNode</span>(treeR);</span><br><span class=\"line\">            newRoot-&gt;ChildL = <span class=\"built_in\">Join</span>(treeL, treeR-&gt;ChildL);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">SetSize</span>(newRoot);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">RBST* <span class=\"title\">InsertAsRoot</span><span class=\"params\">(RBST* root, DataType item)</span> </span>&#123;</span><br><span class=\"line\">        Nodes.<span class=\"built_in\">push_back</span>(<span class=\"keyword\">new</span> RBST);</span><br><span class=\"line\">        RBST *newRoot = Nodes.<span class=\"built_in\">back</span>();</span><br><span class=\"line\">        newRoot-&gt;Data = item;</span><br><span class=\"line\">        <span class=\"built_in\">Split</span>(root, item + <span class=\"number\">1</span>, newRoot-&gt;ChildL, newRoot-&gt;ChildR);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">SetSize</span>(newRoot);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">RBST* <span class=\"title\">Insert</span><span class=\"params\">(RBST* root, DataType item)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">Random</span>() % (<span class=\"built_in\">GetSize</span>(root) + <span class=\"number\">1</span>) == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">InsertAsRoot</span>(root, item);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (item &lt; root-&gt;Data) &#123;</span><br><span class=\"line\">            RBST *newRoot = <span class=\"built_in\">NewNode</span>(root);</span><br><span class=\"line\">            newRoot-&gt;ChildL = <span class=\"built_in\">Insert</span>(root-&gt;ChildL, item);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">SetSize</span>(newRoot);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            RBST *newRoot = <span class=\"built_in\">NewNode</span>(root);</span><br><span class=\"line\">            newRoot-&gt;ChildR = <span class=\"built_in\">Insert</span>(root-&gt;ChildR, item);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">SetSize</span>(newRoot);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\">RBST* <span class=\"title\">Remove</span><span class=\"params\">(RBST* root, DataType item)</span> </span>&#123;</span><br><span class=\"line\">        RBST *tree1, *tree2, *tree3, *tree4 = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">Split</span>(root, item, tree1, tree2);</span><br><span class=\"line\">        <span class=\"built_in\">Split</span>(tree2, item + <span class=\"number\">1</span>, tree2, tree3);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tree2) tree4 = <span class=\"built_in\">Join</span>(tree2-&gt;ChildL, tree2-&gt;ChildR);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">Join</span>(<span class=\"built_in\">Join</span>(tree1, tree4), tree3);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Destroy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; Nodes.<span class=\"built_in\">size</span>(); ++i) <span class=\"keyword\">delete</span> Nodes[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"k-d-\">K-D </h2>\r\n<h3 id=\"-11\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) / 2)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lc o * 2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rc o * 2 + 1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, lc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, rc</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> D, L[N * <span class=\"number\">4</span>][K], R[N * <span class=\"number\">4</span>][K];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> x[K];</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">read</span><span class=\"params\">()</span> </span>&#123; <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;x[i]); &#125;</span><br><span class=\"line\">    <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span> &lt;(<span class=\"keyword\">const</span> node&amp; b)<span class=\"keyword\">const</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> x[D] &lt; b.x[D];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; a[N];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-15\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">lf <span class=\"title\">sq</span><span class=\"params\">(lf x)</span> </span>&#123; <span class=\"keyword\">return</span> x * x; &#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pu</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        L[o][i] = <span class=\"built_in\">min</span>(L[lc][i], L[rc][i]);</span><br><span class=\"line\">        R[o][i] = <span class=\"built_in\">max</span>(R[lc][i], R[rc][i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">bld</span><span class=\"params\">(<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l == r) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) L[o][i] = R[o][i] = a[l].x[i];</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    lf va[K] = &#123;&#125;;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) &#123;</span><br><span class=\"line\">        lf av = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, l, r) av += a[j].x[i];</span><br><span class=\"line\">        av /= r - l + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, l, r) va[i] += <span class=\"built_in\">sq</span>(a[j].x[i] - av);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    D = <span class=\"built_in\">max_element</span>(va, va + K) - va;</span><br><span class=\"line\">    <span class=\"built_in\">nth_element</span>(a + l, a + mid, a + r + <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">bld</span>(lch), <span class=\"built_in\">bld</span>(rch), <span class=\"built_in\">pu</span>(o);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">ll <span class=\"title\">sq</span><span class=\"params\">(<span class=\"keyword\">int</span> x)</span> </span>&#123; <span class=\"keyword\">return</span> <span class=\"number\">1ll</span> * x * x; &#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">mine</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x[], ll re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re += <span class=\"built_in\">sq</span>(<span class=\"built_in\">max</span>(L[o][i] - x[i], <span class=\"number\">0</span>)) + <span class=\"built_in\">sq</span>(<span class=\"built_in\">max</span>(x[i] - R[o][i], <span class=\"number\">0</span>));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">maxe</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x[], ll re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re += <span class=\"built_in\">max</span>(<span class=\"built_in\">sq</span>(x[i] - L[o][i]), <span class=\"built_in\">sq</span>(x[i] - R[o][i]));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">minm</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re += <span class=\"built_in\">max</span>(L[o][i] - x[i], <span class=\"number\">0</span>) + <span class=\"built_in\">max</span>(x[i] - R[o][i], <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">maxm</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re += <span class=\"built_in\">max</span>(<span class=\"built_in\">abs</span>(x[i] - L[o][i]), <span class=\"built_in\">abs</span>(x[i] - R[o][i]));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">minc</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> re = Inf)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re = <span class=\"built_in\">max</span>(re, <span class=\"built_in\">max</span>(L[o][i] - x[i], <span class=\"number\">0</span>) + <span class=\"built_in\">max</span>(x[i] - R[o][i], <span class=\"number\">0</span>));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">maxc</span><span class=\"params\">(<span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re = <span class=\"built_in\">max</span>(&#123;re, <span class=\"built_in\">abs</span>(x[i] - L[o][i]), <span class=\"built_in\">abs</span>(x[i] - R[o][i])&#125;);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"-12\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ll res;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-16\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l == r) <span class=\"keyword\">return</span> <span class=\"built_in\"><span class=\"keyword\">void</span></span>(res = <span class=\"built_in\">mine</span>(o, x));</span><br><span class=\"line\">    ll dl = <span class=\"built_in\">mine</span>(lc, x), dr = <span class=\"built_in\">mine</span>(rc, x);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(dl &lt; dr) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dl &lt; res) <span class=\"built_in\">qry</span>(x, lch);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dr &lt; res) <span class=\"built_in\">qry</span>(x, rch);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dr &lt; res) <span class=\"built_in\">qry</span>(x, rch);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dl &lt; res) <span class=\"built_in\">qry</span>(x, lch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res = Inf;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"-13\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ll res;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-17\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">qry</span><span class=\"params\">(<span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(l == r) <span class=\"keyword\">return</span> <span class=\"built_in\"><span class=\"keyword\">void</span></span>(res = <span class=\"built_in\">maxe</span>(o, x));</span><br><span class=\"line\">    ll dl = <span class=\"built_in\">maxe</span>(lc, x), dr = <span class=\"built_in\">maxe</span>(rc, x);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(dl &gt; dr) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dl &gt; res) <span class=\"built_in\">qry</span>(x, lch);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dr &gt; res) <span class=\"built_in\">qry</span>(x, rch);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dr &gt; res) <span class=\"built_in\">qry</span>(x, rch);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dl &gt; res) <span class=\"built_in\">qry</span>(x, lch);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-1\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">res = <span class=\"number\">0</span>;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">chk1</span><span class=\"params\">(<span class=\"keyword\">int</span> l[], <span class=\"keyword\">int</span> r[], <span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> re = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re &amp;= l[i] &lt;= L[o][i] &amp;&amp; R[o][i] &lt;= r[i];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">chk2</span><span class=\"params\">(<span class=\"keyword\">int</span> l[], <span class=\"keyword\">int</span> r[], <span class=\"keyword\">int</span> o, <span class=\"keyword\">int</span> re = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">0</span>, K) re &amp;= <span class=\"built_in\">max</span>(l[i], L[o][i]) &lt;= <span class=\"built_in\">min</span>(r[i], R[o][i]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">chk1</span><span class=\"params\">(<span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">maxe</span>(x, o) &lt;= <span class=\"number\">1ll</span> * r * r;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">chk2</span><span class=\"params\">(<span class=\"keyword\">int</span> x[], <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">mine</span>(x, o) &lt;= <span class=\"number\">1ll</span> * r * r;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"\"></h1>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"vector-\"><code>vector</code> </h3>\r\n<h4 id=\"-14\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, a[N], tp, stk[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> idx, dfn[N], d[N], fa[<span class=\"number\">20</span>][N];</span><br><span class=\"line\">vector&lt;<span class=\"keyword\">int</span>&gt; G[N], T[N];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-18\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    dfn[u] = ++idx;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">19</span>) fa[i][u] = fa[i - <span class=\"number\">1</span>][fa[i - <span class=\"number\">1</span>][u]];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(v ^ fa[<span class=\"number\">0</span>][u])</span><br><span class=\"line\">        d[v] = d[u] + <span class=\"number\">1</span>, fa[<span class=\"number\">0</span>][v] = u, <span class=\"built_in\">dfs</span>(v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">lca</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(d[u] &lt; d[v]) <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, <span class=\"number\">19</span>) <span class=\"keyword\">if</span>(d[u] - d[v] &gt;&gt; i &amp; <span class=\"number\">1</span>) u = fa[i][u];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u == v) <span class=\"keyword\">return</span> u;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, <span class=\"number\">19</span>, <span class=\"number\">0</span>) <span class=\"keyword\">if</span>(fa[i][u] ^ fa[i][v]) u = fa[i][u], v = fa[i][v];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> fa[<span class=\"number\">0</span>][u];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">bld</span><span class=\"params\">(<span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(a + <span class=\"number\">1</span>, a + k + <span class=\"number\">1</span>, [](<span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> b) &#123; <span class=\"keyword\">return</span> dfn[a] &lt; dfn[b]; &#125;);</span><br><span class=\"line\">    stk[++tp] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, k) <span class=\"keyword\">if</span>(a[i] &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> x = <span class=\"built_in\">lca</span>(a[i], stk[tp]);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(d[stk[tp]] &gt; d[x]) tp--, T[d[stk[tp]] &gt; d[x] ? stk[tp] : x].<span class=\"built_in\">pb</span>(stk[tp + <span class=\"number\">1</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(stk[tp] ^ x) stk[++tp] = x;</span><br><span class=\"line\">        stk[++tp] = a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(--tp) T[stk[tp]].<span class=\"built_in\">pb</span>(stk[tp + <span class=\"number\">1</span>]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">clr</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"built_in\">clr</span>(v); T[u].<span class=\"built_in\">clear</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"-15\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, a[N], p, stk[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> d[N], fa[N], sz[N], son[N], tp[N], idx, dfn[N];</span><br><span class=\"line\">vector&lt;<span class=\"keyword\">int</span>&gt; G[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> eid, he[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">edge</span> &#123;</span> <span class=\"keyword\">int</span> v, nx; &#125; e[N * <span class=\"number\">2</span>];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-19\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    sz[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) &#123;</span><br><span class=\"line\">        d[v] = d[u] + <span class=\"number\">1</span>, <span class=\"built_in\">dfs</span>(v), sz[u] += sz[v];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(sz[v] &gt; sz[son[u]]) son[u] = v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> top)</span> </span>&#123;</span><br><span class=\"line\">    tp[u] = top, dfn[u] = ++idx;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(son[u]) <span class=\"built_in\">Dfs</span>(son[u], top);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(v ^ son[u]) <span class=\"built_in\">Dfs</span>(v, v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">lca</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(; tp[u] ^ tp[v]; d[tp[u]] &gt; d[tp[v]] ? u = fa[tp[u]] : v = fa[tp[v]]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> d[u] &lt; d[v] ? u : v;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> t = <span class=\"number\">1</span>)</span> </span>&#123;</span><br><span class=\"line\">    e[++eid] = &#123;v, h1[u]&#125;, h1[u] = eid;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">bld</span><span class=\"params\">(<span class=\"keyword\">int</span> k)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">sort</span>(a + <span class=\"number\">1</span>, a + k + <span class=\"number\">1</span>, [](<span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> b) &#123; <span class=\"keyword\">return</span> dfn[a] &lt; dfn[b]; &#125;);</span><br><span class=\"line\">    stk[++p] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, k) <span class=\"keyword\">if</span>(a[i] &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> x = <span class=\"built_in\">lca</span>(a[i], stk[p]);</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(d[stk[p]] &gt; d[x])</span><br><span class=\"line\">            p--, <span class=\"built_in\">add</span>(d[stk[p]] &gt; d[x] ? stk[p] : x, stk[p + <span class=\"number\">1</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(stk[p] ^ x) stk[++p] = x;</span><br><span class=\"line\">        stk[++p] = a[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(--p) <span class=\"built_in\">add</span>(stk[p], stk[p + <span class=\"number\">1</span>]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"-lca\"> <code>LCA</code></h2>\r\n<h3 id=\"-16\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> dl[N], dr[N], fa[<span class=\"number\">20</span>][N];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-20\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">lca</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(dl[u] &lt; dl[v]) <span class=\"built_in\">swap</span>(u, v);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(dl[v] &lt;= dl[u] &amp;&amp; dl[u] &lt; dr[v]) <span class=\"keyword\">return</span> v;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, <span class=\"number\">19</span>, <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> x = fa[i][u];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(x &amp;&amp; dl[x] &gt; dl[v]) u = x;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> fa[<span class=\"number\">0</span>][u];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"int-\"><code>int</code> </h3>\r\n<h4 id=\"-17\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, m, s, t;</span><br><span class=\"line\"><span class=\"keyword\">int</span> eid = <span class=\"number\">1</span>, he[N], nw[N], d[N], q[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">edge</span> &#123;</span> <span class=\"keyword\">int</span> v, nx, c; &#125; e[M * <span class=\"number\">2</span>];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-21\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> c)</span> </span>&#123;</span><br><span class=\"line\">    e[++eid] = &#123;v, he[u], c&#125;, he[u] = eid;</span><br><span class=\"line\">    e[++eid] = &#123;u, he[v], <span class=\"number\">0</span>&#125;, he[v] = eid;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">bfs</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(d, <span class=\"number\">0</span>), <span class=\"built_in\">memcpy</span>(nw, he, <span class=\"keyword\">sizeof</span> he);</span><br><span class=\"line\">    q[<span class=\"number\">1</span>] = s, d[s] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> l = <span class=\"number\">1</span>, r = <span class=\"number\">1</span>; l &lt;= r; l++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> u = q[l];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = he[u], v; v = e[i].v; i = e[i].nx)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(e[i].c &amp;&amp; !d[v]) q[++r] = v, d[v] = d[u] + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> d[t];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> lim, <span class=\"keyword\">int</span> re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u == t) <span class=\"keyword\">return</span> lim;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span>&amp; i = nw[u], v; v = e[i].v; i = e[i].nx)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(e[i].c &amp;&amp; d[v] == d[u] + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> t = <span class=\"built_in\">dfs</span>(v, <span class=\"built_in\">min</span>(e[i].c, lim));</span><br><span class=\"line\">        e[i].c -= t, e[i ^ <span class=\"number\">1</span>].c += t, re += t, lim -= t;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!lim) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(lim) d[u] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-1\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> flow = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">while</span>(<span class=\"built_in\">bfs</span>()) flow += <span class=\"built_in\">dfs</span>(s, Inf);</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"long-long-\"><code>long long</code> </h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">bfs</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(d, <span class=\"number\">0</span>), <span class=\"built_in\">memcpy</span>(nw, he, <span class=\"keyword\">sizeof</span> he);</span><br><span class=\"line\">    q[<span class=\"number\">1</span>] = s, d[s] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> l = <span class=\"number\">1</span>, r = <span class=\"number\">1</span>; l &lt;= r; l++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> u = q[l];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = he[u], v; v = e[i].v; i = e[i].nx)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(e[i].c &amp;&amp; !d[v]) q[++r] = v, d[v] = d[u] + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> d[t];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, ll lim, ll re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u == t) <span class=\"keyword\">return</span> lim;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span>&amp; i = nw[u], v; v = e[i].v; i = e[i].nx)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(e[i].c &amp;&amp; d[v] == d[u] + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        ll t = <span class=\"built_in\">dfs</span>(v, <span class=\"built_in\">min</span>((ll)e[i].c, lim));</span><br><span class=\"line\">        e[i].c -= t, e[i ^ <span class=\"number\">1</span>].c += t, re += t, lim -= t;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!lim) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(lim) d[u] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"ssp-\">SSP </h3>\r\n<h4 id=\"-18\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, m, s, t, flow, cost;</span><br><span class=\"line\"><span class=\"keyword\">int</span> eid = <span class=\"number\">1</span>, he[N], nw[N], q[N], d[N], vs[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">edge</span> &#123;</span> <span class=\"keyword\">int</span> v, nx, c, w; &#125; e[M * <span class=\"number\">2</span>];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-22\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> c, <span class=\"keyword\">int</span> w)</span> </span>&#123;</span><br><span class=\"line\">    e[++eid] = &#123;v, he[u], c, w&#125;, he[u] = eid;</span><br><span class=\"line\">    e[++eid] = &#123;u, he[v], <span class=\"number\">0</span>, -w&#125;, he[v] = eid;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">spfa</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(d, <span class=\"number\">63</span>), <span class=\"built_in\">memcpy</span>(nw, he, <span class=\"keyword\">sizeof</span> he);</span><br><span class=\"line\">    q[<span class=\"number\">0</span>] = s, d[s] = <span class=\"number\">0</span>, vs[s] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> l = <span class=\"number\">0</span>, r = <span class=\"number\">0</span>; l &lt;= r; l++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> u = q[l % N]; vs[u] = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = he[u], v; v = e[i].v; i = e[i].nx)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(e[i].c &amp;&amp; d[u] + e[i].w &lt; d[v]) &#123;</span><br><span class=\"line\">            d[v] = d[u] + e[i].w;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!vs[v]) q[++r % N] = v, vs[v] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> d[t] &lt; d[<span class=\"number\">0</span>];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> lim, <span class=\"keyword\">int</span> re = <span class=\"number\">0</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(u == t) <span class=\"keyword\">return</span> lim;</span><br><span class=\"line\">    vs[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span>&amp; i = nw[u], v; v = e[i].v; i = e[i].nx)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!vs[v] &amp;&amp; e[i].c &amp;&amp; d[v] == d[u] + e[i].w) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> t = <span class=\"built_in\">dfs</span>(v, <span class=\"built_in\">min</span>(lim, e[i].c));</span><br><span class=\"line\">        e[i].c -= t, e[i ^ <span class=\"number\">1</span>].c += t, re += t, lim -= t, cost += t * e[i].w;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!lim) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(lim) d[u] = d[<span class=\"number\">0</span>];</span><br><span class=\"line\">    vs[u] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-2\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span>(<span class=\"built_in\">spfa</span>()) flow += <span class=\"built_in\">dfs</span>(s, <span class=\"number\">1e9</span>);</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"primal-dual-\">Primal-Dual </h3>\r\n<h4 id=\"-19\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, m, s, t, flow, cost;</span><br><span class=\"line\"><span class=\"keyword\">int</span> eid = <span class=\"number\">1</span>, he[N], d[N], pre[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">edge</span> &#123;</span> <span class=\"keyword\">int</span> v, nx, c, w; &#125; e[M * <span class=\"number\">2</span>];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">node</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> d, u;</span><br><span class=\"line\">    <span class=\"keyword\">bool</span> <span class=\"keyword\">operator</span> &lt;(<span class=\"keyword\">const</span> node&amp; b)<span class=\"keyword\">const</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> d &gt; b.d;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-23\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> c, <span class=\"keyword\">int</span> w)</span> </span>&#123;</span><br><span class=\"line\">    e[++eid] = &#123;v, he[u], c, w&#125;, he[u] = eid;</span><br><span class=\"line\">    e[++eid] = &#123;u, he[v], <span class=\"number\">0</span>, -w&#125;, he[v] = eid;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dji</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    priority_queue&lt;node&gt; q;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(d, <span class=\"number\">63</span>), q.<span class=\"built_in\">push</span>(&#123;d[s] = <span class=\"number\">0</span>, s&#125;);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(q.<span class=\"built_in\">size</span>()) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> [dis, u] = q.<span class=\"built_in\">top</span>(); q.<span class=\"built_in\">pop</span>();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(dis &gt; d[u]) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = he[u], v; v = e[i].v; i = e[i].nx) <span class=\"keyword\">if</span>(e[i].c) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> w = d[u] + e[i].w - h[v] + h[u];</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(w &lt; d[v]) pre[v] = i ^ <span class=\"number\">1</span>, q.<span class=\"built_in\">push</span>(&#123;d[v] = w, v&#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) h[i] += d[i];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> d[t] &lt; d[<span class=\"number\">0</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-3\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span>(<span class=\"built_in\">dji</span>()) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> mi = Inf;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> u = t, i; i = pre[u]; u = e[i].v) mi = <span class=\"built_in\">min</span>(mi, e[i ^ <span class=\"number\">1</span>].c);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> u = t, i; i = pre[u]; u = e[i].v) e[i].c += mi, e[i ^ <span class=\"number\">1</span>].c -= mi;</span><br><span class=\"line\">    flow += mi, cost += mi * h[t];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-20\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, m, vs[N], mch[N];</span><br><span class=\"line\">vector&lt;<span class=\"keyword\">int</span>&gt; G[N];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-24\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> s)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(vs[u] == s) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    vs[u] = s;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(!mch[v] || <span class=\"built_in\">dfs</span>(mch[v], s)) <span class=\"keyword\">return</span> mch[v] = u;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-4\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> as = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(<span class=\"built_in\">dfs</span>(i, i)) as++;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"sat-\">2-SAT </h2>\r\n<h3 id=\"-21\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, m, co[N * <span class=\"number\">2</span>], stk[N * <span class=\"number\">2</span>], tp;</span><br><span class=\"line\">vector&lt;<span class=\"keyword\">int</span>&gt; G[N * <span class=\"number\">2</span>];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-25\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> b)</span> </span>&#123;</span><br><span class=\"line\">    G[u * <span class=\"number\">2</span> + !a].<span class=\"built_in\">pb</span>(v * <span class=\"number\">2</span> + b);</span><br><span class=\"line\">    G[v * <span class=\"number\">2</span> + !b].<span class=\"built_in\">pb</span>(u * <span class=\"number\">2</span> + a);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(co[u] | co[u ^ <span class=\"number\">1</span>]) <span class=\"keyword\">return</span> co[u];</span><br><span class=\"line\">    co[u] = <span class=\"number\">1</span>, stk[++tp] = u;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) <span class=\"keyword\">if</span>(!<span class=\"built_in\">dfs</span>(v)) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">twoSat</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!co[i * <span class=\"number\">2</span>] &amp;&amp; !co[i * <span class=\"number\">2</span> + <span class=\"number\">1</span>] &amp;&amp; !<span class=\"built_in\">dfs</span>(i * <span class=\"number\">2</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(tp) co[stk[tp--]] = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!<span class=\"built_in\">dfs</span>(i * <span class=\"number\">2</span> + <span class=\"number\">1</span>)) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        tp = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h1 id=\"\"></h1>\r\n<h2 id=\"manacher-\">manacher </h2>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span>&amp; j = ma &gt; i ? <span class=\"built_in\">min</span>(R[p * <span class=\"number\">2</span> - i], ma - i) : <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(s[i - j] == s[i + j + <span class=\"number\">1</span>]) j++;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i + j &gt; ma) ma = i + j, p = i;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-3\"></h3>\r\n<h4 id=\"-22\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">char</span> s[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, sz = <span class=\"number\">1</span>, nw, len[N], f[N], ch[N][<span class=\"number\">26</span>];</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-26\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> jmp = [&amp;](<span class=\"keyword\">int</span> o) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(s[i - len[o] - <span class=\"number\">1</span>] != s[i]) o = f[o];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> o;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> o = <span class=\"built_in\">jmp</span>(nw), c = s[i] - <span class=\"number\">97</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!ch[o][c]]) &#123;</span><br><span class=\"line\">        f[++sz] = ch[<span class=\"built_in\">jmp</span>(f[o])][c];</span><br><span class=\"line\">        len[ch[o][c] = sz] = len[o] + <span class=\"number\">2</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    nw = ch[o][c];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-4\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">len[<span class=\"number\">1</span>] = <span class=\"number\">-1</span>, f[<span class=\"number\">0</span>] = <span class=\"number\">1</span>;</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"\"></h3>\r\n<h4 id=\"-27\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">auto</span> jmp = [&amp;](<span class=\"keyword\">int</span> o) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(o &amp;&amp; s[i - len[o] - <span class=\"number\">1</span>] != s[i]) o = f[o];</span><br><span class=\"line\">        <span class=\"keyword\">return</span> o;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> o = <span class=\"built_in\">jmp</span>(nw), c = s[i] - <span class=\"number\">97</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!ch[o][c]]) &#123;</span><br><span class=\"line\">        f[++sz] = ch[<span class=\"built_in\">jmp</span>(f[o])][c];</span><br><span class=\"line\">        len[ch[o][c] = sz] = len[o] + <span class=\"number\">2</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    nw = ch[o][c];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h4 id=\"-5\"></h4>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">rep</span>(i, <span class=\"number\">0</span>, <span class=\"number\">25</span>) ch[<span class=\"number\">0</span>][i] = <span class=\"number\">1</span>;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-23\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> n, m = <span class=\"number\">128</span>, sa[N], rk[N], tp[N], buc[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> h[<span class=\"number\">20</span>][N];</span><br><span class=\"line\"><span class=\"keyword\">char</span> s[N];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-28\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">SA</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) buc[rk[i] = s[i]]++;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) buc[i] += buc[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, n, <span class=\"number\">1</span>) sa[buc[rk[i]]--] = i;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> k = <span class=\"number\">1</span>, p; <span class=\"built_in\">memset</span>(buc, p = <span class=\"number\">0</span>, m * <span class=\"number\">4</span> + <span class=\"number\">4</span>); k *= <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, n - k + <span class=\"number\">1</span>, n) tp[++p] = i;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"keyword\">if</span>(sa[i] &gt; k) tp[++p] = sa[i] - k;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) buc[rk[i]]++;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) buc[i] += buc[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(i, n, <span class=\"number\">1</span>) sa[buc[rk[tp[i]]]--] = tp[i];</span><br><span class=\"line\">        <span class=\"built_in\">memcpy</span>(tp, rk, n * <span class=\"number\">4</span> + <span class=\"number\">4</span>), p = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) rk[sa[i]] = p += tp[sa[i]] ^ tp[sa[i - <span class=\"number\">1</span>]] || tp[sa[i] + k] ^ tp[sa[i - <span class=\"number\">1</span>] + k];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((m = p) &gt;= n) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">height</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> k = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(k ? k-- : <span class=\"number\">0</span>; s[i + k] == s[sa[rk[i] - <span class=\"number\">1</span>] + k]; k++);</span><br><span class=\"line\">        h[<span class=\"number\">0</span>][rk[i]] = k;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">19</span>) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, n - (<span class=\"number\">1</span> &lt;&lt; i) + <span class=\"number\">1</span>)</span><br><span class=\"line\">        h[i][j] = <span class=\"built_in\">min</span>(h[i - <span class=\"number\">1</span>][j], h[i - <span class=\"number\">1</span>][j + (<span class=\"number\">1</span> &lt;&lt; (i - <span class=\"number\">1</span>))]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-24\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">char</span> s[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, sz = <span class=\"number\">1</span>, nw = <span class=\"number\">1</span>, f[N], len[N], ch[N][<span class=\"number\">26</span>];</span><br></pre></td></tr></table></figure>\r\n<h3 id=\"-29\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">ins</span><span class=\"params\">(<span class=\"keyword\">int</span> c)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> u = ++sz;</span><br><span class=\"line\">    len[u] = len[nw] + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(nw &amp;&amp; !ch[nw][c]) ch[nw][c] = u, nw = f[nw];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!nw) f[u] = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> v = ch[nw][c];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(len[v] &gt; len[nw] + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            f[++sz] = f[v], <span class=\"built_in\">memcpy</span>(ch[sz], ch[v], <span class=\"keyword\">sizeof</span> ch[v]);</span><br><span class=\"line\">            f[v] = f[u] = sz, len[sz] = len[nw] + <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> x = nw; ch[x][c] == v; x = f[x]) ch[x][c] = sz;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> f[u] = v;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    nw = u;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n<h2 id=\"\"></h2>\r\n<h3 id=\"-30\"></h3>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">calc</span><span class=\"params\">(<span class=\"keyword\">char</span> s[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i = <span class=\"number\">0</span>, j = <span class=\"number\">1</span>, k = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(i &lt; n &amp;&amp; j &lt; n &amp;&amp; k &lt; n)</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(s[(i + k) % n] == s[(j + k) % n]) k++;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(s[(i + k) % n] &gt; s[(j + k) % n]) <span class=\"built_in\">swap</span>(i, j);</span><br><span class=\"line\">        j += k + <span class=\"number\">1</span>, k = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(i == j) i++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">min</span>(i, j);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n"},{"title":"","date":"2021-09-08T07:09:11.000Z","updated":"2021-09-08T07:09:11.000Z","top":1,"_content":"\n\n### TC13459\n\n1 1 1\n\n $(i,j),(i,k)$ $(j,k)$  $(i,j)$  $(i,k)$ \n\n\n\n\n\n $x$  $y$  $i$ \n$$\n\\sum_{i=0}^x\\binom xi2^yn^{\\underline{i+y}}n^{\\underline{x-i+y}}\n$$\n $O(n^3)$DFS  $O(n^3\\alpha(n^2))$\n\n### TC12909\n\n\n\n $f_{i,j}$  $i$  $j$ \n\n-  $i+1$ $f_{i+1,j+1} \\leftarrow j \\cdot f_{i,j}$\n-  $i+1$ $f_{i+1,j} \\leftarrow 2j \\cdot f_{i,j}$\n-  $i+1$ $f_{i+1,j-1} \\leftarrow j \\cdot f_{i,j}$\n\n $j \\le G$  $0$\n\n $K$  $x$  $N\\binom{N-K-1}{K-1}$\n\n $O(N^2)$\n\n### TC13692\n\n\n\n $S_1-S_2$  $u$   $f_u$ $u=S_1$  $S_2$  $u$  $O(n^2)$\n\n $S_1-S_2$  $f$ \n\n $S_1-S_2$  $(u,v)$ $(u,v)$ $O(n)$  $f_u+f_v$\n\n $f_{S_1}+f_{S_2}$  \n\n### AGC017F\n\n$0$ $1$  $2^{N-1}$ \n\n $S,T$  $T$  $S$ \n\n `DP` $f_{i,j,k,S}$ \n\n-  $i$  $j$ \n- $S$  $j$  $i$  $N-1-j$  $i-1$ \n-  $i-1$  $j$  $k$\n\n $i$  $j+1$ \n\n $O(n^32^n)$\n\n $S,T$  $S$  $T$ \n\n-  $1$ \n\n-  $1$  $0$  $1$\n\n `DP`  $f_{i,j,S}$  $i$  $S$ $j$  $1$ \n\n\n\n-  $j+1$  $1$ $1$ $O(1)$ \n-  $i$  $1$  $0$  $1$ $O(1)$ \n\n $i$  $0$\n\n $O(n^22^n)$\n\n### ARC078D\n\n $1-n$ \n\n- \n\n $u_1,u_2,\\cdots,u_k$$u_1=1,u_k=n$ $k$  $i$  $u_k$\n\n\n\n-  $g_S$  $S$ \n-  $f_S$  $S$ \n- $f_S \\leftarrow f_{S-T} + g_T({T \\subseteq S})$ $T$ \n\n `DP` \n\n $f_{i,S}$  $S$  $1-i$ \n\n:\n\n- $f_{i,S \\cup \\{i\\}} \\leftarrow f_{j,S} + w(j,i)(j \\not\\in S)$\n- $f_{i,S\\cup T} \\leftarrow f_{i,S}+g_{T\\cup\\{i\\}}(S \\cap T = \\varnothing)$\n\n $O(n3^n)$\n\nARC068D\n\nAGC004F\n\nARC097D\n\nTC10265\n\nTC9844\n\nARC067C\n\nARC097C\n\n### TC10727\n\n\n\n-  $u$  $v$  $k$ \n\n `DP` $x$ $x$  $x$ $\\text{dis}(x,\\text{lca}(x,v)),\\text{dis}(v,\\text{lca}(x,v))$ \n\n $f_{i,j,k}$  $i$ $\\text{dis}(x,\\text{lca}(x,v))=j,\\text{dis}(v,\\text{lca}(x,v))=k$ \n\n\n\n- $f_{i+1,j+1,k} \\leftarrow 2f_{i,j,k},f_{i+1,j-1,k} \\leftarrow f_{i,j,k}(j>0)$\n- $f_{i+1,1,k} \\leftarrow f_{i,0,k},f_{i+1,\\max(1-k,0),\\max(k-1,0)} \\leftarrow f_{i,0,k}(k>0)$\n- $f_{i+1,0,k+1} \\leftarrow f_{i,0,k}(k < \\text{depth}_v)$\n\nTC10664\n\nTC10566\n\nTC10773\n\n### TC10993\n\n $0$ \n\n $C$  $C$ \n\n\n\n $C$  $C$  $\\min  + \\min   \\ge C$\n\n `DP` $f_{i,j}$  $i$  $\\min$  $j$ \n\n $i+1$  $k$$f_{i+1,\\min(j,k)} \\leftarrow f_{i,j}(j+k \\ge C)$ $j$  $i+1$   $i+1$ \n\n $O(nC^2)$\n\n\n\n- $f_{i+1,j} \\leftarrow f_{i,j}(k \\ge \\max(j,C-j))$ $k$\n- $f_{i+1,k} \\leftarrow f_{i,j}(k \\le j \\le C -k)$ $k$  $j$  $O(1)$ \n\n $O(nC)$\n\nTC10741\n\nTC10854\n\nTC10848\n\nTC10902\n\nTC10737\n\nTC10758\n\nTC11003\n\nTC11026\n\nTC11032\n\nTC10748\n\nTC11213\n\nTC11305\n\nTC12620\n\n\n\nTC10758\n\nTC11032\n\n### Gym102391E\n\n $D$ $f_u$ \n\n-  $u$ \n-  $D$\n- $f_u$  $u$/ $fa_u$\n\n\n\n- $u$  $f$  $D$ $D$  $D$  `DP` $f$ \n\n- $u$  $fa$  $u$ \n\n  -  $v$  $+f_v$\n  -  $v_1,v_2$  $+f_{v_1}+f_{v_2}$\n\n   $D$\n\n  $f_u \\leftarrow \\max\\limits_vf_v+$ $v$  $fa$ \n\n  $f_u \\leftarrow$  $fa$ \n\n   $O(^2)$\n\n  -  $i$  $fa$ \n  -  $i$  $fa$  $i$ \n  -  $i$  $fa$ \n  -  $i$ \n\n $O(n\\log V)$\n\n### ZOJ3970\n\n\n\n- \n- \n\n\n\n $i$  $a_i$  $\\sum_{i=2}^n\\max(0,a_i-a_{i-1})$\n\n\n\n $pre_i$  $t_j>0$  $j$\n\n$f_{i,j}$  $i$  $i$  $j$ \n\n\n\n$$\nf_{i,j}=\\min_kf_{pre_i,k}+\\max(0,j-k)+\\max(0,t_i-s_i+j-t_{pre_i}+s_{pre_i}-k)+\\max(0,\\max_{pre_i<x<i}s_x-\\max(j,k))\n$$\n\n $(pre_i,i)$  $0$ \n\n $O(nV^2)$\n\n $f_i$ \n\n $\\min$  $O(1)$  $f_{i,j}$\n\n $f_i$  $[l,r]$ $f_{i,l},f_{i,mid},f_{i,r}$  $[l,r]$ \n\n $O(n\\log V)$\n\n### ZOJ3989\n\n\n\n\n\n- \n- \n- \n- \n\n ```DP``` \n\n\n\n\n\n- \n-  $[l,r]$ $x$ $l < x < r$ $x > r$\n- \n- \n\n $2^{n-2}$\n\n\n\n\n\n\n\n\n\n $f_{S,i}$  $S$ $i$ \n\n $O(n^22^n)$\n\n### \n\n>  $n$  $S$ $f(S)$  $S$  $S \\ne \\{1,2,\\cdots,n\\}$ $|f(S)| \\le |S|$\n>\n> $n, m \\le 10^5$\n\nHall  $S$$|f(S)| \\ge |S|$\n\n $S$  $|f(S)| \\le |S|$ $S$\n\n $S$\n\n $S$ $f(S)$\n\n $v$ $\\text{match}(v)$\n\n $(u,v)$  $(u,\\text{match}(v))$ \n\n### ARC107F\n\n\n\n\n\n-  $-B_i,A_i,B_i$\n-  $u,v$\n- \n\n $i$  $U_i,V_i$\n\n $(S,U_i),(U_i,V_i),(V_i,T)$ \n\n $\\infty-B_i,\\infty+A_i,\\infty+B_i$\n\n $(i,j)$\n\n-  $(S,U_i),(V_j,T)$ $(S,U_i)$ $U_i$  $T$ $(V_j,T)$ $S$  $V_j$ $(V_j,U_i)$ $\\infty^2$ \n-  $(S,U_j),(V_i,T)$ $(V_i,U_j)$ $\\infty^2$ \n\n $n\\infty$\n\n![.png](https://i.loli.net/2021/09/08/4ragjEUYIev5wot.png)\n\n### Gym101471J\n\nCF1307G\n\n### CF1307F\n\nP3980\n\nCF1368H2\n\n### AGC038E\n\n$B_i=1$ \n\n `DP`  `min-max` \n\n $O(n2^n)$  $O(2^n)$  $400$\n\n `min-max` \n$$\n\\sum_{S}(-1)^{|S|}\\frac{\\sum_{i=1}^n A_i}{\\sum_{i \\in S} A_i}\n$$\n $400$  $\\sum_S(-1)^{|S|}$\n\n\n$$\nf_{i,j} = \\sum_{S \\subseteq \\{1,2,\\cdots,i\\}}(-1)^{|S|}[\\sum_{i \\in S}A_i=j]\n$$\n $f_{i,j}=f_{i-1,j}-f_{i-1,j-A_i}$\n$$\n(\\sum_{i=1}^n A_i)\\sum_{i=0}^{400}\\frac{f_{n,i}}i\n$$\n `min-max` \n$$\n\\sum_{S}(-1)^{|S|}[S ]\n$$\n\n $p_i=\\frac{A_i}{\\sum_{j \\in S}A_j}$\n\n\n$$\n\\begin{aligned}\n&\\sum_{\\forall i \\in S,c_i<B_i}[c]\\cdot[c]\\\\\n&=\\sum_{\\forall i \\in S,c_i<B_i}\\frac{(\\sum_{i \\in S}c_i)!}{\\prod_{i \\in S} c_i!}\\prod_{i \\in S}p_i^{c_i} \\cdot \\frac{\\sum_{i=1}^n A_i}{\\sum_{i \\in S} A_i}\\\\\n&=\\sum_{\\forall i \\in S,c_i<B_i}\\frac{(\\sum_{i \\in S}c_i)!}{\\prod_{i \\in S} c_i!}\\prod_{i \\in S}A_i^{c_i} \\cdot \\frac{\\sum_{i=1}^n A_i}{(\\sum_{i \\in S} A_i)^{(\\sum_{i \\in S}c_i)+1}}\n\\end{aligned}\n$$\n\n\n$$\n\\begin{aligned}\n&\\sum_S(-1)^{|S|}\\sum_{\\forall i \\in S,c_i<B_i}\\frac{(\\sum_{i \\in S}c_i)!}{\\prod_{i \\in S} c_i!}\\prod_{i \\in S}A_i^{c_i} \\cdot \\frac{\\sum_{i=1}^n A_i}{(\\sum_{i \\in S} A_i)^{(\\sum_{i \\in S}c_i)+1}}\\\\\n&=(\\sum_{i=1}^n A_i)\\sum_S(-1)^{|S|}\\sum_{\\forall i \\in S,c_i<B_i}\\frac{(\\sum_{i \\in S}c_i)!}{(\\sum_{i \\in S} A_i)^{(\\sum_{i \\in S}c_i)+1}} \\cdot \\prod_{i \\in S}\\frac{A_i^{c_i}}{c_i!}\n\\end{aligned}\n$$\n\n $\\sum_{i \\in S} A_i$  $\\sum_{i \\in S}c_i$\n\n\n$$\nf_{i,j,k}=\\sum_{S \\subseteq \\{1,2,\\cdots,i\\}}(-1)^{|S|}\\sum_{\\forall i \\in S,c_i<B_i}\\prod_{i \\in S}\\frac{A_i^{c_i}}{c_i!}[\\sum_{i \\in S} A_i=j \\land \\sum_{i \\in S}c_i=k]\n$$\n\n$$\nf_{i,j,k}=f_{i-1,j,k}-\\sum_{c=0}^{B_i-1}f_{i-1,j-A_i,k-c}\\frac{A_i^c}{c!}\n$$\n\n$$\n(\\sum_{i=1}^n A_i)\\sum_{i=0}^{400}\\sum_{j=0}^{400}\\frac{j!f_{n,i,j}}{i^{j+1}}\n$$\n $B_i$ $\\sum_{i=1}^nB_i$  $O(n)$  $O(n^3)$ $O(n^2)$\n\n---\n\n### AGC037D\n\n $i$  $(i-1)m+1$  $im$  $(i-1)m+1$  $im$  $i$\n\n $i$  $i$  $n$ \n\n $i$  $i$  $i$ Hall \n\n $O(n^4)$\n\n### AGC043D\n\n $P$ \n\n $A_i$ $A_i$ \n\n\n\n-  $3$ \n- \n-  $1$  $2$  $2$  $1$  $A_i$\n\n $P$  $P$  $A$ \n\n $P$ \n\n $1,2,3$  $cnt_1,cnt_2,cnt_3$ $cnt_1+2cnt_2+3cnt_3=3n$  $cnt_1 \\ge cnt_2$\n\n\n$$\n\\binom{cnt_1+cnt_2+cnt_3}{cnt_1,cnt_2,cnt_3}\\frac{(3n)!}{(cnt_1+cnt_2+cnt_3)!2^{cnt_2}3^{cnt_3}}\n$$\n $(cnt_1+cnt_2+cnt_3)!$  $2^{cnt_2}3^{cnt_3}$ \n\n $O(n^2)$\n\n### AGC049D\n\n\n\n-  $c$ $i$ $A=(c,c,\\cdots,c)$\n-  $j<i$ $A_j,A_{j-1},A_{j-2},\\cdots,A_1$  $1,2,3,\\cdots,j$\n-  $j>i$ $A_j,A_{j+1},A_{j+2},\\cdots,A_n$  $1,2,3,\\cdots,n-j+1$ $i>1$  $i-1$ \n\n $i-1$  $\\frac {i(i-1)}2$ \n\n $i$ $O(\\sqrt m)$  $O(m\\sqrt m)$  $O(\\frac mn)$  $c$\n\n $O(nm\\sqrt m)$\n\n $i \\rightarrow i+1$  $O(\\sqrt m)$  $O(m\\sqrt m)$ \n\n### AGC050D\n\n $f_{i,a,b,j}$  $j$ \n\n-  $a$  $i$ \n-  $b$  $i+1$ \n\n $a$  $f_{i,0,b,j}=f_{i+1,b,0,j}$\n\n- $f_{i,a,b,j}=win \\cdot f_{i,a-1,b,j-[j>b]} + lost \\cdot f_{i,a-1,b+1,j}(j\\ne b+1)$\n- $f_{i,a,b,b+1}=win + lost \\cdot f_{i,a-1,b+1,b+1}(j\\le b)$\n\n $O(n^4)$\n\n### NOI2021Day1T1\n\n\n\n\n\n $O(n\\log^2n)$\n\n### NOI2021Day1T2\n\n $k=2$ \n\n $n_1=n_2=\\cdots=n_k$ \n\n\n\n\n\n-  $(P_1,P_2,\\cdots,P_k)$  $(Q_1,Q_2,\\cdots,Q_k)$ $\\iff$ $(P_1,Q_1)$  $(P_k,Q_k)$ \n\n- \n\n  - \n  - \n\n  \n\n $O(n^4)$\n\n### NOI2021Day1T3\n\n $s$  $t$ \n\n\n\n $x\\Rightarrow z$  $y\\Rightarrow z$ $x\\Rightarrow y$  $y\\Rightarrow x$ $z$ \n\n\n\n $s,t$ \n\n `LCA`  `vector`\n\n $O(n+q\\log n)$\n\n### NOI2021Day2T1\n\n$k \\le 15$  $256$  $16$ \n\n $16$  $7$  `popcount` \n\n### NOI2021Day2T2\n\n~~~~\n\n $a$ \n\n $a_n$  $x,y$ $\\frac {x'}{y'}=a_{n-1}+\\frac 1{a_n}=\\frac {a_{k-1}x+y}x$ $(x,y)$ \n$$\n\\begin{bmatrix}\nx'\\\\\ny'\n\\end{bmatrix}\n=\n\\begin{bmatrix}\na_{n-1}&1\\\\\n1&0\n\\end{bmatrix}\n\\begin{bmatrix}\nx\\\\\ny\n\\end{bmatrix}\n$$\n\n$$\n\\begin{bmatrix}\na&c\\\\\nb&d\n\\end{bmatrix}\n=\n\\prod_{i=1}^n\n\\begin{bmatrix}\na_i&1\\\\\n1&0\n\\end{bmatrix}\n$$\n $\\frac ab$\n\n\n\n- `W`  $\\begin{bmatrix}x&1\\\\1&0\\end{bmatrix}\\begin{bmatrix}1&0\\\\1&1\\end{bmatrix}=\\begin{bmatrix}x+1&1\\\\1&0\\end{bmatrix}$ 'W'  $\\begin{bmatrix}1&0\\\\1&1\\end{bmatrix}$\n\n- `E`  $1$  $1$ \n\n   $1$ \n  $$\n  \\begin{bmatrix}\n  1&1\\\\\n  1&0\n  \\end{bmatrix}\n  \\rightarrow\n  \\begin{bmatrix}\n  1&0\\\\\n  1&1\n  \\end{bmatrix}\n  \\begin{bmatrix}\n  1&1\\\\\n  1&0\n  \\end{bmatrix}\n  =\n  \\begin{bmatrix}\n  1&1\\\\\n  2&1\n  \\end{bmatrix}\n  $$\n  **** $1$ $1$ \n  $$\n  \\begin{bmatrix}\n  1&1\\\\\n  1&0\n  \\end{bmatrix}\n  \\rightarrow\n  \\begin{bmatrix}\n  0&1\\\\\n  1&0\n  \\end{bmatrix}\n  \\begin{bmatrix}\n  1&1\\\\\n  1&0\n  \\end{bmatrix}^2\n  =\n  \\begin{bmatrix}\n  1&1\\\\\n  2&1\n  \\end{bmatrix}\n  $$\n   `E`  $1$  $\\begin{bmatrix}1&0\\\\-1&1\\end{bmatrix}$\n\n   `E`  $\\begin{bmatrix}1&0\\\\-1&1\\end{bmatrix}\\begin{bmatrix}1&1\\\\1&0\\end{bmatrix}^2=\\begin{bmatrix}2&1\\\\-1&0\\end{bmatrix}$\n\n`APPEND``FLIP `  `REVERSE ` `FLIP`  `FLIP` \n\n $O(n\\log n)$\n\n### NOI2021Day2T3\n\n $4$  $0$ $1$ $0,1,2,3$ \n\n $mask$\n\n-  $0,1$  $2,3$ $1$\n-  $01$  $2$\n-  $3$\n\n $O(2^nmn^2)$ \n\n $g_{0/1/2/3,S}$  $S$  $0/1/2/3$ $g$  $O(2^n)$  $g$  $O(1)$ \n\n $O(2^nm)$\n\n $n \\le 32$ $mask$  $\\lceil\\frac n2\\rceil$  $\\lceil\\frac n2\\rceil$ \n\n $mask$  $\\max$\n\n- $\\max \\le \\lceil\\frac n2\\rceil$ $O(2^{\\frac n2}m)$\n\n- $\\max > \\lceil\\frac n2\\rceil$ $n-\\max+1$\n\n   $R$ \n\n  -  $R$  $mask$ \n\n  - \n\n   $mask$  $2\\max-n+1$ $O(2^{n-\\max+1}m)$\n   `DP` $f_{i,S}$  $mask$  $i$  $n-\\max+1$  $S$ $i+1$  $O(2^{n-\\max+1}m)$  $O(2^{n-\\max+1}n)$\n\n $O(2^{n/2}m)$\n\n### CF1548D2\n\n Pick \n$$\nS=i+\\frac b2-1\n$$\n $S\\in \\mathbb Z \\land2S\\equiv b \\pmod 4$\n\n $ABC$ $2S=|\\overrightarrow A\\times \\overrightarrow B+\\overrightarrow B\\times \\overrightarrow C+\\overrightarrow C\\times \\overrightarrow A|$ $S$  $S$  $4$  $2S \\bmod 4$\n\n $AB$  **** $b$  $AB$  $\\text{bounds}(A,B)=\\gcd(|X_A-X_B|,|Y_A-Y_B|)$\n\n $S$  $b$  $\\text{bounds}(A,B) \\bmod 4$  $0$  $2$ \n$$\n\\text{bounds}(A,B) \\equiv 0\\pmod 4 \\iff X_A\\equiv X_B\\pmod 4 \\land Y_A\\equiv Y_B\\pmod 4\n$$\n $\\text{bounds}(A,B) \\not\\equiv 0\\pmod 4$ \n$$\n\\text{bounds}(A,B) \\equiv 2\\pmod 4 \\iff X_A\\equiv X_B\\pmod 2 \\land Y_A\\equiv Y_B\\pmod 2\n$$\n $4$ \n\n EEE  EOO  $cnt_{A,x,y,z}$  $B$ \n$$\nX_B\\equiv x\\pmod 4 \\land Y_B\\equiv y\\pmod 4 \\land \\text{bounds}(A,B) \\equiv z\\pmod 4\n$$\n $O(n^2\\log V)$ \n\n $ABC$  $A$\n$$\nX_B\\bmod 4,Y_B\\bmod 4,\\text{bounds}(A,B)\\bmod 4\\\\X_C\\bmod 4,Y_C\\bmod 4,\\text{bounds}(A,C)\\bmod 4\n$$\n\n$$\nS \\in \\mathbb Z\\\\\n\\text{bounds}(A,B)\\equiv\\text{bounds}(A,C)\\pmod 2\\\\\nX_B\\equiv X_C \\pmod 2\\\\\nY_B\\equiv Y_C\\pmod 2\\\\\nS\\equiv \\text{bounds}(A,B)+\\text{bounds}(A,C)+\\text{bounds}(B,C)\\pmod 4\n$$\n $cnt$  $O(1)$ \n\n EEE  $3$  EOO  $1$ \n\n $O(n^2\\log V)$\n\n### CF1548E\n\n~~ 3400~~\n\n $1$ $0$1-\n\n>  $i,j$1 \n\n $a_i \\ge a_j$$a_i+b_k \\le x \\Rightarrow a_j+b_k \\le x$\n\n $a,b$ \n\n\n\n-  $S$ $L_r$ $R_r$ $L_c$ $R_c$\n-  $a_{L_r},a_{L_r+1},\\cdots,a_{R_r}$  $i$ $(i,L_c),(i,L_c+1),\\cdots,(i,R_c)$  1\n-  $S$  $i$ \n\n $i$ $i$  1  $[l,r]$ $i$ \n\n-  $j$  $a_j \\le a_i$$\\min_{k\\in [l,r]}a_k+\\max_{k\\in (j,i]}b_k>x$\n-  $j$  $a_j<a_i$$\\min_{k\\in [l,r]}a_k+\\max_{k\\in [i,j)}b_k>x$\n\n $i$  $a_j\\le a_i$  $j$  $pre$ $i$  $a_j< a_i$  $j$  $suf$ $[l,r]$  $\\min_{i\\in [l,r]}a_i>x-\\max_{i\\in (pre,suf)}$ $i$  $O(n)$ \n\n\n\n-  $b$ \n-  $a_i$ $i$  $0$  $1$\n-  $key$\n\n\n\n $O(n\\log n)$\n\n### 2021MINIEYE5T1\n\n\n\n- `1`  `access(u)`\n- `2` \n- `3`  `dfs` \n- `4` \n\n `23` \n\n `4`  `LCT`  `access` \n\n $O(n\\log^2n)$\n\n### 2021MINIEYE5T2\n\n $f_{i,j}$  $i$  `a`$j$  `b` $(x+y+k-2)^L$\n\n $\\sum_{i=0}^L\\sum_{j=0}^L[n|i-p][n|j-q][x^i][y^j](x+y+k-2)^L$\n\n $n|P-1$\n$$\n\\frac 1{n^2}\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}(\\omega_n^i+\\omega_n^j+k-2)^L\\omega_n^{-ip}\\omega_n^{-jq}\n$$\n $A_{i,j}=(\\omega_n^i+\\omega_n^j+k-2)^L$  $O(n^2\\log L)$  $B$  $A$  `IDFT`  `IDFT`  $O(n^3)$ Bluestein + MTT  $O(n^2\\log n)$\n\n $O(n^3)$  $O(n^2\\log L)$\n\n### 2021MINIEYE5T9\n\n ****\n\n\n\n####  1\n\n $v$\n\n $v$  $p_1,p_2,\\cdots,p_k$ $[l,r]$  $v$  $p_i$  $v$  $p_j$ \n\n $j$ $(l,r)$ $v$  $1$ $v$  $-1$ $sum_i$ $[l,r]$  $sum_{l-1}<sum_r$ $sum_1,sum_2,\\cdots,sum_{p_j}$ $j\\rightarrow j+1$  $sum_{p_j},sum_{p_j+1},\\cdots,sum_{p_{j+1}-1}$ $+1$ $r\\in[p_j,p_{j+1})$ $l$  $sum_r$  $[p_j,p_{j+1})$  $sum_r$ \n\n $O(n\\log n)$\n\n####  2\n\n $[l,r]$  $l\\le mid+1 \\land r\\ge mid$\n\n $[l,r]$  $[l,mid]$  $[mid+1,r]$ \n\n>  $O(\\log n)$ \n\n $v$  $O(\\log n)$  $v$ $v$  $1$ $v$  $-1$ $sum_i$ $r$  $l\\le mid+1$  $sum_{l-1}<sum_r$ $O(1)$ \n\n $O(n\\log^2n)$\n\n### 2021MINIEYE5T13\n\n $D$ `DP` \n\n $f_{u,0/1}$  $u$  $\\infty$\n\n-  $u$ \n- $u$  $u$ \n-  $D$\n\n$f_{u,1}$  $v$  $\\min(f_{v,0}+w(u,v),f_{v,1}+\\max(w(u,v)-p_v,0))$  $D$$f_{u,1}=\\infty$\n\n$f_{u,0}$ $u$  $(u,v)$  $v$  $\\min(f_{v,0}+w(u,v),f_{v,1}+w(u,v)-p_v)$  $v$\n\n $O(n\\log V)$\n\n### AGC041D\n\n $k$  $k+1$  $\\lceil\\frac n2\\rceil$  $\\lceil\\frac n2\\rceil-1$ \n\n $A$\n\n-  $\\lfloor\\frac n2\\rfloor+1$  $c$ $A=(c,c,\\cdots,c)$\n-  $j<\\lfloor\\frac n2\\rfloor+1$ $A_1,A_2,\\cdots,A_j$ \n-  $j>\\lfloor\\frac n2\\rfloor+1$ $A_j,A_{j+1},\\cdots,A_n$ \n-  $A_1 \\ge 1$ $c-1$ $n-c$\n-  $\\lceil\\frac n2\\rceil$  $\\lceil\\frac n2\\rceil-1$  $x$ $x=c$ $x$  $j$ $x$  $n-j+1$ $c$\n\n $1,2,\\cdots,\\lfloor\\frac n2\\rfloor$  $c-1$  $1,2,\\cdots,\\lceil\\frac n2\\rceil-1$  $n-c$  $c$\n\n $L_{i,j}$  $i$  $j$ \n$$\nL_{i,j}=L_{i-1,j-1}+L_{i,j-i}-L_{i-1,j-i-\\lfloor\\frac n2\\rfloor}\n$$\n $R_{i,j}$\n\n $c$  $O(n)$ \n\n $O(n^2)$\n\n### AGC027D\n\n\n\n- \n-  $1$\n\n $\\text{lcm}$ $\\text{lcm}+1$ $2\\text{lcm}+1,3\\text{lcm}+1,\\cdots$\n\n\n\n $\\text{lcm}$  $\\text{lcm}$ \n\n-  $N$ \n-  $A_{i,j}$  $\\text{lcm(i,j)}$  $N$ \n-  $A_{i,j}$  $\\text{lcm}(i+j,i-j+n)$  $N$  $425$ \n-  $A_{i,j}$  $\\text{lcm}(i+(n-j+1),i-(n-j+1)+n)$\n- \n\n `set`  $O(n^2\\log n)$\n\n $O(n^2)$\n\n### AGC025D\n\n $\\sqrt D$  $(x_1,y_1),(x_2,y_2)$ $x_1-x_2,y_1-y_2$ \n$$\nx_1 \\equiv x_2 \\pmod 2,y_1 \\equiv y_2 \\pmod 2 \\iff D \\equiv 0 \\pmod 4\\\\\nx_1 \\equiv x_2 \\pmod 2,y_1 \\not\\equiv y_2 \\pmod 2 \\iff D \\equiv 1 \\pmod 4\\\\\nx_1 \\not\\equiv x_2 \\pmod 2,y_1 \\not\\equiv y_2 \\pmod 2 \\iff D \\equiv 2 \\pmod 4\\\\\n$$\n $D \\bmod 4$ \n\n>  $\\sqrt D$ \n\n $\\text{color}(x,y,D)=0/1$  $(x,y)$ \n\n-  $D\\equiv 3\\pmod 4$ $\\text{color}(x,y,D)=0$\n\n-  $D\\equiv 2\\pmod 4$ $\\text{color}(x,y,D)=x\\bmod 2$ $\\sqrt D$ \n-  $D \\equiv 1\\pmod 4$ $\\text{color}(x,y,D)=(x+y)\\bmod 2$ $\\sqrt D$ \n\n-  $D\\equiv 0\\pmod 4$ $\\text{color}(x,y,D)=\\text{color}(\\lfloor\\frac x2\\rfloor,\\lfloor\\frac y2\\rfloor,\\frac D4)$\n\n   $\\sqrt D$  $(x_1,y_1),(x_2,y_2)$ $x_1 \\equiv x_2 \\pmod 2,y_1 \\equiv y_2 \\pmod 2$\n  $$\n  \\lfloor\\frac {x_1}2\\rfloor-\\lfloor\\frac {x_2}2\\rfloor=\\frac 12(x_1-x_2)\\\\\n  \\lfloor\\frac {y_1}2\\rfloor-\\lfloor\\frac {y_2}2\\rfloor=\\frac 12(y_1-y_2)\n  $$\n  \n  $$\n  \\begin{aligned}\n  &(x_1-x_2)^2+(y_1-y_2)^2=D\\\\\n  \\Rightarrow &(\\lfloor\\frac {x_1}2\\rfloor-\\lfloor\\frac {x_2}2\\rfloor)^2+(\\lfloor\\frac {y_1}2\\rfloor-\\lfloor\\frac {y_2}2\\rfloor)^2=\\frac D4\\\\\n  \\Rightarrow &\\text{color}(\\lfloor\\frac {x_1}2\\rfloor,\\lfloor\\frac {y_1}2\\rfloor,\\frac D4)\\ne\\text{color}(\\lfloor\\frac {x_2}2\\rfloor,\\lfloor\\frac {y_2}2\\rfloor,\\frac D4)\n  \\end{aligned}\n  $$\n\n $D_1$  $D_2$  $4$  $4$  $n^2$ $n^2$ \n\n $O(n^2)$\n\n### AGC036D\n\n $d_1,d_2,\\cdots,d_n$ $d_1=0$\n\n $i\\rightarrow i+1$  $d$  $0$ $-1\n$ $-2\\cdots$ \n\n $d$ $[a,b]$ $d_{a,a+1,\\cdots,b}=x+1$ $[b+1,c]$ $d_{b+1,b+2,\\cdots,c}=x$\n\n-  $b+1\\le i < j \\le c$ $(i,j)$ \n-  $b+1\\le i\\le c,j<a$ $(i,j)$ \n\n `DP`  $f_{a,b}$  $[a,b]$ \n$$\nf_{a,b}+\\text{cost}_1(b+1,c)+\\text{cost}_2(b+1,c,a-1)\\rightarrow f_{b+1,c}\n$$\n $\\text{cost}_1$  $\\text{cost}_2$  $O(1)$ \n\n $O(n^3)$\n\n### AGC045D\n\n `Snuke`  $p_i=i$  `Snuke` \n\n-  `Snuke`  $1$\n-  $p_i=i$ \n- $p_i$  $p_i$\n- \n\n `Snuke`  $1-A$  $p_i=i$  $i$  $\\min$$\\forall i>A,\\exists j<\\min$  $j$  $i$\n\n $\\min$ $\\min$ \n\n-  $i$  $(-1)^i\\binom{\\min-1}i$\n-  $[1,\\min-1]$  $\\min-1-i$  $(\\min-1-i)!$\n-  $[A+1,n]$  $(\\min-1-i)^{\\overline{n-A}}$\n-  $[\\min+1,A]$  $(\\min-1-i+n-A)^{\\overline{A-\\min}}$\n\n $\\min$ \n$$\n\\sum_{i=0}^{\\min-1}(-1)^i\\binom{\\min-1}i\\frac{(n-1-i)!(\\min-1-i)}{\\min-1-i+n-A}\n$$\n $\\min$ \n$$\n\\sum_{i=0}^A(-1)^i\\binom Ai(n-i)!\n$$\n $O(A^2+n)$\n\n### AGC041E\n\n####  $T=1$\n\n\n\n- \n- \n- \n\n $t$  $t$ \n\n `bitset`  `DFS`  `bitset` $O(\\frac {nm}{\\omega})$ \n\n####  $T=2$\n\n$n=2$  $n>2$ \n\n $size_i$  $i$ \n\n- $size_i=1$\n-  $(x,y)$  $size_x+1$ $size_y+1$ $size_x$  $size_y$  $+1$ $size_x=n-1\\land size_y=n-1$  $size_x+size_y\\le n$\n\n $O(n+m)$\n\n### ABC214G\n\n $n \\le 10^5$ \n\n $F_k$  $k$  $r_{i_1},r_{i_2},\\cdots,r_{i_k}(i_1<i_2<\\cdots<i_k)$ \n$$\n\\forall x\\in[1,k],r_{i_x}=p_{i_x}\\lor r_{i_x}=q_{i_x}\n$$\n\n$$\n\\sum_{i=0}^n(-1)^iF_i(n-i)!\n$$\n $p_i,q_i$  $r_i=p_i\\lor r_i=q_i$  $i$  $F$  `FFT`  $F$ \n\n $m$  $F$  $1,2,\\cdots,m$ $(1,2),(2,3),\\cdots,(m-1,m),(m,1)$ $i$ \n\n-  $(1,2)$ $(2,3)$  $2$  $1$ $(2,3)$  $3$  $2$ $(3,4)$  $3$  $3$ $(3,4)$  $4$  $4$ $2m-2$  $i$ \n\n  >  $n$  $r$  $\\binom {n-r+1}r$\n  >\n  >  $i$  $i-1$  $n-r+1$  $r$ \n\n   $\\binom{2m-i-1}i$\n\n-  $(1,2)$ $(1,2)$  $1$  $2$ $1$ $2m-3$  $i-1$ \n\n   $2\\binom{2m-i-1}{i-1}$\n\n $m$ \n$$\nF_i=\\binom{2m-i-1}i+2\\binom{2m-i-1}{i-1}=\\binom{2m-i}i+\\binom{2m-i-1}{i-1}\n$$\n $F$  $O(n)$  `FFT` $O(n\\log^2n)$\n\n `FFT` \n\n-  $n$ $O(\\sqrt n)$  $O(n\\log n)$ \n-  $\\sum_{u\\in \\mathbb{leaf}}\\text{degree}_u\\text{depth}_u$ `Huffman`  \n\n### ABC214H\n\n `DAG` `DAG`\n\n\n\n-  $u$  $\\text{in}_u$  $\\text{out}_u$\n- $\\text{in}_u$  $\\text{out}_u$  $1$ $-X_u$  $K$ $0$ \n-  $(u,v)$$\\text{out}_u$  $\\text{in}_v$  $K$ $0$ \n- $S$  $\\text{in}_1$  $K$ $0$ $\\text{out}_u$  $T$  $K$ $0$ \n\n`SSP`  `Primal-Dual` \n\n#### Sol 1\n\n `DAG` `DP` \n\n#### Sol 2\n\n `DAG` \n\n\n\n- $S$  $\\sum X_u$$T$  $0$\n- $\\text{in}_u$  $\\sum_{i=1}^uX_i$$\\text{out}_u$  $\\sum_{i=1}^{u-1}X_i$\n\n $O(nK\\log n)$\n\n### AGC027E\n\n $a$  $b$\n\n $a$  $S$  $a,b$  $a$  $b$  $3$  $1$ $|S|$  $|S|$  $ababab\\cdots aba$\n\n>  $p(S)$  $S$  $a$  $b$  $3$$S$  $c$ \n>\n> - $p(S)=p(c)$\n> - $S=c$  $S$ \n\n $|S|\\le 3$  $|S|>3$  $S$  $n$  $a$\n\n- $n \\ge 4$ $a$ $|S|$  $1$\n- $n\\le 3$ $|S|>3$ $b$ $a$  $b$ $b$ $|S|$  $1$\n\n $T$ \n\n-  $S$  $|T|$  $T$ \n\n\n\n $S$ **** \n\n>  $S$ $S$  $T$ \n>\n> -  $S$  $|T|$  $S$  $S_1,S_2,\\cdots,S_{|T|}$$T$  $T_1,T_2,\\cdots,T_{|T|}$\n> -  $\\forall i,p(S_i)=p(T_i)$\n\n\n\n-  $(S_1,S_2,\\cdots,S_{|T|})$\n-  $S_1,S_2,\\cdots,S_{|T|-1}$  $(S_1',S_2',\\cdots,S_{|T|}')$\n-  $S_1,S_2,\\cdots,S_{|T|-1}$ \n-  $S_{|T|}$  $S_{|T|}=abab\\cdots aba$ $|T|>1$ $S_{|T|}$  $S_{|T|-1}$ $T$  $S$  $S$  $T$\n\n $S$  $T$  `DP`\n\n $O(n)$\n\n### Gym101667G\n\n\n\n L  U  U  L  `isRegion` `area` \n\n-  `isRegion`  `area` \n-  `area`\n-  `area`\n\n $O(n+m)$\n\n![.png](https://i.loli.net/2021/09/08/a4fEq6tJWRbrxDy.png)\n\n### Gym101667J\n\n Hall  $f(S)$  $S$  $1$ \n$$\n\\forall |S|\\le\\frac n2,|T|=\\frac n2,S \\cap T=\\varnothing\\\\\n|f(S)\\cap T| \\ge |S|\n$$\n $|f(S)\\cap T|$  $|f(S)|+|S|-\\frac n2$ $|f(S)|\\ge\\frac n2$\n\n $\\min_{|S|\\le \\frac n2}|f(S)|$\n\n- $f(S)$  $S$  $V-S-f(S)$ \n-  $T$  $\\frac n2$ $S$ $|f(S)|\\le |T|$\n\n\n\n-  $u$  $\\text{in}_u$  $\\text{out}_u$\n- $\\text{in}_u$  $\\text{out}_u$  $1$ \n-  $(u,v)$$\\text{out}_u$  $\\text{in}_v$$\\text{out}_v$  $\\text{in}_u$  $\\infty$ \n-  $u,v$ $\\text{out}_u$  $\\text{in}_v$ \n\n $O(n^2\\cdot flow)$\n\n~~~~ $\\frac n2$ $u$ $v$ $\\text{out}_u$  $\\text{in}_v$  $k$  $O(nk\\cdot flow)$\n\n### ABC215H\n\n\n\n- $S$  $i$  $A_i$ \n-  $i$  $T$  $B_i$ \n-  $c_{i,j}=1$ $i$  $j$  $\\infty$ \n- $\\max flow=\\sum_{i=1}^mB_i$\n\n $T$  $S$  $S$  $mask$ $mask$  $T$  $sum$ $\\sum_{i\\in mask}A_i-sum+1$ $sum>0$\n\n $mask$ $sum$ $B_i$  $mask$  $mask$  $i$ `FMT` $mask$  $\\sum_{i\\in mask}A_i-sum+1$ \n\n $mask$  $mask$  $S$ $mask\\subseteq S$ `FMT`  $ans$ $mask$ $mask$  $ans$  $mask$  $mask$  $O(3^n)$\n\n $f_S$  $S$  $ans$  $mask$ \n$$\n\\sum_{T\\subseteq S}f_T=\\binom{\\sum_{i\\in S}A_i}{ans}\n$$\n `IFMT`  $f$ \n\n $O(n2^n+nm)$\n\n### AGC020E\n\n $S$  `DP`  $f_{l,r}$  $[l,r]$ \n\n- $s_l$  $f_{l+1,r}$\n- $s_l$  $s_l$  $T$  $i>1$ $f_{l,l+T-1}\\cdot f_{l+Ti,r}$\n\n `DP`  $s_l$  $f_{l,l+T-1}$  `DP`  $f(s)$  $s$  $suf(i)$  $s$  $s_i$ \n\n-  $(s_0+1)f(suf(1))$\n\n-  $s_l$  $T$  $i>1$ $s[l,r]$  $s$  $l$  $r$ \n  $$\n  t=s[0,T-1]\\&s[T,2T-1]\\&\\cdots\\&s[T(i-1),Ti-1](\\&\\ is\\ \\text{bitand})\n  $$\n   $f(t)\\cdot f(suf(Ti))$\n\n $O(2^{n+1})$ $O()$ \n\n $O(n^3+2^{\\frac n8})$ $\\frac n8$  $2^{\\frac n8}$  $\\frac n8$ \n\n-  $2$  $2$ \n-  $2$  $3$ \n-  $3$  $2$ \n\n\n\n$s[a,a+k-1]\\&s[a+k,a+2k-1]\\&s[b,b+k-1]\\&s[b+k,b+2k-1]$\n\n $a,b,k$  $O(n^3)$ $O(n^3)$\n\n $12$  $41703$\n\n### CF1562E\n\n\n$$\ns[l_1,r_1],s[l_2,r_2],\\cdots,s[l_k,r_k]\n$$\n $l$ $r$  $l$ $r$ \n\n $l$ $r\\in[r_1,r_2]$ $r_2<n$$s[l,r_2]$  $s[l',r']$ $s[l,r_2+1]<s[l',r']$ $s[l,r_2]$  $s[l,r_2+1]$ $s[l,r_2]<s[l',r']\\le s[l,r_2+1]$\n$$\ns[l',l'+r_1-l]=s[l,r_1]\\\\\ns[l',l'+r_1+1-l]=s[l,r_1+1]\\\\\ns[l',l'+r_1+2-l]=s[l,r_1+2]\\\\\n\\cdots\\\\\ns[l',l'+r_2-l]=s[l,r_2]\n$$\n $l$ \n\n `DP`  $f_i$  $s[i,n]$ \n$$\nf_i=\\max_{j<i\\land s[j,n]<s[i,n]}f_j+n-\\text{lcp}(s[i,n],s[j,n])+1\n$$\n $\\text{lcp}(s[i,n],s[j,n])\\leftarrow \\text{lcp}(s[i+1,n],s[j+1,n])$ $O(n^2)$\n\n#### \n\n $O(n\\sqrt n)$\n\n `LCP`   `height` \n\n $SA$  `height` \n$$\nf_{SA_i}=\\max_{j<i \\land SA_j<SA_i}f_{SA_j}+\\max_{k=j+1}^in-height_k+1\n$$\n `height`  $\\max$ $(v,S)$ $(n-height_{i+1}+1,\\{i\\})$  $(v_1,S_1)$ $(v_2,S_2)$ $v_1\\ge v_2$ $(v_1,S_1\\cup S_2)$\n\n $i$  $f_{i+1}$ $(v,S)$ $\\max_{j \\in S\\land SA_j\\le SA_i}+v\\rightarrow f_{SA_{i+1}}$ $|S|\\le \\sqrt n$  $A$  $|S|>\\sqrt n$  $B$  $\\sqrt n$  $|S|>\\sqrt n$  $A$  $\\max$$B$  $\\sqrt n$  $\\max$\n\n\n\n-  $|S_1|+|S_2|\\le \\sqrt n$  $S_2$  $A$  $|S_2|$  $n\\sqrt n$ \n-  $|S_1|>\\sqrt n\\land |S_2|\\le \\sqrt n$  $B$  $|S_2|$  $n$ \n-  $|S_1|,|S_2|>\\sqrt n$  $|S_1|,|S_2|\\le \\sqrt n\\land |S_1|+|S_2|>\\sqrt n$  $|S_1|+|S_2|$  $B$ $\\sqrt n$ \n\n $A$  $O(1)$ $O(\\sqrt n)$ $B$  $O(\\sqrt n)$ $O(1)$  $O(n\\sqrt n)$\n\n $\\max$$A$  $B$ \n\n### CF1562F\n\n>  $n$  $A$ $\\text{lcm}$ $n+5000$  $A$\n>\n> $n\\le 10^5,A_i\\le 2\\cdot 10^5$\n\n $\\gcd(a,b)=1$ $\\text{lcm}(a,b)=ab$ $A$  $p$ $n-1$  $A$\n\n $p$  $p$  $\\text{lcm}(A_1,A_2),\\text{lcm}(A_2,A_3),\\text{lcm}(A_3,A_4),\\cdots,\\text{lcm}(A_{n-1},n)$ $p$ $p$  $n-1$  $A$ $2n-2$ $100<n\\le7500$\n\n $n\\le 100$  $n>7500$ \n\n$n\\le 100$  $\\text{lcm}$ $n>3$  $\\text{lcm}$  $\\text{lcm}$  $\\max A_i(\\max A_i-1)$ $A_i$ $n=3$ \n\n $n>7500$  $5000$  $A$  $p$ $450$  $p'$ \n\n $\\text{lcm}(A_i,A_j)$ $450$  $p,q$  $A_i,A_j$  $p,q$ $A_i$ $k$ $p\\not|\\text{lcm}(A_i,A_k)$  $A_i=p$ $q\\not|\\text{lcm}(A_j,A_k)$  $A_i=q$ $O(\\ln^2n)$\n\n\n$$\n\\text{lcm}(p',x)=\n\\begin{cases}\nx&(x|p')\\\\\nxp'&(x\\not|p')\n\\end{cases}\n$$\n $\\text{lcm}(p',x)>2\\cdot 10^5$  $x\\not|p'$ $x$  $n-900$  $p$  $p$ \n\n### AUOJ1760\n\n>  $n$ \n>\n> ****\n>\n> $n \\le 10^6$\n\n\n\n $m$ $A$\n$$\nA_{i,j}=\n\\begin{cases}\n-1 &( j  i )\\\\\n0 &( j  i )\\\\\n1 &( j  i )\n\\end{cases}\n$$\n\n\n$A_i\\ne \\{0,0,\\cdots, 0\\}$\n\n $B$\n$$\nB_i=\n\\begin{cases}\n-1 &( i )\\\\\n0 &( i )\\\\\n1 &( i )\n\\end{cases}\n$$\n $B$  $A_?$ \n\n $B$ $C$ $C=-B$ $B$  $C$  $A_i$ \n\n$\\forall i \\ne j, A_i\\ne A_j \\land A_i \\ne -A_j$\n\n\n\n$\\forall j\\in[1,m],\\sum_{i=1}^nA_{i,j}=0$\n\n $m$ $n$  $A$ \n\n$n$  $\\frac{3^m-1}2$$n$  $\\frac{3^m-1}2$\n\n$\\forall j\\in[1,m],\\sum_{i=1}^n|A_{i,j}|=3^{m-1}$\n\n> $m$  $n\\le \\frac{3^m-3}2$\n\n $m$ \n\n $3|n$  $\\text{next}(A)$  $A$ $-1\\rightarrow 0,0\\rightarrow 1,1\\rightarrow -1$$A,\\text{next}(A),\\text{next}(\\text{next}(A))$  $0$\n\n\n\n```plain\n1 0 -1 1\n-1 1 0 -1\n0 -1 1 0\n```\n\n $\\{-1,-1,\\cdots,-1\\}$  $\\{1,1,\\cdots,1\\}$ $\\frac {3^m-3}3$   $A$\n\n### \n\n $3\\not|n$ \n\n-  $\\sum_{j=1}^m|\\sum_{i=1}^nA_{i,j}|$ \n- \n- \n  -  $i$ $A_i$  $-A_i$\n  -  $i$ $B$  $B$  $-B$  $A$  $A_i=B$\n\n $n$ $n\\le 10^4$ \n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary>\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nusing ll = long long;\nusing lf = double;\n\nll gen(ll x) {\n    const ll k = 0x9ddfea08eb382d69ull;\n    rep(i, 1, 3) x *= k, x ^= x >> 47;\n    return x * k;\n}\nint rnd() {\n    static ll s = time(0);\n    return (s += gen(s)) & INT_MAX;\n}\nvoid wrt(int x, int ed) {\n    static streambuf* out = cout.rdbuf();\n    #define pc out -> sputc\n    static char c[11]; int sz = 0;\n    do c[++sz] = x % 10, x /= 10; while(x);\n    while(sz) pc(c[sz--] + 48);\n    pc(ed);\n}\nint n, m = 2, t = 9, nw[15], idx, A[2500000][15], c[15];\nvoid dfs(int i) {\n    if(i > m) {\n        rep(j, 2, 4) {\n            idx++;\n            rep(k, 1, m) A[idx][k] = (nw[k] + j) % 3 - 1;\n            if(idx == t) break;\n        }\n        return;\n    }\n    rep(j, -1, 1) {\n        nw[i] = j, dfs(i + 1);\n        if(idx == t) break;\n    }\n}\nint main() {\n    ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n    cin >> n;\n    while(t - 3 >> 1 < n) m++, t *= 3;\n    wrt(m, 10);\n    t = t - 1 >> 1, dfs(2);\n    rep(i, 1, n) rep(j, 1, m) c[j] += A[i][j];\n    int su = 0;\n    rep(i, 1, m) su += abs(c[i]);\n    while(su) {\n        int i = rnd() % n + 1;\n        if(rnd() % t < n) {\n            int d = 0;\n            rep(j, 1, m) d += abs(c[j] - 2 * A[i][j]);\n            if(d < su || rnd() % n < 10) {\n                su = d;\n                rep(j, 1, m) c[j] -= 2 * A[i][j], A[i][j] *= -1;\n            }\n        } else {\n            int k = rnd() % (t - n) + n + 1, d = 0;\n            rep(j, 1, m) d += abs(c[j] - A[i][j] + A[k][j]);\n            if(d < su || rnd() % n < 10) {\n                su = d;\n                rep(j, 1, m) c[j] -= A[i][j] - A[k][j], swap(A[i][j], A[k][j]);\n            }\n        }\n    }\n    rep(i, 1, n) {\n        int v = 0;\n        per(j, m, 1) v = v * 3 + A[i][j] + 1;\n        wrt(v, 32);\n    }\n}\n```\n</details>\n\n### \n\n\n\n-  $\\forall j\\in[1,m],|\\sum_{i=1}^nA_{i,j}|\\le 1$\n-  $j$ $\\sum_{i=1}^nA_{i,j}=-1$ $i$  $A_{i,j}<1$  $A_{i,j}$  $A_{i,j}$ \n\n $n$ $10^6$  $10$ \n\n $10^6$  $n$\n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary>\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nusing ll = long long;\n\nvoid wrt(int x, int ed) {\n    static streambuf* out = cout.rdbuf();\n    #define pc out -> sputc\n    static char c[11]; int sz = 0;\n    do c[++sz] = x % 10, x /= 10; while(x);\n    while(sz) pc(c[sz--] + 48);\n    pc(ed);\n}\nint n, m = 2, t = 9, nw[15], idx, A[1000005], c[15], as;\nbool vs[1600000];\nvoid dfs(int i) {\n    if(i) rep(j, -1, 1) { nw[i] = j, dfs(i - 1); if(idx == n) break; }\n    else rep(j, 1, 3) {\n        int x = 0;\n        per(k, m, 1) x = x * 3 + (j + nw[k]) % 3;\n        if(!x || vs[x] || idx == n) break;\n        A[++idx] = x, vs[x] = vs[t - x] = 1;\n        rep(k, 1, m) c[k] += (j + nw[k]) % 3 - 1;\n    }\n}\nint main() {\n    ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n    cin >> n;\n    while(t - 3 >> 1 < n) m++, t *= 3;\n    t--, vs[t / 2] = 1, wrt(m, 10), nw[m] = -1, dfs(m - 1);\n    if(n % 3) {\n        rep(i, 1, m) as += abs(c[i]);\n        int th = 1;\n        rep(j, 1, m) {\n            rep(i, 1, n) {\n                if(!c[j]) break;\n                int v = A[i] / th % 3;\n                auto Try = [&](int x) {\n                    int nw = A[i] + x * th;\n                    if(vs[nw]) return;\n                    vs[A[i]] = vs[t - A[i]] = 0, vs[nw] = vs[t - nw] = 1;\n                    as -= abs(c[j]), c[j] += x, v += x, as += abs(c[j]), A[i] = nw;\n                };\n                if(v < 2 && c[j] < 0) Try(1);\n                if(v > 0 && c[j] > 0) Try(-1);\n            }\n            th *= 3;\n        }\n    }\n    rep(i, 1, n) wrt(A[i], 32);\n}\n```\n</details>\n\n### \n\n $n$ \n\n-  $\\sum_{j=1}^m|\\sum_{i=1}^nA_{i,j}|$ \n\n- $A$ **** $m$ $\\{-1,0,1\\}$  $B$ $B$  $-B$  $A$  $B,\\text{next}(B),\\text{next}(\\text{next}(B))$  $A$  $n$  $\\forall j\\in[1,m],|\\sum_{i=1}^nA_{i,j}|\\le 1$\n\n-  $0$\n\n   $j$  $i$\n\n  -  $\\sum_{i=1}^nA_{i,j}=-1\\land A_{i,j}<1$ $A_{i,j}$ \n  -  $\\sum_{i=1}^nA_{i,j}=1$ $A_{i,j}=0$\n\n $10^6$  $n$\n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary>\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nusing ll = long long;\n\nvoid wrt(int x, int ed) {\n    static streambuf* out = cout.rdbuf();\n    #define pc out -> sputc\n    static char c[11]; int sz = 0;\n    do c[++sz] = x % 10, x /= 10; while(x);\n    while(sz) pc(c[sz--] + 48);\n    pc(ed);\n}\nint n, m = 2, t = 9, nw[15], idx, A[797170], c[15], as;\nbool vs[1600000];\nvoid dfs(int i) {\n    if(i) per(j, 1, -1) { nw[i] = j, dfs(i - 1); if(idx == n) break; }\n    else rep(j, 1, 3) {\n        int x = 0;\n        per(k, m, 1) x = x * 3 + (j + nw[k]) % 3;\n        if(x == t || vs[x] || idx == n) break;\n        A[++idx] = x, vs[x] = vs[t - x] = 1;\n        rep(k, 1, m) c[k] += (j + nw[k]) % 3 - 1;\n    }\n}\nint main() {\n    ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n    cin >> n;\n    while(t - 3 >> 1 < n) m++, t *= 3;\n    t--, vs[t / 2] = 1, wrt(m, 10), nw[m] = 1, dfs(m - 1);\n    rep(i, 1, m) as += abs(c[i]);\n    while(as) {\n        int th = 1;\n        rep(j, 1, m) {\n            rep(i, 1, n) {\n                if(!c[j]) break;\n                int v = A[i] / th % 3;\n                auto Try = [&](int x) {\n                    int nw = A[i] + x * th;\n                    if(vs[nw]) return;\n                    vs[A[i]] = vs[t - A[i]] = 0, vs[nw] = vs[t - nw] = 1;\n                    as -= abs(c[j]), c[j] += x, v += x, as += abs(c[j]), A[i] = nw;\n                };\n                if(v < 2 && c[j] < 0) Try(1);\n                if(v > 0 && c[j] > 0) Try(-v);\n            }\n            th *= 3;\n        }\n    }\n    rep(i, 1, n) wrt(A[i], 32);\n}\n```\n</details>\n\n### AUOJ1761\n\n>  $n$  $A$  $1$  $m$  $B$ $0$ \n>\n> $A$  $0$ $A_i$  $i$ $j$  $A_i>B_{j\\bmod m}$ $A_i=B_{j\\bmod m}$\n>\n> $q$  $d_i$ \n>\n> $n,m,q\\le 3\\cdot 10^5,d_i\\le 3\\cdot 10^{12},t_i\\le 10^{18}$\n\n $d_i$  $A_i$ $m$\n\n>  $p$  $A_i$ $p+m$ \n\n $p-m$  $A_i$  $p$  $A_i=B_{p \\bmod m}$ $A_i$  $m$  $p$  $p+m$ \n\n $A_i$  $p_i$  $p_i,p_i+m,p_i+2m,pi+3m,\\cdots$   $m$\n\n $p_i$  $A$  $A_i$  $p_i$  $p_i$\n\n $pos$  $B$  $i$  $A_i$  $B_{pos}$  $T_i$ $p_i\\in[T_i-m+1,T_i]$ $p_i=T_i-m+k_i$$k_i$  $x$  $ix+(T_i-m)i>B_{pos+x}$ $[l,r]$  $\\min_{j=l}^rB_{pos+j}-ij$ $x$  $\\min_{j=1}^x\\{B_{pos+j}-ij\\}<(T_i-m)i$ $i$  $O(n\\log n)$ $p_i$\n\n $d$ $A_i$  $m$ $A_i$  $p_i\\bmod m$  $A_i$ $d\\bmod m$  $d\\bmod m<p_i\\bmod m$\n\n### CodeChef-btree\n\n>  $S(u,k)$  $u$  $k$ \n>\n>  $n$ $q$  $|S(u_1,k_1)\\cup S(u_2,k_2)\\cup S(u_3,k_3)\\cup \\cdots \\cup S(u_{m_i},k_{m_i})|$ \n>\n> $n,q\\le 5\\cdot 10^4,\\sum_{i=1}^qm_i\\le 5\\cdot 10^5$\n\n $|S(u,k)|$ \n\n#### Sol 1\n\n $u_1,u_2,u_3,\\cdots,u_{m_i}$  $0$\n\n $(u_1,k_1),(u_2,k_2)$  $k_1-\\text{dis}(u_1,u_2)>k_2$ $S(u_2,k_2)\\subsetneq S(u_1,k_1)$ $S(u_2,k_2)$  $k_2=k_1-\\text{dis}(u_1,u_2)$\n\n `Dijkstra`  `DP`\n\n $V$ $E$$u$  $r_u$ $\\sum_{u\\in V}|S(u,r_u)|-\\sum_{(u,v)\\in E}|S(u,r_u)\\cap S(v,r_v)|$ $S(u,r_u)$  $|S(u,r_u)|-|S(u,r_u)\\cap S(fa_u,r_{fa_u})|$\n\n$|S(u,r_u)|$ $|S(u,r_u)\\cap S(v,r_v)|$  $S(w,r)$ $w$ $w$ \n\n $O((n+m)\\log n)$\n\n#### Sol 2\n\n `bitset` \n\n $nq \\le 2.5\\cdot 10^9,n\\sum_{i=1}^qm_i\\le 2.5\\cdot 10^{10}$ $O(\\frac{n\\sum_{i=1}^qm_i}\\omega)$ $O(\\frac{nq}\\omega)$ \n\n $S(u,k)$  `bitset`  $O(\\frac n\\omega)$\n\n $S(u,k)$  $O(\\log n)$  $d$  $d$  $S(u,k)$  $O(\\frac{n\\log n}\\omega)$  $O(\\log n)$  $n,\\frac n2,\\frac n4,\\frac n8,\\cdots$ $2n$  $[1,n]$ `DFS`  $n,\\frac n2,\\frac n4,\\frac n8,\\cdots$ $O(\\frac n\\omega)$\n\n `bitset` `bitset`  `bitset`  `popcount` `unsigned long long`  `bitset``popcount`  $[0,65536)$  `popcount` `unsigned long long`  $[0,65536)$ \n\n Sol 1 \n\n### URAL2118\n\n>  $k$  $01$ \n>\n>  $s$ $01$  $S$ $S$  $-1$\n>\n> $k \\le 52, n\\le 10^6$\n\n\n\n-  $0$ $1$ $S$ \n-  $0$ $1$ $|S|$\n\n $0$  $1$  $1$  $0$ $0$  $1$\n\n $1$  $0$ \n\n $1$ $1$ \n\n $0$ $T$ $T$  $1$ $T$  ****  $x$  $0$ $y$  $1$ $y+1$ $x$  $0$  $T$ $T$  $1$ \n\n $T$  $y$  $1$ $y+1$ $y$ $T'$  $y$  $T'$  $1$  $|T|\\ge |T'|$ $y$  $T'$  $1$  $T=T'0+T'$$y$ \n\n $T'$ $T'$  $T'$  $suffix(i)$  $S$  $i$  $suffix(1),suffix(2),suffix(3),\\cdots$ `AC` \n\n $O(nk)$\n\n### Graph Subpaths\n\n> \n>\n>  $n$  $m$  $k$  $l_i$ $k$ \n>\n>  $i \\in [2,n]$ $1\\rightarrow i$ \n>\n> $n,m,\\sum_{i=1}^kl_i \\le 10^5$\n\n### Sol 1\n\n $i\\rightarrow 1$ \n\n $(u,v)$ $v$ $T_i$  $i\\rightarrow 1$  `trie` $T_u$ $(u,v)$$T_v$  $T_v$  $u$  $T_u$ $u$  $T_u$ \n\n $T_u$  `trie` $(u,v)$ $T_u$  $T_v$  $T_v$\n\n $O(n^2)$\n\n $O(n\\log n)$ \n\n $O(n\\log n)$\n\n### Sol 2\n\n `AC`  $O(n^2)$  `DP` $f_{i,u}$  $i$`AC`  `u` `AC` \n\n `AC`  `DP`  $f_u$ \n\n `AC`  $O(n\\log n)$\n\n### ZOJ3390\n\n>  $T_1,T_2$ $T_1+T_2$ $T_1\\cdot T_2$  $T_1$  $T_2$$T_1=T_2$ \n>\n>  $A,B,C$ $X,Y$  $AX+BY=C$\n>\n> $|A|,|B|,|C| \\le 10^5$\n\n $height(T)$  $T$ \n\n $height(T_1+T_2)=\\max(height(T_1),height(T_2)),height(T_1\\cdot T_2)=height(T_1)+height(T_2)$\n\n $\\max(height(A)+height(X),height(B)+height(Y))=height(C)$ $height(A)+height(X)=height(C)$\n\n $height(X)$ $X$ $u$  $C$  $height(X)$  $u$  $X$ $AX$ $BY$ $Y$ \n\n $BY$ \n\n\n$$\nf_u=1+\\sum_{v\\in son(u)}f_v\\cdot \\text{prime}(size_v)\n$$\n $\\text{prime}(i)$  $i$ \n\n**** $T_1,T_2$$f_{T_1}=f_{T_2}$ \n\n`Generator`  $T,A,B,C,D$  $A,X,B,Y$ \n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary>\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define fi first \n#define se second\n#define all(x) (x).begin(), (x).end()\n#define SZ(x) int((x).size())\n#define mid ((l + r) / 2)\n#define lc o * 2\n#define rc o * 2 + 1\n#define lch l, mid, lc\n#define rch mid + 1, r, rc\n#define cmi(a, b) (a = min(a, b))\n#define cma(a, b) (a = max(a, b))\n#define lb lower_bound\n#define ub upper_bound\n#define bs binary_search\n#define pop __builtin_popcount\n#define llpop __builtin_popcountll\n#define ctz __builtin_ctz\n#define llctz __builtin_ctzll\n#define clz __builtin_clz\n#define llclz __builtin_clzll\n#define par __builtin_parity\n#define llpar __builtin_parityll\n\nusing namespace std;\nusing ll = long long;\nusing lf = double;\n// using P = pair<int, int>;\nusing V = vector<int>;\n// using cmp = complex<lf>;\n\nll gen(ll x) {\n    const ll k = 0x9ddfea08eb382d69ull;\n    rep(i, 1, 3) x *= k, x ^= x >> 47;\n    return x * k;\n}\nint rnd() {\n    static ll s = time(0) + (ll)new char;\n    return (s += gen(s)) & INT_MAX;\n}\nV tmul(V a, V b) {\n    int n = a.size() - 1, m = b.size() - 1, su = n;\n    rep(i, 1, n) {\n        rep(j, 2, m) a.pb(b[j] == 1 ? i : b[j] + su - 1);\n        su += m - 1;\n    }\n    return a;\n}\nV tplus(V a, V b) {\n    int n = a.size() - 1, m = b.size() - 1;\n    rep(j, 2, m) a.pb(b[j] == 1 ? 1 : b[j] + n - 1);\n    return a;\n}\nconst int N = 5, A = 5, B = 5, C = 5, D = 5;\nint main() {\n    const int T = 100000;\n    printf(\"%d\\n\", T);\n    rep(kase, 1, T) {\n        int a = rnd() % A + 1, b = rnd() % B + 1, c = rnd() % C + 1, d = rnd() % D + 1;\n        V t1{0}, t2{0}, t3{0}, t4{0};\n        auto get = [](V& t, int n) { rep(i, 1, n) t.pb(i > 1 ? rnd() % (i - 1) + 1 : 0); };\n        get(t1, a), get(t2, b), get(t3, c), get(t4, d);\n        V t5 = tplus(tmul(t1, t2), tmul(t3, t4));\n        printf(\"%d %d %llu\\n\", a, c, t5.size() - 1);\n        auto prt = [](V& v) { For(i, 1, v.size()) printf(\"%d \", v[i]); puts(\"\"); };\n        prt(t1), prt(t3), prt(t5);\n    }\n}\n```\n</details>\n\n`Special judge` `checker.cpp``checker <input-file> <output-file>` $0$ $1$\n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary>\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define fi first \n#define se second\n#define all(x) (x).begin(), (x).end()\n#define SZ(x) int((x).size())\n#define mid ((l + r) / 2)\n#define lc o * 2\n#define rc o * 2 + 1\n#define lch l, mid, lc\n#define rch mid + 1, r, rc\n#define cmi(a, b) (a = min(a, b))\n#define cma(a, b) (a = max(a, b))\n#define lb lower_bound\n#define ub upper_bound\n#define bs binary_search\n#define pop __builtin_popcount\n#define llpop __builtin_popcountll\n#define ctz __builtin_ctz\n#define llctz __builtin_ctzll\n#define clz __builtin_clz\n#define llclz __builtin_clzll\n#define par __builtin_parity\n#define llpar __builtin_parityll\n\nusing namespace std;\nusing ll = long long;\nusing lf = double;\nusing P = pair<int, int>;\nusing V = vector<int>;\n// using cmp = complex<lf>;\n\nconst int N = 1e5 + 5, M = 1299709;\nint f[M + 5], pid, prm[N];\n\nV tmul(V a, V b) {\n    int n = a.size() - 1, m = b.size() - 1, su = n;\n    rep(i, 1, n) {\n        rep(j, 2, m) a.pb(b[j] == 1 ? i : b[j] + su - 1);\n        su += m - 1;\n    }\n    return a;\n}\nV tplus(V a, V b) {\n    int n = a.size() - 1, m = b.size() - 1;\n    rep(j, 2, m) a.pb(b[j] == 1 ? 1 : b[j] + n - 1);\n    return a;\n}\n\nP dfs(int u, const V G[]) {\n    P re(1, 1);\n    for(int v : G[u]) {\n        auto [h, sz] = dfs(v, G);\n        re.fi = (re.fi + (ll)h * prm[sz]) % 999999937;\n        re.se += sz;\n    }\n    return re;\n}\nint Hash(const V& t) {\n    vector<int> G[N];\n    For(i, 1, t.size()) G[t[i]].pb(i);\n    return dfs(1, G).fi;\n}\nint read(FILE* f) { int x; return fscanf(f, \"%d\", &x) == 1 ? x : -1; }\n\nint main(int argc, char* argv[]) {\n    rep(i, 2, M) {\n        if(!f[i]) prm[++pid] = i;\n        for(int j = 1; i * prm[j] <= M; j++) {\n            f[i * prm[j]] = 1;\n            if(i % prm[j] == 0) break;\n        }\n    }\n    FILE *in = fopen(argv[1], \"r\"), *out = fopen(argv[2], \"r\");\n    for(int T = read(in); T--;) {\n        V t1{0}, t2{0}, t3{0}, t4{0}, t5{0};\n        auto get = [](FILE* f, V& t, int n) { rep(i, 1, n) t.pb(read(f)); };\n        int a = read(in), b = read(in), c = read(in);\n        get(in, t1, a), get(in, t3, b), get(in, t5, c);\n        int d = read(out), e = read(out);\n        auto err = [&]() {\n            printf(\"1\\n%d %d %d\\n\", a, b, c);\n            rep(i, 1, a) printf(\"%d \", t1[i]); puts(\"\");\n            rep(i, 1, b) printf(\"%d \", t3[i]); puts(\"\");\n            rep(i, 1, c) printf(\"%d \", t5[i]);\n            exit(1);\n        };\n        if(!~d) err();\n        get(out, t2, d), get(out, t4, e);\n        if((ll)a * d + (ll)b * e != c && Hash(tplus(tmul(t1, t2), tmul(t3, t4))) != Hash(t5)) err();\n    }\n}\n```\n</details>\n\n### IZhO 2020 D1T3\n\n> [](codeforces.com/group/Uo1lq8ZyWf/contest/265564)\n>\n>  $n$  $A$ $(i,j,k)$  $i\\le j<k$  $[i,j]$  $[j+1,k]$ \n>\n> $n \\le 2\\cdot 10^5$\n\n $prev_i$  $A_i$ $next_i$  $A_i$ \n\n $(i,j,k)$ \n\n-  $[j+1,k]$  $[i,j]$  $i \\le \\min prev_{j+1\\cdots i}$ $i$  $R_{j,k}=\\min prev_{j+1\\cdots k}$\n-  $[i,j]$  $[j+1,k]$  $\\max next_{i\\cdots j}\\le k$ $i$  $L_{j,k}$ $L_{j,k}$  $i$  $\\max next_{i\\cdots j}\\le k$\n\n $(j,k)$  $\\max(R_{j,k}-L_{j,k}+1,0)$ $k$ $\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)$\n\n $L_{j,k}$  $R_{j,k}$ \n\n $R_{j,k}=\\min prev_{j+1\\cdots k}$ $prev$  $\\min$ $k\\rightarrow k+1$ $R_{j,k}$  $prev_{k+1}$\n\n $L_{j,k}$ $k\\rightarrow k+1$  $j$$L_{j,k}$  $k$ $\\max next_{i\\cdots j}$  $next$  $\\max$ $next_{1\\cdots j}$  $next_{i_1},next_{i_2},next_{i_3},\\cdots,next_{i_k}$\n\n-  $k\\in[j+1,next_{i_k}-1]$ $L_{j,k}=\\infty$\n-  $k\\in [next_{i_k},next_{i_{k-1}-1}]$$L_{j,k}=i_{k-1}+1$\n- $\\cdots$\n-  $k\\in [next_{i_1},n]$$L_{j,k}=1$\n\n $i_x$  $k\\in [next_{i_x},next_{i_{x-1}}-1]$$L_{j,k}=i_{x-1}+1$ $next_y$  $next_{i_x}$  $j\\in [i_x,y-1],k\\in [next_{i_x},next_{i_{x-1}}-1]$ $L_{j,k}=i_{x-1}+1$ $k$  $next_{i_x}-1\\rightarrow next_{i_x}$  $L_{i_x\\cdots y-1,k}$  \n$i_x+1$ $n$  $L_{j,k}$\n\n $\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)$ $L_{j,k}$  $R_{j,k}$  $k$  $R_{l\\cdots r,k}$  $v$ $v \\le \\min L_{l\\cdots r,k}$ $0$ $v \\ge \\max L_{l\\cdots r,k}$ $\\sum_{j=l}^rR_{j,k}-\\sum_{j=l}^rL_{j,k}+(r-l+1)$ $x$ $\\forall j \\in[l,x], v\\ge L_{j,k},\\forall j\\in[x+1,r],v\\le L_{j,k}$ $L_{j,k},R_{j,k}$  $\\min,\\max$  $sum$  $\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)$ \n\n $x$ $L_{ql\\cdots qr,k}$  $v$ $[l,r]$ $ql\\le l\\land r \\le qr$  $ql\\le l\\land r \\le qr \\land (v \\le \\min L_{l\\cdots r,k}\\lor v \\ge \\max L_{l\\cdots r,k})$  $\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)$\n\n $O(n\\log n)$\n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary>\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n#define eb emplace_back\n#define mid ((l + r) / 2)\n#define lc o * 2\n#define rc o * 2 + 1\n#define lch l, mid, lc\n#define rch mid + 1, r, rc\n\nusing namespace std;\nusing ll = long long;\n\nconst int N = 2e5 + 5;\n\nint n, a[N], pre[N], nxt[N], L[N];\nvector<tuple<int, int, int>> vl[N], vr[N];\nint tagL[N * 4], minL[N * 4], maxL[N * 4];\nint tagR[N * 4], minR[N * 4], maxR[N * 4];\nll sum[N * 4], sumL[N * 4], sumR[N * 4], as;\n\nvoid pushUp(int o) {\n    sum[o] = sum[lc] + sum[rc];\n    sumL[o] = sumL[lc] + sumL[rc];\n    sumR[o] = sumR[lc] + sumR[rc];\n    minL[o] = min(minL[lc], minL[rc]);\n    minR[o] = min(minR[lc], minR[rc]);\n    maxL[o] = max(maxL[lc], maxL[rc]);\n    maxR[o] = max(maxR[lc], maxR[rc]);\n}\nvoid pushL(int v, int l, int r, int o) {\n    tagL[o] = minL[o] = maxL[o] = v, sumL[o] = v * (r - l + 1ll);\n    sum[o] = max(sumR[o] - sumL[o], 0ll);\n}\nvoid pushR(int v, int l, int r, int o) {\n    tagR[o] = minR[o] = maxR[o] = v, sumR[o] = v * (r - l + 1ll);\n    sum[o] = max(sumR[o] - sumL[o], 0ll);\n}\nvoid pushDown(int l, int r, int o) {\n    if(~tagL[o]) pushL(tagL[o], lch), pushL(tagL[o], rch), tagL[o] = -1;\n    if(~tagR[o]) pushR(tagR[o], lch), pushR(tagR[o], rch), tagR[o] = -1;\n}\nvoid updL(int L, int R, int v, int l, int r, int o) {\n    if(L <= l && r <= R && (v <= minR[o] || v >= maxR[o])) return pushL(v, l, r, o);\n    pushDown(l, r, o);\n    if(L <= mid) updL(L, R, v, lch);\n    if(R > mid) updL(L, R, v, rch);\n    pushUp(o);\n}\nvoid updR(int L, int R, int v, int l, int r, int o) {\n    if(L <= l && r <= R && (v >= maxL[o] || v <= minL[o])) return pushR(v, l, r, o);\n    pushDown(l, r, o);\n    if(L <= mid) updR(L, R, v, lch);\n    if(R > mid) updR(L, R, v, rch);\n    pushUp(o);\n}\nint main() {\n    cin >> n;\n    rep(i, 1, n) scanf(\"%d\", &a[i]);\n    rep(i, 1, n) L[i] = 0;\n    rep(i, 1, n) pre[i] = L[a[i]], L[a[i]] = i;\n    rep(i, 1, n) L[i] = n + 1;\n    per(i, n, 1) nxt[i] = L[a[i]], L[a[i]] = i;\n    rep(i, 2, n) {\n        int& j = L[i] = i - 1;\n        for(; j && pre[j] >= pre[i]; j = L[j]);\n        vr[i].eb(max(j, 1), i - 1, pre[i]);\n    }\n    rep(i, 2, n) {\n        int& j = L[i] = i - 1;\n        for(; j && nxt[j] <= nxt[i]; j = L[j])\n            vl[nxt[j]].eb(max(j, 1), i - 1, L[j]);\n    }\n    mem(tagL, 63), mem(tagR, -1);\n    rep(i, 1, n) {\n        for(auto [l, r, v] : vl[i]) updL(l, r, v, 1, n, 1);\n        for(auto [l, r, v] : vr[i]) updR(l, r, v, 1, n, 1);\n        as += sum[1];\n    }\n    cout << as;\n}\n```\n</details>\n\n### CF566C\n\n>  $n$  $w_i$  $u$  $v$  $1.5$ \n>\n>  $f(u)$  $u$  $f(u)$ \n>\n> $n \\le 2\\cdot 10^5$\n\n $f(u)$  $f(u)$  $f(u)$ \n\n $w_v\\text{dis}^{1.5}_v(u)$ \n\n $[l,r]$  $\\frac {l+r}2$  $\\frac {l+r}2$ \n\n\n\n $f(u)$ $u$  $f(u)$  $0$ $(u,v)$ $f(u)$  $(u,v)$  $v$  $u$ \n\n $u$  $v$ \n$$\n\\frac 32\\left(\\sum_{i=1}^nw_i\\sqrt{\\text{dis}(i,u)}-2\\sum_{i\\in \\text{subree}(v)}w_i\\sqrt{\\text{dis}(i,u)}\\right)\n$$\n $O(n)$  $u$  $O(n\\log n)$\n\n","source":"_posts/problems.md","raw":"---\ntitle: \ndate: 2021-09-08 15:09:11\nupdated: 2021-09-08 15:09:11\ntags: []\ntop: 1\n---\n\n\n### TC13459\n\n1 1 1\n\n $(i,j),(i,k)$ $(j,k)$  $(i,j)$  $(i,k)$ \n\n\n\n\n\n $x$  $y$  $i$ \n$$\n\\sum_{i=0}^x\\binom xi2^yn^{\\underline{i+y}}n^{\\underline{x-i+y}}\n$$\n $O(n^3)$DFS  $O(n^3\\alpha(n^2))$\n\n### TC12909\n\n\n\n $f_{i,j}$  $i$  $j$ \n\n-  $i+1$ $f_{i+1,j+1} \\leftarrow j \\cdot f_{i,j}$\n-  $i+1$ $f_{i+1,j} \\leftarrow 2j \\cdot f_{i,j}$\n-  $i+1$ $f_{i+1,j-1} \\leftarrow j \\cdot f_{i,j}$\n\n $j \\le G$  $0$\n\n $K$  $x$  $N\\binom{N-K-1}{K-1}$\n\n $O(N^2)$\n\n### TC13692\n\n\n\n $S_1-S_2$  $u$   $f_u$ $u=S_1$  $S_2$  $u$  $O(n^2)$\n\n $S_1-S_2$  $f$ \n\n $S_1-S_2$  $(u,v)$ $(u,v)$ $O(n)$  $f_u+f_v$\n\n $f_{S_1}+f_{S_2}$  \n\n### AGC017F\n\n$0$ $1$  $2^{N-1}$ \n\n $S,T$  $T$  $S$ \n\n `DP` $f_{i,j,k,S}$ \n\n-  $i$  $j$ \n- $S$  $j$  $i$  $N-1-j$  $i-1$ \n-  $i-1$  $j$  $k$\n\n $i$  $j+1$ \n\n $O(n^32^n)$\n\n $S,T$  $S$  $T$ \n\n-  $1$ \n\n-  $1$  $0$  $1$\n\n `DP`  $f_{i,j,S}$  $i$  $S$ $j$  $1$ \n\n\n\n-  $j+1$  $1$ $1$ $O(1)$ \n-  $i$  $1$  $0$  $1$ $O(1)$ \n\n $i$  $0$\n\n $O(n^22^n)$\n\n### ARC078D\n\n $1-n$ \n\n- \n\n $u_1,u_2,\\cdots,u_k$$u_1=1,u_k=n$ $k$  $i$  $u_k$\n\n\n\n-  $g_S$  $S$ \n-  $f_S$  $S$ \n- $f_S \\leftarrow f_{S-T} + g_T({T \\subseteq S})$ $T$ \n\n `DP` \n\n $f_{i,S}$  $S$  $1-i$ \n\n:\n\n- $f_{i,S \\cup \\{i\\}} \\leftarrow f_{j,S} + w(j,i)(j \\not\\in S)$\n- $f_{i,S\\cup T} \\leftarrow f_{i,S}+g_{T\\cup\\{i\\}}(S \\cap T = \\varnothing)$\n\n $O(n3^n)$\n\nARC068D\n\nAGC004F\n\nARC097D\n\nTC10265\n\nTC9844\n\nARC067C\n\nARC097C\n\n### TC10727\n\n\n\n-  $u$  $v$  $k$ \n\n `DP` $x$ $x$  $x$ $\\text{dis}(x,\\text{lca}(x,v)),\\text{dis}(v,\\text{lca}(x,v))$ \n\n $f_{i,j,k}$  $i$ $\\text{dis}(x,\\text{lca}(x,v))=j,\\text{dis}(v,\\text{lca}(x,v))=k$ \n\n\n\n- $f_{i+1,j+1,k} \\leftarrow 2f_{i,j,k},f_{i+1,j-1,k} \\leftarrow f_{i,j,k}(j>0)$\n- $f_{i+1,1,k} \\leftarrow f_{i,0,k},f_{i+1,\\max(1-k,0),\\max(k-1,0)} \\leftarrow f_{i,0,k}(k>0)$\n- $f_{i+1,0,k+1} \\leftarrow f_{i,0,k}(k < \\text{depth}_v)$\n\nTC10664\n\nTC10566\n\nTC10773\n\n### TC10993\n\n $0$ \n\n $C$  $C$ \n\n\n\n $C$  $C$  $\\min  + \\min   \\ge C$\n\n `DP` $f_{i,j}$  $i$  $\\min$  $j$ \n\n $i+1$  $k$$f_{i+1,\\min(j,k)} \\leftarrow f_{i,j}(j+k \\ge C)$ $j$  $i+1$   $i+1$ \n\n $O(nC^2)$\n\n\n\n- $f_{i+1,j} \\leftarrow f_{i,j}(k \\ge \\max(j,C-j))$ $k$\n- $f_{i+1,k} \\leftarrow f_{i,j}(k \\le j \\le C -k)$ $k$  $j$  $O(1)$ \n\n $O(nC)$\n\nTC10741\n\nTC10854\n\nTC10848\n\nTC10902\n\nTC10737\n\nTC10758\n\nTC11003\n\nTC11026\n\nTC11032\n\nTC10748\n\nTC11213\n\nTC11305\n\nTC12620\n\n\n\nTC10758\n\nTC11032\n\n### Gym102391E\n\n $D$ $f_u$ \n\n-  $u$ \n-  $D$\n- $f_u$  $u$/ $fa_u$\n\n\n\n- $u$  $f$  $D$ $D$  $D$  `DP` $f$ \n\n- $u$  $fa$  $u$ \n\n  -  $v$  $+f_v$\n  -  $v_1,v_2$  $+f_{v_1}+f_{v_2}$\n\n   $D$\n\n  $f_u \\leftarrow \\max\\limits_vf_v+$ $v$  $fa$ \n\n  $f_u \\leftarrow$  $fa$ \n\n   $O(^2)$\n\n  -  $i$  $fa$ \n  -  $i$  $fa$  $i$ \n  -  $i$  $fa$ \n  -  $i$ \n\n $O(n\\log V)$\n\n### ZOJ3970\n\n\n\n- \n- \n\n\n\n $i$  $a_i$  $\\sum_{i=2}^n\\max(0,a_i-a_{i-1})$\n\n\n\n $pre_i$  $t_j>0$  $j$\n\n$f_{i,j}$  $i$  $i$  $j$ \n\n\n\n$$\nf_{i,j}=\\min_kf_{pre_i,k}+\\max(0,j-k)+\\max(0,t_i-s_i+j-t_{pre_i}+s_{pre_i}-k)+\\max(0,\\max_{pre_i<x<i}s_x-\\max(j,k))\n$$\n\n $(pre_i,i)$  $0$ \n\n $O(nV^2)$\n\n $f_i$ \n\n $\\min$  $O(1)$  $f_{i,j}$\n\n $f_i$  $[l,r]$ $f_{i,l},f_{i,mid},f_{i,r}$  $[l,r]$ \n\n $O(n\\log V)$\n\n### ZOJ3989\n\n\n\n\n\n- \n- \n- \n- \n\n ```DP``` \n\n\n\n\n\n- \n-  $[l,r]$ $x$ $l < x < r$ $x > r$\n- \n- \n\n $2^{n-2}$\n\n\n\n\n\n\n\n\n\n $f_{S,i}$  $S$ $i$ \n\n $O(n^22^n)$\n\n### \n\n>  $n$  $S$ $f(S)$  $S$  $S \\ne \\{1,2,\\cdots,n\\}$ $|f(S)| \\le |S|$\n>\n> $n, m \\le 10^5$\n\nHall  $S$$|f(S)| \\ge |S|$\n\n $S$  $|f(S)| \\le |S|$ $S$\n\n $S$\n\n $S$ $f(S)$\n\n $v$ $\\text{match}(v)$\n\n $(u,v)$  $(u,\\text{match}(v))$ \n\n### ARC107F\n\n\n\n\n\n-  $-B_i,A_i,B_i$\n-  $u,v$\n- \n\n $i$  $U_i,V_i$\n\n $(S,U_i),(U_i,V_i),(V_i,T)$ \n\n $\\infty-B_i,\\infty+A_i,\\infty+B_i$\n\n $(i,j)$\n\n-  $(S,U_i),(V_j,T)$ $(S,U_i)$ $U_i$  $T$ $(V_j,T)$ $S$  $V_j$ $(V_j,U_i)$ $\\infty^2$ \n-  $(S,U_j),(V_i,T)$ $(V_i,U_j)$ $\\infty^2$ \n\n $n\\infty$\n\n![.png](https://i.loli.net/2021/09/08/4ragjEUYIev5wot.png)\n\n### Gym101471J\n\nCF1307G\n\n### CF1307F\n\nP3980\n\nCF1368H2\n\n### AGC038E\n\n$B_i=1$ \n\n `DP`  `min-max` \n\n $O(n2^n)$  $O(2^n)$  $400$\n\n `min-max` \n$$\n\\sum_{S}(-1)^{|S|}\\frac{\\sum_{i=1}^n A_i}{\\sum_{i \\in S} A_i}\n$$\n $400$  $\\sum_S(-1)^{|S|}$\n\n\n$$\nf_{i,j} = \\sum_{S \\subseteq \\{1,2,\\cdots,i\\}}(-1)^{|S|}[\\sum_{i \\in S}A_i=j]\n$$\n $f_{i,j}=f_{i-1,j}-f_{i-1,j-A_i}$\n$$\n(\\sum_{i=1}^n A_i)\\sum_{i=0}^{400}\\frac{f_{n,i}}i\n$$\n `min-max` \n$$\n\\sum_{S}(-1)^{|S|}[S ]\n$$\n\n $p_i=\\frac{A_i}{\\sum_{j \\in S}A_j}$\n\n\n$$\n\\begin{aligned}\n&\\sum_{\\forall i \\in S,c_i<B_i}[c]\\cdot[c]\\\\\n&=\\sum_{\\forall i \\in S,c_i<B_i}\\frac{(\\sum_{i \\in S}c_i)!}{\\prod_{i \\in S} c_i!}\\prod_{i \\in S}p_i^{c_i} \\cdot \\frac{\\sum_{i=1}^n A_i}{\\sum_{i \\in S} A_i}\\\\\n&=\\sum_{\\forall i \\in S,c_i<B_i}\\frac{(\\sum_{i \\in S}c_i)!}{\\prod_{i \\in S} c_i!}\\prod_{i \\in S}A_i^{c_i} \\cdot \\frac{\\sum_{i=1}^n A_i}{(\\sum_{i \\in S} A_i)^{(\\sum_{i \\in S}c_i)+1}}\n\\end{aligned}\n$$\n\n\n$$\n\\begin{aligned}\n&\\sum_S(-1)^{|S|}\\sum_{\\forall i \\in S,c_i<B_i}\\frac{(\\sum_{i \\in S}c_i)!}{\\prod_{i \\in S} c_i!}\\prod_{i \\in S}A_i^{c_i} \\cdot \\frac{\\sum_{i=1}^n A_i}{(\\sum_{i \\in S} A_i)^{(\\sum_{i \\in S}c_i)+1}}\\\\\n&=(\\sum_{i=1}^n A_i)\\sum_S(-1)^{|S|}\\sum_{\\forall i \\in S,c_i<B_i}\\frac{(\\sum_{i \\in S}c_i)!}{(\\sum_{i \\in S} A_i)^{(\\sum_{i \\in S}c_i)+1}} \\cdot \\prod_{i \\in S}\\frac{A_i^{c_i}}{c_i!}\n\\end{aligned}\n$$\n\n $\\sum_{i \\in S} A_i$  $\\sum_{i \\in S}c_i$\n\n\n$$\nf_{i,j,k}=\\sum_{S \\subseteq \\{1,2,\\cdots,i\\}}(-1)^{|S|}\\sum_{\\forall i \\in S,c_i<B_i}\\prod_{i \\in S}\\frac{A_i^{c_i}}{c_i!}[\\sum_{i \\in S} A_i=j \\land \\sum_{i \\in S}c_i=k]\n$$\n\n$$\nf_{i,j,k}=f_{i-1,j,k}-\\sum_{c=0}^{B_i-1}f_{i-1,j-A_i,k-c}\\frac{A_i^c}{c!}\n$$\n\n$$\n(\\sum_{i=1}^n A_i)\\sum_{i=0}^{400}\\sum_{j=0}^{400}\\frac{j!f_{n,i,j}}{i^{j+1}}\n$$\n $B_i$ $\\sum_{i=1}^nB_i$  $O(n)$  $O(n^3)$ $O(n^2)$\n\n---\n\n### AGC037D\n\n $i$  $(i-1)m+1$  $im$  $(i-1)m+1$  $im$  $i$\n\n $i$  $i$  $n$ \n\n $i$  $i$  $i$ Hall \n\n $O(n^4)$\n\n### AGC043D\n\n $P$ \n\n $A_i$ $A_i$ \n\n\n\n-  $3$ \n- \n-  $1$  $2$  $2$  $1$  $A_i$\n\n $P$  $P$  $A$ \n\n $P$ \n\n $1,2,3$  $cnt_1,cnt_2,cnt_3$ $cnt_1+2cnt_2+3cnt_3=3n$  $cnt_1 \\ge cnt_2$\n\n\n$$\n\\binom{cnt_1+cnt_2+cnt_3}{cnt_1,cnt_2,cnt_3}\\frac{(3n)!}{(cnt_1+cnt_2+cnt_3)!2^{cnt_2}3^{cnt_3}}\n$$\n $(cnt_1+cnt_2+cnt_3)!$  $2^{cnt_2}3^{cnt_3}$ \n\n $O(n^2)$\n\n### AGC049D\n\n\n\n-  $c$ $i$ $A=(c,c,\\cdots,c)$\n-  $j<i$ $A_j,A_{j-1},A_{j-2},\\cdots,A_1$  $1,2,3,\\cdots,j$\n-  $j>i$ $A_j,A_{j+1},A_{j+2},\\cdots,A_n$  $1,2,3,\\cdots,n-j+1$ $i>1$  $i-1$ \n\n $i-1$  $\\frac {i(i-1)}2$ \n\n $i$ $O(\\sqrt m)$  $O(m\\sqrt m)$  $O(\\frac mn)$  $c$\n\n $O(nm\\sqrt m)$\n\n $i \\rightarrow i+1$  $O(\\sqrt m)$  $O(m\\sqrt m)$ \n\n### AGC050D\n\n $f_{i,a,b,j}$  $j$ \n\n-  $a$  $i$ \n-  $b$  $i+1$ \n\n $a$  $f_{i,0,b,j}=f_{i+1,b,0,j}$\n\n- $f_{i,a,b,j}=win \\cdot f_{i,a-1,b,j-[j>b]} + lost \\cdot f_{i,a-1,b+1,j}(j\\ne b+1)$\n- $f_{i,a,b,b+1}=win + lost \\cdot f_{i,a-1,b+1,b+1}(j\\le b)$\n\n $O(n^4)$\n\n### NOI2021Day1T1\n\n\n\n\n\n $O(n\\log^2n)$\n\n### NOI2021Day1T2\n\n $k=2$ \n\n $n_1=n_2=\\cdots=n_k$ \n\n\n\n\n\n-  $(P_1,P_2,\\cdots,P_k)$  $(Q_1,Q_2,\\cdots,Q_k)$ $\\iff$ $(P_1,Q_1)$  $(P_k,Q_k)$ \n\n- \n\n  - \n  - \n\n  \n\n $O(n^4)$\n\n### NOI2021Day1T3\n\n $s$  $t$ \n\n\n\n $x\\Rightarrow z$  $y\\Rightarrow z$ $x\\Rightarrow y$  $y\\Rightarrow x$ $z$ \n\n\n\n $s,t$ \n\n `LCA`  `vector`\n\n $O(n+q\\log n)$\n\n### NOI2021Day2T1\n\n$k \\le 15$  $256$  $16$ \n\n $16$  $7$  `popcount` \n\n### NOI2021Day2T2\n\n~~~~\n\n $a$ \n\n $a_n$  $x,y$ $\\frac {x'}{y'}=a_{n-1}+\\frac 1{a_n}=\\frac {a_{k-1}x+y}x$ $(x,y)$ \n$$\n\\begin{bmatrix}\nx'\\\\\ny'\n\\end{bmatrix}\n=\n\\begin{bmatrix}\na_{n-1}&1\\\\\n1&0\n\\end{bmatrix}\n\\begin{bmatrix}\nx\\\\\ny\n\\end{bmatrix}\n$$\n\n$$\n\\begin{bmatrix}\na&c\\\\\nb&d\n\\end{bmatrix}\n=\n\\prod_{i=1}^n\n\\begin{bmatrix}\na_i&1\\\\\n1&0\n\\end{bmatrix}\n$$\n $\\frac ab$\n\n\n\n- `W`  $\\begin{bmatrix}x&1\\\\1&0\\end{bmatrix}\\begin{bmatrix}1&0\\\\1&1\\end{bmatrix}=\\begin{bmatrix}x+1&1\\\\1&0\\end{bmatrix}$ 'W'  $\\begin{bmatrix}1&0\\\\1&1\\end{bmatrix}$\n\n- `E`  $1$  $1$ \n\n   $1$ \n  $$\n  \\begin{bmatrix}\n  1&1\\\\\n  1&0\n  \\end{bmatrix}\n  \\rightarrow\n  \\begin{bmatrix}\n  1&0\\\\\n  1&1\n  \\end{bmatrix}\n  \\begin{bmatrix}\n  1&1\\\\\n  1&0\n  \\end{bmatrix}\n  =\n  \\begin{bmatrix}\n  1&1\\\\\n  2&1\n  \\end{bmatrix}\n  $$\n  **** $1$ $1$ \n  $$\n  \\begin{bmatrix}\n  1&1\\\\\n  1&0\n  \\end{bmatrix}\n  \\rightarrow\n  \\begin{bmatrix}\n  0&1\\\\\n  1&0\n  \\end{bmatrix}\n  \\begin{bmatrix}\n  1&1\\\\\n  1&0\n  \\end{bmatrix}^2\n  =\n  \\begin{bmatrix}\n  1&1\\\\\n  2&1\n  \\end{bmatrix}\n  $$\n   `E`  $1$  $\\begin{bmatrix}1&0\\\\-1&1\\end{bmatrix}$\n\n   `E`  $\\begin{bmatrix}1&0\\\\-1&1\\end{bmatrix}\\begin{bmatrix}1&1\\\\1&0\\end{bmatrix}^2=\\begin{bmatrix}2&1\\\\-1&0\\end{bmatrix}$\n\n`APPEND``FLIP `  `REVERSE ` `FLIP`  `FLIP` \n\n $O(n\\log n)$\n\n### NOI2021Day2T3\n\n $4$  $0$ $1$ $0,1,2,3$ \n\n $mask$\n\n-  $0,1$  $2,3$ $1$\n-  $01$  $2$\n-  $3$\n\n $O(2^nmn^2)$ \n\n $g_{0/1/2/3,S}$  $S$  $0/1/2/3$ $g$  $O(2^n)$  $g$  $O(1)$ \n\n $O(2^nm)$\n\n $n \\le 32$ $mask$  $\\lceil\\frac n2\\rceil$  $\\lceil\\frac n2\\rceil$ \n\n $mask$  $\\max$\n\n- $\\max \\le \\lceil\\frac n2\\rceil$ $O(2^{\\frac n2}m)$\n\n- $\\max > \\lceil\\frac n2\\rceil$ $n-\\max+1$\n\n   $R$ \n\n  -  $R$  $mask$ \n\n  - \n\n   $mask$  $2\\max-n+1$ $O(2^{n-\\max+1}m)$\n   `DP` $f_{i,S}$  $mask$  $i$  $n-\\max+1$  $S$ $i+1$  $O(2^{n-\\max+1}m)$  $O(2^{n-\\max+1}n)$\n\n $O(2^{n/2}m)$\n\n### CF1548D2\n\n Pick \n$$\nS=i+\\frac b2-1\n$$\n $S\\in \\mathbb Z \\land2S\\equiv b \\pmod 4$\n\n $ABC$ $2S=|\\overrightarrow A\\times \\overrightarrow B+\\overrightarrow B\\times \\overrightarrow C+\\overrightarrow C\\times \\overrightarrow A|$ $S$  $S$  $4$  $2S \\bmod 4$\n\n $AB$  **** $b$  $AB$  $\\text{bounds}(A,B)=\\gcd(|X_A-X_B|,|Y_A-Y_B|)$\n\n $S$  $b$  $\\text{bounds}(A,B) \\bmod 4$  $0$  $2$ \n$$\n\\text{bounds}(A,B) \\equiv 0\\pmod 4 \\iff X_A\\equiv X_B\\pmod 4 \\land Y_A\\equiv Y_B\\pmod 4\n$$\n $\\text{bounds}(A,B) \\not\\equiv 0\\pmod 4$ \n$$\n\\text{bounds}(A,B) \\equiv 2\\pmod 4 \\iff X_A\\equiv X_B\\pmod 2 \\land Y_A\\equiv Y_B\\pmod 2\n$$\n $4$ \n\n EEE  EOO  $cnt_{A,x,y,z}$  $B$ \n$$\nX_B\\equiv x\\pmod 4 \\land Y_B\\equiv y\\pmod 4 \\land \\text{bounds}(A,B) \\equiv z\\pmod 4\n$$\n $O(n^2\\log V)$ \n\n $ABC$  $A$\n$$\nX_B\\bmod 4,Y_B\\bmod 4,\\text{bounds}(A,B)\\bmod 4\\\\X_C\\bmod 4,Y_C\\bmod 4,\\text{bounds}(A,C)\\bmod 4\n$$\n\n$$\nS \\in \\mathbb Z\\\\\n\\text{bounds}(A,B)\\equiv\\text{bounds}(A,C)\\pmod 2\\\\\nX_B\\equiv X_C \\pmod 2\\\\\nY_B\\equiv Y_C\\pmod 2\\\\\nS\\equiv \\text{bounds}(A,B)+\\text{bounds}(A,C)+\\text{bounds}(B,C)\\pmod 4\n$$\n $cnt$  $O(1)$ \n\n EEE  $3$  EOO  $1$ \n\n $O(n^2\\log V)$\n\n### CF1548E\n\n~~ 3400~~\n\n $1$ $0$1-\n\n>  $i,j$1 \n\n $a_i \\ge a_j$$a_i+b_k \\le x \\Rightarrow a_j+b_k \\le x$\n\n $a,b$ \n\n\n\n-  $S$ $L_r$ $R_r$ $L_c$ $R_c$\n-  $a_{L_r},a_{L_r+1},\\cdots,a_{R_r}$  $i$ $(i,L_c),(i,L_c+1),\\cdots,(i,R_c)$  1\n-  $S$  $i$ \n\n $i$ $i$  1  $[l,r]$ $i$ \n\n-  $j$  $a_j \\le a_i$$\\min_{k\\in [l,r]}a_k+\\max_{k\\in (j,i]}b_k>x$\n-  $j$  $a_j<a_i$$\\min_{k\\in [l,r]}a_k+\\max_{k\\in [i,j)}b_k>x$\n\n $i$  $a_j\\le a_i$  $j$  $pre$ $i$  $a_j< a_i$  $j$  $suf$ $[l,r]$  $\\min_{i\\in [l,r]}a_i>x-\\max_{i\\in (pre,suf)}$ $i$  $O(n)$ \n\n\n\n-  $b$ \n-  $a_i$ $i$  $0$  $1$\n-  $key$\n\n\n\n $O(n\\log n)$\n\n### 2021MINIEYE5T1\n\n\n\n- `1`  `access(u)`\n- `2` \n- `3`  `dfs` \n- `4` \n\n `23` \n\n `4`  `LCT`  `access` \n\n $O(n\\log^2n)$\n\n### 2021MINIEYE5T2\n\n $f_{i,j}$  $i$  `a`$j$  `b` $(x+y+k-2)^L$\n\n $\\sum_{i=0}^L\\sum_{j=0}^L[n|i-p][n|j-q][x^i][y^j](x+y+k-2)^L$\n\n $n|P-1$\n$$\n\\frac 1{n^2}\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}(\\omega_n^i+\\omega_n^j+k-2)^L\\omega_n^{-ip}\\omega_n^{-jq}\n$$\n $A_{i,j}=(\\omega_n^i+\\omega_n^j+k-2)^L$  $O(n^2\\log L)$  $B$  $A$  `IDFT`  `IDFT`  $O(n^3)$ Bluestein + MTT  $O(n^2\\log n)$\n\n $O(n^3)$  $O(n^2\\log L)$\n\n### 2021MINIEYE5T9\n\n ****\n\n\n\n####  1\n\n $v$\n\n $v$  $p_1,p_2,\\cdots,p_k$ $[l,r]$  $v$  $p_i$  $v$  $p_j$ \n\n $j$ $(l,r)$ $v$  $1$ $v$  $-1$ $sum_i$ $[l,r]$  $sum_{l-1}<sum_r$ $sum_1,sum_2,\\cdots,sum_{p_j}$ $j\\rightarrow j+1$  $sum_{p_j},sum_{p_j+1},\\cdots,sum_{p_{j+1}-1}$ $+1$ $r\\in[p_j,p_{j+1})$ $l$  $sum_r$  $[p_j,p_{j+1})$  $sum_r$ \n\n $O(n\\log n)$\n\n####  2\n\n $[l,r]$  $l\\le mid+1 \\land r\\ge mid$\n\n $[l,r]$  $[l,mid]$  $[mid+1,r]$ \n\n>  $O(\\log n)$ \n\n $v$  $O(\\log n)$  $v$ $v$  $1$ $v$  $-1$ $sum_i$ $r$  $l\\le mid+1$  $sum_{l-1}<sum_r$ $O(1)$ \n\n $O(n\\log^2n)$\n\n### 2021MINIEYE5T13\n\n $D$ `DP` \n\n $f_{u,0/1}$  $u$  $\\infty$\n\n-  $u$ \n- $u$  $u$ \n-  $D$\n\n$f_{u,1}$  $v$  $\\min(f_{v,0}+w(u,v),f_{v,1}+\\max(w(u,v)-p_v,0))$  $D$$f_{u,1}=\\infty$\n\n$f_{u,0}$ $u$  $(u,v)$  $v$  $\\min(f_{v,0}+w(u,v),f_{v,1}+w(u,v)-p_v)$  $v$\n\n $O(n\\log V)$\n\n### AGC041D\n\n $k$  $k+1$  $\\lceil\\frac n2\\rceil$  $\\lceil\\frac n2\\rceil-1$ \n\n $A$\n\n-  $\\lfloor\\frac n2\\rfloor+1$  $c$ $A=(c,c,\\cdots,c)$\n-  $j<\\lfloor\\frac n2\\rfloor+1$ $A_1,A_2,\\cdots,A_j$ \n-  $j>\\lfloor\\frac n2\\rfloor+1$ $A_j,A_{j+1},\\cdots,A_n$ \n-  $A_1 \\ge 1$ $c-1$ $n-c$\n-  $\\lceil\\frac n2\\rceil$  $\\lceil\\frac n2\\rceil-1$  $x$ $x=c$ $x$  $j$ $x$  $n-j+1$ $c$\n\n $1,2,\\cdots,\\lfloor\\frac n2\\rfloor$  $c-1$  $1,2,\\cdots,\\lceil\\frac n2\\rceil-1$  $n-c$  $c$\n\n $L_{i,j}$  $i$  $j$ \n$$\nL_{i,j}=L_{i-1,j-1}+L_{i,j-i}-L_{i-1,j-i-\\lfloor\\frac n2\\rfloor}\n$$\n $R_{i,j}$\n\n $c$  $O(n)$ \n\n $O(n^2)$\n\n### AGC027D\n\n\n\n- \n-  $1$\n\n $\\text{lcm}$ $\\text{lcm}+1$ $2\\text{lcm}+1,3\\text{lcm}+1,\\cdots$\n\n\n\n $\\text{lcm}$  $\\text{lcm}$ \n\n-  $N$ \n-  $A_{i,j}$  $\\text{lcm(i,j)}$  $N$ \n-  $A_{i,j}$  $\\text{lcm}(i+j,i-j+n)$  $N$  $425$ \n-  $A_{i,j}$  $\\text{lcm}(i+(n-j+1),i-(n-j+1)+n)$\n- \n\n `set`  $O(n^2\\log n)$\n\n $O(n^2)$\n\n### AGC025D\n\n $\\sqrt D$  $(x_1,y_1),(x_2,y_2)$ $x_1-x_2,y_1-y_2$ \n$$\nx_1 \\equiv x_2 \\pmod 2,y_1 \\equiv y_2 \\pmod 2 \\iff D \\equiv 0 \\pmod 4\\\\\nx_1 \\equiv x_2 \\pmod 2,y_1 \\not\\equiv y_2 \\pmod 2 \\iff D \\equiv 1 \\pmod 4\\\\\nx_1 \\not\\equiv x_2 \\pmod 2,y_1 \\not\\equiv y_2 \\pmod 2 \\iff D \\equiv 2 \\pmod 4\\\\\n$$\n $D \\bmod 4$ \n\n>  $\\sqrt D$ \n\n $\\text{color}(x,y,D)=0/1$  $(x,y)$ \n\n-  $D\\equiv 3\\pmod 4$ $\\text{color}(x,y,D)=0$\n\n-  $D\\equiv 2\\pmod 4$ $\\text{color}(x,y,D)=x\\bmod 2$ $\\sqrt D$ \n-  $D \\equiv 1\\pmod 4$ $\\text{color}(x,y,D)=(x+y)\\bmod 2$ $\\sqrt D$ \n\n-  $D\\equiv 0\\pmod 4$ $\\text{color}(x,y,D)=\\text{color}(\\lfloor\\frac x2\\rfloor,\\lfloor\\frac y2\\rfloor,\\frac D4)$\n\n   $\\sqrt D$  $(x_1,y_1),(x_2,y_2)$ $x_1 \\equiv x_2 \\pmod 2,y_1 \\equiv y_2 \\pmod 2$\n  $$\n  \\lfloor\\frac {x_1}2\\rfloor-\\lfloor\\frac {x_2}2\\rfloor=\\frac 12(x_1-x_2)\\\\\n  \\lfloor\\frac {y_1}2\\rfloor-\\lfloor\\frac {y_2}2\\rfloor=\\frac 12(y_1-y_2)\n  $$\n  \n  $$\n  \\begin{aligned}\n  &(x_1-x_2)^2+(y_1-y_2)^2=D\\\\\n  \\Rightarrow &(\\lfloor\\frac {x_1}2\\rfloor-\\lfloor\\frac {x_2}2\\rfloor)^2+(\\lfloor\\frac {y_1}2\\rfloor-\\lfloor\\frac {y_2}2\\rfloor)^2=\\frac D4\\\\\n  \\Rightarrow &\\text{color}(\\lfloor\\frac {x_1}2\\rfloor,\\lfloor\\frac {y_1}2\\rfloor,\\frac D4)\\ne\\text{color}(\\lfloor\\frac {x_2}2\\rfloor,\\lfloor\\frac {y_2}2\\rfloor,\\frac D4)\n  \\end{aligned}\n  $$\n\n $D_1$  $D_2$  $4$  $4$  $n^2$ $n^2$ \n\n $O(n^2)$\n\n### AGC036D\n\n $d_1,d_2,\\cdots,d_n$ $d_1=0$\n\n $i\\rightarrow i+1$  $d$  $0$ $-1\n$ $-2\\cdots$ \n\n $d$ $[a,b]$ $d_{a,a+1,\\cdots,b}=x+1$ $[b+1,c]$ $d_{b+1,b+2,\\cdots,c}=x$\n\n-  $b+1\\le i < j \\le c$ $(i,j)$ \n-  $b+1\\le i\\le c,j<a$ $(i,j)$ \n\n `DP`  $f_{a,b}$  $[a,b]$ \n$$\nf_{a,b}+\\text{cost}_1(b+1,c)+\\text{cost}_2(b+1,c,a-1)\\rightarrow f_{b+1,c}\n$$\n $\\text{cost}_1$  $\\text{cost}_2$  $O(1)$ \n\n $O(n^3)$\n\n### AGC045D\n\n `Snuke`  $p_i=i$  `Snuke` \n\n-  `Snuke`  $1$\n-  $p_i=i$ \n- $p_i$  $p_i$\n- \n\n `Snuke`  $1-A$  $p_i=i$  $i$  $\\min$$\\forall i>A,\\exists j<\\min$  $j$  $i$\n\n $\\min$ $\\min$ \n\n-  $i$  $(-1)^i\\binom{\\min-1}i$\n-  $[1,\\min-1]$  $\\min-1-i$  $(\\min-1-i)!$\n-  $[A+1,n]$  $(\\min-1-i)^{\\overline{n-A}}$\n-  $[\\min+1,A]$  $(\\min-1-i+n-A)^{\\overline{A-\\min}}$\n\n $\\min$ \n$$\n\\sum_{i=0}^{\\min-1}(-1)^i\\binom{\\min-1}i\\frac{(n-1-i)!(\\min-1-i)}{\\min-1-i+n-A}\n$$\n $\\min$ \n$$\n\\sum_{i=0}^A(-1)^i\\binom Ai(n-i)!\n$$\n $O(A^2+n)$\n\n### AGC041E\n\n####  $T=1$\n\n\n\n- \n- \n- \n\n $t$  $t$ \n\n `bitset`  `DFS`  `bitset` $O(\\frac {nm}{\\omega})$ \n\n####  $T=2$\n\n$n=2$  $n>2$ \n\n $size_i$  $i$ \n\n- $size_i=1$\n-  $(x,y)$  $size_x+1$ $size_y+1$ $size_x$  $size_y$  $+1$ $size_x=n-1\\land size_y=n-1$  $size_x+size_y\\le n$\n\n $O(n+m)$\n\n### ABC214G\n\n $n \\le 10^5$ \n\n $F_k$  $k$  $r_{i_1},r_{i_2},\\cdots,r_{i_k}(i_1<i_2<\\cdots<i_k)$ \n$$\n\\forall x\\in[1,k],r_{i_x}=p_{i_x}\\lor r_{i_x}=q_{i_x}\n$$\n\n$$\n\\sum_{i=0}^n(-1)^iF_i(n-i)!\n$$\n $p_i,q_i$  $r_i=p_i\\lor r_i=q_i$  $i$  $F$  `FFT`  $F$ \n\n $m$  $F$  $1,2,\\cdots,m$ $(1,2),(2,3),\\cdots,(m-1,m),(m,1)$ $i$ \n\n-  $(1,2)$ $(2,3)$  $2$  $1$ $(2,3)$  $3$  $2$ $(3,4)$  $3$  $3$ $(3,4)$  $4$  $4$ $2m-2$  $i$ \n\n  >  $n$  $r$  $\\binom {n-r+1}r$\n  >\n  >  $i$  $i-1$  $n-r+1$  $r$ \n\n   $\\binom{2m-i-1}i$\n\n-  $(1,2)$ $(1,2)$  $1$  $2$ $1$ $2m-3$  $i-1$ \n\n   $2\\binom{2m-i-1}{i-1}$\n\n $m$ \n$$\nF_i=\\binom{2m-i-1}i+2\\binom{2m-i-1}{i-1}=\\binom{2m-i}i+\\binom{2m-i-1}{i-1}\n$$\n $F$  $O(n)$  `FFT` $O(n\\log^2n)$\n\n `FFT` \n\n-  $n$ $O(\\sqrt n)$  $O(n\\log n)$ \n-  $\\sum_{u\\in \\mathbb{leaf}}\\text{degree}_u\\text{depth}_u$ `Huffman`  \n\n### ABC214H\n\n `DAG` `DAG`\n\n\n\n-  $u$  $\\text{in}_u$  $\\text{out}_u$\n- $\\text{in}_u$  $\\text{out}_u$  $1$ $-X_u$  $K$ $0$ \n-  $(u,v)$$\\text{out}_u$  $\\text{in}_v$  $K$ $0$ \n- $S$  $\\text{in}_1$  $K$ $0$ $\\text{out}_u$  $T$  $K$ $0$ \n\n`SSP`  `Primal-Dual` \n\n#### Sol 1\n\n `DAG` `DP` \n\n#### Sol 2\n\n `DAG` \n\n\n\n- $S$  $\\sum X_u$$T$  $0$\n- $\\text{in}_u$  $\\sum_{i=1}^uX_i$$\\text{out}_u$  $\\sum_{i=1}^{u-1}X_i$\n\n $O(nK\\log n)$\n\n### AGC027E\n\n $a$  $b$\n\n $a$  $S$  $a,b$  $a$  $b$  $3$  $1$ $|S|$  $|S|$  $ababab\\cdots aba$\n\n>  $p(S)$  $S$  $a$  $b$  $3$$S$  $c$ \n>\n> - $p(S)=p(c)$\n> - $S=c$  $S$ \n\n $|S|\\le 3$  $|S|>3$  $S$  $n$  $a$\n\n- $n \\ge 4$ $a$ $|S|$  $1$\n- $n\\le 3$ $|S|>3$ $b$ $a$  $b$ $b$ $|S|$  $1$\n\n $T$ \n\n-  $S$  $|T|$  $T$ \n\n\n\n $S$ **** \n\n>  $S$ $S$  $T$ \n>\n> -  $S$  $|T|$  $S$  $S_1,S_2,\\cdots,S_{|T|}$$T$  $T_1,T_2,\\cdots,T_{|T|}$\n> -  $\\forall i,p(S_i)=p(T_i)$\n\n\n\n-  $(S_1,S_2,\\cdots,S_{|T|})$\n-  $S_1,S_2,\\cdots,S_{|T|-1}$  $(S_1',S_2',\\cdots,S_{|T|}')$\n-  $S_1,S_2,\\cdots,S_{|T|-1}$ \n-  $S_{|T|}$  $S_{|T|}=abab\\cdots aba$ $|T|>1$ $S_{|T|}$  $S_{|T|-1}$ $T$  $S$  $S$  $T$\n\n $S$  $T$  `DP`\n\n $O(n)$\n\n### Gym101667G\n\n\n\n L  U  U  L  `isRegion` `area` \n\n-  `isRegion`  `area` \n-  `area`\n-  `area`\n\n $O(n+m)$\n\n![.png](https://i.loli.net/2021/09/08/a4fEq6tJWRbrxDy.png)\n\n### Gym101667J\n\n Hall  $f(S)$  $S$  $1$ \n$$\n\\forall |S|\\le\\frac n2,|T|=\\frac n2,S \\cap T=\\varnothing\\\\\n|f(S)\\cap T| \\ge |S|\n$$\n $|f(S)\\cap T|$  $|f(S)|+|S|-\\frac n2$ $|f(S)|\\ge\\frac n2$\n\n $\\min_{|S|\\le \\frac n2}|f(S)|$\n\n- $f(S)$  $S$  $V-S-f(S)$ \n-  $T$  $\\frac n2$ $S$ $|f(S)|\\le |T|$\n\n\n\n-  $u$  $\\text{in}_u$  $\\text{out}_u$\n- $\\text{in}_u$  $\\text{out}_u$  $1$ \n-  $(u,v)$$\\text{out}_u$  $\\text{in}_v$$\\text{out}_v$  $\\text{in}_u$  $\\infty$ \n-  $u,v$ $\\text{out}_u$  $\\text{in}_v$ \n\n $O(n^2\\cdot flow)$\n\n~~~~ $\\frac n2$ $u$ $v$ $\\text{out}_u$  $\\text{in}_v$  $k$  $O(nk\\cdot flow)$\n\n### ABC215H\n\n\n\n- $S$  $i$  $A_i$ \n-  $i$  $T$  $B_i$ \n-  $c_{i,j}=1$ $i$  $j$  $\\infty$ \n- $\\max flow=\\sum_{i=1}^mB_i$\n\n $T$  $S$  $S$  $mask$ $mask$  $T$  $sum$ $\\sum_{i\\in mask}A_i-sum+1$ $sum>0$\n\n $mask$ $sum$ $B_i$  $mask$  $mask$  $i$ `FMT` $mask$  $\\sum_{i\\in mask}A_i-sum+1$ \n\n $mask$  $mask$  $S$ $mask\\subseteq S$ `FMT`  $ans$ $mask$ $mask$  $ans$  $mask$  $mask$  $O(3^n)$\n\n $f_S$  $S$  $ans$  $mask$ \n$$\n\\sum_{T\\subseteq S}f_T=\\binom{\\sum_{i\\in S}A_i}{ans}\n$$\n `IFMT`  $f$ \n\n $O(n2^n+nm)$\n\n### AGC020E\n\n $S$  `DP`  $f_{l,r}$  $[l,r]$ \n\n- $s_l$  $f_{l+1,r}$\n- $s_l$  $s_l$  $T$  $i>1$ $f_{l,l+T-1}\\cdot f_{l+Ti,r}$\n\n `DP`  $s_l$  $f_{l,l+T-1}$  `DP`  $f(s)$  $s$  $suf(i)$  $s$  $s_i$ \n\n-  $(s_0+1)f(suf(1))$\n\n-  $s_l$  $T$  $i>1$ $s[l,r]$  $s$  $l$  $r$ \n  $$\n  t=s[0,T-1]\\&s[T,2T-1]\\&\\cdots\\&s[T(i-1),Ti-1](\\&\\ is\\ \\text{bitand})\n  $$\n   $f(t)\\cdot f(suf(Ti))$\n\n $O(2^{n+1})$ $O()$ \n\n $O(n^3+2^{\\frac n8})$ $\\frac n8$  $2^{\\frac n8}$  $\\frac n8$ \n\n-  $2$  $2$ \n-  $2$  $3$ \n-  $3$  $2$ \n\n\n\n$s[a,a+k-1]\\&s[a+k,a+2k-1]\\&s[b,b+k-1]\\&s[b+k,b+2k-1]$\n\n $a,b,k$  $O(n^3)$ $O(n^3)$\n\n $12$  $41703$\n\n### CF1562E\n\n\n$$\ns[l_1,r_1],s[l_2,r_2],\\cdots,s[l_k,r_k]\n$$\n $l$ $r$  $l$ $r$ \n\n $l$ $r\\in[r_1,r_2]$ $r_2<n$$s[l,r_2]$  $s[l',r']$ $s[l,r_2+1]<s[l',r']$ $s[l,r_2]$  $s[l,r_2+1]$ $s[l,r_2]<s[l',r']\\le s[l,r_2+1]$\n$$\ns[l',l'+r_1-l]=s[l,r_1]\\\\\ns[l',l'+r_1+1-l]=s[l,r_1+1]\\\\\ns[l',l'+r_1+2-l]=s[l,r_1+2]\\\\\n\\cdots\\\\\ns[l',l'+r_2-l]=s[l,r_2]\n$$\n $l$ \n\n `DP`  $f_i$  $s[i,n]$ \n$$\nf_i=\\max_{j<i\\land s[j,n]<s[i,n]}f_j+n-\\text{lcp}(s[i,n],s[j,n])+1\n$$\n $\\text{lcp}(s[i,n],s[j,n])\\leftarrow \\text{lcp}(s[i+1,n],s[j+1,n])$ $O(n^2)$\n\n#### \n\n $O(n\\sqrt n)$\n\n `LCP`   `height` \n\n $SA$  `height` \n$$\nf_{SA_i}=\\max_{j<i \\land SA_j<SA_i}f_{SA_j}+\\max_{k=j+1}^in-height_k+1\n$$\n `height`  $\\max$ $(v,S)$ $(n-height_{i+1}+1,\\{i\\})$  $(v_1,S_1)$ $(v_2,S_2)$ $v_1\\ge v_2$ $(v_1,S_1\\cup S_2)$\n\n $i$  $f_{i+1}$ $(v,S)$ $\\max_{j \\in S\\land SA_j\\le SA_i}+v\\rightarrow f_{SA_{i+1}}$ $|S|\\le \\sqrt n$  $A$  $|S|>\\sqrt n$  $B$  $\\sqrt n$  $|S|>\\sqrt n$  $A$  $\\max$$B$  $\\sqrt n$  $\\max$\n\n\n\n-  $|S_1|+|S_2|\\le \\sqrt n$  $S_2$  $A$  $|S_2|$  $n\\sqrt n$ \n-  $|S_1|>\\sqrt n\\land |S_2|\\le \\sqrt n$  $B$  $|S_2|$  $n$ \n-  $|S_1|,|S_2|>\\sqrt n$  $|S_1|,|S_2|\\le \\sqrt n\\land |S_1|+|S_2|>\\sqrt n$  $|S_1|+|S_2|$  $B$ $\\sqrt n$ \n\n $A$  $O(1)$ $O(\\sqrt n)$ $B$  $O(\\sqrt n)$ $O(1)$  $O(n\\sqrt n)$\n\n $\\max$$A$  $B$ \n\n### CF1562F\n\n>  $n$  $A$ $\\text{lcm}$ $n+5000$  $A$\n>\n> $n\\le 10^5,A_i\\le 2\\cdot 10^5$\n\n $\\gcd(a,b)=1$ $\\text{lcm}(a,b)=ab$ $A$  $p$ $n-1$  $A$\n\n $p$  $p$  $\\text{lcm}(A_1,A_2),\\text{lcm}(A_2,A_3),\\text{lcm}(A_3,A_4),\\cdots,\\text{lcm}(A_{n-1},n)$ $p$ $p$  $n-1$  $A$ $2n-2$ $100<n\\le7500$\n\n $n\\le 100$  $n>7500$ \n\n$n\\le 100$  $\\text{lcm}$ $n>3$  $\\text{lcm}$  $\\text{lcm}$  $\\max A_i(\\max A_i-1)$ $A_i$ $n=3$ \n\n $n>7500$  $5000$  $A$  $p$ $450$  $p'$ \n\n $\\text{lcm}(A_i,A_j)$ $450$  $p,q$  $A_i,A_j$  $p,q$ $A_i$ $k$ $p\\not|\\text{lcm}(A_i,A_k)$  $A_i=p$ $q\\not|\\text{lcm}(A_j,A_k)$  $A_i=q$ $O(\\ln^2n)$\n\n\n$$\n\\text{lcm}(p',x)=\n\\begin{cases}\nx&(x|p')\\\\\nxp'&(x\\not|p')\n\\end{cases}\n$$\n $\\text{lcm}(p',x)>2\\cdot 10^5$  $x\\not|p'$ $x$  $n-900$  $p$  $p$ \n\n### AUOJ1760\n\n>  $n$ \n>\n> ****\n>\n> $n \\le 10^6$\n\n\n\n $m$ $A$\n$$\nA_{i,j}=\n\\begin{cases}\n-1 &( j  i )\\\\\n0 &( j  i )\\\\\n1 &( j  i )\n\\end{cases}\n$$\n\n\n$A_i\\ne \\{0,0,\\cdots, 0\\}$\n\n $B$\n$$\nB_i=\n\\begin{cases}\n-1 &( i )\\\\\n0 &( i )\\\\\n1 &( i )\n\\end{cases}\n$$\n $B$  $A_?$ \n\n $B$ $C$ $C=-B$ $B$  $C$  $A_i$ \n\n$\\forall i \\ne j, A_i\\ne A_j \\land A_i \\ne -A_j$\n\n\n\n$\\forall j\\in[1,m],\\sum_{i=1}^nA_{i,j}=0$\n\n $m$ $n$  $A$ \n\n$n$  $\\frac{3^m-1}2$$n$  $\\frac{3^m-1}2$\n\n$\\forall j\\in[1,m],\\sum_{i=1}^n|A_{i,j}|=3^{m-1}$\n\n> $m$  $n\\le \\frac{3^m-3}2$\n\n $m$ \n\n $3|n$  $\\text{next}(A)$  $A$ $-1\\rightarrow 0,0\\rightarrow 1,1\\rightarrow -1$$A,\\text{next}(A),\\text{next}(\\text{next}(A))$  $0$\n\n\n\n```plain\n1 0 -1 1\n-1 1 0 -1\n0 -1 1 0\n```\n\n $\\{-1,-1,\\cdots,-1\\}$  $\\{1,1,\\cdots,1\\}$ $\\frac {3^m-3}3$   $A$\n\n### \n\n $3\\not|n$ \n\n-  $\\sum_{j=1}^m|\\sum_{i=1}^nA_{i,j}|$ \n- \n- \n  -  $i$ $A_i$  $-A_i$\n  -  $i$ $B$  $B$  $-B$  $A$  $A_i=B$\n\n $n$ $n\\le 10^4$ \n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary>\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nusing ll = long long;\nusing lf = double;\n\nll gen(ll x) {\n    const ll k = 0x9ddfea08eb382d69ull;\n    rep(i, 1, 3) x *= k, x ^= x >> 47;\n    return x * k;\n}\nint rnd() {\n    static ll s = time(0);\n    return (s += gen(s)) & INT_MAX;\n}\nvoid wrt(int x, int ed) {\n    static streambuf* out = cout.rdbuf();\n    #define pc out -> sputc\n    static char c[11]; int sz = 0;\n    do c[++sz] = x % 10, x /= 10; while(x);\n    while(sz) pc(c[sz--] + 48);\n    pc(ed);\n}\nint n, m = 2, t = 9, nw[15], idx, A[2500000][15], c[15];\nvoid dfs(int i) {\n    if(i > m) {\n        rep(j, 2, 4) {\n            idx++;\n            rep(k, 1, m) A[idx][k] = (nw[k] + j) % 3 - 1;\n            if(idx == t) break;\n        }\n        return;\n    }\n    rep(j, -1, 1) {\n        nw[i] = j, dfs(i + 1);\n        if(idx == t) break;\n    }\n}\nint main() {\n    ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n    cin >> n;\n    while(t - 3 >> 1 < n) m++, t *= 3;\n    wrt(m, 10);\n    t = t - 1 >> 1, dfs(2);\n    rep(i, 1, n) rep(j, 1, m) c[j] += A[i][j];\n    int su = 0;\n    rep(i, 1, m) su += abs(c[i]);\n    while(su) {\n        int i = rnd() % n + 1;\n        if(rnd() % t < n) {\n            int d = 0;\n            rep(j, 1, m) d += abs(c[j] - 2 * A[i][j]);\n            if(d < su || rnd() % n < 10) {\n                su = d;\n                rep(j, 1, m) c[j] -= 2 * A[i][j], A[i][j] *= -1;\n            }\n        } else {\n            int k = rnd() % (t - n) + n + 1, d = 0;\n            rep(j, 1, m) d += abs(c[j] - A[i][j] + A[k][j]);\n            if(d < su || rnd() % n < 10) {\n                su = d;\n                rep(j, 1, m) c[j] -= A[i][j] - A[k][j], swap(A[i][j], A[k][j]);\n            }\n        }\n    }\n    rep(i, 1, n) {\n        int v = 0;\n        per(j, m, 1) v = v * 3 + A[i][j] + 1;\n        wrt(v, 32);\n    }\n}\n```\n</details>\n\n### \n\n\n\n-  $\\forall j\\in[1,m],|\\sum_{i=1}^nA_{i,j}|\\le 1$\n-  $j$ $\\sum_{i=1}^nA_{i,j}=-1$ $i$  $A_{i,j}<1$  $A_{i,j}$  $A_{i,j}$ \n\n $n$ $10^6$  $10$ \n\n $10^6$  $n$\n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary>\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nusing ll = long long;\n\nvoid wrt(int x, int ed) {\n    static streambuf* out = cout.rdbuf();\n    #define pc out -> sputc\n    static char c[11]; int sz = 0;\n    do c[++sz] = x % 10, x /= 10; while(x);\n    while(sz) pc(c[sz--] + 48);\n    pc(ed);\n}\nint n, m = 2, t = 9, nw[15], idx, A[1000005], c[15], as;\nbool vs[1600000];\nvoid dfs(int i) {\n    if(i) rep(j, -1, 1) { nw[i] = j, dfs(i - 1); if(idx == n) break; }\n    else rep(j, 1, 3) {\n        int x = 0;\n        per(k, m, 1) x = x * 3 + (j + nw[k]) % 3;\n        if(!x || vs[x] || idx == n) break;\n        A[++idx] = x, vs[x] = vs[t - x] = 1;\n        rep(k, 1, m) c[k] += (j + nw[k]) % 3 - 1;\n    }\n}\nint main() {\n    ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n    cin >> n;\n    while(t - 3 >> 1 < n) m++, t *= 3;\n    t--, vs[t / 2] = 1, wrt(m, 10), nw[m] = -1, dfs(m - 1);\n    if(n % 3) {\n        rep(i, 1, m) as += abs(c[i]);\n        int th = 1;\n        rep(j, 1, m) {\n            rep(i, 1, n) {\n                if(!c[j]) break;\n                int v = A[i] / th % 3;\n                auto Try = [&](int x) {\n                    int nw = A[i] + x * th;\n                    if(vs[nw]) return;\n                    vs[A[i]] = vs[t - A[i]] = 0, vs[nw] = vs[t - nw] = 1;\n                    as -= abs(c[j]), c[j] += x, v += x, as += abs(c[j]), A[i] = nw;\n                };\n                if(v < 2 && c[j] < 0) Try(1);\n                if(v > 0 && c[j] > 0) Try(-1);\n            }\n            th *= 3;\n        }\n    }\n    rep(i, 1, n) wrt(A[i], 32);\n}\n```\n</details>\n\n### \n\n $n$ \n\n-  $\\sum_{j=1}^m|\\sum_{i=1}^nA_{i,j}|$ \n\n- $A$ **** $m$ $\\{-1,0,1\\}$  $B$ $B$  $-B$  $A$  $B,\\text{next}(B),\\text{next}(\\text{next}(B))$  $A$  $n$  $\\forall j\\in[1,m],|\\sum_{i=1}^nA_{i,j}|\\le 1$\n\n-  $0$\n\n   $j$  $i$\n\n  -  $\\sum_{i=1}^nA_{i,j}=-1\\land A_{i,j}<1$ $A_{i,j}$ \n  -  $\\sum_{i=1}^nA_{i,j}=1$ $A_{i,j}=0$\n\n $10^6$  $n$\n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary>\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n\nusing namespace std;\nusing ll = long long;\n\nvoid wrt(int x, int ed) {\n    static streambuf* out = cout.rdbuf();\n    #define pc out -> sputc\n    static char c[11]; int sz = 0;\n    do c[++sz] = x % 10, x /= 10; while(x);\n    while(sz) pc(c[sz--] + 48);\n    pc(ed);\n}\nint n, m = 2, t = 9, nw[15], idx, A[797170], c[15], as;\nbool vs[1600000];\nvoid dfs(int i) {\n    if(i) per(j, 1, -1) { nw[i] = j, dfs(i - 1); if(idx == n) break; }\n    else rep(j, 1, 3) {\n        int x = 0;\n        per(k, m, 1) x = x * 3 + (j + nw[k]) % 3;\n        if(x == t || vs[x] || idx == n) break;\n        A[++idx] = x, vs[x] = vs[t - x] = 1;\n        rep(k, 1, m) c[k] += (j + nw[k]) % 3 - 1;\n    }\n}\nint main() {\n    ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n    cin >> n;\n    while(t - 3 >> 1 < n) m++, t *= 3;\n    t--, vs[t / 2] = 1, wrt(m, 10), nw[m] = 1, dfs(m - 1);\n    rep(i, 1, m) as += abs(c[i]);\n    while(as) {\n        int th = 1;\n        rep(j, 1, m) {\n            rep(i, 1, n) {\n                if(!c[j]) break;\n                int v = A[i] / th % 3;\n                auto Try = [&](int x) {\n                    int nw = A[i] + x * th;\n                    if(vs[nw]) return;\n                    vs[A[i]] = vs[t - A[i]] = 0, vs[nw] = vs[t - nw] = 1;\n                    as -= abs(c[j]), c[j] += x, v += x, as += abs(c[j]), A[i] = nw;\n                };\n                if(v < 2 && c[j] < 0) Try(1);\n                if(v > 0 && c[j] > 0) Try(-v);\n            }\n            th *= 3;\n        }\n    }\n    rep(i, 1, n) wrt(A[i], 32);\n}\n```\n</details>\n\n### AUOJ1761\n\n>  $n$  $A$  $1$  $m$  $B$ $0$ \n>\n> $A$  $0$ $A_i$  $i$ $j$  $A_i>B_{j\\bmod m}$ $A_i=B_{j\\bmod m}$\n>\n> $q$  $d_i$ \n>\n> $n,m,q\\le 3\\cdot 10^5,d_i\\le 3\\cdot 10^{12},t_i\\le 10^{18}$\n\n $d_i$  $A_i$ $m$\n\n>  $p$  $A_i$ $p+m$ \n\n $p-m$  $A_i$  $p$  $A_i=B_{p \\bmod m}$ $A_i$  $m$  $p$  $p+m$ \n\n $A_i$  $p_i$  $p_i,p_i+m,p_i+2m,pi+3m,\\cdots$   $m$\n\n $p_i$  $A$  $A_i$  $p_i$  $p_i$\n\n $pos$  $B$  $i$  $A_i$  $B_{pos}$  $T_i$ $p_i\\in[T_i-m+1,T_i]$ $p_i=T_i-m+k_i$$k_i$  $x$  $ix+(T_i-m)i>B_{pos+x}$ $[l,r]$  $\\min_{j=l}^rB_{pos+j}-ij$ $x$  $\\min_{j=1}^x\\{B_{pos+j}-ij\\}<(T_i-m)i$ $i$  $O(n\\log n)$ $p_i$\n\n $d$ $A_i$  $m$ $A_i$  $p_i\\bmod m$  $A_i$ $d\\bmod m$  $d\\bmod m<p_i\\bmod m$\n\n### CodeChef-btree\n\n>  $S(u,k)$  $u$  $k$ \n>\n>  $n$ $q$  $|S(u_1,k_1)\\cup S(u_2,k_2)\\cup S(u_3,k_3)\\cup \\cdots \\cup S(u_{m_i},k_{m_i})|$ \n>\n> $n,q\\le 5\\cdot 10^4,\\sum_{i=1}^qm_i\\le 5\\cdot 10^5$\n\n $|S(u,k)|$ \n\n#### Sol 1\n\n $u_1,u_2,u_3,\\cdots,u_{m_i}$  $0$\n\n $(u_1,k_1),(u_2,k_2)$  $k_1-\\text{dis}(u_1,u_2)>k_2$ $S(u_2,k_2)\\subsetneq S(u_1,k_1)$ $S(u_2,k_2)$  $k_2=k_1-\\text{dis}(u_1,u_2)$\n\n `Dijkstra`  `DP`\n\n $V$ $E$$u$  $r_u$ $\\sum_{u\\in V}|S(u,r_u)|-\\sum_{(u,v)\\in E}|S(u,r_u)\\cap S(v,r_v)|$ $S(u,r_u)$  $|S(u,r_u)|-|S(u,r_u)\\cap S(fa_u,r_{fa_u})|$\n\n$|S(u,r_u)|$ $|S(u,r_u)\\cap S(v,r_v)|$  $S(w,r)$ $w$ $w$ \n\n $O((n+m)\\log n)$\n\n#### Sol 2\n\n `bitset` \n\n $nq \\le 2.5\\cdot 10^9,n\\sum_{i=1}^qm_i\\le 2.5\\cdot 10^{10}$ $O(\\frac{n\\sum_{i=1}^qm_i}\\omega)$ $O(\\frac{nq}\\omega)$ \n\n $S(u,k)$  `bitset`  $O(\\frac n\\omega)$\n\n $S(u,k)$  $O(\\log n)$  $d$  $d$  $S(u,k)$  $O(\\frac{n\\log n}\\omega)$  $O(\\log n)$  $n,\\frac n2,\\frac n4,\\frac n8,\\cdots$ $2n$  $[1,n]$ `DFS`  $n,\\frac n2,\\frac n4,\\frac n8,\\cdots$ $O(\\frac n\\omega)$\n\n `bitset` `bitset`  `bitset`  `popcount` `unsigned long long`  `bitset``popcount`  $[0,65536)$  `popcount` `unsigned long long`  $[0,65536)$ \n\n Sol 1 \n\n### URAL2118\n\n>  $k$  $01$ \n>\n>  $s$ $01$  $S$ $S$  $-1$\n>\n> $k \\le 52, n\\le 10^6$\n\n\n\n-  $0$ $1$ $S$ \n-  $0$ $1$ $|S|$\n\n $0$  $1$  $1$  $0$ $0$  $1$\n\n $1$  $0$ \n\n $1$ $1$ \n\n $0$ $T$ $T$  $1$ $T$  ****  $x$  $0$ $y$  $1$ $y+1$ $x$  $0$  $T$ $T$  $1$ \n\n $T$  $y$  $1$ $y+1$ $y$ $T'$  $y$  $T'$  $1$  $|T|\\ge |T'|$ $y$  $T'$  $1$  $T=T'0+T'$$y$ \n\n $T'$ $T'$  $T'$  $suffix(i)$  $S$  $i$  $suffix(1),suffix(2),suffix(3),\\cdots$ `AC` \n\n $O(nk)$\n\n### Graph Subpaths\n\n> \n>\n>  $n$  $m$  $k$  $l_i$ $k$ \n>\n>  $i \\in [2,n]$ $1\\rightarrow i$ \n>\n> $n,m,\\sum_{i=1}^kl_i \\le 10^5$\n\n### Sol 1\n\n $i\\rightarrow 1$ \n\n $(u,v)$ $v$ $T_i$  $i\\rightarrow 1$  `trie` $T_u$ $(u,v)$$T_v$  $T_v$  $u$  $T_u$ $u$  $T_u$ \n\n $T_u$  `trie` $(u,v)$ $T_u$  $T_v$  $T_v$\n\n $O(n^2)$\n\n $O(n\\log n)$ \n\n $O(n\\log n)$\n\n### Sol 2\n\n `AC`  $O(n^2)$  `DP` $f_{i,u}$  $i$`AC`  `u` `AC` \n\n `AC`  `DP`  $f_u$ \n\n `AC`  $O(n\\log n)$\n\n### ZOJ3390\n\n>  $T_1,T_2$ $T_1+T_2$ $T_1\\cdot T_2$  $T_1$  $T_2$$T_1=T_2$ \n>\n>  $A,B,C$ $X,Y$  $AX+BY=C$\n>\n> $|A|,|B|,|C| \\le 10^5$\n\n $height(T)$  $T$ \n\n $height(T_1+T_2)=\\max(height(T_1),height(T_2)),height(T_1\\cdot T_2)=height(T_1)+height(T_2)$\n\n $\\max(height(A)+height(X),height(B)+height(Y))=height(C)$ $height(A)+height(X)=height(C)$\n\n $height(X)$ $X$ $u$  $C$  $height(X)$  $u$  $X$ $AX$ $BY$ $Y$ \n\n $BY$ \n\n\n$$\nf_u=1+\\sum_{v\\in son(u)}f_v\\cdot \\text{prime}(size_v)\n$$\n $\\text{prime}(i)$  $i$ \n\n**** $T_1,T_2$$f_{T_1}=f_{T_2}$ \n\n`Generator`  $T,A,B,C,D$  $A,X,B,Y$ \n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary>\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define fi first \n#define se second\n#define all(x) (x).begin(), (x).end()\n#define SZ(x) int((x).size())\n#define mid ((l + r) / 2)\n#define lc o * 2\n#define rc o * 2 + 1\n#define lch l, mid, lc\n#define rch mid + 1, r, rc\n#define cmi(a, b) (a = min(a, b))\n#define cma(a, b) (a = max(a, b))\n#define lb lower_bound\n#define ub upper_bound\n#define bs binary_search\n#define pop __builtin_popcount\n#define llpop __builtin_popcountll\n#define ctz __builtin_ctz\n#define llctz __builtin_ctzll\n#define clz __builtin_clz\n#define llclz __builtin_clzll\n#define par __builtin_parity\n#define llpar __builtin_parityll\n\nusing namespace std;\nusing ll = long long;\nusing lf = double;\n// using P = pair<int, int>;\nusing V = vector<int>;\n// using cmp = complex<lf>;\n\nll gen(ll x) {\n    const ll k = 0x9ddfea08eb382d69ull;\n    rep(i, 1, 3) x *= k, x ^= x >> 47;\n    return x * k;\n}\nint rnd() {\n    static ll s = time(0) + (ll)new char;\n    return (s += gen(s)) & INT_MAX;\n}\nV tmul(V a, V b) {\n    int n = a.size() - 1, m = b.size() - 1, su = n;\n    rep(i, 1, n) {\n        rep(j, 2, m) a.pb(b[j] == 1 ? i : b[j] + su - 1);\n        su += m - 1;\n    }\n    return a;\n}\nV tplus(V a, V b) {\n    int n = a.size() - 1, m = b.size() - 1;\n    rep(j, 2, m) a.pb(b[j] == 1 ? 1 : b[j] + n - 1);\n    return a;\n}\nconst int N = 5, A = 5, B = 5, C = 5, D = 5;\nint main() {\n    const int T = 100000;\n    printf(\"%d\\n\", T);\n    rep(kase, 1, T) {\n        int a = rnd() % A + 1, b = rnd() % B + 1, c = rnd() % C + 1, d = rnd() % D + 1;\n        V t1{0}, t2{0}, t3{0}, t4{0};\n        auto get = [](V& t, int n) { rep(i, 1, n) t.pb(i > 1 ? rnd() % (i - 1) + 1 : 0); };\n        get(t1, a), get(t2, b), get(t3, c), get(t4, d);\n        V t5 = tplus(tmul(t1, t2), tmul(t3, t4));\n        printf(\"%d %d %llu\\n\", a, c, t5.size() - 1);\n        auto prt = [](V& v) { For(i, 1, v.size()) printf(\"%d \", v[i]); puts(\"\"); };\n        prt(t1), prt(t3), prt(t5);\n    }\n}\n```\n</details>\n\n`Special judge` `checker.cpp``checker <input-file> <output-file>` $0$ $1$\n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary>\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define fi first \n#define se second\n#define all(x) (x).begin(), (x).end()\n#define SZ(x) int((x).size())\n#define mid ((l + r) / 2)\n#define lc o * 2\n#define rc o * 2 + 1\n#define lch l, mid, lc\n#define rch mid + 1, r, rc\n#define cmi(a, b) (a = min(a, b))\n#define cma(a, b) (a = max(a, b))\n#define lb lower_bound\n#define ub upper_bound\n#define bs binary_search\n#define pop __builtin_popcount\n#define llpop __builtin_popcountll\n#define ctz __builtin_ctz\n#define llctz __builtin_ctzll\n#define clz __builtin_clz\n#define llclz __builtin_clzll\n#define par __builtin_parity\n#define llpar __builtin_parityll\n\nusing namespace std;\nusing ll = long long;\nusing lf = double;\nusing P = pair<int, int>;\nusing V = vector<int>;\n// using cmp = complex<lf>;\n\nconst int N = 1e5 + 5, M = 1299709;\nint f[M + 5], pid, prm[N];\n\nV tmul(V a, V b) {\n    int n = a.size() - 1, m = b.size() - 1, su = n;\n    rep(i, 1, n) {\n        rep(j, 2, m) a.pb(b[j] == 1 ? i : b[j] + su - 1);\n        su += m - 1;\n    }\n    return a;\n}\nV tplus(V a, V b) {\n    int n = a.size() - 1, m = b.size() - 1;\n    rep(j, 2, m) a.pb(b[j] == 1 ? 1 : b[j] + n - 1);\n    return a;\n}\n\nP dfs(int u, const V G[]) {\n    P re(1, 1);\n    for(int v : G[u]) {\n        auto [h, sz] = dfs(v, G);\n        re.fi = (re.fi + (ll)h * prm[sz]) % 999999937;\n        re.se += sz;\n    }\n    return re;\n}\nint Hash(const V& t) {\n    vector<int> G[N];\n    For(i, 1, t.size()) G[t[i]].pb(i);\n    return dfs(1, G).fi;\n}\nint read(FILE* f) { int x; return fscanf(f, \"%d\", &x) == 1 ? x : -1; }\n\nint main(int argc, char* argv[]) {\n    rep(i, 2, M) {\n        if(!f[i]) prm[++pid] = i;\n        for(int j = 1; i * prm[j] <= M; j++) {\n            f[i * prm[j]] = 1;\n            if(i % prm[j] == 0) break;\n        }\n    }\n    FILE *in = fopen(argv[1], \"r\"), *out = fopen(argv[2], \"r\");\n    for(int T = read(in); T--;) {\n        V t1{0}, t2{0}, t3{0}, t4{0}, t5{0};\n        auto get = [](FILE* f, V& t, int n) { rep(i, 1, n) t.pb(read(f)); };\n        int a = read(in), b = read(in), c = read(in);\n        get(in, t1, a), get(in, t3, b), get(in, t5, c);\n        int d = read(out), e = read(out);\n        auto err = [&]() {\n            printf(\"1\\n%d %d %d\\n\", a, b, c);\n            rep(i, 1, a) printf(\"%d \", t1[i]); puts(\"\");\n            rep(i, 1, b) printf(\"%d \", t3[i]); puts(\"\");\n            rep(i, 1, c) printf(\"%d \", t5[i]);\n            exit(1);\n        };\n        if(!~d) err();\n        get(out, t2, d), get(out, t4, e);\n        if((ll)a * d + (ll)b * e != c && Hash(tplus(tmul(t1, t2), tmul(t3, t4))) != Hash(t5)) err();\n    }\n}\n```\n</details>\n\n### IZhO 2020 D1T3\n\n> [](codeforces.com/group/Uo1lq8ZyWf/contest/265564)\n>\n>  $n$  $A$ $(i,j,k)$  $i\\le j<k$  $[i,j]$  $[j+1,k]$ \n>\n> $n \\le 2\\cdot 10^5$\n\n $prev_i$  $A_i$ $next_i$  $A_i$ \n\n $(i,j,k)$ \n\n-  $[j+1,k]$  $[i,j]$  $i \\le \\min prev_{j+1\\cdots i}$ $i$  $R_{j,k}=\\min prev_{j+1\\cdots k}$\n-  $[i,j]$  $[j+1,k]$  $\\max next_{i\\cdots j}\\le k$ $i$  $L_{j,k}$ $L_{j,k}$  $i$  $\\max next_{i\\cdots j}\\le k$\n\n $(j,k)$  $\\max(R_{j,k}-L_{j,k}+1,0)$ $k$ $\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)$\n\n $L_{j,k}$  $R_{j,k}$ \n\n $R_{j,k}=\\min prev_{j+1\\cdots k}$ $prev$  $\\min$ $k\\rightarrow k+1$ $R_{j,k}$  $prev_{k+1}$\n\n $L_{j,k}$ $k\\rightarrow k+1$  $j$$L_{j,k}$  $k$ $\\max next_{i\\cdots j}$  $next$  $\\max$ $next_{1\\cdots j}$  $next_{i_1},next_{i_2},next_{i_3},\\cdots,next_{i_k}$\n\n-  $k\\in[j+1,next_{i_k}-1]$ $L_{j,k}=\\infty$\n-  $k\\in [next_{i_k},next_{i_{k-1}-1}]$$L_{j,k}=i_{k-1}+1$\n- $\\cdots$\n-  $k\\in [next_{i_1},n]$$L_{j,k}=1$\n\n $i_x$  $k\\in [next_{i_x},next_{i_{x-1}}-1]$$L_{j,k}=i_{x-1}+1$ $next_y$  $next_{i_x}$  $j\\in [i_x,y-1],k\\in [next_{i_x},next_{i_{x-1}}-1]$ $L_{j,k}=i_{x-1}+1$ $k$  $next_{i_x}-1\\rightarrow next_{i_x}$  $L_{i_x\\cdots y-1,k}$  \n$i_x+1$ $n$  $L_{j,k}$\n\n $\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)$ $L_{j,k}$  $R_{j,k}$  $k$  $R_{l\\cdots r,k}$  $v$ $v \\le \\min L_{l\\cdots r,k}$ $0$ $v \\ge \\max L_{l\\cdots r,k}$ $\\sum_{j=l}^rR_{j,k}-\\sum_{j=l}^rL_{j,k}+(r-l+1)$ $x$ $\\forall j \\in[l,x], v\\ge L_{j,k},\\forall j\\in[x+1,r],v\\le L_{j,k}$ $L_{j,k},R_{j,k}$  $\\min,\\max$  $sum$  $\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)$ \n\n $x$ $L_{ql\\cdots qr,k}$  $v$ $[l,r]$ $ql\\le l\\land r \\le qr$  $ql\\le l\\land r \\le qr \\land (v \\le \\min L_{l\\cdots r,k}\\lor v \\ge \\max L_{l\\cdots r,k})$  $\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)$\n\n $O(n\\log n)$\n\n<details><summary><span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span></summary>\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n#define pb push_back\n#define eb emplace_back\n#define mid ((l + r) / 2)\n#define lc o * 2\n#define rc o * 2 + 1\n#define lch l, mid, lc\n#define rch mid + 1, r, rc\n\nusing namespace std;\nusing ll = long long;\n\nconst int N = 2e5 + 5;\n\nint n, a[N], pre[N], nxt[N], L[N];\nvector<tuple<int, int, int>> vl[N], vr[N];\nint tagL[N * 4], minL[N * 4], maxL[N * 4];\nint tagR[N * 4], minR[N * 4], maxR[N * 4];\nll sum[N * 4], sumL[N * 4], sumR[N * 4], as;\n\nvoid pushUp(int o) {\n    sum[o] = sum[lc] + sum[rc];\n    sumL[o] = sumL[lc] + sumL[rc];\n    sumR[o] = sumR[lc] + sumR[rc];\n    minL[o] = min(minL[lc], minL[rc]);\n    minR[o] = min(minR[lc], minR[rc]);\n    maxL[o] = max(maxL[lc], maxL[rc]);\n    maxR[o] = max(maxR[lc], maxR[rc]);\n}\nvoid pushL(int v, int l, int r, int o) {\n    tagL[o] = minL[o] = maxL[o] = v, sumL[o] = v * (r - l + 1ll);\n    sum[o] = max(sumR[o] - sumL[o], 0ll);\n}\nvoid pushR(int v, int l, int r, int o) {\n    tagR[o] = minR[o] = maxR[o] = v, sumR[o] = v * (r - l + 1ll);\n    sum[o] = max(sumR[o] - sumL[o], 0ll);\n}\nvoid pushDown(int l, int r, int o) {\n    if(~tagL[o]) pushL(tagL[o], lch), pushL(tagL[o], rch), tagL[o] = -1;\n    if(~tagR[o]) pushR(tagR[o], lch), pushR(tagR[o], rch), tagR[o] = -1;\n}\nvoid updL(int L, int R, int v, int l, int r, int o) {\n    if(L <= l && r <= R && (v <= minR[o] || v >= maxR[o])) return pushL(v, l, r, o);\n    pushDown(l, r, o);\n    if(L <= mid) updL(L, R, v, lch);\n    if(R > mid) updL(L, R, v, rch);\n    pushUp(o);\n}\nvoid updR(int L, int R, int v, int l, int r, int o) {\n    if(L <= l && r <= R && (v >= maxL[o] || v <= minL[o])) return pushR(v, l, r, o);\n    pushDown(l, r, o);\n    if(L <= mid) updR(L, R, v, lch);\n    if(R > mid) updR(L, R, v, rch);\n    pushUp(o);\n}\nint main() {\n    cin >> n;\n    rep(i, 1, n) scanf(\"%d\", &a[i]);\n    rep(i, 1, n) L[i] = 0;\n    rep(i, 1, n) pre[i] = L[a[i]], L[a[i]] = i;\n    rep(i, 1, n) L[i] = n + 1;\n    per(i, n, 1) nxt[i] = L[a[i]], L[a[i]] = i;\n    rep(i, 2, n) {\n        int& j = L[i] = i - 1;\n        for(; j && pre[j] >= pre[i]; j = L[j]);\n        vr[i].eb(max(j, 1), i - 1, pre[i]);\n    }\n    rep(i, 2, n) {\n        int& j = L[i] = i - 1;\n        for(; j && nxt[j] <= nxt[i]; j = L[j])\n            vl[nxt[j]].eb(max(j, 1), i - 1, L[j]);\n    }\n    mem(tagL, 63), mem(tagR, -1);\n    rep(i, 1, n) {\n        for(auto [l, r, v] : vl[i]) updL(l, r, v, 1, n, 1);\n        for(auto [l, r, v] : vr[i]) updR(l, r, v, 1, n, 1);\n        as += sum[1];\n    }\n    cout << as;\n}\n```\n</details>\n\n### CF566C\n\n>  $n$  $w_i$  $u$  $v$  $1.5$ \n>\n>  $f(u)$  $u$  $f(u)$ \n>\n> $n \\le 2\\cdot 10^5$\n\n $f(u)$  $f(u)$  $f(u)$ \n\n $w_v\\text{dis}^{1.5}_v(u)$ \n\n $[l,r]$  $\\frac {l+r}2$  $\\frac {l+r}2$ \n\n\n\n $f(u)$ $u$  $f(u)$  $0$ $(u,v)$ $f(u)$  $(u,v)$  $v$  $u$ \n\n $u$  $v$ \n$$\n\\frac 32\\left(\\sum_{i=1}^nw_i\\sqrt{\\text{dis}(i,u)}-2\\sum_{i\\in \\text{subree}(v)}w_i\\sqrt{\\text{dis}(i,u)}\\right)\n$$\n $O(n)$  $u$  $O(n\\log n)$\n\n","slug":"problems","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh45007qootn3an141oa","content":"<p></p>\r\n<h3 id=\"tc13459\">TC13459</h3>\r\n<p>1 1 1</p>\r\n<p> <span class=\"math inline\">\\((i,j),(i,k)\\)</span> <span class=\"math inline\">\\((j,k)\\)</span>  <span class=\"math inline\">\\((i,j)\\)</span>  <span class=\"math inline\">\\((i,k)\\)</span> </p>\r\n<p></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math display\">\\[\r\n\\sum_{i=0}^x\\binom xi2^yn^{\\underline{i+y}}n^{\\underline{x-i+y}}\r\n\\]</span>  <span class=\"math inline\">\\(O(n^3)\\)</span>DFS  <span class=\"math inline\">\\(O(n^3\\alpha(n^2))\\)</span></p>\r\n<h3 id=\"tc12909\">TC12909</h3>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(f_{i,j}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i+1\\)</span> <span class=\"math inline\">\\(f_{i+1,j+1} \\leftarrow j \\cdot f_{i,j}\\)</span></li>\r\n<li> <span class=\"math inline\">\\(i+1\\)</span> <span class=\"math inline\">\\(f_{i+1,j} \\leftarrow 2j \\cdot f_{i,j}\\)</span></li>\r\n<li> <span class=\"math inline\">\\(i+1\\)</span> <span class=\"math inline\">\\(f_{i+1,j-1} \\leftarrow j \\cdot f_{i,j}\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(j \\le G\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(N\\binom{N-K-1}{K-1}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(N^2)\\)</span></p>\r\n<h3 id=\"tc13692\">TC13692</h3>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(S_1-S_2\\)</span>  <span class=\"math inline\">\\(u\\)</span> <span class=\"math inline\">\\(f_u\\)</span> <span class=\"math inline\">\\(u=S_1\\)</span>  <span class=\"math inline\">\\(S_2\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S_1-S_2\\)</span>  <span class=\"math inline\">\\(f\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(S_1-S_2\\)</span>  <span class=\"math inline\">\\((u,v)\\)</span> <span class=\"math inline\">\\((u,v)\\)</span> <span class=\"math inline\">\\(O(n)\\)</span>  <span class=\"math inline\">\\(f_u+f_v\\)</span></p>\r\n<p> <span class=\"math inline\">\\(f_{S_1}+f_{S_2}\\)</span> </p>\r\n<h3 id=\"agc017f\">AGC017F</h3>\r\n<p><span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(2^{N-1}\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(S,T\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(S\\)</span> </p>\r\n<p> <code>DP</code> <span class=\"math inline\">\\(f_{i,j,k,S}\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span> </li>\r\n<li><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(N-1-j\\)</span>  <span class=\"math inline\">\\(i-1\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i-1\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(k\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j+1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^32^n)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S,T\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(T\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(1\\)</span> </p></li>\r\n<li><p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(1\\)</span></p></li>\r\n</ul>\r\n<p> <code>DP</code>  <span class=\"math inline\">\\(f_{i,j,S}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(j+1\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(O(1)\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(O(1)\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n^22^n)\\)</span></p>\r\n<h3 id=\"arc078d\">ARC078D</h3>\r\n<p> <span class=\"math inline\">\\(1-n\\)</span> </p>\r\n<ul>\r\n<li></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(u_1,u_2,\\cdots,u_k\\)</span><span class=\"math inline\">\\(u_1=1,u_k=n\\)</span> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(u_k\\)</span></p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(g_S\\)</span>  <span class=\"math inline\">\\(S\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(f_S\\)</span>  <span class=\"math inline\">\\(S\\)</span> </li>\r\n<li><span class=\"math inline\">\\(f_S \\leftarrow f_{S-T} + g_T({T \\subseteq S})\\)</span> <span class=\"math inline\">\\(T\\)</span> </li>\r\n</ul>\r\n<p> <code>DP</code> </p>\r\n<p> <span class=\"math inline\">\\(f_{i,S}\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(1-i\\)</span> </p>\r\n<p>:</p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(f_{i,S \\cup \\{i\\}} \\leftarrow f_{j,S} + w(j,i)(j \\not\\in S)\\)</span></li>\r\n<li><span class=\"math inline\">\\(f_{i,S\\cup T} \\leftarrow f_{i,S}+g_{T\\cup\\{i\\}}(S \\cap T = \\varnothing)\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n3^n)\\)</span></p>\r\n<p>ARC068D</p>\r\n<p>AGC004F</p>\r\n<p>ARC097D</p>\r\n<p>TC10265</p>\r\n<p>TC9844</p>\r\n<p>ARC067C</p>\r\n<p>ARC097C</p>\r\n<h3 id=\"tc10727\">TC10727</h3>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(k\\)</span> </li>\r\n</ul>\r\n<p> <code>DP</code> <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(\\text{dis}(x,\\text{lca}(x,v)),\\text{dis}(v,\\text{lca}(x,v))\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(f_{i,j,k}\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(\\text{dis}(x,\\text{lca}(x,v))=j,\\text{dis}(v,\\text{lca}(x,v))=k\\)</span> </p>\r\n<p></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(f_{i+1,j+1,k} \\leftarrow 2f_{i,j,k},f_{i+1,j-1,k} \\leftarrow f_{i,j,k}(j&gt;0)\\)</span></li>\r\n<li><span class=\"math inline\">\\(f_{i+1,1,k} \\leftarrow f_{i,0,k},f_{i+1,\\max(1-k,0),\\max(k-1,0)} \\leftarrow f_{i,0,k}(k&gt;0)\\)</span></li>\r\n<li><span class=\"math inline\">\\(f_{i+1,0,k+1} \\leftarrow f_{i,0,k}(k &lt; \\text{depth}_v)\\)</span></li>\r\n</ul>\r\n<p>TC10664</p>\r\n<p>TC10566</p>\r\n<p>TC10773</p>\r\n<h3 id=\"tc10993\">TC10993</h3>\r\n<p> <span class=\"math inline\">\\(0\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(C\\)</span>  <span class=\"math inline\">\\(C\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(C\\)</span>  <span class=\"math inline\">\\(C\\)</span>  <span class=\"math inline\">\\(\\min  + \\min  \\ge C\\)</span></p>\r\n<p> <code>DP</code> <span class=\"math inline\">\\(f_{i,j}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(\\min\\)</span>  <span class=\"math inline\">\\(j\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(i+1\\)</span>  <span class=\"math inline\">\\(k\\)</span><span class=\"math inline\">\\(f_{i+1,\\min(j,k)} \\leftarrow f_{i,j}(j+k \\ge C)\\)</span> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(i+1\\)</span>  <span class=\"math inline\">\\(i+1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(nC^2)\\)</span></p>\r\n<p></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(f_{i+1,j} \\leftarrow f_{i,j}(k \\ge \\max(j,C-j))\\)</span> <span class=\"math inline\">\\(k\\)</span></li>\r\n<li><span class=\"math inline\">\\(f_{i+1,k} \\leftarrow f_{i,j}(k \\le j \\le C -k)\\)</span> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(O(1)\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(nC)\\)</span></p>\r\n<p>TC10741</p>\r\n<p>TC10854</p>\r\n<p>TC10848</p>\r\n<p>TC10902</p>\r\n<p>TC10737</p>\r\n<p>TC10758</p>\r\n<p>TC11003</p>\r\n<p>TC11026</p>\r\n<p>TC11032</p>\r\n<p>TC10748</p>\r\n<p>TC11213</p>\r\n<p>TC11305</p>\r\n<p>TC12620</p>\r\n<p>TC10758</p>\r\n<p>TC11032</p>\r\n<h3 id=\"gym102391e\">Gym102391E</h3>\r\n<p> <span class=\"math inline\">\\(D\\)</span> <span class=\"math inline\">\\(f_u\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(u\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(D\\)</span></li>\r\n<li><span class=\"math inline\">\\(f_u\\)</span>  <span class=\"math inline\">\\(u\\)</span>/ <span class=\"math inline\">\\(fa_u\\)</span></li>\r\n</ul>\r\n<p></p>\r\n<ul>\r\n<li><p><span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(f\\)</span>  <span class=\"math inline\">\\(D\\)</span> <span class=\"math inline\">\\(D\\)</span>  <span class=\"math inline\">\\(D\\)</span>  <code>DP</code> <span class=\"math inline\">\\(f\\)</span> </p></li>\r\n<li><p><span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(fa\\)</span>  <span class=\"math inline\">\\(u\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(+f_v\\)</span></li>\r\n<li> <span class=\"math inline\">\\(v_1,v_2\\)</span>  <span class=\"math inline\">\\(+f_{v_1}+f_{v_2}\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(D\\)</span></p>\r\n<p><span class=\"math inline\">\\(f_u \\leftarrow \\max\\limits_vf_v+\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(fa\\)</span> </p>\r\n<p><span class=\"math inline\">\\(f_u \\leftarrow\\)</span>  <span class=\"math inline\">\\(fa\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(^2)\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(fa\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(fa\\)</span>  <span class=\"math inline\">\\(i\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(fa\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span> </li>\r\n</ul></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n\\log V)\\)</span></p>\r\n<h3 id=\"zoj3970\">ZOJ3970</h3>\r\n<p></p>\r\n<ul>\r\n<li></li>\r\n<li></li>\r\n</ul>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(a_i\\)</span>  <span class=\"math inline\">\\(\\sum_{i=2}^n\\max(0,a_i-a_{i-1})\\)</span></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(pre_i\\)</span>  <span class=\"math inline\">\\(t_j&gt;0\\)</span>  <span class=\"math inline\">\\(j\\)</span></p>\r\n<p><span class=\"math inline\">\\(f_{i,j}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span> </p>\r\n<p></p>\r\n<p><span class=\"math display\">\\[\r\nf_{i,j}=\\min_kf_{pre_i,k}+\\max(0,j-k)+\\max(0,t_i-s_i+j-t_{pre_i}+s_{pre_i}-k)+\\max(0,\\max_{pre_i&lt;x&lt;i}s_x-\\max(j,k))\r\n\\]</span></p>\r\n<p> <span class=\"math inline\">\\((pre_i,i)\\)</span>  <span class=\"math inline\">\\(0\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(nV^2)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(f_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\min\\)</span>  <span class=\"math inline\">\\(O(1)\\)</span>  <span class=\"math inline\">\\(f_{i,j}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(f_i\\)</span>  <span class=\"math inline\">\\([l,r]\\)</span> <span class=\"math inline\">\\(f_{i,l},f_{i,mid},f_{i,r}\\)</span>  <span class=\"math inline\">\\([l,r]\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n\\log V)\\)</span></p>\r\n<h3 id=\"zoj3989\">ZOJ3989</h3>\r\n<p></p>\r\n<p></p>\r\n<ul>\r\n<li></li>\r\n<li></li>\r\n<li></li>\r\n<li></li>\r\n</ul>\r\n<p> <code>DP</code> </p>\r\n<p></p>\r\n<p></p>\r\n<ul>\r\n<li></li>\r\n<li> <span class=\"math inline\">\\([l,r]\\)</span> <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(l &lt; x &lt; r\\)</span> <span class=\"math inline\">\\(x &gt; r\\)</span></li>\r\n<li></li>\r\n<li></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(2^{n-2}\\)</span></p>\r\n<p></p>\r\n<p></p>\r\n<p></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(f_{S,i}\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^22^n)\\)</span></p>\r\n<h3 id=\"\"></h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(f(S)\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S \\ne \\{1,2,\\cdots,n\\}\\)</span> <span class=\"math inline\">\\(|f(S)| \\le |S|\\)</span></p>\r\n<p><span class=\"math inline\">\\(n, m \\le 10^5\\)</span></p>\r\n</blockquote>\r\n<p>Hall  <span class=\"math inline\">\\(S\\)</span><span class=\"math inline\">\\(|f(S)| \\ge |S|\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(|f(S)| \\le |S|\\)</span> <span class=\"math inline\">\\(S\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(f(S)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\(\\text{match}(v)\\)</span></p>\r\n<p> <span class=\"math inline\">\\((u,v)\\)</span>  <span class=\"math inline\">\\((u,\\text{match}(v))\\)</span> </p>\r\n<h3 id=\"arc107f\">ARC107F</h3>\r\n<p></p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(-B_i,A_i,B_i\\)</span></li>\r\n<li> <span class=\"math inline\">\\(u,v\\)</span></li>\r\n<li></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(U_i,V_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\((S,U_i),(U_i,V_i),(V_i,T)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\infty-B_i,\\infty+A_i,\\infty+B_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\((i,j)\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\((S,U_i),(V_j,T)\\)</span> <span class=\"math inline\">\\((S,U_i)\\)</span> <span class=\"math inline\">\\(U_i\\)</span>  <span class=\"math inline\">\\(T\\)</span> <span class=\"math inline\">\\((V_j,T)\\)</span> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(V_j\\)</span> <span class=\"math inline\">\\((V_j,U_i)\\)</span> <span class=\"math inline\">\\(\\infty^2\\)</span> </li>\r\n<li> <span class=\"math inline\">\\((S,U_j),(V_i,T)\\)</span> <span class=\"math inline\">\\((V_i,U_j)\\)</span> <span class=\"math inline\">\\(\\infty^2\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(n\\infty\\)</span></p>\r\n<figure>\r\n<img src=\"https://i.loli.net/2021/09/08/4ragjEUYIev5wot.png\" alt=\".png\" /><figcaption aria-hidden=\"true\">.png</figcaption>\r\n</figure>\r\n<h3 id=\"gym101471j\">Gym101471J</h3>\r\n<p>CF1307G</p>\r\n<h3 id=\"cf1307f\">CF1307F</h3>\r\n<p>P3980</p>\r\n<p>CF1368H2</p>\r\n<h3 id=\"agc038e\">AGC038E</h3>\r\n<p><span class=\"math inline\">\\(B_i=1\\)</span> </p>\r\n<p> <code>DP</code>  <code>min-max</code> </p>\r\n<p> <span class=\"math inline\">\\(O(n2^n)\\)</span>  <span class=\"math inline\">\\(O(2^n)\\)</span>  <span class=\"math inline\">\\(400\\)</span></p>\r\n<p> <code>min-max</code>  <span class=\"math display\">\\[\r\n\\sum_{S}(-1)^{|S|}\\frac{\\sum_{i=1}^n A_i}{\\sum_{i \\in S} A_i}\r\n\\]</span>  <span class=\"math inline\">\\(400\\)</span>  <span class=\"math inline\">\\(\\sum_S(-1)^{|S|}\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\nf_{i,j} = \\sum_{S \\subseteq \\{1,2,\\cdots,i\\}}(-1)^{|S|}[\\sum_{i \\in S}A_i=j]\r\n\\]</span>  <span class=\"math inline\">\\(f_{i,j}=f_{i-1,j}-f_{i-1,j-A_i}\\)</span> <span class=\"math display\">\\[\r\n(\\sum_{i=1}^n A_i)\\sum_{i=0}^{400}\\frac{f_{n,i}}i\r\n\\]</span>  <code>min-max</code>  <span class=\"math display\">\\[\r\n\\sum_{S}(-1)^{|S|}[S ]\r\n\\]</span></p>\r\n<p> <span class=\"math inline\">\\(p_i=\\frac{A_i}{\\sum_{j \\in S}A_j}\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;\\sum_{\\forall i \\in S,c_i&lt;B_i}[c]\\cdot[c]\\\\\r\n&amp;=\\sum_{\\forall i \\in S,c_i&lt;B_i}\\frac{(\\sum_{i \\in S}c_i)!}{\\prod_{i \\in S} c_i!}\\prod_{i \\in S}p_i^{c_i} \\cdot \\frac{\\sum_{i=1}^n A_i}{\\sum_{i \\in S} A_i}\\\\\r\n&amp;=\\sum_{\\forall i \\in S,c_i&lt;B_i}\\frac{(\\sum_{i \\in S}c_i)!}{\\prod_{i \\in S} c_i!}\\prod_{i \\in S}A_i^{c_i} \\cdot \\frac{\\sum_{i=1}^n A_i}{(\\sum_{i \\in S} A_i)^{(\\sum_{i \\in S}c_i)+1}}\r\n\\end{aligned}\r\n\\]</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;\\sum_S(-1)^{|S|}\\sum_{\\forall i \\in S,c_i&lt;B_i}\\frac{(\\sum_{i \\in S}c_i)!}{\\prod_{i \\in S} c_i!}\\prod_{i \\in S}A_i^{c_i} \\cdot \\frac{\\sum_{i=1}^n A_i}{(\\sum_{i \\in S} A_i)^{(\\sum_{i \\in S}c_i)+1}}\\\\\r\n&amp;=(\\sum_{i=1}^n A_i)\\sum_S(-1)^{|S|}\\sum_{\\forall i \\in S,c_i&lt;B_i}\\frac{(\\sum_{i \\in S}c_i)!}{(\\sum_{i \\in S} A_i)^{(\\sum_{i \\in S}c_i)+1}} \\cdot \\prod_{i \\in S}\\frac{A_i^{c_i}}{c_i!}\r\n\\end{aligned}\r\n\\]</span></p>\r\n<p> <span class=\"math inline\">\\(\\sum_{i \\in S} A_i\\)</span>  <span class=\"math inline\">\\(\\sum_{i \\in S}c_i\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\nf_{i,j,k}=\\sum_{S \\subseteq \\{1,2,\\cdots,i\\}}(-1)^{|S|}\\sum_{\\forall i \\in S,c_i&lt;B_i}\\prod_{i \\in S}\\frac{A_i^{c_i}}{c_i!}[\\sum_{i \\in S} A_i=j \\land \\sum_{i \\in S}c_i=k]\r\n\\]</span>  <span class=\"math display\">\\[\r\nf_{i,j,k}=f_{i-1,j,k}-\\sum_{c=0}^{B_i-1}f_{i-1,j-A_i,k-c}\\frac{A_i^c}{c!}\r\n\\]</span>  <span class=\"math display\">\\[\r\n(\\sum_{i=1}^n A_i)\\sum_{i=0}^{400}\\sum_{j=0}^{400}\\frac{j!f_{n,i,j}}{i^{j+1}}\r\n\\]</span>  <span class=\"math inline\">\\(B_i\\)</span> <span class=\"math inline\">\\(\\sum_{i=1}^nB_i\\)</span>  <span class=\"math inline\">\\(O(n)\\)</span>  <span class=\"math inline\">\\(O(n^3)\\)</span> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<hr />\r\n<h3 id=\"agc037d\">AGC037D</h3>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\((i-1)m+1\\)</span>  <span class=\"math inline\">\\(im\\)</span>  <span class=\"math inline\">\\((i-1)m+1\\)</span>  <span class=\"math inline\">\\(im\\)</span>  <span class=\"math inline\">\\(i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i\\)</span> Hall </p>\r\n<p> <span class=\"math inline\">\\(O(n^4)\\)</span></p>\r\n<h3 id=\"agc043d\">AGC043D</h3>\r\n<p> <span class=\"math inline\">\\(P\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(A_i\\)</span> </p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(3\\)</span> </li>\r\n<li></li>\r\n<li> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(A_i\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(P\\)</span>  <span class=\"math inline\">\\(P\\)</span>  <span class=\"math inline\">\\(A\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(P\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(1,2,3\\)</span>  <span class=\"math inline\">\\(cnt_1,cnt_2,cnt_3\\)</span> <span class=\"math inline\">\\(cnt_1+2cnt_2+3cnt_3=3n\\)</span>  <span class=\"math inline\">\\(cnt_1 \\ge cnt_2\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\binom{cnt_1+cnt_2+cnt_3}{cnt_1,cnt_2,cnt_3}\\frac{(3n)!}{(cnt_1+cnt_2+cnt_3)!2^{cnt_2}3^{cnt_3}}\r\n\\]</span>  <span class=\"math inline\">\\((cnt_1+cnt_2+cnt_3)!\\)</span>  <span class=\"math inline\">\\(2^{cnt_2}3^{cnt_3}\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<h3 id=\"agc049d\">AGC049D</h3>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(c\\)</span> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(A=(c,c,\\cdots,c)\\)</span></li>\r\n<li> <span class=\"math inline\">\\(j&lt;i\\)</span> <span class=\"math inline\">\\(A_j,A_{j-1},A_{j-2},\\cdots,A_1\\)</span>  <span class=\"math inline\">\\(1,2,3,\\cdots,j\\)</span></li>\r\n<li> <span class=\"math inline\">\\(j&gt;i\\)</span> <span class=\"math inline\">\\(A_j,A_{j+1},A_{j+2},\\cdots,A_n\\)</span>  <span class=\"math inline\">\\(1,2,3,\\cdots,n-j+1\\)</span> <span class=\"math inline\">\\(i&gt;1\\)</span>  <span class=\"math inline\">\\(i-1\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i-1\\)</span>  <span class=\"math inline\">\\(\\frac {i(i-1)}2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(O(\\sqrt m)\\)</span>  <span class=\"math inline\">\\(O(m\\sqrt m)\\)</span>  <span class=\"math inline\">\\(O(\\frac mn)\\)</span>  <span class=\"math inline\">\\(c\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(nm\\sqrt m)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i \\rightarrow i+1\\)</span>  <span class=\"math inline\">\\(O(\\sqrt m)\\)</span>  <span class=\"math inline\">\\(O(m\\sqrt m)\\)</span> </p>\r\n<h3 id=\"agc050d\">AGC050D</h3>\r\n<p> <span class=\"math inline\">\\(f_{i,a,b,j}\\)</span>  <span class=\"math inline\">\\(j\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(i\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\(i+1\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(f_{i,0,b,j}=f_{i+1,b,0,j}\\)</span></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(f_{i,a,b,j}=win \\cdot f_{i,a-1,b,j-[j&gt;b]} + lost \\cdot f_{i,a-1,b+1,j}(j\\ne b+1)\\)</span></li>\r\n<li><span class=\"math inline\">\\(f_{i,a,b,b+1}=win + lost \\cdot f_{i,a-1,b+1,b+1}(j\\le b)\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n^4)\\)</span></p>\r\n<h3 id=\"noi2021day1t1\">NOI2021Day1T1</h3>\r\n<p></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(O(n\\log^2n)\\)</span></p>\r\n<h3 id=\"noi2021day1t2\">NOI2021Day1T2</h3>\r\n<p> <span class=\"math inline\">\\(k=2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(n_1=n_2=\\cdots=n_k\\)</span> </p>\r\n<p></p>\r\n<p></p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\((P_1,P_2,\\cdots,P_k)\\)</span>  <span class=\"math inline\">\\((Q_1,Q_2,\\cdots,Q_k)\\)</span> <span class=\"math inline\">\\(\\iff\\)</span> <span class=\"math inline\">\\((P_1,Q_1)\\)</span>  <span class=\"math inline\">\\((P_k,Q_k)\\)</span> </p></li>\r\n<li><p></p>\r\n<ul>\r\n<li></li>\r\n<li></li>\r\n</ul>\r\n<p></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n^4)\\)</span></p>\r\n<h3 id=\"noi2021day1t3\">NOI2021Day1T3</h3>\r\n<p> <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(t\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(x\\Rightarrow z\\)</span>  <span class=\"math inline\">\\(y\\Rightarrow z\\)</span> <span class=\"math inline\">\\(x\\Rightarrow y\\)</span>  <span class=\"math inline\">\\(y\\Rightarrow x\\)</span> <span class=\"math inline\">\\(z\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(s,t\\)</span> </p>\r\n<p> <code>LCA</code>  <code>vector</code></p>\r\n<p> <span class=\"math inline\">\\(O(n+q\\log n)\\)</span></p>\r\n<h3 id=\"noi2021day2t1\">NOI2021Day2T1</h3>\r\n<p><span class=\"math inline\">\\(k \\le 15\\)</span>  <span class=\"math inline\">\\(256\\)</span>  <span class=\"math inline\">\\(16\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(16\\)</span>  <span class=\"math inline\">\\(7\\)</span>  <code>popcount</code> </p>\r\n<h3 id=\"noi2021day2t2\">NOI2021Day2T2</h3>\r\n<p><del></del></p>\r\n<p> <span class=\"math inline\">\\(a\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(a_n\\)</span>  <span class=\"math inline\">\\(x,y\\)</span> <span class=\"math inline\">\\(\\frac {x&#39;}{y&#39;}=a_{n-1}+\\frac 1{a_n}=\\frac {a_{k-1}x+y}x\\)</span> <span class=\"math inline\">\\((x,y)\\)</span>  <span class=\"math display\">\\[\r\n\\begin{bmatrix}\r\nx&#39;\\\\\r\ny&#39;\r\n\\end{bmatrix}\r\n=\r\n\\begin{bmatrix}\r\na_{n-1}&amp;1\\\\\r\n1&amp;0\r\n\\end{bmatrix}\r\n\\begin{bmatrix}\r\nx\\\\\r\ny\r\n\\end{bmatrix}\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\begin{bmatrix}\r\na&amp;c\\\\\r\nb&amp;d\r\n\\end{bmatrix}\r\n=\r\n\\prod_{i=1}^n\r\n\\begin{bmatrix}\r\na_i&amp;1\\\\\r\n1&amp;0\r\n\\end{bmatrix}\r\n\\]</span>  <span class=\"math inline\">\\(\\frac ab\\)</span></p>\r\n<p></p>\r\n<ul>\r\n<li><p><code>W</code>  <span class=\"math inline\">\\(\\begin{bmatrix}x&amp;1\\\\1&amp;0\\end{bmatrix}\\begin{bmatrix}1&amp;0\\\\1&amp;1\\end{bmatrix}=\\begin{bmatrix}x+1&amp;1\\\\1&amp;0\\end{bmatrix}\\)</span> 'W'  <span class=\"math inline\">\\(\\begin{bmatrix}1&amp;0\\\\1&amp;1\\end{bmatrix}\\)</span></p></li>\r\n<li><p><code>E</code>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math display\">\\[\r\n\\begin{bmatrix}\r\n1&amp;1\\\\\r\n1&amp;0\r\n\\end{bmatrix}\r\n\\rightarrow\r\n\\begin{bmatrix}\r\n1&amp;0\\\\\r\n1&amp;1\r\n\\end{bmatrix}\r\n\\begin{bmatrix}\r\n1&amp;1\\\\\r\n1&amp;0\r\n\\end{bmatrix}\r\n=\r\n\\begin{bmatrix}\r\n1&amp;1\\\\\r\n2&amp;1\r\n\\end{bmatrix}\r\n\\]</span> <strong></strong> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math display\">\\[\r\n\\begin{bmatrix}\r\n1&amp;1\\\\\r\n1&amp;0\r\n\\end{bmatrix}\r\n\\rightarrow\r\n\\begin{bmatrix}\r\n0&amp;1\\\\\r\n1&amp;0\r\n\\end{bmatrix}\r\n\\begin{bmatrix}\r\n1&amp;1\\\\\r\n1&amp;0\r\n\\end{bmatrix}^2\r\n=\r\n\\begin{bmatrix}\r\n1&amp;1\\\\\r\n2&amp;1\r\n\\end{bmatrix}\r\n\\]</span>  <code>E</code>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(\\begin{bmatrix}1&amp;0\\\\-1&amp;1\\end{bmatrix}\\)</span></p>\r\n<p> <code>E</code>  <span class=\"math inline\">\\(\\begin{bmatrix}1&amp;0\\\\-1&amp;1\\end{bmatrix}\\begin{bmatrix}1&amp;1\\\\1&amp;0\\end{bmatrix}^2=\\begin{bmatrix}2&amp;1\\\\-1&amp;0\\end{bmatrix}\\)</span></p></li>\r\n</ul>\r\n<p><code>APPEND</code><code>FLIP</code>  <code>REVERSE</code> <code>FLIP</code>  <code>FLIP</code> </p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<h3 id=\"noi2021day2t3\">NOI2021Day2T3</h3>\r\n<p> <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(0,1,2,3\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(mask\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(0,1\\)</span>  <span class=\"math inline\">\\(2,3\\)</span> <span class=\"math inline\">\\(1\\)</span></li>\r\n<li> <span class=\"math inline\">\\(01\\)</span>  <span class=\"math inline\">\\(2\\)</span></li>\r\n<li> <span class=\"math inline\">\\(3\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(2^nmn^2)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(g_{0/1/2/3,S}\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(0/1/2/3\\)</span> <span class=\"math inline\">\\(g\\)</span>  <span class=\"math inline\">\\(O(2^n)\\)</span>  <span class=\"math inline\">\\(g\\)</span>  <span class=\"math inline\">\\(O(1)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(2^nm)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n \\le 32\\)</span> <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(\\lceil\\frac n2\\rceil\\)</span>  <span class=\"math inline\">\\(\\lceil\\frac n2\\rceil\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(\\max\\)</span></p>\r\n<ul>\r\n<li><p><span class=\"math inline\">\\(\\max \\le \\lceil\\frac n2\\rceil\\)</span> <span class=\"math inline\">\\(O(2^{\\frac n2}m)\\)</span></p></li>\r\n<li><p><span class=\"math inline\">\\(\\max &gt; \\lceil\\frac n2\\rceil\\)</span> <span class=\"math inline\">\\(n-\\max+1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(R\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(R\\)</span>  <span class=\"math inline\">\\(mask\\)</span> </p></li>\r\n<li><p></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(2\\max-n+1\\)</span> <span class=\"math inline\">\\(O(2^{n-\\max+1}m)\\)</span>  <code>DP</code> <span class=\"math inline\">\\(f_{i,S}\\)</span>  <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(n-\\max+1\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(i+1\\)</span>  <span class=\"math inline\">\\(O(2^{n-\\max+1}m)\\)</span>  <span class=\"math inline\">\\(O(2^{n-\\max+1}n)\\)</span></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(2^{n/2}m)\\)</span></p>\r\n<h3 id=\"cf1548d2\">CF1548D2</h3>\r\n<p> Pick  <span class=\"math display\">\\[\r\nS=i+\\frac b2-1\r\n\\]</span>  <span class=\"math inline\">\\(S\\in \\mathbb Z \\land2S\\equiv b \\pmod 4\\)</span></p>\r\n<p> <span class=\"math inline\">\\(ABC\\)</span> <span class=\"math inline\">\\(2S=|\\overrightarrow A\\times \\overrightarrow B+\\overrightarrow B\\times \\overrightarrow C+\\overrightarrow C\\times \\overrightarrow A|\\)</span> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(2S \\bmod 4\\)</span></p>\r\n<p> <span class=\"math inline\">\\(AB\\)</span>  <strong></strong> <span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\(AB\\)</span>  <span class=\"math inline\">\\(\\text{bounds}(A,B)=\\gcd(|X_A-X_B|,|Y_A-Y_B|)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\(\\text{bounds}(A,B) \\bmod 4\\)</span>  <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(2\\)</span>  <span class=\"math display\">\\[\r\n\\text{bounds}(A,B) \\equiv 0\\pmod 4 \\iff X_A\\equiv X_B\\pmod 4 \\land Y_A\\equiv Y_B\\pmod 4\r\n\\]</span>  <span class=\"math inline\">\\(\\text{bounds}(A,B) \\not\\equiv 0\\pmod 4\\)</span>  <span class=\"math display\">\\[\r\n\\text{bounds}(A,B) \\equiv 2\\pmod 4 \\iff X_A\\equiv X_B\\pmod 2 \\land Y_A\\equiv Y_B\\pmod 2\r\n\\]</span>  <span class=\"math inline\">\\(4\\)</span> </p>\r\n<p> EEE  EOO  <span class=\"math inline\">\\(cnt_{A,x,y,z}\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math display\">\\[\r\nX_B\\equiv x\\pmod 4 \\land Y_B\\equiv y\\pmod 4 \\land \\text{bounds}(A,B) \\equiv z\\pmod 4\r\n\\]</span>  <span class=\"math inline\">\\(O(n^2\\log V)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(ABC\\)</span>  <span class=\"math inline\">\\(A\\)</span> <span class=\"math display\">\\[\r\nX_B\\bmod 4,Y_B\\bmod 4,\\text{bounds}(A,B)\\bmod 4\\\\X_C\\bmod 4,Y_C\\bmod 4,\\text{bounds}(A,C)\\bmod 4\r\n\\]</span>  <span class=\"math display\">\\[\r\nS \\in \\mathbb Z\\\\\r\n\\text{bounds}(A,B)\\equiv\\text{bounds}(A,C)\\pmod 2\\\\\r\nX_B\\equiv X_C \\pmod 2\\\\\r\nY_B\\equiv Y_C\\pmod 2\\\\\r\nS\\equiv \\text{bounds}(A,B)+\\text{bounds}(A,C)+\\text{bounds}(B,C)\\pmod 4\r\n\\]</span>  <span class=\"math inline\">\\(cnt\\)</span>  <span class=\"math inline\">\\(O(1)\\)</span> </p>\r\n<p> EEE  <span class=\"math inline\">\\(3\\)</span>  EOO  <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^2\\log V)\\)</span></p>\r\n<h3 id=\"cf1548e\">CF1548E</h3>\r\n<p><del> 3400</del></p>\r\n<p> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(0\\)</span>1-</p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(i,j\\)</span>1 </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(a_i \\ge a_j\\)</span><span class=\"math inline\">\\(a_i+b_k \\le x \\Rightarrow a_j+b_k \\le x\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a,b\\)</span> </p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(L_r\\)</span> <span class=\"math inline\">\\(R_r\\)</span> <span class=\"math inline\">\\(L_c\\)</span> <span class=\"math inline\">\\(R_c\\)</span></li>\r\n<li> <span class=\"math inline\">\\(a_{L_r},a_{L_r+1},\\cdots,a_{R_r}\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\((i,L_c),(i,L_c+1),\\cdots,(i,R_c)\\)</span>  1</li>\r\n<li> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(i\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(i\\)</span>  1  <span class=\"math inline\">\\([l,r]\\)</span> <span class=\"math inline\">\\(i\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(a_j \\le a_i\\)</span><span class=\"math inline\">\\(\\min_{k\\in [l,r]}a_k+\\max_{k\\in (j,i]}b_k&gt;x\\)</span></li>\r\n<li> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(a_j&lt;a_i\\)</span><span class=\"math inline\">\\(\\min_{k\\in [l,r]}a_k+\\max_{k\\in [i,j)}b_k&gt;x\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(a_j\\le a_i\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(pre\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(a_j&lt; a_i\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(suf\\)</span> <span class=\"math inline\">\\([l,r]\\)</span>  <span class=\"math inline\">\\(\\min_{i\\in [l,r]}a_i&gt;x-\\max_{i\\in (pre,suf)}\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(O(n)\\)</span> </p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(b\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(a_i\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(1\\)</span></li>\r\n<li> <span class=\"math inline\">\\(key\\)</span></li>\r\n</ul>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<h3 id=\"minieye5t1\">2021MINIEYE5T1</h3>\r\n<p></p>\r\n<ul>\r\n<li><code>1</code>  <code>access(u)</code></li>\r\n<li><code>2</code> </li>\r\n<li><code>3</code>  <code>dfs</code> </li>\r\n<li><code>4</code> </li>\r\n</ul>\r\n<p> <code>23</code> </p>\r\n<p> <code>4</code>  <code>LCT</code>  <code>access</code> </p>\r\n<p> <span class=\"math inline\">\\(O(n\\log^2n)\\)</span></p>\r\n<h3 id=\"minieye5t2\">2021MINIEYE5T2</h3>\r\n<p> <span class=\"math inline\">\\(f_{i,j}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <code>a</code><span class=\"math inline\">\\(j\\)</span>  <code>b</code> <span class=\"math inline\">\\((x+y+k-2)^L\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\sum_{i=0}^L\\sum_{j=0}^L[n|i-p][n|j-q][x^i][y^j](x+y+k-2)^L\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n|P-1\\)</span> <span class=\"math display\">\\[\r\n\\frac 1{n^2}\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}(\\omega_n^i+\\omega_n^j+k-2)^L\\omega_n^{-ip}\\omega_n^{-jq}\r\n\\]</span>  <span class=\"math inline\">\\(A_{i,j}=(\\omega_n^i+\\omega_n^j+k-2)^L\\)</span>  <span class=\"math inline\">\\(O(n^2\\log L)\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <code>IDFT</code>  <code>IDFT</code>  <span class=\"math inline\">\\(O(n^3)\\)</span> Bluestein + MTT  <span class=\"math inline\">\\(O(n^2\\log n)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n^3)\\)</span>  <span class=\"math inline\">\\(O(n^2\\log L)\\)</span></p>\r\n<h3 id=\"minieye5t9\">2021MINIEYE5T9</h3>\r\n<p> <strong></strong></p>\r\n<p></p>\r\n<h4 id=\"-1\"> 1</h4>\r\n<p> <span class=\"math inline\">\\(v\\)</span></p>\r\n<p> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(p_1,p_2,\\cdots,p_k\\)</span> <span class=\"math inline\">\\([l,r]\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(p_j\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(j\\)</span> <span class=\"math inline\">\\((l,r)\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(-1\\)</span> <span class=\"math inline\">\\(sum_i\\)</span> <span class=\"math inline\">\\([l,r]\\)</span>  <span class=\"math inline\">\\(sum_{l-1}&lt;sum_r\\)</span> <span class=\"math inline\">\\(sum_1,sum_2,\\cdots,sum_{p_j}\\)</span> <span class=\"math inline\">\\(j\\rightarrow j+1\\)</span>  <span class=\"math inline\">\\(sum_{p_j},sum_{p_j+1},\\cdots,sum_{p_{j+1}-1}\\)</span> <span class=\"math inline\">\\(+1\\)</span> <span class=\"math inline\">\\(r\\in[p_j,p_{j+1})\\)</span> <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(sum_r\\)</span>  <span class=\"math inline\">\\([p_j,p_{j+1})\\)</span>  <span class=\"math inline\">\\(sum_r\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<h4 id=\"-2\"> 2</h4>\r\n<p> <span class=\"math inline\">\\([l,r]\\)</span>  <span class=\"math inline\">\\(l\\le mid+1 \\land r\\ge mid\\)</span></p>\r\n<p> <span class=\"math inline\">\\([l,r]\\)</span>  <span class=\"math inline\">\\([l,mid]\\)</span>  <span class=\"math inline\">\\([mid+1,r]\\)</span> </p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(O(\\log n)\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(O(\\log n)\\)</span>  <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(-1\\)</span> <span class=\"math inline\">\\(sum_i\\)</span> <span class=\"math inline\">\\(r\\)</span>  <span class=\"math inline\">\\(l\\le mid+1\\)</span>  <span class=\"math inline\">\\(sum_{l-1}&lt;sum_r\\)</span> <span class=\"math inline\">\\(O(1)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n\\log^2n)\\)</span></p>\r\n<h3 id=\"minieye5t13\">2021MINIEYE5T13</h3>\r\n<p> <span class=\"math inline\">\\(D\\)</span> <code>DP</code> </p>\r\n<p> <span class=\"math inline\">\\(f_{u,0/1}\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(\\infty\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(u\\)</span> </li>\r\n<li><span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(D\\)</span></li>\r\n</ul>\r\n<p><span class=\"math inline\">\\(f_{u,1}\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(\\min(f_{v,0}+w(u,v),f_{v,1}+\\max(w(u,v)-p_v,0))\\)</span>  <span class=\"math inline\">\\(D\\)</span><span class=\"math inline\">\\(f_{u,1}=\\infty\\)</span></p>\r\n<p><span class=\"math inline\">\\(f_{u,0}\\)</span> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\((u,v)\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(\\min(f_{v,0}+w(u,v),f_{v,1}+w(u,v)-p_v)\\)</span>  <span class=\"math inline\">\\(v\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n\\log V)\\)</span></p>\r\n<h3 id=\"agc041d\">AGC041D</h3>\r\n<p> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(k+1\\)</span>  <span class=\"math inline\">\\(\\lceil\\frac n2\\rceil\\)</span>  <span class=\"math inline\">\\(\\lceil\\frac n2\\rceil-1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(A\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(\\lfloor\\frac n2\\rfloor+1\\)</span>  <span class=\"math inline\">\\(c\\)</span> <span class=\"math inline\">\\(A=(c,c,\\cdots,c)\\)</span></li>\r\n<li> <span class=\"math inline\">\\(j&lt;\\lfloor\\frac n2\\rfloor+1\\)</span> <span class=\"math inline\">\\(A_1,A_2,\\cdots,A_j\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(j&gt;\\lfloor\\frac n2\\rfloor+1\\)</span> <span class=\"math inline\">\\(A_j,A_{j+1},\\cdots,A_n\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(A_1 \\ge 1\\)</span> <span class=\"math inline\">\\(c-1\\)</span> <span class=\"math inline\">\\(n-c\\)</span></li>\r\n<li> <span class=\"math inline\">\\(\\lceil\\frac n2\\rceil\\)</span>  <span class=\"math inline\">\\(\\lceil\\frac n2\\rceil-1\\)</span>  <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(x=c\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(j\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(n-j+1\\)</span> <span class=\"math inline\">\\(c\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(1,2,\\cdots,\\lfloor\\frac n2\\rfloor\\)</span>  <span class=\"math inline\">\\(c-1\\)</span>  <span class=\"math inline\">\\(1,2,\\cdots,\\lceil\\frac n2\\rceil-1\\)</span>  <span class=\"math inline\">\\(n-c\\)</span>  <span class=\"math inline\">\\(c\\)</span></p>\r\n<p> <span class=\"math inline\">\\(L_{i,j}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math display\">\\[\r\nL_{i,j}=L_{i-1,j-1}+L_{i,j-i}-L_{i-1,j-i-\\lfloor\\frac n2\\rfloor}\r\n\\]</span>  <span class=\"math inline\">\\(R_{i,j}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(c\\)</span>  <span class=\"math inline\">\\(O(n)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<h3 id=\"agc027d\">AGC027D</h3>\r\n<p></p>\r\n<ul>\r\n<li></li>\r\n<li> <span class=\"math inline\">\\(1\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(\\text{lcm}\\)</span> <span class=\"math inline\">\\(\\text{lcm}+1\\)</span> <span class=\"math inline\">\\(2\\text{lcm}+1,3\\text{lcm}+1,\\cdots\\)</span></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(\\text{lcm}\\)</span>  <span class=\"math inline\">\\(\\text{lcm}\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(N\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(A_{i,j}\\)</span>  <span class=\"math inline\">\\(\\text{lcm(i,j)}\\)</span>  <span class=\"math inline\">\\(N\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(A_{i,j}\\)</span>  <span class=\"math inline\">\\(\\text{lcm}(i+j,i-j+n)\\)</span>  <span class=\"math inline\">\\(N\\)</span>  <span class=\"math inline\">\\(425\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(A_{i,j}\\)</span>  <span class=\"math inline\">\\(\\text{lcm}(i+(n-j+1),i-(n-j+1)+n)\\)</span></li>\r\n<li></li>\r\n</ul>\r\n<p> <code>set</code>  <span class=\"math inline\">\\(O(n^2\\log n)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<h3 id=\"agc025d\">AGC025D</h3>\r\n<p> <span class=\"math inline\">\\(\\sqrt D\\)</span>  <span class=\"math inline\">\\((x_1,y_1),(x_2,y_2)\\)</span> <span class=\"math inline\">\\(x_1-x_2,y_1-y_2\\)</span>  <span class=\"math display\">\\[\r\nx_1 \\equiv x_2 \\pmod 2,y_1 \\equiv y_2 \\pmod 2 \\iff D \\equiv 0 \\pmod 4\\\\\r\nx_1 \\equiv x_2 \\pmod 2,y_1 \\not\\equiv y_2 \\pmod 2 \\iff D \\equiv 1 \\pmod 4\\\\\r\nx_1 \\not\\equiv x_2 \\pmod 2,y_1 \\not\\equiv y_2 \\pmod 2 \\iff D \\equiv 2 \\pmod 4\\\\\r\n\\]</span>  <span class=\"math inline\">\\(D \\bmod 4\\)</span> </p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(\\sqrt D\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(\\text{color}(x,y,D)=0/1\\)</span>  <span class=\"math inline\">\\((x,y)\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(D\\equiv 3\\pmod 4\\)</span> <span class=\"math inline\">\\(\\text{color}(x,y,D)=0\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\(D\\equiv 2\\pmod 4\\)</span> <span class=\"math inline\">\\(\\text{color}(x,y,D)=x\\bmod 2\\)</span> <span class=\"math inline\">\\(\\sqrt D\\)</span> </p></li>\r\n<li><p> <span class=\"math inline\">\\(D \\equiv 1\\pmod 4\\)</span> <span class=\"math inline\">\\(\\text{color}(x,y,D)=(x+y)\\bmod 2\\)</span> <span class=\"math inline\">\\(\\sqrt D\\)</span> </p></li>\r\n<li><p> <span class=\"math inline\">\\(D\\equiv 0\\pmod 4\\)</span> <span class=\"math inline\">\\(\\text{color}(x,y,D)=\\text{color}(\\lfloor\\frac x2\\rfloor,\\lfloor\\frac y2\\rfloor,\\frac D4)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\sqrt D\\)</span>  <span class=\"math inline\">\\((x_1,y_1),(x_2,y_2)\\)</span> <span class=\"math inline\">\\(x_1 \\equiv x_2 \\pmod 2,y_1 \\equiv y_2 \\pmod 2\\)</span> <span class=\"math display\">\\[\r\n\\lfloor\\frac {x_1}2\\rfloor-\\lfloor\\frac {x_2}2\\rfloor=\\frac 12(x_1-x_2)\\\\\r\n\\lfloor\\frac {y_1}2\\rfloor-\\lfloor\\frac {y_2}2\\rfloor=\\frac 12(y_1-y_2)\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;(x_1-x_2)^2+(y_1-y_2)^2=D\\\\\r\n\\Rightarrow &amp;(\\lfloor\\frac {x_1}2\\rfloor-\\lfloor\\frac {x_2}2\\rfloor)^2+(\\lfloor\\frac {y_1}2\\rfloor-\\lfloor\\frac {y_2}2\\rfloor)^2=\\frac D4\\\\\r\n\\Rightarrow &amp;\\text{color}(\\lfloor\\frac {x_1}2\\rfloor,\\lfloor\\frac {y_1}2\\rfloor,\\frac D4)\\ne\\text{color}(\\lfloor\\frac {x_2}2\\rfloor,\\lfloor\\frac {y_2}2\\rfloor,\\frac D4)\r\n\\end{aligned}\r\n\\]</span></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(D_1\\)</span>  <span class=\"math inline\">\\(D_2\\)</span>  <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(n^2\\)</span> <span class=\"math inline\">\\(n^2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<h3 id=\"agc036d\">AGC036D</h3>\r\n<p> <span class=\"math inline\">\\(d_1,d_2,\\cdots,d_n\\)</span> <span class=\"math inline\">\\(d_1=0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\rightarrow i+1\\)</span>  <span class=\"math inline\">\\(d\\)</span>  <span class=\"math inline\">\\(0\\)</span> $-1 $ <span class=\"math inline\">\\(-2\\cdots\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(d\\)</span> <span class=\"math inline\">\\([a,b]\\)</span> <span class=\"math inline\">\\(d_{a,a+1,\\cdots,b}=x+1\\)</span> <span class=\"math inline\">\\([b+1,c]\\)</span> <span class=\"math inline\">\\(d_{b+1,b+2,\\cdots,c}=x\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(b+1\\le i &lt; j \\le c\\)</span> <span class=\"math inline\">\\((i,j)\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(b+1\\le i\\le c,j&lt;a\\)</span> <span class=\"math inline\">\\((i,j)\\)</span> </li>\r\n</ul>\r\n<p> <code>DP</code>  <span class=\"math inline\">\\(f_{a,b}\\)</span>  <span class=\"math inline\">\\([a,b]\\)</span>  <span class=\"math display\">\\[\r\nf_{a,b}+\\text{cost}_1(b+1,c)+\\text{cost}_2(b+1,c,a-1)\\rightarrow f_{b+1,c}\r\n\\]</span>  <span class=\"math inline\">\\(\\text{cost}_1\\)</span>  <span class=\"math inline\">\\(\\text{cost}_2\\)</span>  <span class=\"math inline\">\\(O(1)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^3)\\)</span></p>\r\n<h3 id=\"agc045d\">AGC045D</h3>\r\n<p> <code>Snuke</code>  <span class=\"math inline\">\\(p_i=i\\)</span>  <code>Snuke</code> </p>\r\n<ul>\r\n<li> <code>Snuke</code>  <span class=\"math inline\">\\(1\\)</span></li>\r\n<li> <span class=\"math inline\">\\(p_i=i\\)</span> </li>\r\n<li><span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(p_i\\)</span></li>\r\n<li></li>\r\n</ul>\r\n<p> <code>Snuke</code>  <span class=\"math inline\">\\(1-A\\)</span>  <span class=\"math inline\">\\(p_i=i\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(\\min\\)</span><span class=\"math inline\">\\(\\forall i&gt;A,\\exists j&lt;\\min\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\min\\)</span> <span class=\"math inline\">\\(\\min\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\((-1)^i\\binom{\\min-1}i\\)</span></li>\r\n<li> <span class=\"math inline\">\\([1,\\min-1]\\)</span>  <span class=\"math inline\">\\(\\min-1-i\\)</span>  <span class=\"math inline\">\\((\\min-1-i)!\\)</span></li>\r\n<li> <span class=\"math inline\">\\([A+1,n]\\)</span>  <span class=\"math inline\">\\((\\min-1-i)^{\\overline{n-A}}\\)</span></li>\r\n<li> <span class=\"math inline\">\\([\\min+1,A]\\)</span>  <span class=\"math inline\">\\((\\min-1-i+n-A)^{\\overline{A-\\min}}\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(\\min\\)</span>  <span class=\"math display\">\\[\r\n\\sum_{i=0}^{\\min-1}(-1)^i\\binom{\\min-1}i\\frac{(n-1-i)!(\\min-1-i)}{\\min-1-i+n-A}\r\n\\]</span>  <span class=\"math inline\">\\(\\min\\)</span>  <span class=\"math display\">\\[\r\n\\sum_{i=0}^A(-1)^i\\binom Ai(n-i)!\r\n\\]</span>  <span class=\"math inline\">\\(O(A^2+n)\\)</span></p>\r\n<h3 id=\"agc041e\">AGC041E</h3>\r\n<h4 id=\"-t1\"> <span class=\"math inline\">\\(T=1\\)</span></h4>\r\n<p></p>\r\n<ul>\r\n<li></li>\r\n<li></li>\r\n<li></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(t\\)</span> </p>\r\n<p> <code>bitset</code>  <code>DFS</code>  <code>bitset</code> <span class=\"math inline\">\\(O(\\frac {nm}{\\omega})\\)</span> </p>\r\n<h4 id=\"-t2\"> <span class=\"math inline\">\\(T=2\\)</span></h4>\r\n<p><span class=\"math inline\">\\(n=2\\)</span>  <span class=\"math inline\">\\(n&gt;2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(size_i\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(size_i=1\\)</span></li>\r\n<li> <span class=\"math inline\">\\((x,y)\\)</span>  <span class=\"math inline\">\\(size_x+1\\)</span> <span class=\"math inline\">\\(size_y+1\\)</span> <span class=\"math inline\">\\(size_x\\)</span>  <span class=\"math inline\">\\(size_y\\)</span>  <span class=\"math inline\">\\(+1\\)</span> <span class=\"math inline\">\\(size_x=n-1\\land size_y=n-1\\)</span>  <span class=\"math inline\">\\(size_x+size_y\\le n\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n+m)\\)</span></p>\r\n<h3 id=\"abc214g\">ABC214G</h3>\r\n<p> <span class=\"math inline\">\\(n \\le 10^5\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(F_k\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(r_{i_1},r_{i_2},\\cdots,r_{i_k}(i_1&lt;i_2&lt;\\cdots&lt;i_k)\\)</span>  <span class=\"math display\">\\[\r\n\\forall x\\in[1,k],r_{i_x}=p_{i_x}\\lor r_{i_x}=q_{i_x}\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\sum_{i=0}^n(-1)^iF_i(n-i)!\r\n\\]</span>  <span class=\"math inline\">\\(p_i,q_i\\)</span>  <span class=\"math inline\">\\(r_i=p_i\\lor r_i=q_i\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(F\\)</span>  <code>FFT</code>  <span class=\"math inline\">\\(F\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(F\\)</span>  <span class=\"math inline\">\\(1,2,\\cdots,m\\)</span> <span class=\"math inline\">\\((1,2),(2,3),\\cdots,(m-1,m),(m,1)\\)</span> <span class=\"math inline\">\\(i\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\((1,2)\\)</span> <span class=\"math inline\">\\((2,3)\\)</span>  <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\((2,3)\\)</span>  <span class=\"math inline\">\\(3\\)</span>  <span class=\"math inline\">\\(2\\)</span> <span class=\"math inline\">\\((3,4)\\)</span>  <span class=\"math inline\">\\(3\\)</span>  <span class=\"math inline\">\\(3\\)</span> <span class=\"math inline\">\\((3,4)\\)</span>  <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(4\\)</span> <span class=\"math inline\">\\(2m-2\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(r\\)</span>  <span class=\"math inline\">\\(\\binom {n-r+1}r\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i-1\\)</span>  <span class=\"math inline\">\\(n-r+1\\)</span>  <span class=\"math inline\">\\(r\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(\\binom{2m-i-1}i\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\((1,2)\\)</span> <span class=\"math inline\">\\((1,2)\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(2\\)</span> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(2m-3\\)</span>  <span class=\"math inline\">\\(i-1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(2\\binom{2m-i-1}{i-1}\\)</span></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(m\\)</span>  <span class=\"math display\">\\[\r\nF_i=\\binom{2m-i-1}i+2\\binom{2m-i-1}{i-1}=\\binom{2m-i}i+\\binom{2m-i-1}{i-1}\r\n\\]</span>  <span class=\"math inline\">\\(F\\)</span>  <span class=\"math inline\">\\(O(n)\\)</span>  <code>FFT</code> <span class=\"math inline\">\\(O(n\\log^2n)\\)</span></p>\r\n<p> <code>FFT</code> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(n\\)</span> <span class=\"math inline\">\\(O(\\sqrt n)\\)</span>  <span class=\"math inline\">\\(O(n\\log n)\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(\\sum_{u\\in \\mathbb{leaf}}\\text{degree}_u\\text{depth}_u\\)</span> <code>Huffman</code>  </li>\r\n</ul>\r\n<h3 id=\"abc214h\">ABC214H</h3>\r\n<p> <code>DAG</code> <code>DAG</code></p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(\\text{in}_u\\)</span>  <span class=\"math inline\">\\(\\text{out}_u\\)</span></li>\r\n<li><span class=\"math inline\">\\(\\text{in}_u\\)</span>  <span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(-X_u\\)</span>  <span class=\"math inline\">\\(K\\)</span> <span class=\"math inline\">\\(0\\)</span> </li>\r\n<li> <span class=\"math inline\">\\((u,v)\\)</span><span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(\\text{in}_v\\)</span>  <span class=\"math inline\">\\(K\\)</span> <span class=\"math inline\">\\(0\\)</span> </li>\r\n<li><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(\\text{in}_1\\)</span>  <span class=\"math inline\">\\(K\\)</span> <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(K\\)</span> <span class=\"math inline\">\\(0\\)</span> </li>\r\n</ul>\r\n<p><code>SSP</code>  <code>Primal-Dual</code> </p>\r\n<h4 id=\"sol-1\">Sol 1</h4>\r\n<p> <code>DAG</code> <code>DP</code> </p>\r\n<h4 id=\"sol-2\">Sol 2</h4>\r\n<p> <code>DAG</code> </p>\r\n<p></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(\\sum X_u\\)</span><span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(0\\)</span></li>\r\n<li><span class=\"math inline\">\\(\\text{in}_u\\)</span>  <span class=\"math inline\">\\(\\sum_{i=1}^uX_i\\)</span><span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(\\sum_{i=1}^{u-1}X_i\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(nK\\log n)\\)</span></p>\r\n<h3 id=\"agc027e\">AGC027E</h3>\r\n<p> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(b\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(a,b\\)</span>  <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\(3\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(|S|\\)</span>  <span class=\"math inline\">\\(|S|\\)</span>  <span class=\"math inline\">\\(ababab\\cdots aba\\)</span></p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(p(S)\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\(3\\)</span><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(c\\)</span> </p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(p(S)=p(c)\\)</span></li>\r\n<li><span class=\"math inline\">\\(S=c\\)</span>  <span class=\"math inline\">\\(S\\)</span> </li>\r\n</ul>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(|S|\\le 3\\)</span>  <span class=\"math inline\">\\(|S|&gt;3\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(a\\)</span></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(n \\ge 4\\)</span> <span class=\"math inline\">\\(a\\)</span> <span class=\"math inline\">\\(|S|\\)</span>  <span class=\"math inline\">\\(1\\)</span></li>\r\n<li><span class=\"math inline\">\\(n\\le 3\\)</span> <span class=\"math inline\">\\(|S|&gt;3\\)</span> <span class=\"math inline\">\\(b\\)</span> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(b\\)</span> <span class=\"math inline\">\\(b\\)</span> <span class=\"math inline\">\\(|S|\\)</span>  <span class=\"math inline\">\\(1\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(T\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(|T|\\)</span>  <span class=\"math inline\">\\(T\\)</span> </li>\r\n</ul>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(S\\)</span> <strong></strong> </p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(T\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(|T|\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S_1,S_2,\\cdots,S_{|T|}\\)</span><span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(T_1,T_2,\\cdots,T_{|T|}\\)</span></li>\r\n<li> <span class=\"math inline\">\\(\\forall i,p(S_i)=p(T_i)\\)</span></li>\r\n</ul>\r\n</blockquote>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\((S_1,S_2,\\cdots,S_{|T|})\\)</span></li>\r\n<li> <span class=\"math inline\">\\(S_1,S_2,\\cdots,S_{|T|-1}\\)</span>  <span class=\"math inline\">\\((S_1&#39;,S_2&#39;,\\cdots,S_{|T|}&#39;)\\)</span></li>\r\n<li> <span class=\"math inline\">\\(S_1,S_2,\\cdots,S_{|T|-1}\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(S_{|T|}\\)</span>  <span class=\"math inline\">\\(S_{|T|}=abab\\cdots aba\\)</span> <span class=\"math inline\">\\(|T|&gt;1\\)</span> <span class=\"math inline\">\\(S_{|T|}\\)</span>  <span class=\"math inline\">\\(S_{|T|-1}\\)</span> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(T\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <code>DP</code></p>\r\n<p> <span class=\"math inline\">\\(O(n)\\)</span></p>\r\n<h3 id=\"gym101667g\">Gym101667G</h3>\r\n<p></p>\r\n<p> L  U  U  L  <code>isRegion</code> <code>area</code> </p>\r\n<ul>\r\n<li> <code>isRegion</code>  <code>area</code> </li>\r\n<li> <code>area</code></li>\r\n<li> <code>area</code></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n+m)\\)</span></p>\r\n<figure>\r\n<img src=\"https://i.loli.net/2021/09/08/a4fEq6tJWRbrxDy.png\" alt=\".png\" /><figcaption aria-hidden=\"true\">.png</figcaption>\r\n</figure>\r\n<h3 id=\"gym101667j\">Gym101667J</h3>\r\n<p> Hall  <span class=\"math inline\">\\(f(S)\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math display\">\\[\r\n\\forall |S|\\le\\frac n2,|T|=\\frac n2,S \\cap T=\\varnothing\\\\\r\n|f(S)\\cap T| \\ge |S|\r\n\\]</span>  <span class=\"math inline\">\\(|f(S)\\cap T|\\)</span>  <span class=\"math inline\">\\(|f(S)|+|S|-\\frac n2\\)</span> <span class=\"math inline\">\\(|f(S)|\\ge\\frac n2\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\min_{|S|\\le \\frac n2}|f(S)|\\)</span></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(f(S)\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(V-S-f(S)\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(\\frac n2\\)</span> <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(|f(S)|\\le |T|\\)</span></li>\r\n</ul>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(\\text{in}_u\\)</span>  <span class=\"math inline\">\\(\\text{out}_u\\)</span></li>\r\n<li><span class=\"math inline\">\\(\\text{in}_u\\)</span>  <span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(1\\)</span> </li>\r\n<li> <span class=\"math inline\">\\((u,v)\\)</span><span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(\\text{in}_v\\)</span><span class=\"math inline\">\\(\\text{out}_v\\)</span>  <span class=\"math inline\">\\(\\text{in}_u\\)</span>  <span class=\"math inline\">\\(\\infty\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(u,v\\)</span> <span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(\\text{in}_v\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n^2\\cdot flow)\\)</span></p>\r\n<p><del></del> <span class=\"math inline\">\\(\\frac n2\\)</span> <span class=\"math inline\">\\(u\\)</span> <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(\\text{in}_v\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(O(nk\\cdot flow)\\)</span></p>\r\n<h3 id=\"abc215h\">ABC215H</h3>\r\n<p></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(B_i\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(c_{i,j}=1\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(\\infty\\)</span> </li>\r\n<li><span class=\"math inline\">\\(\\max flow=\\sum_{i=1}^mB_i\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(mask\\)</span> <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(sum\\)</span> <span class=\"math inline\">\\(\\sum_{i\\in mask}A_i-sum+1\\)</span> <span class=\"math inline\">\\(sum&gt;0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(mask\\)</span> <span class=\"math inline\">\\(sum\\)</span> <span class=\"math inline\">\\(B_i\\)</span>  <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(i\\)</span> <code>FMT</code> <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(\\sum_{i\\in mask}A_i-sum+1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(mask\\subseteq S\\)</span> <code>FMT</code>  <span class=\"math inline\">\\(ans\\)</span> <span class=\"math inline\">\\(mask\\)</span> <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(ans\\)</span>  <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(O(3^n)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(f_S\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(ans\\)</span>  <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math display\">\\[\r\n\\sum_{T\\subseteq S}f_T=\\binom{\\sum_{i\\in S}A_i}{ans}\r\n\\]</span>  <code>IFMT</code>  <span class=\"math inline\">\\(f\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n2^n+nm)\\)</span></p>\r\n<h3 id=\"agc020e\">AGC020E</h3>\r\n<p> <span class=\"math inline\">\\(S\\)</span>  <code>DP</code>  <span class=\"math inline\">\\(f_{l,r}\\)</span>  <span class=\"math inline\">\\([l,r]\\)</span> </p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(s_l\\)</span>  <span class=\"math inline\">\\(f_{l+1,r}\\)</span></li>\r\n<li><span class=\"math inline\">\\(s_l\\)</span>  <span class=\"math inline\">\\(s_l\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(i&gt;1\\)</span> <span class=\"math inline\">\\(f_{l,l+T-1}\\cdot f_{l+Ti,r}\\)</span></li>\r\n</ul>\r\n<p> <code>DP</code>  <span class=\"math inline\">\\(s_l\\)</span>  <span class=\"math inline\">\\(f_{l,l+T-1}\\)</span>  <code>DP</code>  <span class=\"math inline\">\\(f(s)\\)</span>  <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(suf(i)\\)</span>  <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(s_i\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\((s_0+1)f(suf(1))\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\(s_l\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(i&gt;1\\)</span> <span class=\"math inline\">\\(s[l,r]\\)</span>  <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(r\\)</span>  <span class=\"math display\">\\[\r\nt=s[0,T-1]\\&amp;s[T,2T-1]\\&amp;\\cdots\\&amp;s[T(i-1),Ti-1](\\&amp;\\ is\\ \\text{bitand})\r\n\\]</span>  <span class=\"math inline\">\\(f(t)\\cdot f(suf(Ti))\\)</span></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(2^{n+1})\\)</span> <span class=\"math inline\">\\(O()\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^3+2^{\\frac n8})\\)</span> <span class=\"math inline\">\\(\\frac n8\\)</span>  <span class=\"math inline\">\\(2^{\\frac n8}\\)</span>  <span class=\"math inline\">\\(\\frac n8\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(2\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(3\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(3\\)</span>  <span class=\"math inline\">\\(2\\)</span> </li>\r\n</ul>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(s[a,a+k-1]\\&amp;s[a+k,a+2k-1]\\&amp;s[b,b+k-1]\\&amp;s[b+k,b+2k-1]\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a,b,k\\)</span>  <span class=\"math inline\">\\(O(n^3)\\)</span> <span class=\"math inline\">\\(O(n^3)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(12\\)</span>  <span class=\"math inline\">\\(41703\\)</span></p>\r\n<h3 id=\"cf1562e\">CF1562E</h3>\r\n<p> <span class=\"math display\">\\[\r\ns[l_1,r_1],s[l_2,r_2],\\cdots,s[l_k,r_k]\r\n\\]</span>  <span class=\"math inline\">\\(l\\)</span> <span class=\"math inline\">\\(r\\)</span>  <span class=\"math inline\">\\(l\\)</span> <span class=\"math inline\">\\(r\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(l\\)</span> <span class=\"math inline\">\\(r\\in[r_1,r_2]\\)</span> <span class=\"math inline\">\\(r_2&lt;n\\)</span><span class=\"math inline\">\\(s[l,r_2]\\)</span>  <span class=\"math inline\">\\(s[l&#39;,r&#39;]\\)</span> <span class=\"math inline\">\\(s[l,r_2+1]&lt;s[l&#39;,r&#39;]\\)</span> <span class=\"math inline\">\\(s[l,r_2]\\)</span>  <span class=\"math inline\">\\(s[l,r_2+1]\\)</span> <span class=\"math inline\">\\(s[l,r_2]&lt;s[l&#39;,r&#39;]\\le s[l,r_2+1]\\)</span> <span class=\"math display\">\\[\r\ns[l&#39;,l&#39;+r_1-l]=s[l,r_1]\\\\\r\ns[l&#39;,l&#39;+r_1+1-l]=s[l,r_1+1]\\\\\r\ns[l&#39;,l&#39;+r_1+2-l]=s[l,r_1+2]\\\\\r\n\\cdots\\\\\r\ns[l&#39;,l&#39;+r_2-l]=s[l,r_2]\r\n\\]</span>  <span class=\"math inline\">\\(l\\)</span> </p>\r\n<p> <code>DP</code>  <span class=\"math inline\">\\(f_i\\)</span>  <span class=\"math inline\">\\(s[i,n]\\)</span>  <span class=\"math display\">\\[\r\nf_i=\\max_{j&lt;i\\land s[j,n]&lt;s[i,n]}f_j+n-\\text{lcp}(s[i,n],s[j,n])+1\r\n\\]</span>  <span class=\"math inline\">\\(\\text{lcp}(s[i,n],s[j,n])\\leftarrow \\text{lcp}(s[i+1,n],s[j+1,n])\\)</span> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<h4 id=\"\"></h4>\r\n<p> <span class=\"math inline\">\\(O(n\\sqrt n)\\)</span></p>\r\n<p> <code>LCP</code>  <code>height</code> </p>\r\n<p> <span class=\"math inline\">\\(SA\\)</span>  <code>height</code>  <span class=\"math display\">\\[\r\nf_{SA_i}=\\max_{j&lt;i \\land SA_j&lt;SA_i}f_{SA_j}+\\max_{k=j+1}^in-height_k+1\r\n\\]</span>  <code>height</code>  <span class=\"math inline\">\\(\\max\\)</span> <span class=\"math inline\">\\((v,S)\\)</span> <span class=\"math inline\">\\((n-height_{i+1}+1,\\{i\\})\\)</span>  <span class=\"math inline\">\\((v_1,S_1)\\)</span> <span class=\"math inline\">\\((v_2,S_2)\\)</span> <span class=\"math inline\">\\(v_1\\ge v_2\\)</span> <span class=\"math inline\">\\((v_1,S_1\\cup S_2)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(f_{i+1}\\)</span> <span class=\"math inline\">\\((v,S)\\)</span> <span class=\"math inline\">\\(\\max_{j \\in S\\land SA_j\\le SA_i}+v\\rightarrow f_{SA_{i+1}}\\)</span> <span class=\"math inline\">\\(|S|\\le \\sqrt n\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(|S|&gt;\\sqrt n\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(\\sqrt n\\)</span>  <span class=\"math inline\">\\(|S|&gt;\\sqrt n\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(\\max\\)</span><span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(\\sqrt n\\)</span>  <span class=\"math inline\">\\(\\max\\)</span></p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(|S_1|+|S_2|\\le \\sqrt n\\)</span>  <span class=\"math inline\">\\(S_2\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(|S_2|\\)</span>  <span class=\"math inline\">\\(n\\sqrt n\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(|S_1|&gt;\\sqrt n\\land |S_2|\\le \\sqrt n\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(|S_2|\\)</span>  <span class=\"math inline\">\\(n\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(|S_1|,|S_2|&gt;\\sqrt n\\)</span>  <span class=\"math inline\">\\(|S_1|,|S_2|\\le \\sqrt n\\land |S_1|+|S_2|&gt;\\sqrt n\\)</span>  <span class=\"math inline\">\\(|S_1|+|S_2|\\)</span>  <span class=\"math inline\">\\(B\\)</span> <span class=\"math inline\">\\(\\sqrt n\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(O(1)\\)</span> <span class=\"math inline\">\\(O(\\sqrt n)\\)</span> <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(O(\\sqrt n)\\)</span> <span class=\"math inline\">\\(O(1)\\)</span>  <span class=\"math inline\">\\(O(n\\sqrt n)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\max\\)</span><span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(B\\)</span> </p>\r\n<h3 id=\"cf1562f\">CF1562F</h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span> <span class=\"math inline\">\\(\\text{lcm}\\)</span> <span class=\"math inline\">\\(n+5000\\)</span>  <span class=\"math inline\">\\(A\\)</span></p>\r\n<p><span class=\"math inline\">\\(n\\le 10^5,A_i\\le 2\\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(\\gcd(a,b)=1\\)</span> <span class=\"math inline\">\\(\\text{lcm}(a,b)=ab\\)</span> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(p\\)</span> <span class=\"math inline\">\\(n-1\\)</span>  <span class=\"math inline\">\\(A\\)</span></p>\r\n<p> <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(\\text{lcm}(A_1,A_2),\\text{lcm}(A_2,A_3),\\text{lcm}(A_3,A_4),\\cdots,\\text{lcm}(A_{n-1},n)\\)</span> <span class=\"math inline\">\\(p\\)</span> <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(n-1\\)</span>  <span class=\"math inline\">\\(A\\)</span> <span class=\"math inline\">\\(2n-2\\)</span> <span class=\"math inline\">\\(100&lt;n\\le7500\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n\\le 100\\)</span>  <span class=\"math inline\">\\(n&gt;7500\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n\\le 100\\)</span>  <span class=\"math inline\">\\(\\text{lcm}\\)</span> <span class=\"math inline\">\\(n&gt;3\\)</span>  <span class=\"math inline\">\\(\\text{lcm}\\)</span>  <span class=\"math inline\">\\(\\text{lcm}\\)</span>  <span class=\"math inline\">\\(\\max A_i(\\max A_i-1)\\)</span> <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(n=3\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(n&gt;7500\\)</span>  <span class=\"math inline\">\\(5000\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(p\\)</span> <span class=\"math inline\">\\(450\\)</span>  <span class=\"math inline\">\\(p&#39;\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\text{lcm}(A_i,A_j)\\)</span> <span class=\"math inline\">\\(450\\)</span>  <span class=\"math inline\">\\(p,q\\)</span>  <span class=\"math inline\">\\(A_i,A_j\\)</span>  <span class=\"math inline\">\\(p,q\\)</span> <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(k\\)</span> <span class=\"math inline\">\\(p\\not|\\text{lcm}(A_i,A_k)\\)</span>  <span class=\"math inline\">\\(A_i=p\\)</span> <span class=\"math inline\">\\(q\\not|\\text{lcm}(A_j,A_k)\\)</span>  <span class=\"math inline\">\\(A_i=q\\)</span> <span class=\"math inline\">\\(O(\\ln^2n)\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\text{lcm}(p&#39;,x)=\r\n\\begin{cases}\r\nx&amp;(x|p&#39;)\\\\\r\nxp&#39;&amp;(x\\not|p&#39;)\r\n\\end{cases}\r\n\\]</span>  <span class=\"math inline\">\\(\\text{lcm}(p&#39;,x)&gt;2\\cdot 10^5\\)</span>  <span class=\"math inline\">\\(x\\not|p&#39;\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(n-900\\)</span>  <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(p\\)</span> </p>\r\n<h3 id=\"auoj1760\">AUOJ1760</h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p><strong></strong></p>\r\n<p><span class=\"math inline\">\\(n \\le 10^6\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(m\\)</span> <span class=\"math inline\">\\(A\\)</span> <span class=\"math display\">\\[\r\nA_{i,j}=\r\n\\begin{cases}\r\n-1 &amp;( j  i )\\\\\r\n0 &amp;( j  i )\\\\\r\n1 &amp;( j  i )\r\n\\end{cases}\r\n\\]</span> </p>\r\n<p><span class=\"math inline\">\\(A_i\\ne \\{0,0,\\cdots, 0\\}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(B\\)</span> <span class=\"math display\">\\[\r\nB_i=\r\n\\begin{cases}\r\n-1 &amp;( i )\\\\\r\n0 &amp;( i )\\\\\r\n1 &amp;( i )\r\n\\end{cases}\r\n\\]</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(A_?\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(B\\)</span> <span class=\"math inline\">\\(C\\)</span> <span class=\"math inline\">\\(C=-B\\)</span> <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(C\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> </p>\r\n<p><span class=\"math inline\">\\(\\forall i \\ne j, A_i\\ne A_j \\land A_i \\ne -A_j\\)</span></p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(\\forall j\\in[1,m],\\sum_{i=1}^nA_{i,j}=0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(m\\)</span> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(\\frac{3^m-1}2\\)</span><span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(\\frac{3^m-1}2\\)</span></p>\r\n<p><span class=\"math inline\">\\(\\forall j\\in[1,m],\\sum_{i=1}^n|A_{i,j}|=3^{m-1}\\)</span></p>\r\n<blockquote>\r\n<p><span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(n\\le \\frac{3^m-3}2\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(m\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(3|n\\)</span>  <span class=\"math inline\">\\(\\text{next}(A)\\)</span>  <span class=\"math inline\">\\(A\\)</span> <span class=\"math inline\">\\(-1\\rightarrow 0,0\\rightarrow 1,1\\rightarrow -1\\)</span><span class=\"math inline\">\\(A,\\text{next}(A),\\text{next}(\\text{next}(A))\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1 0 -1 1</span><br><span class=\"line\">-1 1 0 -1</span><br><span class=\"line\">0 -1 1 0</span><br></pre></td></tr></table></figure>\r\n<p> <span class=\"math inline\">\\(\\{-1,-1,\\cdots,-1\\}\\)</span>  <span class=\"math inline\">\\(\\{1,1,\\cdots,1\\}\\)</span> <span class=\"math inline\">\\(\\frac {3^m-3}3\\)</span>   <span class=\"math inline\">\\(A\\)</span></p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(3\\not|n\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(\\sum_{j=1}^m|\\sum_{i=1}^nA_{i,j}|\\)</span> </li>\r\n<li></li>\r\n<li>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(-A_i\\)</span></li>\r\n<li> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(-B\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(A_i=B\\)</span></li>\r\n</ul></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(n\\)</span> <span class=\"math inline\">\\(n\\le 10^4\\)</span> </p>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> lf = <span class=\"keyword\">double</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">gen</span><span class=\"params\">(ll x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> ll k = <span class=\"number\">0x9ddfea08eb382d69</span>ull;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">3</span>) x *= k, x ^= x &gt;&gt; <span class=\"number\">47</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * k;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">rnd</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> ll s = <span class=\"built_in\">time</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (s += <span class=\"built_in\">gen</span>(s)) &amp; INT_MAX;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">wrt</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> ed)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* out = cout.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> pc out -&gt; sputc</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> c[<span class=\"number\">11</span>]; <span class=\"keyword\">int</span> sz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> c[++sz] = x % <span class=\"number\">10</span>, x /= <span class=\"number\">10</span>; <span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(sz) <span class=\"built_in\">pc</span>(c[sz--] + <span class=\"number\">48</span>);</span><br><span class=\"line\">    <span class=\"built_in\">pc</span>(ed);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m = <span class=\"number\">2</span>, t = <span class=\"number\">9</span>, nw[<span class=\"number\">15</span>], idx, A[<span class=\"number\">2500000</span>][<span class=\"number\">15</span>], c[<span class=\"number\">15</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i &gt; m) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">2</span>, <span class=\"number\">4</span>) &#123;</span><br><span class=\"line\">            idx++;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(k, <span class=\"number\">1</span>, m) A[idx][k] = (nw[k] + j) % <span class=\"number\">3</span> - <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(idx == t) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(j, <span class=\"number\">-1</span>, <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        nw[i] = j, <span class=\"built_in\">dfs</span>(i + <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(idx == t) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>), cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>), cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(t - <span class=\"number\">3</span> &gt;&gt; <span class=\"number\">1</span> &lt; n) m++, t *= <span class=\"number\">3</span>;</span><br><span class=\"line\">    <span class=\"built_in\">wrt</span>(m, <span class=\"number\">10</span>);</span><br><span class=\"line\">    t = t - <span class=\"number\">1</span> &gt;&gt; <span class=\"number\">1</span>, <span class=\"built_in\">dfs</span>(<span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) c[j] += A[i][j];</span><br><span class=\"line\">    <span class=\"keyword\">int</span> su = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) su += <span class=\"built_in\">abs</span>(c[i]);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(su) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> i = <span class=\"built_in\">rnd</span>() % n + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"built_in\">rnd</span>() % t &lt; n) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> d = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) d += <span class=\"built_in\">abs</span>(c[j] - <span class=\"number\">2</span> * A[i][j]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(d &lt; su || <span class=\"built_in\">rnd</span>() % n &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">                su = d;</span><br><span class=\"line\">                <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) c[j] -= <span class=\"number\">2</span> * A[i][j], A[i][j] *= <span class=\"number\">-1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> k = <span class=\"built_in\">rnd</span>() % (t - n) + n + <span class=\"number\">1</span>, d = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) d += <span class=\"built_in\">abs</span>(c[j] - A[i][j] + A[k][j]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(d &lt; su || <span class=\"built_in\">rnd</span>() % n &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">                su = d;</span><br><span class=\"line\">                <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) c[j] -= A[i][j] - A[k][j], <span class=\"built_in\">swap</span>(A[i][j], A[k][j]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> v = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(j, m, <span class=\"number\">1</span>) v = v * <span class=\"number\">3</span> + A[i][j] + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">wrt</span>(v, <span class=\"number\">32</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n</details>\r\n<h3 id=\"\"></h3>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(\\forall j\\in[1,m],|\\sum_{i=1}^nA_{i,j}|\\le 1\\)</span></li>\r\n<li> <span class=\"math inline\">\\(j\\)</span> <span class=\"math inline\">\\(\\sum_{i=1}^nA_{i,j}=-1\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(A_{i,j}&lt;1\\)</span>  <span class=\"math inline\">\\(A_{i,j}\\)</span>  <span class=\"math inline\">\\(A_{i,j}\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(n\\)</span> <span class=\"math inline\">\\(10^6\\)</span>  <span class=\"math inline\">\\(10\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(10^6\\)</span>  <span class=\"math inline\">\\(n\\)</span></p>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">wrt</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> ed)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* out = cout.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> pc out -&gt; sputc</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> c[<span class=\"number\">11</span>]; <span class=\"keyword\">int</span> sz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> c[++sz] = x % <span class=\"number\">10</span>, x /= <span class=\"number\">10</span>; <span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(sz) <span class=\"built_in\">pc</span>(c[sz--] + <span class=\"number\">48</span>);</span><br><span class=\"line\">    <span class=\"built_in\">pc</span>(ed);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m = <span class=\"number\">2</span>, t = <span class=\"number\">9</span>, nw[<span class=\"number\">15</span>], idx, A[<span class=\"number\">1000005</span>], c[<span class=\"number\">15</span>], as;</span><br><span class=\"line\"><span class=\"keyword\">bool</span> vs[<span class=\"number\">1600000</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i) <span class=\"built_in\">rep</span>(j, <span class=\"number\">-1</span>, <span class=\"number\">1</span>) &#123; nw[i] = j, <span class=\"built_in\">dfs</span>(i - <span class=\"number\">1</span>); <span class=\"keyword\">if</span>(idx == n) <span class=\"keyword\">break</span>; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> x = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(k, m, <span class=\"number\">1</span>) x = x * <span class=\"number\">3</span> + (j + nw[k]) % <span class=\"number\">3</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!x || vs[x] || idx == n) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        A[++idx] = x, vs[x] = vs[t - x] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(k, <span class=\"number\">1</span>, m) c[k] += (j + nw[k]) % <span class=\"number\">3</span> - <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>), cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>), cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(t - <span class=\"number\">3</span> &gt;&gt; <span class=\"number\">1</span> &lt; n) m++, t *= <span class=\"number\">3</span>;</span><br><span class=\"line\">    t--, vs[t / <span class=\"number\">2</span>] = <span class=\"number\">1</span>, <span class=\"built_in\">wrt</span>(m, <span class=\"number\">10</span>), nw[m] = <span class=\"number\">-1</span>, <span class=\"built_in\">dfs</span>(m - <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n % <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) as += <span class=\"built_in\">abs</span>(c[i]);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> th = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(!c[j]) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">int</span> v = A[i] / th % <span class=\"number\">3</span>;</span><br><span class=\"line\">                <span class=\"keyword\">auto</span> Try = [&amp;](<span class=\"keyword\">int</span> x) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> nw = A[i] + x * th;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(vs[nw]) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                    vs[A[i]] = vs[t - A[i]] = <span class=\"number\">0</span>, vs[nw] = vs[t - nw] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                    as -= <span class=\"built_in\">abs</span>(c[j]), c[j] += x, v += x, as += <span class=\"built_in\">abs</span>(c[j]), A[i] = nw;</span><br><span class=\"line\">                &#125;;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(v &lt; <span class=\"number\">2</span> &amp;&amp; c[j] &lt; <span class=\"number\">0</span>) <span class=\"built_in\">Try</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(v &gt; <span class=\"number\">0</span> &amp;&amp; c[j] &gt; <span class=\"number\">0</span>) <span class=\"built_in\">Try</span>(<span class=\"number\">-1</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            th *= <span class=\"number\">3</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">wrt</span>(A[i], <span class=\"number\">32</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n</details>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(n\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(\\sum_{j=1}^m|\\sum_{i=1}^nA_{i,j}|\\)</span> </p></li>\r\n<li><p><span class=\"math inline\">\\(A\\)</span> <strong></strong> <span class=\"math inline\">\\(m\\)</span> <span class=\"math inline\">\\(\\{-1,0,1\\}\\)</span>  <span class=\"math inline\">\\(B\\)</span> <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(-B\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(B,\\text{next}(B),\\text{next}(\\text{next}(B))\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(\\forall j\\in[1,m],|\\sum_{i=1}^nA_{i,j}|\\le 1\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(i\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(\\sum_{i=1}^nA_{i,j}=-1\\land A_{i,j}&lt;1\\)</span> <span class=\"math inline\">\\(A_{i,j}\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(\\sum_{i=1}^nA_{i,j}=1\\)</span> <span class=\"math inline\">\\(A_{i,j}=0\\)</span></li>\r\n</ul></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(10^6\\)</span>  <span class=\"math inline\">\\(n\\)</span></p>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">wrt</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> ed)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* out = cout.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> pc out -&gt; sputc</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> c[<span class=\"number\">11</span>]; <span class=\"keyword\">int</span> sz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> c[++sz] = x % <span class=\"number\">10</span>, x /= <span class=\"number\">10</span>; <span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(sz) <span class=\"built_in\">pc</span>(c[sz--] + <span class=\"number\">48</span>);</span><br><span class=\"line\">    <span class=\"built_in\">pc</span>(ed);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m = <span class=\"number\">2</span>, t = <span class=\"number\">9</span>, nw[<span class=\"number\">15</span>], idx, A[<span class=\"number\">797170</span>], c[<span class=\"number\">15</span>], as;</span><br><span class=\"line\"><span class=\"keyword\">bool</span> vs[<span class=\"number\">1600000</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i) <span class=\"built_in\">per</span>(j, <span class=\"number\">1</span>, <span class=\"number\">-1</span>) &#123; nw[i] = j, <span class=\"built_in\">dfs</span>(i - <span class=\"number\">1</span>); <span class=\"keyword\">if</span>(idx == n) <span class=\"keyword\">break</span>; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> x = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(k, m, <span class=\"number\">1</span>) x = x * <span class=\"number\">3</span> + (j + nw[k]) % <span class=\"number\">3</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(x == t || vs[x] || idx == n) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        A[++idx] = x, vs[x] = vs[t - x] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(k, <span class=\"number\">1</span>, m) c[k] += (j + nw[k]) % <span class=\"number\">3</span> - <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>), cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>), cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(t - <span class=\"number\">3</span> &gt;&gt; <span class=\"number\">1</span> &lt; n) m++, t *= <span class=\"number\">3</span>;</span><br><span class=\"line\">    t--, vs[t / <span class=\"number\">2</span>] = <span class=\"number\">1</span>, <span class=\"built_in\">wrt</span>(m, <span class=\"number\">10</span>), nw[m] = <span class=\"number\">1</span>, <span class=\"built_in\">dfs</span>(m - <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) as += <span class=\"built_in\">abs</span>(c[i]);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(as) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> th = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(!c[j]) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">int</span> v = A[i] / th % <span class=\"number\">3</span>;</span><br><span class=\"line\">                <span class=\"keyword\">auto</span> Try = [&amp;](<span class=\"keyword\">int</span> x) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> nw = A[i] + x * th;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(vs[nw]) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                    vs[A[i]] = vs[t - A[i]] = <span class=\"number\">0</span>, vs[nw] = vs[t - nw] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                    as -= <span class=\"built_in\">abs</span>(c[j]), c[j] += x, v += x, as += <span class=\"built_in\">abs</span>(c[j]), A[i] = nw;</span><br><span class=\"line\">                &#125;;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(v &lt; <span class=\"number\">2</span> &amp;&amp; c[j] &lt; <span class=\"number\">0</span>) <span class=\"built_in\">Try</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(v &gt; <span class=\"number\">0</span> &amp;&amp; c[j] &gt; <span class=\"number\">0</span>) <span class=\"built_in\">Try</span>(-v);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            th *= <span class=\"number\">3</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">wrt</span>(A[i], <span class=\"number\">32</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n</details>\r\n<h3 id=\"auoj1761\">AUOJ1761</h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(B\\)</span> <span class=\"math inline\">\\(0\\)</span> </p>\r\n<p><span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(A_i&gt;B_{j\\bmod m}\\)</span> <span class=\"math inline\">\\(A_i=B_{j\\bmod m}\\)</span></p>\r\n<p><span class=\"math inline\">\\(q\\)</span>  <span class=\"math inline\">\\(d_i\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n,m,q\\le 3\\cdot 10^5,d_i\\le 3\\cdot 10^{12},t_i\\le 10^{18}\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(d_i\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(m\\)</span></p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(p+m\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(p-m\\)</span>  <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(A_i=B_{p \\bmod m}\\)</span> <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(p+m\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(p_i,p_i+m,p_i+2m,pi+3m,\\cdots\\)</span>  <span class=\"math inline\">\\(m\\)</span></p>\r\n<p> <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(p_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(pos\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(B_{pos}\\)</span>  <span class=\"math inline\">\\(T_i\\)</span> <span class=\"math inline\">\\(p_i\\in[T_i-m+1,T_i]\\)</span> <span class=\"math inline\">\\(p_i=T_i-m+k_i\\)</span><span class=\"math inline\">\\(k_i\\)</span>  <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(ix+(T_i-m)i&gt;B_{pos+x}\\)</span> <span class=\"math inline\">\\([l,r]\\)</span>  <span class=\"math inline\">\\(\\min_{j=l}^rB_{pos+j}-ij\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(\\min_{j=1}^x\\{B_{pos+j}-ij\\}&lt;(T_i-m)i\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(O(n\\log n)\\)</span> <span class=\"math inline\">\\(p_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(d\\)</span> <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(m\\)</span> <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(p_i\\bmod m\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(d\\bmod m\\)</span>  <span class=\"math inline\">\\(d\\bmod m&lt;p_i\\bmod m\\)</span></p>\r\n<h3 id=\"codechef-btree\">CodeChef-btree</h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(S(u,k)\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(n\\)</span> <span class=\"math inline\">\\(q\\)</span>  <span class=\"math inline\">\\(|S(u_1,k_1)\\cup S(u_2,k_2)\\cup S(u_3,k_3)\\cup \\cdots \\cup S(u_{m_i},k_{m_i})|\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n,q\\le 5\\cdot 10^4,\\sum_{i=1}^qm_i\\le 5\\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(|S(u,k)|\\)</span> </p>\r\n<h4 id=\"sol-1-1\">Sol 1</h4>\r\n<p> <span class=\"math inline\">\\(u_1,u_2,u_3,\\cdots,u_{m_i}\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\((u_1,k_1),(u_2,k_2)\\)</span>  <span class=\"math inline\">\\(k_1-\\text{dis}(u_1,u_2)&gt;k_2\\)</span> <span class=\"math inline\">\\(S(u_2,k_2)\\subsetneq S(u_1,k_1)\\)</span> <span class=\"math inline\">\\(S(u_2,k_2)\\)</span>  <span class=\"math inline\">\\(k_2=k_1-\\text{dis}(u_1,u_2)\\)</span></p>\r\n<p> <code>Dijkstra</code>  <code>DP</code></p>\r\n<p> <span class=\"math inline\">\\(V\\)</span> <span class=\"math inline\">\\(E\\)</span><span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(r_u\\)</span> <span class=\"math inline\">\\(\\sum_{u\\in V}|S(u,r_u)|-\\sum_{(u,v)\\in E}|S(u,r_u)\\cap S(v,r_v)|\\)</span> <span class=\"math inline\">\\(S(u,r_u)\\)</span>  <span class=\"math inline\">\\(|S(u,r_u)|-|S(u,r_u)\\cap S(fa_u,r_{fa_u})|\\)</span></p>\r\n<p><span class=\"math inline\">\\(|S(u,r_u)|\\)</span> <span class=\"math inline\">\\(|S(u,r_u)\\cap S(v,r_v)|\\)</span>  <span class=\"math inline\">\\(S(w,r)\\)</span> <span class=\"math inline\">\\(w\\)</span> <span class=\"math inline\">\\(w\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O((n+m)\\log n)\\)</span></p>\r\n<h4 id=\"sol-2-1\">Sol 2</h4>\r\n<p> <code>bitset</code> </p>\r\n<p> <span class=\"math inline\">\\(nq \\le 2.5\\cdot 10^9,n\\sum_{i=1}^qm_i\\le 2.5\\cdot 10^{10}\\)</span> <span class=\"math inline\">\\(O(\\frac{n\\sum_{i=1}^qm_i}\\omega)\\)</span> <span class=\"math inline\">\\(O(\\frac{nq}\\omega)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(S(u,k)\\)</span>  <code>bitset</code>  <span class=\"math inline\">\\(O(\\frac n\\omega)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S(u,k)\\)</span>  <span class=\"math inline\">\\(O(\\log n)\\)</span>  <span class=\"math inline\">\\(d\\)</span>  <span class=\"math inline\">\\(d\\)</span>  <span class=\"math inline\">\\(S(u,k)\\)</span>  <span class=\"math inline\">\\(O(\\frac{n\\log n}\\omega)\\)</span>  <span class=\"math inline\">\\(O(\\log n)\\)</span>  <span class=\"math inline\">\\(n,\\frac n2,\\frac n4,\\frac n8,\\cdots\\)</span> <span class=\"math inline\">\\(2n\\)</span>  <span class=\"math inline\">\\([1,n]\\)</span> <code>DFS</code>  <span class=\"math inline\">\\(n,\\frac n2,\\frac n4,\\frac n8,\\cdots\\)</span> <span class=\"math inline\">\\(O(\\frac n\\omega)\\)</span></p>\r\n<p> <code>bitset</code> <code>bitset</code>  <code>bitset</code>  <code>popcount</code> <code>unsigned long long</code>  <code>bitset</code><code>popcount</code>  <span class=\"math inline\">\\([0,65536)\\)</span>  <code>popcount</code> <code>unsigned long long</code>  <span class=\"math inline\">\\([0,65536)\\)</span> </p>\r\n<p> Sol 1 </p>\r\n<h3 id=\"ural2118\">URAL2118</h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(01\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(s\\)</span> <span class=\"math inline\">\\(01\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(-1\\)</span></p>\r\n<p><span class=\"math inline\">\\(k \\le 52, n\\le 10^6\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(S\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(|S|\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(0\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(T\\)</span> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(T\\)</span>  <strong></strong>  <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(y+1\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(T\\)</span> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(y+1\\)</span> <span class=\"math inline\">\\(y\\)</span> <span class=\"math inline\">\\(T&#39;\\)</span>  <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(T&#39;\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(|T|\\ge |T&#39;|\\)</span> <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(T&#39;\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(T=T&#39;0+T&#39;\\)</span><span class=\"math inline\">\\(y\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(T&#39;\\)</span> <span class=\"math inline\">\\(T&#39;\\)</span>  <span class=\"math inline\">\\(T&#39;\\)</span>  <span class=\"math inline\">\\(suffix(i)\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(suffix(1),suffix(2),suffix(3),\\cdots\\)</span> <code>AC</code> </p>\r\n<p> <span class=\"math inline\">\\(O(nk)\\)</span></p>\r\n<h3 id=\"graph-subpaths\">Graph Subpaths</h3>\r\n<blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(l_i\\)</span> <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(i \\in [2,n]\\)</span> <span class=\"math inline\">\\(1\\rightarrow i\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n,m,\\sum_{i=1}^kl_i \\le 10^5\\)</span></p>\r\n</blockquote>\r\n<h3 id=\"sol-1-2\">Sol 1</h3>\r\n<p> <span class=\"math inline\">\\(i\\rightarrow 1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\((u,v)\\)</span> <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\(T_i\\)</span>  <span class=\"math inline\">\\(i\\rightarrow 1\\)</span>  <code>trie</code> <span class=\"math inline\">\\(T_u\\)</span> <span class=\"math inline\">\\((u,v)\\)</span><span class=\"math inline\">\\(T_v\\)</span>  <span class=\"math inline\">\\(T_v\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(T_u\\)</span> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(T_u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(T_u\\)</span>  <code>trie</code> <span class=\"math inline\">\\((u,v)\\)</span> <span class=\"math inline\">\\(T_u\\)</span>  <span class=\"math inline\">\\(T_v\\)</span>  <span class=\"math inline\">\\(T_v\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<h3 id=\"sol-2-2\">Sol 2</h3>\r\n<p> <code>AC</code>  <span class=\"math inline\">\\(O(n^2)\\)</span>  <code>DP</code> <span class=\"math inline\">\\(f_{i,u}\\)</span>  <span class=\"math inline\">\\(i\\)</span><code>AC</code>  <code>u</code> <code>AC</code> </p>\r\n<p> <code>AC</code>  <code>DP</code>  <span class=\"math inline\">\\(f_u\\)</span> </p>\r\n<p> <code>AC</code>  <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<h3 id=\"zoj3390\">ZOJ3390</h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(T_1,T_2\\)</span> <span class=\"math inline\">\\(T_1+T_2\\)</span> <span class=\"math inline\">\\(T_1\\cdot T_2\\)</span>  <span class=\"math inline\">\\(T_1\\)</span>  <span class=\"math inline\">\\(T_2\\)</span><span class=\"math inline\">\\(T_1=T_2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(A,B,C\\)</span> <span class=\"math inline\">\\(X,Y\\)</span>  <span class=\"math inline\">\\(AX+BY=C\\)</span></p>\r\n<p><span class=\"math inline\">\\(|A|,|B|,|C| \\le 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(height(T)\\)</span>  <span class=\"math inline\">\\(T\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(height(T_1+T_2)=\\max(height(T_1),height(T_2)),height(T_1\\cdot T_2)=height(T_1)+height(T_2)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\max(height(A)+height(X),height(B)+height(Y))=height(C)\\)</span> <span class=\"math inline\">\\(height(A)+height(X)=height(C)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(height(X)\\)</span> <span class=\"math inline\">\\(X\\)</span> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(C\\)</span>  <span class=\"math inline\">\\(height(X)\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(X\\)</span> <span class=\"math inline\">\\(AX\\)</span> <span class=\"math inline\">\\(BY\\)</span> <span class=\"math inline\">\\(Y\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(BY\\)</span> </p>\r\n<p> <span class=\"math display\">\\[\r\nf_u=1+\\sum_{v\\in son(u)}f_v\\cdot \\text{prime}(size_v)\r\n\\]</span>  <span class=\"math inline\">\\(\\text{prime}(i)\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p><strong></strong> <span class=\"math inline\">\\(T_1,T_2\\)</span><span class=\"math inline\">\\(f_{T_1}=f_{T_2}\\)</span> </p>\r\n<p><code>Generator</code>  <span class=\"math inline\">\\(T,A,B,C,D\\)</span>  <span class=\"math inline\">\\(A,X,B,Y\\)</span> </p>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> eb emplace_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mp make_pair</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> fi first </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> se second</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> all(x) (x).begin(), (x).end()</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> SZ(x) int((x).size())</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) / 2)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lc o * 2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rc o * 2 + 1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, lc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, rc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> cmi(a, b) (a = min(a, b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> cma(a, b) (a = max(a, b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lb lower_bound</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ub upper_bound</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> bs binary_search</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pop __builtin_popcount</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llpop __builtin_popcountll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ctz __builtin_ctz</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llctz __builtin_ctzll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> clz __builtin_clz</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llclz __builtin_clzll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> par __builtin_parity</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llpar __builtin_parityll</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> lf = <span class=\"keyword\">double</span>;</span><br><span class=\"line\"><span class=\"comment\">// using P = pair&lt;int, int&gt;;</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> V = vector&lt;<span class=\"keyword\">int</span>&gt;;</span><br><span class=\"line\"><span class=\"comment\">// using cmp = complex&lt;lf&gt;;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">gen</span><span class=\"params\">(ll x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> ll k = <span class=\"number\">0x9ddfea08eb382d69</span>ull;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">3</span>) x *= k, x ^= x &gt;&gt; <span class=\"number\">47</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * k;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">rnd</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> ll s = <span class=\"built_in\">time</span>(<span class=\"number\">0</span>) + (ll)<span class=\"keyword\">new</span> <span class=\"keyword\">char</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (s += <span class=\"built_in\">gen</span>(s)) &amp; INT_MAX;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">V <span class=\"title\">tmul</span><span class=\"params\">(V a, V b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = a.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>, m = b.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>, su = n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">2</span>, m) a.<span class=\"built_in\">pb</span>(b[j] == <span class=\"number\">1</span> ? i : b[j] + su - <span class=\"number\">1</span>);</span><br><span class=\"line\">        su += m - <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">V <span class=\"title\">tplus</span><span class=\"params\">(V a, V b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = a.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>, m = b.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(j, <span class=\"number\">2</span>, m) a.<span class=\"built_in\">pb</span>(b[j] == <span class=\"number\">1</span> ? <span class=\"number\">1</span> : b[j] + n - <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">5</span>, A = <span class=\"number\">5</span>, B = <span class=\"number\">5</span>, C = <span class=\"number\">5</span>, D = <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">int</span> T = <span class=\"number\">100000</span>;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, T);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(kase, <span class=\"number\">1</span>, T) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> a = <span class=\"built_in\">rnd</span>() % A + <span class=\"number\">1</span>, b = <span class=\"built_in\">rnd</span>() % B + <span class=\"number\">1</span>, c = <span class=\"built_in\">rnd</span>() % C + <span class=\"number\">1</span>, d = <span class=\"built_in\">rnd</span>() % D + <span class=\"number\">1</span>;</span><br><span class=\"line\">        V t1&#123;<span class=\"number\">0</span>&#125;, t2&#123;<span class=\"number\">0</span>&#125;, t3&#123;<span class=\"number\">0</span>&#125;, t4&#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> get = [](V&amp; t, <span class=\"keyword\">int</span> n) &#123; <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) t.<span class=\"built_in\">pb</span>(i &gt; <span class=\"number\">1</span> ? <span class=\"built_in\">rnd</span>() % (i - <span class=\"number\">1</span>) + <span class=\"number\">1</span> : <span class=\"number\">0</span>); &#125;;</span><br><span class=\"line\">        <span class=\"built_in\">get</span>(t1, a), <span class=\"built_in\">get</span>(t2, b), <span class=\"built_in\">get</span>(t3, c), <span class=\"built_in\">get</span>(t4, d);</span><br><span class=\"line\">        V t5 = <span class=\"built_in\">tplus</span>(<span class=\"built_in\">tmul</span>(t1, t2), <span class=\"built_in\">tmul</span>(t3, t4));</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d %d %llu\\n&quot;</span>, a, c, t5.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> prt = [](V&amp; v) &#123; <span class=\"built_in\">For</span>(i, <span class=\"number\">1</span>, v.<span class=\"built_in\">size</span>()) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, v[i]); <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;&quot;</span>); &#125;;</span><br><span class=\"line\">        <span class=\"built_in\">prt</span>(t1), <span class=\"built_in\">prt</span>(t3), <span class=\"built_in\">prt</span>(t5);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n</details>\r\n<p><code>Special judge</code> <code>checker.cpp</code><code>checker &lt;input-file&gt; &lt;output-file&gt;</code> <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(1\\)</span></p>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> eb emplace_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mp make_pair</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> fi first </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> se second</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> all(x) (x).begin(), (x).end()</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> SZ(x) int((x).size())</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) / 2)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lc o * 2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rc o * 2 + 1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, lc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, rc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> cmi(a, b) (a = min(a, b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> cma(a, b) (a = max(a, b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lb lower_bound</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ub upper_bound</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> bs binary_search</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pop __builtin_popcount</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llpop __builtin_popcountll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ctz __builtin_ctz</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llctz __builtin_ctzll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> clz __builtin_clz</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llclz __builtin_clzll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> par __builtin_parity</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llpar __builtin_parityll</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> lf = <span class=\"keyword\">double</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> P = pair&lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;;</span><br><span class=\"line\"><span class=\"keyword\">using</span> V = vector&lt;<span class=\"keyword\">int</span>&gt;;</span><br><span class=\"line\"><span class=\"comment\">// using cmp = complex&lt;lf&gt;;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1e5</span> + <span class=\"number\">5</span>, M = <span class=\"number\">1299709</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> f[M + <span class=\"number\">5</span>], pid, prm[N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">V <span class=\"title\">tmul</span><span class=\"params\">(V a, V b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = a.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>, m = b.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>, su = n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">2</span>, m) a.<span class=\"built_in\">pb</span>(b[j] == <span class=\"number\">1</span> ? i : b[j] + su - <span class=\"number\">1</span>);</span><br><span class=\"line\">        su += m - <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">V <span class=\"title\">tplus</span><span class=\"params\">(V a, V b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = a.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>, m = b.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(j, <span class=\"number\">2</span>, m) a.<span class=\"built_in\">pb</span>(b[j] == <span class=\"number\">1</span> ? <span class=\"number\">1</span> : b[j] + n - <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">P <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">const</span> V G[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\">P <span class=\"title\">re</span><span class=\"params\">(<span class=\"number\">1</span>, <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> [h, sz] = <span class=\"built_in\">dfs</span>(v, G);</span><br><span class=\"line\">        re.fi = (re.fi + (ll)h * prm[sz]) % <span class=\"number\">999999937</span>;</span><br><span class=\"line\">        re.se += sz;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">Hash</span><span class=\"params\">(<span class=\"keyword\">const</span> V&amp; t)</span> </span>&#123;</span><br><span class=\"line\">    vector&lt;<span class=\"keyword\">int</span>&gt; G[N];</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">1</span>, t.<span class=\"built_in\">size</span>()) G[t[i]].<span class=\"built_in\">pb</span>(i);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>, G).fi;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">(FILE* f)</span> </span>&#123; <span class=\"keyword\">int</span> x; <span class=\"keyword\">return</span> <span class=\"built_in\">fscanf</span>(f, <span class=\"string\">&quot;%d&quot;</span>, &amp;x) == <span class=\"number\">1</span> ? x : <span class=\"number\">-1</span>; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, M) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!f[i]) prm[++pid] = i;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">1</span>; i * prm[j] &lt;= M; j++) &#123;</span><br><span class=\"line\">            f[i * prm[j]] = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(i % prm[j] == <span class=\"number\">0</span>) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    FILE *in = <span class=\"built_in\">fopen</span>(argv[<span class=\"number\">1</span>], <span class=\"string\">&quot;r&quot;</span>), *out = <span class=\"built_in\">fopen</span>(argv[<span class=\"number\">2</span>], <span class=\"string\">&quot;r&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> T = <span class=\"built_in\">read</span>(in); T--;) &#123;</span><br><span class=\"line\">        V t1&#123;<span class=\"number\">0</span>&#125;, t2&#123;<span class=\"number\">0</span>&#125;, t3&#123;<span class=\"number\">0</span>&#125;, t4&#123;<span class=\"number\">0</span>&#125;, t5&#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> get = [](FILE* f, V&amp; t, <span class=\"keyword\">int</span> n) &#123; <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) t.<span class=\"built_in\">pb</span>(<span class=\"built_in\">read</span>(f)); &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> a = <span class=\"built_in\">read</span>(in), b = <span class=\"built_in\">read</span>(in), c = <span class=\"built_in\">read</span>(in);</span><br><span class=\"line\">        <span class=\"built_in\">get</span>(in, t1, a), <span class=\"built_in\">get</span>(in, t3, b), <span class=\"built_in\">get</span>(in, t5, c);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> d = <span class=\"built_in\">read</span>(out), e = <span class=\"built_in\">read</span>(out);</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> err = [&amp;]() &#123;</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;1\\n%d %d %d\\n&quot;</span>, a, b, c);</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, a) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, t1[i]); <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, b) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, t3[i]); <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, c) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, t5[i]);</span><br><span class=\"line\">            <span class=\"built_in\">exit</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!~d) <span class=\"built_in\">err</span>();</span><br><span class=\"line\">        <span class=\"built_in\">get</span>(out, t2, d), <span class=\"built_in\">get</span>(out, t4, e);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((ll)a * d + (ll)b * e != c &amp;&amp; <span class=\"built_in\">Hash</span>(<span class=\"built_in\">tplus</span>(<span class=\"built_in\">tmul</span>(t1, t2), <span class=\"built_in\">tmul</span>(t3, t4))) != <span class=\"built_in\">Hash</span>(t5)) <span class=\"built_in\">err</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n</details>\r\n<h3 id=\"izho-2020-d1t3\">IZhO 2020 D1T3</h3>\r\n<blockquote>\r\n<p><a href=\"codeforces.com/group/Uo1lq8ZyWf/contest/265564\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span> <span class=\"math inline\">\\((i,j,k)\\)</span>  <span class=\"math inline\">\\(i\\le j&lt;k\\)</span>  <span class=\"math inline\">\\([i,j]\\)</span>  <span class=\"math inline\">\\([j+1,k]\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 2\\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(prev_i\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(next_i\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\((i,j,k)\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\([j+1,k]\\)</span>  <span class=\"math inline\">\\([i,j]\\)</span>  <span class=\"math inline\">\\(i \\le \\min prev_{j+1\\cdots i}\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(R_{j,k}=\\min prev_{j+1\\cdots k}\\)</span></li>\r\n<li> <span class=\"math inline\">\\([i,j]\\)</span>  <span class=\"math inline\">\\([j+1,k]\\)</span>  <span class=\"math inline\">\\(\\max next_{i\\cdots j}\\le k\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(L_{j,k}\\)</span> <span class=\"math inline\">\\(L_{j,k}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(\\max next_{i\\cdots j}\\le k\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\((j,k)\\)</span>  <span class=\"math inline\">\\(\\max(R_{j,k}-L_{j,k}+1,0)\\)</span> <span class=\"math inline\">\\(k\\)</span> <span class=\"math inline\">\\(\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(L_{j,k}\\)</span>  <span class=\"math inline\">\\(R_{j,k}\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(R_{j,k}=\\min prev_{j+1\\cdots k}\\)</span> <span class=\"math inline\">\\(prev\\)</span>  <span class=\"math inline\">\\(\\min\\)</span> <span class=\"math inline\">\\(k\\rightarrow k+1\\)</span> <span class=\"math inline\">\\(R_{j,k}\\)</span>  <span class=\"math inline\">\\(prev_{k+1}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(L_{j,k}\\)</span> <span class=\"math inline\">\\(k\\rightarrow k+1\\)</span>  <span class=\"math inline\">\\(j\\)</span><span class=\"math inline\">\\(L_{j,k}\\)</span>  <span class=\"math inline\">\\(k\\)</span> <span class=\"math inline\">\\(\\max next_{i\\cdots j}\\)</span>  <span class=\"math inline\">\\(next\\)</span>  <span class=\"math inline\">\\(\\max\\)</span> <span class=\"math inline\">\\(next_{1\\cdots j}\\)</span>  <span class=\"math inline\">\\(next_{i_1},next_{i_2},next_{i_3},\\cdots,next_{i_k}\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(k\\in[j+1,next_{i_k}-1]\\)</span> <span class=\"math inline\">\\(L_{j,k}=\\infty\\)</span></li>\r\n<li> <span class=\"math inline\">\\(k\\in [next_{i_k},next_{i_{k-1}-1}]\\)</span><span class=\"math inline\">\\(L_{j,k}=i_{k-1}+1\\)</span></li>\r\n<li><span class=\"math inline\">\\(\\cdots\\)</span></li>\r\n<li> <span class=\"math inline\">\\(k\\in [next_{i_1},n]\\)</span><span class=\"math inline\">\\(L_{j,k}=1\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i_x\\)</span>  <span class=\"math inline\">\\(k\\in [next_{i_x},next_{i_{x-1}}-1]\\)</span><span class=\"math inline\">\\(L_{j,k}=i_{x-1}+1\\)</span> <span class=\"math inline\">\\(next_y\\)</span>  <span class=\"math inline\">\\(next_{i_x}\\)</span>  <span class=\"math inline\">\\(j\\in [i_x,y-1],k\\in [next_{i_x},next_{i_{x-1}}-1]\\)</span> <span class=\"math inline\">\\(L_{j,k}=i_{x-1}+1\\)</span> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(next_{i_x}-1\\rightarrow next_{i_x}\\)</span>  <span class=\"math inline\">\\(L_{i_x\\cdots y-1,k}\\)</span>  <span class=\"math inline\">\\(i_x+1\\)</span> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(L_{j,k}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)\\)</span> <span class=\"math inline\">\\(L_{j,k}\\)</span>  <span class=\"math inline\">\\(R_{j,k}\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(R_{l\\cdots r,k}\\)</span>  <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\(v \\le \\min L_{l\\cdots r,k}\\)</span> <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(v \\ge \\max L_{l\\cdots r,k}\\)</span> <span class=\"math inline\">\\(\\sum_{j=l}^rR_{j,k}-\\sum_{j=l}^rL_{j,k}+(r-l+1)\\)</span> <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(\\forall j \\in[l,x], v\\ge L_{j,k},\\forall j\\in[x+1,r],v\\le L_{j,k}\\)</span> <span class=\"math inline\">\\(L_{j,k},R_{j,k}\\)</span>  <span class=\"math inline\">\\(\\min,\\max\\)</span>  <span class=\"math inline\">\\(sum\\)</span>  <span class=\"math inline\">\\(\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(L_{ql\\cdots qr,k}\\)</span>  <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\([l,r]\\)</span> <span class=\"math inline\">\\(ql\\le l\\land r \\le qr\\)</span>  <span class=\"math inline\">\\(ql\\le l\\land r \\le qr \\land (v \\le \\min L_{l\\cdots r,k}\\lor v \\ge \\max L_{l\\cdots r,k})\\)</span>  <span class=\"math inline\">\\(\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> eb emplace_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) / 2)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lc o * 2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rc o * 2 + 1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, lc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, rc</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, a[N], pre[N], nxt[N], L[N];</span><br><span class=\"line\">vector&lt;tuple&lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; vl[N], vr[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> tagL[N * <span class=\"number\">4</span>], minL[N * <span class=\"number\">4</span>], maxL[N * <span class=\"number\">4</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> tagR[N * <span class=\"number\">4</span>], minR[N * <span class=\"number\">4</span>], maxR[N * <span class=\"number\">4</span>];</span><br><span class=\"line\">ll sum[N * <span class=\"number\">4</span>], sumL[N * <span class=\"number\">4</span>], sumR[N * <span class=\"number\">4</span>], as;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pushUp</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    sum[o] = sum[lc] + sum[rc];</span><br><span class=\"line\">    sumL[o] = sumL[lc] + sumL[rc];</span><br><span class=\"line\">    sumR[o] = sumR[lc] + sumR[rc];</span><br><span class=\"line\">    minL[o] = <span class=\"built_in\">min</span>(minL[lc], minL[rc]);</span><br><span class=\"line\">    minR[o] = <span class=\"built_in\">min</span>(minR[lc], minR[rc]);</span><br><span class=\"line\">    maxL[o] = <span class=\"built_in\">max</span>(maxL[lc], maxL[rc]);</span><br><span class=\"line\">    maxR[o] = <span class=\"built_in\">max</span>(maxR[lc], maxR[rc]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pushL</span><span class=\"params\">(<span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    tagL[o] = minL[o] = maxL[o] = v, sumL[o] = v * (r - l + <span class=\"number\">1ll</span>);</span><br><span class=\"line\">    sum[o] = <span class=\"built_in\">max</span>(sumR[o] - sumL[o], <span class=\"number\">0ll</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pushR</span><span class=\"params\">(<span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    tagR[o] = minR[o] = maxR[o] = v, sumR[o] = v * (r - l + <span class=\"number\">1ll</span>);</span><br><span class=\"line\">    sum[o] = <span class=\"built_in\">max</span>(sumR[o] - sumL[o], <span class=\"number\">0ll</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pushDown</span><span class=\"params\">(<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(~tagL[o]) <span class=\"built_in\">pushL</span>(tagL[o], lch), <span class=\"built_in\">pushL</span>(tagL[o], rch), tagL[o] = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(~tagR[o]) <span class=\"built_in\">pushR</span>(tagR[o], lch), <span class=\"built_in\">pushR</span>(tagR[o], rch), tagR[o] = <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">updL</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L &lt;= l &amp;&amp; r &lt;= R &amp;&amp; (v &lt;= minR[o] || v &gt;= maxR[o])) <span class=\"keyword\">return</span> <span class=\"built_in\">pushL</span>(v, l, r, o);</span><br><span class=\"line\">    <span class=\"built_in\">pushDown</span>(l, r, o);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L &lt;= mid) <span class=\"built_in\">updL</span>(L, R, v, lch);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(R &gt; mid) <span class=\"built_in\">updL</span>(L, R, v, rch);</span><br><span class=\"line\">    <span class=\"built_in\">pushUp</span>(o);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">updR</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L &lt;= l &amp;&amp; r &lt;= R &amp;&amp; (v &gt;= maxL[o] || v &lt;= minL[o])) <span class=\"keyword\">return</span> <span class=\"built_in\">pushR</span>(v, l, r, o);</span><br><span class=\"line\">    <span class=\"built_in\">pushDown</span>(l, r, o);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L &lt;= mid) <span class=\"built_in\">updR</span>(L, R, v, lch);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(R &gt; mid) <span class=\"built_in\">updR</span>(L, R, v, rch);</span><br><span class=\"line\">    <span class=\"built_in\">pushUp</span>(o);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) L[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) pre[i] = L[a[i]], L[a[i]] = i;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) L[i] = n + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, n, <span class=\"number\">1</span>) nxt[i] = L[a[i]], L[a[i]] = i;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>&amp; j = L[i] = i - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; j &amp;&amp; pre[j] &gt;= pre[i]; j = L[j]);</span><br><span class=\"line\">        vr[i].<span class=\"built_in\">eb</span>(<span class=\"built_in\">max</span>(j, <span class=\"number\">1</span>), i - <span class=\"number\">1</span>, pre[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>&amp; j = L[i] = i - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; j &amp;&amp; nxt[j] &lt;= nxt[i]; j = L[j])</span><br><span class=\"line\">            vl[nxt[j]].<span class=\"built_in\">eb</span>(<span class=\"built_in\">max</span>(j, <span class=\"number\">1</span>), i - <span class=\"number\">1</span>, L[j]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(tagL, <span class=\"number\">63</span>), <span class=\"built_in\">mem</span>(tagR, <span class=\"number\">-1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [l, r, v] : vl[i]) <span class=\"built_in\">updL</span>(l, r, v, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [l, r, v] : vr[i]) <span class=\"built_in\">updR</span>(l, r, v, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">        as += sum[<span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; as;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n</details>\r\n<h3 id=\"cf566c\">CF566C</h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(w_i\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(1.5\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(f(u)\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(f(u)\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 2\\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(f(u)\\)</span>  <span class=\"math inline\">\\(f(u)\\)</span>  <span class=\"math inline\">\\(f(u)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(w_v\\text{dis}^{1.5}_v(u)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\([l,r]\\)</span>  <span class=\"math inline\">\\(\\frac {l+r}2\\)</span>  <span class=\"math inline\">\\(\\frac {l+r}2\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(f(u)\\)</span> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(f(u)\\)</span>  <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\((u,v)\\)</span> <span class=\"math inline\">\\(f(u)\\)</span>  <span class=\"math inline\">\\((u,v)\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math display\">\\[\r\n\\frac 32\\left(\\sum_{i=1}^nw_i\\sqrt{\\text{dis}(i,u)}-2\\sum_{i\\in \\text{subree}(v)}w_i\\sqrt{\\text{dis}(i,u)}\\right)\r\n\\]</span>  <span class=\"math inline\">\\(O(n)\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n","site":{"data":{}},"length":55543,"excerpt":"","more":"<p></p>\r\n<h3 id=\"tc13459\">TC13459</h3>\r\n<p>1 1 1</p>\r\n<p> <span class=\"math inline\">\\((i,j),(i,k)\\)</span> <span class=\"math inline\">\\((j,k)\\)</span>  <span class=\"math inline\">\\((i,j)\\)</span>  <span class=\"math inline\">\\((i,k)\\)</span> </p>\r\n<p></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math display\">\\[\r\n\\sum_{i=0}^x\\binom xi2^yn^{\\underline{i+y}}n^{\\underline{x-i+y}}\r\n\\]</span>  <span class=\"math inline\">\\(O(n^3)\\)</span>DFS  <span class=\"math inline\">\\(O(n^3\\alpha(n^2))\\)</span></p>\r\n<h3 id=\"tc12909\">TC12909</h3>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(f_{i,j}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i+1\\)</span> <span class=\"math inline\">\\(f_{i+1,j+1} \\leftarrow j \\cdot f_{i,j}\\)</span></li>\r\n<li> <span class=\"math inline\">\\(i+1\\)</span> <span class=\"math inline\">\\(f_{i+1,j} \\leftarrow 2j \\cdot f_{i,j}\\)</span></li>\r\n<li> <span class=\"math inline\">\\(i+1\\)</span> <span class=\"math inline\">\\(f_{i+1,j-1} \\leftarrow j \\cdot f_{i,j}\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(j \\le G\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(K\\)</span>  <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(N\\binom{N-K-1}{K-1}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(N^2)\\)</span></p>\r\n<h3 id=\"tc13692\">TC13692</h3>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(S_1-S_2\\)</span>  <span class=\"math inline\">\\(u\\)</span> <span class=\"math inline\">\\(f_u\\)</span> <span class=\"math inline\">\\(u=S_1\\)</span>  <span class=\"math inline\">\\(S_2\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S_1-S_2\\)</span>  <span class=\"math inline\">\\(f\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(S_1-S_2\\)</span>  <span class=\"math inline\">\\((u,v)\\)</span> <span class=\"math inline\">\\((u,v)\\)</span> <span class=\"math inline\">\\(O(n)\\)</span>  <span class=\"math inline\">\\(f_u+f_v\\)</span></p>\r\n<p> <span class=\"math inline\">\\(f_{S_1}+f_{S_2}\\)</span> </p>\r\n<h3 id=\"agc017f\">AGC017F</h3>\r\n<p><span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(2^{N-1}\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(S,T\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(S\\)</span> </p>\r\n<p> <code>DP</code> <span class=\"math inline\">\\(f_{i,j,k,S}\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span> </li>\r\n<li><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(N-1-j\\)</span>  <span class=\"math inline\">\\(i-1\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i-1\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(k\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j+1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^32^n)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S,T\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(T\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(1\\)</span> </p></li>\r\n<li><p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(1\\)</span></p></li>\r\n</ul>\r\n<p> <code>DP</code>  <span class=\"math inline\">\\(f_{i,j,S}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(j+1\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(O(1)\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(O(1)\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n^22^n)\\)</span></p>\r\n<h3 id=\"arc078d\">ARC078D</h3>\r\n<p> <span class=\"math inline\">\\(1-n\\)</span> </p>\r\n<ul>\r\n<li></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(u_1,u_2,\\cdots,u_k\\)</span><span class=\"math inline\">\\(u_1=1,u_k=n\\)</span> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(u_k\\)</span></p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(g_S\\)</span>  <span class=\"math inline\">\\(S\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(f_S\\)</span>  <span class=\"math inline\">\\(S\\)</span> </li>\r\n<li><span class=\"math inline\">\\(f_S \\leftarrow f_{S-T} + g_T({T \\subseteq S})\\)</span> <span class=\"math inline\">\\(T\\)</span> </li>\r\n</ul>\r\n<p> <code>DP</code> </p>\r\n<p> <span class=\"math inline\">\\(f_{i,S}\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(1-i\\)</span> </p>\r\n<p>:</p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(f_{i,S \\cup \\{i\\}} \\leftarrow f_{j,S} + w(j,i)(j \\not\\in S)\\)</span></li>\r\n<li><span class=\"math inline\">\\(f_{i,S\\cup T} \\leftarrow f_{i,S}+g_{T\\cup\\{i\\}}(S \\cap T = \\varnothing)\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n3^n)\\)</span></p>\r\n<p>ARC068D</p>\r\n<p>AGC004F</p>\r\n<p>ARC097D</p>\r\n<p>TC10265</p>\r\n<p>TC9844</p>\r\n<p>ARC067C</p>\r\n<p>ARC097C</p>\r\n<h3 id=\"tc10727\">TC10727</h3>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(k\\)</span> </li>\r\n</ul>\r\n<p> <code>DP</code> <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(\\text{dis}(x,\\text{lca}(x,v)),\\text{dis}(v,\\text{lca}(x,v))\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(f_{i,j,k}\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(\\text{dis}(x,\\text{lca}(x,v))=j,\\text{dis}(v,\\text{lca}(x,v))=k\\)</span> </p>\r\n<p></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(f_{i+1,j+1,k} \\leftarrow 2f_{i,j,k},f_{i+1,j-1,k} \\leftarrow f_{i,j,k}(j&gt;0)\\)</span></li>\r\n<li><span class=\"math inline\">\\(f_{i+1,1,k} \\leftarrow f_{i,0,k},f_{i+1,\\max(1-k,0),\\max(k-1,0)} \\leftarrow f_{i,0,k}(k&gt;0)\\)</span></li>\r\n<li><span class=\"math inline\">\\(f_{i+1,0,k+1} \\leftarrow f_{i,0,k}(k &lt; \\text{depth}_v)\\)</span></li>\r\n</ul>\r\n<p>TC10664</p>\r\n<p>TC10566</p>\r\n<p>TC10773</p>\r\n<h3 id=\"tc10993\">TC10993</h3>\r\n<p> <span class=\"math inline\">\\(0\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(C\\)</span>  <span class=\"math inline\">\\(C\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(C\\)</span>  <span class=\"math inline\">\\(C\\)</span>  <span class=\"math inline\">\\(\\min  + \\min  \\ge C\\)</span></p>\r\n<p> <code>DP</code> <span class=\"math inline\">\\(f_{i,j}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(\\min\\)</span>  <span class=\"math inline\">\\(j\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(i+1\\)</span>  <span class=\"math inline\">\\(k\\)</span><span class=\"math inline\">\\(f_{i+1,\\min(j,k)} \\leftarrow f_{i,j}(j+k \\ge C)\\)</span> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(i+1\\)</span>  <span class=\"math inline\">\\(i+1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(nC^2)\\)</span></p>\r\n<p></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(f_{i+1,j} \\leftarrow f_{i,j}(k \\ge \\max(j,C-j))\\)</span> <span class=\"math inline\">\\(k\\)</span></li>\r\n<li><span class=\"math inline\">\\(f_{i+1,k} \\leftarrow f_{i,j}(k \\le j \\le C -k)\\)</span> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(O(1)\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(nC)\\)</span></p>\r\n<p>TC10741</p>\r\n<p>TC10854</p>\r\n<p>TC10848</p>\r\n<p>TC10902</p>\r\n<p>TC10737</p>\r\n<p>TC10758</p>\r\n<p>TC11003</p>\r\n<p>TC11026</p>\r\n<p>TC11032</p>\r\n<p>TC10748</p>\r\n<p>TC11213</p>\r\n<p>TC11305</p>\r\n<p>TC12620</p>\r\n<p>TC10758</p>\r\n<p>TC11032</p>\r\n<h3 id=\"gym102391e\">Gym102391E</h3>\r\n<p> <span class=\"math inline\">\\(D\\)</span> <span class=\"math inline\">\\(f_u\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(u\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(D\\)</span></li>\r\n<li><span class=\"math inline\">\\(f_u\\)</span>  <span class=\"math inline\">\\(u\\)</span>/ <span class=\"math inline\">\\(fa_u\\)</span></li>\r\n</ul>\r\n<p></p>\r\n<ul>\r\n<li><p><span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(f\\)</span>  <span class=\"math inline\">\\(D\\)</span> <span class=\"math inline\">\\(D\\)</span>  <span class=\"math inline\">\\(D\\)</span>  <code>DP</code> <span class=\"math inline\">\\(f\\)</span> </p></li>\r\n<li><p><span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(fa\\)</span>  <span class=\"math inline\">\\(u\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(+f_v\\)</span></li>\r\n<li> <span class=\"math inline\">\\(v_1,v_2\\)</span>  <span class=\"math inline\">\\(+f_{v_1}+f_{v_2}\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(D\\)</span></p>\r\n<p><span class=\"math inline\">\\(f_u \\leftarrow \\max\\limits_vf_v+\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(fa\\)</span> </p>\r\n<p><span class=\"math inline\">\\(f_u \\leftarrow\\)</span>  <span class=\"math inline\">\\(fa\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(^2)\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(fa\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(fa\\)</span>  <span class=\"math inline\">\\(i\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(fa\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span> </li>\r\n</ul></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n\\log V)\\)</span></p>\r\n<h3 id=\"zoj3970\">ZOJ3970</h3>\r\n<p></p>\r\n<ul>\r\n<li></li>\r\n<li></li>\r\n</ul>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(a_i\\)</span>  <span class=\"math inline\">\\(\\sum_{i=2}^n\\max(0,a_i-a_{i-1})\\)</span></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(pre_i\\)</span>  <span class=\"math inline\">\\(t_j&gt;0\\)</span>  <span class=\"math inline\">\\(j\\)</span></p>\r\n<p><span class=\"math inline\">\\(f_{i,j}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span> </p>\r\n<p></p>\r\n<p><span class=\"math display\">\\[\r\nf_{i,j}=\\min_kf_{pre_i,k}+\\max(0,j-k)+\\max(0,t_i-s_i+j-t_{pre_i}+s_{pre_i}-k)+\\max(0,\\max_{pre_i&lt;x&lt;i}s_x-\\max(j,k))\r\n\\]</span></p>\r\n<p> <span class=\"math inline\">\\((pre_i,i)\\)</span>  <span class=\"math inline\">\\(0\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(nV^2)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(f_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\min\\)</span>  <span class=\"math inline\">\\(O(1)\\)</span>  <span class=\"math inline\">\\(f_{i,j}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(f_i\\)</span>  <span class=\"math inline\">\\([l,r]\\)</span> <span class=\"math inline\">\\(f_{i,l},f_{i,mid},f_{i,r}\\)</span>  <span class=\"math inline\">\\([l,r]\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n\\log V)\\)</span></p>\r\n<h3 id=\"zoj3989\">ZOJ3989</h3>\r\n<p></p>\r\n<p></p>\r\n<ul>\r\n<li></li>\r\n<li></li>\r\n<li></li>\r\n<li></li>\r\n</ul>\r\n<p> <code>DP</code> </p>\r\n<p></p>\r\n<p></p>\r\n<ul>\r\n<li></li>\r\n<li> <span class=\"math inline\">\\([l,r]\\)</span> <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(l &lt; x &lt; r\\)</span> <span class=\"math inline\">\\(x &gt; r\\)</span></li>\r\n<li></li>\r\n<li></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(2^{n-2}\\)</span></p>\r\n<p></p>\r\n<p></p>\r\n<p></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(f_{S,i}\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^22^n)\\)</span></p>\r\n<h3 id=\"\"></h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(f(S)\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S \\ne \\{1,2,\\cdots,n\\}\\)</span> <span class=\"math inline\">\\(|f(S)| \\le |S|\\)</span></p>\r\n<p><span class=\"math inline\">\\(n, m \\le 10^5\\)</span></p>\r\n</blockquote>\r\n<p>Hall  <span class=\"math inline\">\\(S\\)</span><span class=\"math inline\">\\(|f(S)| \\ge |S|\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(|f(S)| \\le |S|\\)</span> <span class=\"math inline\">\\(S\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(f(S)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\(\\text{match}(v)\\)</span></p>\r\n<p> <span class=\"math inline\">\\((u,v)\\)</span>  <span class=\"math inline\">\\((u,\\text{match}(v))\\)</span> </p>\r\n<h3 id=\"arc107f\">ARC107F</h3>\r\n<p></p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(-B_i,A_i,B_i\\)</span></li>\r\n<li> <span class=\"math inline\">\\(u,v\\)</span></li>\r\n<li></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(U_i,V_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\((S,U_i),(U_i,V_i),(V_i,T)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\infty-B_i,\\infty+A_i,\\infty+B_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\((i,j)\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\((S,U_i),(V_j,T)\\)</span> <span class=\"math inline\">\\((S,U_i)\\)</span> <span class=\"math inline\">\\(U_i\\)</span>  <span class=\"math inline\">\\(T\\)</span> <span class=\"math inline\">\\((V_j,T)\\)</span> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(V_j\\)</span> <span class=\"math inline\">\\((V_j,U_i)\\)</span> <span class=\"math inline\">\\(\\infty^2\\)</span> </li>\r\n<li> <span class=\"math inline\">\\((S,U_j),(V_i,T)\\)</span> <span class=\"math inline\">\\((V_i,U_j)\\)</span> <span class=\"math inline\">\\(\\infty^2\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(n\\infty\\)</span></p>\r\n<figure>\r\n<img src=\"https://i.loli.net/2021/09/08/4ragjEUYIev5wot.png\" alt=\".png\" /><figcaption aria-hidden=\"true\">.png</figcaption>\r\n</figure>\r\n<h3 id=\"gym101471j\">Gym101471J</h3>\r\n<p>CF1307G</p>\r\n<h3 id=\"cf1307f\">CF1307F</h3>\r\n<p>P3980</p>\r\n<p>CF1368H2</p>\r\n<h3 id=\"agc038e\">AGC038E</h3>\r\n<p><span class=\"math inline\">\\(B_i=1\\)</span> </p>\r\n<p> <code>DP</code>  <code>min-max</code> </p>\r\n<p> <span class=\"math inline\">\\(O(n2^n)\\)</span>  <span class=\"math inline\">\\(O(2^n)\\)</span>  <span class=\"math inline\">\\(400\\)</span></p>\r\n<p> <code>min-max</code>  <span class=\"math display\">\\[\r\n\\sum_{S}(-1)^{|S|}\\frac{\\sum_{i=1}^n A_i}{\\sum_{i \\in S} A_i}\r\n\\]</span>  <span class=\"math inline\">\\(400\\)</span>  <span class=\"math inline\">\\(\\sum_S(-1)^{|S|}\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\nf_{i,j} = \\sum_{S \\subseteq \\{1,2,\\cdots,i\\}}(-1)^{|S|}[\\sum_{i \\in S}A_i=j]\r\n\\]</span>  <span class=\"math inline\">\\(f_{i,j}=f_{i-1,j}-f_{i-1,j-A_i}\\)</span> <span class=\"math display\">\\[\r\n(\\sum_{i=1}^n A_i)\\sum_{i=0}^{400}\\frac{f_{n,i}}i\r\n\\]</span>  <code>min-max</code>  <span class=\"math display\">\\[\r\n\\sum_{S}(-1)^{|S|}[S ]\r\n\\]</span></p>\r\n<p> <span class=\"math inline\">\\(p_i=\\frac{A_i}{\\sum_{j \\in S}A_j}\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;\\sum_{\\forall i \\in S,c_i&lt;B_i}[c]\\cdot[c]\\\\\r\n&amp;=\\sum_{\\forall i \\in S,c_i&lt;B_i}\\frac{(\\sum_{i \\in S}c_i)!}{\\prod_{i \\in S} c_i!}\\prod_{i \\in S}p_i^{c_i} \\cdot \\frac{\\sum_{i=1}^n A_i}{\\sum_{i \\in S} A_i}\\\\\r\n&amp;=\\sum_{\\forall i \\in S,c_i&lt;B_i}\\frac{(\\sum_{i \\in S}c_i)!}{\\prod_{i \\in S} c_i!}\\prod_{i \\in S}A_i^{c_i} \\cdot \\frac{\\sum_{i=1}^n A_i}{(\\sum_{i \\in S} A_i)^{(\\sum_{i \\in S}c_i)+1}}\r\n\\end{aligned}\r\n\\]</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;\\sum_S(-1)^{|S|}\\sum_{\\forall i \\in S,c_i&lt;B_i}\\frac{(\\sum_{i \\in S}c_i)!}{\\prod_{i \\in S} c_i!}\\prod_{i \\in S}A_i^{c_i} \\cdot \\frac{\\sum_{i=1}^n A_i}{(\\sum_{i \\in S} A_i)^{(\\sum_{i \\in S}c_i)+1}}\\\\\r\n&amp;=(\\sum_{i=1}^n A_i)\\sum_S(-1)^{|S|}\\sum_{\\forall i \\in S,c_i&lt;B_i}\\frac{(\\sum_{i \\in S}c_i)!}{(\\sum_{i \\in S} A_i)^{(\\sum_{i \\in S}c_i)+1}} \\cdot \\prod_{i \\in S}\\frac{A_i^{c_i}}{c_i!}\r\n\\end{aligned}\r\n\\]</span></p>\r\n<p> <span class=\"math inline\">\\(\\sum_{i \\in S} A_i\\)</span>  <span class=\"math inline\">\\(\\sum_{i \\in S}c_i\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\nf_{i,j,k}=\\sum_{S \\subseteq \\{1,2,\\cdots,i\\}}(-1)^{|S|}\\sum_{\\forall i \\in S,c_i&lt;B_i}\\prod_{i \\in S}\\frac{A_i^{c_i}}{c_i!}[\\sum_{i \\in S} A_i=j \\land \\sum_{i \\in S}c_i=k]\r\n\\]</span>  <span class=\"math display\">\\[\r\nf_{i,j,k}=f_{i-1,j,k}-\\sum_{c=0}^{B_i-1}f_{i-1,j-A_i,k-c}\\frac{A_i^c}{c!}\r\n\\]</span>  <span class=\"math display\">\\[\r\n(\\sum_{i=1}^n A_i)\\sum_{i=0}^{400}\\sum_{j=0}^{400}\\frac{j!f_{n,i,j}}{i^{j+1}}\r\n\\]</span>  <span class=\"math inline\">\\(B_i\\)</span> <span class=\"math inline\">\\(\\sum_{i=1}^nB_i\\)</span>  <span class=\"math inline\">\\(O(n)\\)</span>  <span class=\"math inline\">\\(O(n^3)\\)</span> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<hr />\r\n<h3 id=\"agc037d\">AGC037D</h3>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\((i-1)m+1\\)</span>  <span class=\"math inline\">\\(im\\)</span>  <span class=\"math inline\">\\((i-1)m+1\\)</span>  <span class=\"math inline\">\\(im\\)</span>  <span class=\"math inline\">\\(i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i\\)</span> Hall </p>\r\n<p> <span class=\"math inline\">\\(O(n^4)\\)</span></p>\r\n<h3 id=\"agc043d\">AGC043D</h3>\r\n<p> <span class=\"math inline\">\\(P\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(A_i\\)</span> </p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(3\\)</span> </li>\r\n<li></li>\r\n<li> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(A_i\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(P\\)</span>  <span class=\"math inline\">\\(P\\)</span>  <span class=\"math inline\">\\(A\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(P\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(1,2,3\\)</span>  <span class=\"math inline\">\\(cnt_1,cnt_2,cnt_3\\)</span> <span class=\"math inline\">\\(cnt_1+2cnt_2+3cnt_3=3n\\)</span>  <span class=\"math inline\">\\(cnt_1 \\ge cnt_2\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\binom{cnt_1+cnt_2+cnt_3}{cnt_1,cnt_2,cnt_3}\\frac{(3n)!}{(cnt_1+cnt_2+cnt_3)!2^{cnt_2}3^{cnt_3}}\r\n\\]</span>  <span class=\"math inline\">\\((cnt_1+cnt_2+cnt_3)!\\)</span>  <span class=\"math inline\">\\(2^{cnt_2}3^{cnt_3}\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<h3 id=\"agc049d\">AGC049D</h3>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(c\\)</span> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(A=(c,c,\\cdots,c)\\)</span></li>\r\n<li> <span class=\"math inline\">\\(j&lt;i\\)</span> <span class=\"math inline\">\\(A_j,A_{j-1},A_{j-2},\\cdots,A_1\\)</span>  <span class=\"math inline\">\\(1,2,3,\\cdots,j\\)</span></li>\r\n<li> <span class=\"math inline\">\\(j&gt;i\\)</span> <span class=\"math inline\">\\(A_j,A_{j+1},A_{j+2},\\cdots,A_n\\)</span>  <span class=\"math inline\">\\(1,2,3,\\cdots,n-j+1\\)</span> <span class=\"math inline\">\\(i&gt;1\\)</span>  <span class=\"math inline\">\\(i-1\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i-1\\)</span>  <span class=\"math inline\">\\(\\frac {i(i-1)}2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(O(\\sqrt m)\\)</span>  <span class=\"math inline\">\\(O(m\\sqrt m)\\)</span>  <span class=\"math inline\">\\(O(\\frac mn)\\)</span>  <span class=\"math inline\">\\(c\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(nm\\sqrt m)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i \\rightarrow i+1\\)</span>  <span class=\"math inline\">\\(O(\\sqrt m)\\)</span>  <span class=\"math inline\">\\(O(m\\sqrt m)\\)</span> </p>\r\n<h3 id=\"agc050d\">AGC050D</h3>\r\n<p> <span class=\"math inline\">\\(f_{i,a,b,j}\\)</span>  <span class=\"math inline\">\\(j\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(i\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\(i+1\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(f_{i,0,b,j}=f_{i+1,b,0,j}\\)</span></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(f_{i,a,b,j}=win \\cdot f_{i,a-1,b,j-[j&gt;b]} + lost \\cdot f_{i,a-1,b+1,j}(j\\ne b+1)\\)</span></li>\r\n<li><span class=\"math inline\">\\(f_{i,a,b,b+1}=win + lost \\cdot f_{i,a-1,b+1,b+1}(j\\le b)\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n^4)\\)</span></p>\r\n<h3 id=\"noi2021day1t1\">NOI2021Day1T1</h3>\r\n<p></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(O(n\\log^2n)\\)</span></p>\r\n<h3 id=\"noi2021day1t2\">NOI2021Day1T2</h3>\r\n<p> <span class=\"math inline\">\\(k=2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(n_1=n_2=\\cdots=n_k\\)</span> </p>\r\n<p></p>\r\n<p></p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\((P_1,P_2,\\cdots,P_k)\\)</span>  <span class=\"math inline\">\\((Q_1,Q_2,\\cdots,Q_k)\\)</span> <span class=\"math inline\">\\(\\iff\\)</span> <span class=\"math inline\">\\((P_1,Q_1)\\)</span>  <span class=\"math inline\">\\((P_k,Q_k)\\)</span> </p></li>\r\n<li><p></p>\r\n<ul>\r\n<li></li>\r\n<li></li>\r\n</ul>\r\n<p></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n^4)\\)</span></p>\r\n<h3 id=\"noi2021day1t3\">NOI2021Day1T3</h3>\r\n<p> <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(t\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(x\\Rightarrow z\\)</span>  <span class=\"math inline\">\\(y\\Rightarrow z\\)</span> <span class=\"math inline\">\\(x\\Rightarrow y\\)</span>  <span class=\"math inline\">\\(y\\Rightarrow x\\)</span> <span class=\"math inline\">\\(z\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(s,t\\)</span> </p>\r\n<p> <code>LCA</code>  <code>vector</code></p>\r\n<p> <span class=\"math inline\">\\(O(n+q\\log n)\\)</span></p>\r\n<h3 id=\"noi2021day2t1\">NOI2021Day2T1</h3>\r\n<p><span class=\"math inline\">\\(k \\le 15\\)</span>  <span class=\"math inline\">\\(256\\)</span>  <span class=\"math inline\">\\(16\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(16\\)</span>  <span class=\"math inline\">\\(7\\)</span>  <code>popcount</code> </p>\r\n<h3 id=\"noi2021day2t2\">NOI2021Day2T2</h3>\r\n<p><del></del></p>\r\n<p> <span class=\"math inline\">\\(a\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(a_n\\)</span>  <span class=\"math inline\">\\(x,y\\)</span> <span class=\"math inline\">\\(\\frac {x&#39;}{y&#39;}=a_{n-1}+\\frac 1{a_n}=\\frac {a_{k-1}x+y}x\\)</span> <span class=\"math inline\">\\((x,y)\\)</span>  <span class=\"math display\">\\[\r\n\\begin{bmatrix}\r\nx&#39;\\\\\r\ny&#39;\r\n\\end{bmatrix}\r\n=\r\n\\begin{bmatrix}\r\na_{n-1}&amp;1\\\\\r\n1&amp;0\r\n\\end{bmatrix}\r\n\\begin{bmatrix}\r\nx\\\\\r\ny\r\n\\end{bmatrix}\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\begin{bmatrix}\r\na&amp;c\\\\\r\nb&amp;d\r\n\\end{bmatrix}\r\n=\r\n\\prod_{i=1}^n\r\n\\begin{bmatrix}\r\na_i&amp;1\\\\\r\n1&amp;0\r\n\\end{bmatrix}\r\n\\]</span>  <span class=\"math inline\">\\(\\frac ab\\)</span></p>\r\n<p></p>\r\n<ul>\r\n<li><p><code>W</code>  <span class=\"math inline\">\\(\\begin{bmatrix}x&amp;1\\\\1&amp;0\\end{bmatrix}\\begin{bmatrix}1&amp;0\\\\1&amp;1\\end{bmatrix}=\\begin{bmatrix}x+1&amp;1\\\\1&amp;0\\end{bmatrix}\\)</span> 'W'  <span class=\"math inline\">\\(\\begin{bmatrix}1&amp;0\\\\1&amp;1\\end{bmatrix}\\)</span></p></li>\r\n<li><p><code>E</code>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math display\">\\[\r\n\\begin{bmatrix}\r\n1&amp;1\\\\\r\n1&amp;0\r\n\\end{bmatrix}\r\n\\rightarrow\r\n\\begin{bmatrix}\r\n1&amp;0\\\\\r\n1&amp;1\r\n\\end{bmatrix}\r\n\\begin{bmatrix}\r\n1&amp;1\\\\\r\n1&amp;0\r\n\\end{bmatrix}\r\n=\r\n\\begin{bmatrix}\r\n1&amp;1\\\\\r\n2&amp;1\r\n\\end{bmatrix}\r\n\\]</span> <strong></strong> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math display\">\\[\r\n\\begin{bmatrix}\r\n1&amp;1\\\\\r\n1&amp;0\r\n\\end{bmatrix}\r\n\\rightarrow\r\n\\begin{bmatrix}\r\n0&amp;1\\\\\r\n1&amp;0\r\n\\end{bmatrix}\r\n\\begin{bmatrix}\r\n1&amp;1\\\\\r\n1&amp;0\r\n\\end{bmatrix}^2\r\n=\r\n\\begin{bmatrix}\r\n1&amp;1\\\\\r\n2&amp;1\r\n\\end{bmatrix}\r\n\\]</span>  <code>E</code>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(\\begin{bmatrix}1&amp;0\\\\-1&amp;1\\end{bmatrix}\\)</span></p>\r\n<p> <code>E</code>  <span class=\"math inline\">\\(\\begin{bmatrix}1&amp;0\\\\-1&amp;1\\end{bmatrix}\\begin{bmatrix}1&amp;1\\\\1&amp;0\\end{bmatrix}^2=\\begin{bmatrix}2&amp;1\\\\-1&amp;0\\end{bmatrix}\\)</span></p></li>\r\n</ul>\r\n<p><code>APPEND</code><code>FLIP</code>  <code>REVERSE</code> <code>FLIP</code>  <code>FLIP</code> </p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<h3 id=\"noi2021day2t3\">NOI2021Day2T3</h3>\r\n<p> <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(0,1,2,3\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(mask\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(0,1\\)</span>  <span class=\"math inline\">\\(2,3\\)</span> <span class=\"math inline\">\\(1\\)</span></li>\r\n<li> <span class=\"math inline\">\\(01\\)</span>  <span class=\"math inline\">\\(2\\)</span></li>\r\n<li> <span class=\"math inline\">\\(3\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(2^nmn^2)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(g_{0/1/2/3,S}\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(0/1/2/3\\)</span> <span class=\"math inline\">\\(g\\)</span>  <span class=\"math inline\">\\(O(2^n)\\)</span>  <span class=\"math inline\">\\(g\\)</span>  <span class=\"math inline\">\\(O(1)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(2^nm)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n \\le 32\\)</span> <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(\\lceil\\frac n2\\rceil\\)</span>  <span class=\"math inline\">\\(\\lceil\\frac n2\\rceil\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(\\max\\)</span></p>\r\n<ul>\r\n<li><p><span class=\"math inline\">\\(\\max \\le \\lceil\\frac n2\\rceil\\)</span> <span class=\"math inline\">\\(O(2^{\\frac n2}m)\\)</span></p></li>\r\n<li><p><span class=\"math inline\">\\(\\max &gt; \\lceil\\frac n2\\rceil\\)</span> <span class=\"math inline\">\\(n-\\max+1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(R\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(R\\)</span>  <span class=\"math inline\">\\(mask\\)</span> </p></li>\r\n<li><p></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(2\\max-n+1\\)</span> <span class=\"math inline\">\\(O(2^{n-\\max+1}m)\\)</span>  <code>DP</code> <span class=\"math inline\">\\(f_{i,S}\\)</span>  <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(n-\\max+1\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(i+1\\)</span>  <span class=\"math inline\">\\(O(2^{n-\\max+1}m)\\)</span>  <span class=\"math inline\">\\(O(2^{n-\\max+1}n)\\)</span></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(2^{n/2}m)\\)</span></p>\r\n<h3 id=\"cf1548d2\">CF1548D2</h3>\r\n<p> Pick  <span class=\"math display\">\\[\r\nS=i+\\frac b2-1\r\n\\]</span>  <span class=\"math inline\">\\(S\\in \\mathbb Z \\land2S\\equiv b \\pmod 4\\)</span></p>\r\n<p> <span class=\"math inline\">\\(ABC\\)</span> <span class=\"math inline\">\\(2S=|\\overrightarrow A\\times \\overrightarrow B+\\overrightarrow B\\times \\overrightarrow C+\\overrightarrow C\\times \\overrightarrow A|\\)</span> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(2S \\bmod 4\\)</span></p>\r\n<p> <span class=\"math inline\">\\(AB\\)</span>  <strong></strong> <span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\(AB\\)</span>  <span class=\"math inline\">\\(\\text{bounds}(A,B)=\\gcd(|X_A-X_B|,|Y_A-Y_B|)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\(\\text{bounds}(A,B) \\bmod 4\\)</span>  <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(2\\)</span>  <span class=\"math display\">\\[\r\n\\text{bounds}(A,B) \\equiv 0\\pmod 4 \\iff X_A\\equiv X_B\\pmod 4 \\land Y_A\\equiv Y_B\\pmod 4\r\n\\]</span>  <span class=\"math inline\">\\(\\text{bounds}(A,B) \\not\\equiv 0\\pmod 4\\)</span>  <span class=\"math display\">\\[\r\n\\text{bounds}(A,B) \\equiv 2\\pmod 4 \\iff X_A\\equiv X_B\\pmod 2 \\land Y_A\\equiv Y_B\\pmod 2\r\n\\]</span>  <span class=\"math inline\">\\(4\\)</span> </p>\r\n<p> EEE  EOO  <span class=\"math inline\">\\(cnt_{A,x,y,z}\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math display\">\\[\r\nX_B\\equiv x\\pmod 4 \\land Y_B\\equiv y\\pmod 4 \\land \\text{bounds}(A,B) \\equiv z\\pmod 4\r\n\\]</span>  <span class=\"math inline\">\\(O(n^2\\log V)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(ABC\\)</span>  <span class=\"math inline\">\\(A\\)</span> <span class=\"math display\">\\[\r\nX_B\\bmod 4,Y_B\\bmod 4,\\text{bounds}(A,B)\\bmod 4\\\\X_C\\bmod 4,Y_C\\bmod 4,\\text{bounds}(A,C)\\bmod 4\r\n\\]</span>  <span class=\"math display\">\\[\r\nS \\in \\mathbb Z\\\\\r\n\\text{bounds}(A,B)\\equiv\\text{bounds}(A,C)\\pmod 2\\\\\r\nX_B\\equiv X_C \\pmod 2\\\\\r\nY_B\\equiv Y_C\\pmod 2\\\\\r\nS\\equiv \\text{bounds}(A,B)+\\text{bounds}(A,C)+\\text{bounds}(B,C)\\pmod 4\r\n\\]</span>  <span class=\"math inline\">\\(cnt\\)</span>  <span class=\"math inline\">\\(O(1)\\)</span> </p>\r\n<p> EEE  <span class=\"math inline\">\\(3\\)</span>  EOO  <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^2\\log V)\\)</span></p>\r\n<h3 id=\"cf1548e\">CF1548E</h3>\r\n<p><del> 3400</del></p>\r\n<p> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(0\\)</span>1-</p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(i,j\\)</span>1 </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(a_i \\ge a_j\\)</span><span class=\"math inline\">\\(a_i+b_k \\le x \\Rightarrow a_j+b_k \\le x\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a,b\\)</span> </p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(L_r\\)</span> <span class=\"math inline\">\\(R_r\\)</span> <span class=\"math inline\">\\(L_c\\)</span> <span class=\"math inline\">\\(R_c\\)</span></li>\r\n<li> <span class=\"math inline\">\\(a_{L_r},a_{L_r+1},\\cdots,a_{R_r}\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\((i,L_c),(i,L_c+1),\\cdots,(i,R_c)\\)</span>  1</li>\r\n<li> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(i\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(i\\)</span>  1  <span class=\"math inline\">\\([l,r]\\)</span> <span class=\"math inline\">\\(i\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(a_j \\le a_i\\)</span><span class=\"math inline\">\\(\\min_{k\\in [l,r]}a_k+\\max_{k\\in (j,i]}b_k&gt;x\\)</span></li>\r\n<li> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(a_j&lt;a_i\\)</span><span class=\"math inline\">\\(\\min_{k\\in [l,r]}a_k+\\max_{k\\in [i,j)}b_k&gt;x\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(a_j\\le a_i\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(pre\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(a_j&lt; a_i\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(suf\\)</span> <span class=\"math inline\">\\([l,r]\\)</span>  <span class=\"math inline\">\\(\\min_{i\\in [l,r]}a_i&gt;x-\\max_{i\\in (pre,suf)}\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(O(n)\\)</span> </p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(b\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(a_i\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(1\\)</span></li>\r\n<li> <span class=\"math inline\">\\(key\\)</span></li>\r\n</ul>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<h3 id=\"minieye5t1\">2021MINIEYE5T1</h3>\r\n<p></p>\r\n<ul>\r\n<li><code>1</code>  <code>access(u)</code></li>\r\n<li><code>2</code> </li>\r\n<li><code>3</code>  <code>dfs</code> </li>\r\n<li><code>4</code> </li>\r\n</ul>\r\n<p> <code>23</code> </p>\r\n<p> <code>4</code>  <code>LCT</code>  <code>access</code> </p>\r\n<p> <span class=\"math inline\">\\(O(n\\log^2n)\\)</span></p>\r\n<h3 id=\"minieye5t2\">2021MINIEYE5T2</h3>\r\n<p> <span class=\"math inline\">\\(f_{i,j}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <code>a</code><span class=\"math inline\">\\(j\\)</span>  <code>b</code> <span class=\"math inline\">\\((x+y+k-2)^L\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\sum_{i=0}^L\\sum_{j=0}^L[n|i-p][n|j-q][x^i][y^j](x+y+k-2)^L\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n|P-1\\)</span> <span class=\"math display\">\\[\r\n\\frac 1{n^2}\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}(\\omega_n^i+\\omega_n^j+k-2)^L\\omega_n^{-ip}\\omega_n^{-jq}\r\n\\]</span>  <span class=\"math inline\">\\(A_{i,j}=(\\omega_n^i+\\omega_n^j+k-2)^L\\)</span>  <span class=\"math inline\">\\(O(n^2\\log L)\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <code>IDFT</code>  <code>IDFT</code>  <span class=\"math inline\">\\(O(n^3)\\)</span> Bluestein + MTT  <span class=\"math inline\">\\(O(n^2\\log n)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n^3)\\)</span>  <span class=\"math inline\">\\(O(n^2\\log L)\\)</span></p>\r\n<h3 id=\"minieye5t9\">2021MINIEYE5T9</h3>\r\n<p> <strong></strong></p>\r\n<p></p>\r\n<h4 id=\"-1\"> 1</h4>\r\n<p> <span class=\"math inline\">\\(v\\)</span></p>\r\n<p> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(p_1,p_2,\\cdots,p_k\\)</span> <span class=\"math inline\">\\([l,r]\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(p_j\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(j\\)</span> <span class=\"math inline\">\\((l,r)\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(-1\\)</span> <span class=\"math inline\">\\(sum_i\\)</span> <span class=\"math inline\">\\([l,r]\\)</span>  <span class=\"math inline\">\\(sum_{l-1}&lt;sum_r\\)</span> <span class=\"math inline\">\\(sum_1,sum_2,\\cdots,sum_{p_j}\\)</span> <span class=\"math inline\">\\(j\\rightarrow j+1\\)</span>  <span class=\"math inline\">\\(sum_{p_j},sum_{p_j+1},\\cdots,sum_{p_{j+1}-1}\\)</span> <span class=\"math inline\">\\(+1\\)</span> <span class=\"math inline\">\\(r\\in[p_j,p_{j+1})\\)</span> <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(sum_r\\)</span>  <span class=\"math inline\">\\([p_j,p_{j+1})\\)</span>  <span class=\"math inline\">\\(sum_r\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<h4 id=\"-2\"> 2</h4>\r\n<p> <span class=\"math inline\">\\([l,r]\\)</span>  <span class=\"math inline\">\\(l\\le mid+1 \\land r\\ge mid\\)</span></p>\r\n<p> <span class=\"math inline\">\\([l,r]\\)</span>  <span class=\"math inline\">\\([l,mid]\\)</span>  <span class=\"math inline\">\\([mid+1,r]\\)</span> </p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(O(\\log n)\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(O(\\log n)\\)</span>  <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(-1\\)</span> <span class=\"math inline\">\\(sum_i\\)</span> <span class=\"math inline\">\\(r\\)</span>  <span class=\"math inline\">\\(l\\le mid+1\\)</span>  <span class=\"math inline\">\\(sum_{l-1}&lt;sum_r\\)</span> <span class=\"math inline\">\\(O(1)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n\\log^2n)\\)</span></p>\r\n<h3 id=\"minieye5t13\">2021MINIEYE5T13</h3>\r\n<p> <span class=\"math inline\">\\(D\\)</span> <code>DP</code> </p>\r\n<p> <span class=\"math inline\">\\(f_{u,0/1}\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(\\infty\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(u\\)</span> </li>\r\n<li><span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(u\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(D\\)</span></li>\r\n</ul>\r\n<p><span class=\"math inline\">\\(f_{u,1}\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(\\min(f_{v,0}+w(u,v),f_{v,1}+\\max(w(u,v)-p_v,0))\\)</span>  <span class=\"math inline\">\\(D\\)</span><span class=\"math inline\">\\(f_{u,1}=\\infty\\)</span></p>\r\n<p><span class=\"math inline\">\\(f_{u,0}\\)</span> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\((u,v)\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(\\min(f_{v,0}+w(u,v),f_{v,1}+w(u,v)-p_v)\\)</span>  <span class=\"math inline\">\\(v\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n\\log V)\\)</span></p>\r\n<h3 id=\"agc041d\">AGC041D</h3>\r\n<p> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(k+1\\)</span>  <span class=\"math inline\">\\(\\lceil\\frac n2\\rceil\\)</span>  <span class=\"math inline\">\\(\\lceil\\frac n2\\rceil-1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(A\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(\\lfloor\\frac n2\\rfloor+1\\)</span>  <span class=\"math inline\">\\(c\\)</span> <span class=\"math inline\">\\(A=(c,c,\\cdots,c)\\)</span></li>\r\n<li> <span class=\"math inline\">\\(j&lt;\\lfloor\\frac n2\\rfloor+1\\)</span> <span class=\"math inline\">\\(A_1,A_2,\\cdots,A_j\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(j&gt;\\lfloor\\frac n2\\rfloor+1\\)</span> <span class=\"math inline\">\\(A_j,A_{j+1},\\cdots,A_n\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(A_1 \\ge 1\\)</span> <span class=\"math inline\">\\(c-1\\)</span> <span class=\"math inline\">\\(n-c\\)</span></li>\r\n<li> <span class=\"math inline\">\\(\\lceil\\frac n2\\rceil\\)</span>  <span class=\"math inline\">\\(\\lceil\\frac n2\\rceil-1\\)</span>  <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(x=c\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(j\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(n-j+1\\)</span> <span class=\"math inline\">\\(c\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(1,2,\\cdots,\\lfloor\\frac n2\\rfloor\\)</span>  <span class=\"math inline\">\\(c-1\\)</span>  <span class=\"math inline\">\\(1,2,\\cdots,\\lceil\\frac n2\\rceil-1\\)</span>  <span class=\"math inline\">\\(n-c\\)</span>  <span class=\"math inline\">\\(c\\)</span></p>\r\n<p> <span class=\"math inline\">\\(L_{i,j}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math display\">\\[\r\nL_{i,j}=L_{i-1,j-1}+L_{i,j-i}-L_{i-1,j-i-\\lfloor\\frac n2\\rfloor}\r\n\\]</span>  <span class=\"math inline\">\\(R_{i,j}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(c\\)</span>  <span class=\"math inline\">\\(O(n)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<h3 id=\"agc027d\">AGC027D</h3>\r\n<p></p>\r\n<ul>\r\n<li></li>\r\n<li> <span class=\"math inline\">\\(1\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(\\text{lcm}\\)</span> <span class=\"math inline\">\\(\\text{lcm}+1\\)</span> <span class=\"math inline\">\\(2\\text{lcm}+1,3\\text{lcm}+1,\\cdots\\)</span></p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(\\text{lcm}\\)</span>  <span class=\"math inline\">\\(\\text{lcm}\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(N\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(A_{i,j}\\)</span>  <span class=\"math inline\">\\(\\text{lcm(i,j)}\\)</span>  <span class=\"math inline\">\\(N\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(A_{i,j}\\)</span>  <span class=\"math inline\">\\(\\text{lcm}(i+j,i-j+n)\\)</span>  <span class=\"math inline\">\\(N\\)</span>  <span class=\"math inline\">\\(425\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(A_{i,j}\\)</span>  <span class=\"math inline\">\\(\\text{lcm}(i+(n-j+1),i-(n-j+1)+n)\\)</span></li>\r\n<li></li>\r\n</ul>\r\n<p> <code>set</code>  <span class=\"math inline\">\\(O(n^2\\log n)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<h3 id=\"agc025d\">AGC025D</h3>\r\n<p> <span class=\"math inline\">\\(\\sqrt D\\)</span>  <span class=\"math inline\">\\((x_1,y_1),(x_2,y_2)\\)</span> <span class=\"math inline\">\\(x_1-x_2,y_1-y_2\\)</span>  <span class=\"math display\">\\[\r\nx_1 \\equiv x_2 \\pmod 2,y_1 \\equiv y_2 \\pmod 2 \\iff D \\equiv 0 \\pmod 4\\\\\r\nx_1 \\equiv x_2 \\pmod 2,y_1 \\not\\equiv y_2 \\pmod 2 \\iff D \\equiv 1 \\pmod 4\\\\\r\nx_1 \\not\\equiv x_2 \\pmod 2,y_1 \\not\\equiv y_2 \\pmod 2 \\iff D \\equiv 2 \\pmod 4\\\\\r\n\\]</span>  <span class=\"math inline\">\\(D \\bmod 4\\)</span> </p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(\\sqrt D\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(\\text{color}(x,y,D)=0/1\\)</span>  <span class=\"math inline\">\\((x,y)\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(D\\equiv 3\\pmod 4\\)</span> <span class=\"math inline\">\\(\\text{color}(x,y,D)=0\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\(D\\equiv 2\\pmod 4\\)</span> <span class=\"math inline\">\\(\\text{color}(x,y,D)=x\\bmod 2\\)</span> <span class=\"math inline\">\\(\\sqrt D\\)</span> </p></li>\r\n<li><p> <span class=\"math inline\">\\(D \\equiv 1\\pmod 4\\)</span> <span class=\"math inline\">\\(\\text{color}(x,y,D)=(x+y)\\bmod 2\\)</span> <span class=\"math inline\">\\(\\sqrt D\\)</span> </p></li>\r\n<li><p> <span class=\"math inline\">\\(D\\equiv 0\\pmod 4\\)</span> <span class=\"math inline\">\\(\\text{color}(x,y,D)=\\text{color}(\\lfloor\\frac x2\\rfloor,\\lfloor\\frac y2\\rfloor,\\frac D4)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\sqrt D\\)</span>  <span class=\"math inline\">\\((x_1,y_1),(x_2,y_2)\\)</span> <span class=\"math inline\">\\(x_1 \\equiv x_2 \\pmod 2,y_1 \\equiv y_2 \\pmod 2\\)</span> <span class=\"math display\">\\[\r\n\\lfloor\\frac {x_1}2\\rfloor-\\lfloor\\frac {x_2}2\\rfloor=\\frac 12(x_1-x_2)\\\\\r\n\\lfloor\\frac {y_1}2\\rfloor-\\lfloor\\frac {y_2}2\\rfloor=\\frac 12(y_1-y_2)\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\begin{aligned}\r\n&amp;(x_1-x_2)^2+(y_1-y_2)^2=D\\\\\r\n\\Rightarrow &amp;(\\lfloor\\frac {x_1}2\\rfloor-\\lfloor\\frac {x_2}2\\rfloor)^2+(\\lfloor\\frac {y_1}2\\rfloor-\\lfloor\\frac {y_2}2\\rfloor)^2=\\frac D4\\\\\r\n\\Rightarrow &amp;\\text{color}(\\lfloor\\frac {x_1}2\\rfloor,\\lfloor\\frac {y_1}2\\rfloor,\\frac D4)\\ne\\text{color}(\\lfloor\\frac {x_2}2\\rfloor,\\lfloor\\frac {y_2}2\\rfloor,\\frac D4)\r\n\\end{aligned}\r\n\\]</span></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(D_1\\)</span>  <span class=\"math inline\">\\(D_2\\)</span>  <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(n^2\\)</span> <span class=\"math inline\">\\(n^2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<h3 id=\"agc036d\">AGC036D</h3>\r\n<p> <span class=\"math inline\">\\(d_1,d_2,\\cdots,d_n\\)</span> <span class=\"math inline\">\\(d_1=0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\rightarrow i+1\\)</span>  <span class=\"math inline\">\\(d\\)</span>  <span class=\"math inline\">\\(0\\)</span> $-1 $ <span class=\"math inline\">\\(-2\\cdots\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(d\\)</span> <span class=\"math inline\">\\([a,b]\\)</span> <span class=\"math inline\">\\(d_{a,a+1,\\cdots,b}=x+1\\)</span> <span class=\"math inline\">\\([b+1,c]\\)</span> <span class=\"math inline\">\\(d_{b+1,b+2,\\cdots,c}=x\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(b+1\\le i &lt; j \\le c\\)</span> <span class=\"math inline\">\\((i,j)\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(b+1\\le i\\le c,j&lt;a\\)</span> <span class=\"math inline\">\\((i,j)\\)</span> </li>\r\n</ul>\r\n<p> <code>DP</code>  <span class=\"math inline\">\\(f_{a,b}\\)</span>  <span class=\"math inline\">\\([a,b]\\)</span>  <span class=\"math display\">\\[\r\nf_{a,b}+\\text{cost}_1(b+1,c)+\\text{cost}_2(b+1,c,a-1)\\rightarrow f_{b+1,c}\r\n\\]</span>  <span class=\"math inline\">\\(\\text{cost}_1\\)</span>  <span class=\"math inline\">\\(\\text{cost}_2\\)</span>  <span class=\"math inline\">\\(O(1)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^3)\\)</span></p>\r\n<h3 id=\"agc045d\">AGC045D</h3>\r\n<p> <code>Snuke</code>  <span class=\"math inline\">\\(p_i=i\\)</span>  <code>Snuke</code> </p>\r\n<ul>\r\n<li> <code>Snuke</code>  <span class=\"math inline\">\\(1\\)</span></li>\r\n<li> <span class=\"math inline\">\\(p_i=i\\)</span> </li>\r\n<li><span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(p_i\\)</span></li>\r\n<li></li>\r\n</ul>\r\n<p> <code>Snuke</code>  <span class=\"math inline\">\\(1-A\\)</span>  <span class=\"math inline\">\\(p_i=i\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(\\min\\)</span><span class=\"math inline\">\\(\\forall i&gt;A,\\exists j&lt;\\min\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\min\\)</span> <span class=\"math inline\">\\(\\min\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\((-1)^i\\binom{\\min-1}i\\)</span></li>\r\n<li> <span class=\"math inline\">\\([1,\\min-1]\\)</span>  <span class=\"math inline\">\\(\\min-1-i\\)</span>  <span class=\"math inline\">\\((\\min-1-i)!\\)</span></li>\r\n<li> <span class=\"math inline\">\\([A+1,n]\\)</span>  <span class=\"math inline\">\\((\\min-1-i)^{\\overline{n-A}}\\)</span></li>\r\n<li> <span class=\"math inline\">\\([\\min+1,A]\\)</span>  <span class=\"math inline\">\\((\\min-1-i+n-A)^{\\overline{A-\\min}}\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(\\min\\)</span>  <span class=\"math display\">\\[\r\n\\sum_{i=0}^{\\min-1}(-1)^i\\binom{\\min-1}i\\frac{(n-1-i)!(\\min-1-i)}{\\min-1-i+n-A}\r\n\\]</span>  <span class=\"math inline\">\\(\\min\\)</span>  <span class=\"math display\">\\[\r\n\\sum_{i=0}^A(-1)^i\\binom Ai(n-i)!\r\n\\]</span>  <span class=\"math inline\">\\(O(A^2+n)\\)</span></p>\r\n<h3 id=\"agc041e\">AGC041E</h3>\r\n<h4 id=\"-t1\"> <span class=\"math inline\">\\(T=1\\)</span></h4>\r\n<p></p>\r\n<ul>\r\n<li></li>\r\n<li></li>\r\n<li></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(t\\)</span>  <span class=\"math inline\">\\(t\\)</span> </p>\r\n<p> <code>bitset</code>  <code>DFS</code>  <code>bitset</code> <span class=\"math inline\">\\(O(\\frac {nm}{\\omega})\\)</span> </p>\r\n<h4 id=\"-t2\"> <span class=\"math inline\">\\(T=2\\)</span></h4>\r\n<p><span class=\"math inline\">\\(n=2\\)</span>  <span class=\"math inline\">\\(n&gt;2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(size_i\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(size_i=1\\)</span></li>\r\n<li> <span class=\"math inline\">\\((x,y)\\)</span>  <span class=\"math inline\">\\(size_x+1\\)</span> <span class=\"math inline\">\\(size_y+1\\)</span> <span class=\"math inline\">\\(size_x\\)</span>  <span class=\"math inline\">\\(size_y\\)</span>  <span class=\"math inline\">\\(+1\\)</span> <span class=\"math inline\">\\(size_x=n-1\\land size_y=n-1\\)</span>  <span class=\"math inline\">\\(size_x+size_y\\le n\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n+m)\\)</span></p>\r\n<h3 id=\"abc214g\">ABC214G</h3>\r\n<p> <span class=\"math inline\">\\(n \\le 10^5\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(F_k\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(r_{i_1},r_{i_2},\\cdots,r_{i_k}(i_1&lt;i_2&lt;\\cdots&lt;i_k)\\)</span>  <span class=\"math display\">\\[\r\n\\forall x\\in[1,k],r_{i_x}=p_{i_x}\\lor r_{i_x}=q_{i_x}\r\n\\]</span>  <span class=\"math display\">\\[\r\n\\sum_{i=0}^n(-1)^iF_i(n-i)!\r\n\\]</span>  <span class=\"math inline\">\\(p_i,q_i\\)</span>  <span class=\"math inline\">\\(r_i=p_i\\lor r_i=q_i\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(F\\)</span>  <code>FFT</code>  <span class=\"math inline\">\\(F\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(F\\)</span>  <span class=\"math inline\">\\(1,2,\\cdots,m\\)</span> <span class=\"math inline\">\\((1,2),(2,3),\\cdots,(m-1,m),(m,1)\\)</span> <span class=\"math inline\">\\(i\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\((1,2)\\)</span> <span class=\"math inline\">\\((2,3)\\)</span>  <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\((2,3)\\)</span>  <span class=\"math inline\">\\(3\\)</span>  <span class=\"math inline\">\\(2\\)</span> <span class=\"math inline\">\\((3,4)\\)</span>  <span class=\"math inline\">\\(3\\)</span>  <span class=\"math inline\">\\(3\\)</span> <span class=\"math inline\">\\((3,4)\\)</span>  <span class=\"math inline\">\\(4\\)</span>  <span class=\"math inline\">\\(4\\)</span> <span class=\"math inline\">\\(2m-2\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(r\\)</span>  <span class=\"math inline\">\\(\\binom {n-r+1}r\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(i-1\\)</span>  <span class=\"math inline\">\\(n-r+1\\)</span>  <span class=\"math inline\">\\(r\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(\\binom{2m-i-1}i\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\((1,2)\\)</span> <span class=\"math inline\">\\((1,2)\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(2\\)</span> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(2m-3\\)</span>  <span class=\"math inline\">\\(i-1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(2\\binom{2m-i-1}{i-1}\\)</span></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(m\\)</span>  <span class=\"math display\">\\[\r\nF_i=\\binom{2m-i-1}i+2\\binom{2m-i-1}{i-1}=\\binom{2m-i}i+\\binom{2m-i-1}{i-1}\r\n\\]</span>  <span class=\"math inline\">\\(F\\)</span>  <span class=\"math inline\">\\(O(n)\\)</span>  <code>FFT</code> <span class=\"math inline\">\\(O(n\\log^2n)\\)</span></p>\r\n<p> <code>FFT</code> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(n\\)</span> <span class=\"math inline\">\\(O(\\sqrt n)\\)</span>  <span class=\"math inline\">\\(O(n\\log n)\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(\\sum_{u\\in \\mathbb{leaf}}\\text{degree}_u\\text{depth}_u\\)</span> <code>Huffman</code>  </li>\r\n</ul>\r\n<h3 id=\"abc214h\">ABC214H</h3>\r\n<p> <code>DAG</code> <code>DAG</code></p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(\\text{in}_u\\)</span>  <span class=\"math inline\">\\(\\text{out}_u\\)</span></li>\r\n<li><span class=\"math inline\">\\(\\text{in}_u\\)</span>  <span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(-X_u\\)</span>  <span class=\"math inline\">\\(K\\)</span> <span class=\"math inline\">\\(0\\)</span> </li>\r\n<li> <span class=\"math inline\">\\((u,v)\\)</span><span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(\\text{in}_v\\)</span>  <span class=\"math inline\">\\(K\\)</span> <span class=\"math inline\">\\(0\\)</span> </li>\r\n<li><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(\\text{in}_1\\)</span>  <span class=\"math inline\">\\(K\\)</span> <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(K\\)</span> <span class=\"math inline\">\\(0\\)</span> </li>\r\n</ul>\r\n<p><code>SSP</code>  <code>Primal-Dual</code> </p>\r\n<h4 id=\"sol-1\">Sol 1</h4>\r\n<p> <code>DAG</code> <code>DP</code> </p>\r\n<h4 id=\"sol-2\">Sol 2</h4>\r\n<p> <code>DAG</code> </p>\r\n<p></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(\\sum X_u\\)</span><span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(0\\)</span></li>\r\n<li><span class=\"math inline\">\\(\\text{in}_u\\)</span>  <span class=\"math inline\">\\(\\sum_{i=1}^uX_i\\)</span><span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(\\sum_{i=1}^{u-1}X_i\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(nK\\log n)\\)</span></p>\r\n<h3 id=\"agc027e\">AGC027E</h3>\r\n<p> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(b\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(a,b\\)</span>  <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\(3\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(|S|\\)</span>  <span class=\"math inline\">\\(|S|\\)</span>  <span class=\"math inline\">\\(ababab\\cdots aba\\)</span></p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(p(S)\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(b\\)</span>  <span class=\"math inline\">\\(3\\)</span><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(c\\)</span> </p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(p(S)=p(c)\\)</span></li>\r\n<li><span class=\"math inline\">\\(S=c\\)</span>  <span class=\"math inline\">\\(S\\)</span> </li>\r\n</ul>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(|S|\\le 3\\)</span>  <span class=\"math inline\">\\(|S|&gt;3\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(a\\)</span></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(n \\ge 4\\)</span> <span class=\"math inline\">\\(a\\)</span> <span class=\"math inline\">\\(|S|\\)</span>  <span class=\"math inline\">\\(1\\)</span></li>\r\n<li><span class=\"math inline\">\\(n\\le 3\\)</span> <span class=\"math inline\">\\(|S|&gt;3\\)</span> <span class=\"math inline\">\\(b\\)</span> <span class=\"math inline\">\\(a\\)</span>  <span class=\"math inline\">\\(b\\)</span> <span class=\"math inline\">\\(b\\)</span> <span class=\"math inline\">\\(|S|\\)</span>  <span class=\"math inline\">\\(1\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(T\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(|T|\\)</span>  <span class=\"math inline\">\\(T\\)</span> </li>\r\n</ul>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(S\\)</span> <strong></strong> </p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(T\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(|T|\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S_1,S_2,\\cdots,S_{|T|}\\)</span><span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(T_1,T_2,\\cdots,T_{|T|}\\)</span></li>\r\n<li> <span class=\"math inline\">\\(\\forall i,p(S_i)=p(T_i)\\)</span></li>\r\n</ul>\r\n</blockquote>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\((S_1,S_2,\\cdots,S_{|T|})\\)</span></li>\r\n<li> <span class=\"math inline\">\\(S_1,S_2,\\cdots,S_{|T|-1}\\)</span>  <span class=\"math inline\">\\((S_1&#39;,S_2&#39;,\\cdots,S_{|T|}&#39;)\\)</span></li>\r\n<li> <span class=\"math inline\">\\(S_1,S_2,\\cdots,S_{|T|-1}\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(S_{|T|}\\)</span>  <span class=\"math inline\">\\(S_{|T|}=abab\\cdots aba\\)</span> <span class=\"math inline\">\\(|T|&gt;1\\)</span> <span class=\"math inline\">\\(S_{|T|}\\)</span>  <span class=\"math inline\">\\(S_{|T|-1}\\)</span> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(T\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <code>DP</code></p>\r\n<p> <span class=\"math inline\">\\(O(n)\\)</span></p>\r\n<h3 id=\"gym101667g\">Gym101667G</h3>\r\n<p></p>\r\n<p> L  U  U  L  <code>isRegion</code> <code>area</code> </p>\r\n<ul>\r\n<li> <code>isRegion</code>  <code>area</code> </li>\r\n<li> <code>area</code></li>\r\n<li> <code>area</code></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n+m)\\)</span></p>\r\n<figure>\r\n<img src=\"https://i.loli.net/2021/09/08/a4fEq6tJWRbrxDy.png\" alt=\".png\" /><figcaption aria-hidden=\"true\">.png</figcaption>\r\n</figure>\r\n<h3 id=\"gym101667j\">Gym101667J</h3>\r\n<p> Hall  <span class=\"math inline\">\\(f(S)\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math display\">\\[\r\n\\forall |S|\\le\\frac n2,|T|=\\frac n2,S \\cap T=\\varnothing\\\\\r\n|f(S)\\cap T| \\ge |S|\r\n\\]</span>  <span class=\"math inline\">\\(|f(S)\\cap T|\\)</span>  <span class=\"math inline\">\\(|f(S)|+|S|-\\frac n2\\)</span> <span class=\"math inline\">\\(|f(S)|\\ge\\frac n2\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\min_{|S|\\le \\frac n2}|f(S)|\\)</span></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(f(S)\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(V-S-f(S)\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(\\frac n2\\)</span> <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(|f(S)|\\le |T|\\)</span></li>\r\n</ul>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(\\text{in}_u\\)</span>  <span class=\"math inline\">\\(\\text{out}_u\\)</span></li>\r\n<li><span class=\"math inline\">\\(\\text{in}_u\\)</span>  <span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(1\\)</span> </li>\r\n<li> <span class=\"math inline\">\\((u,v)\\)</span><span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(\\text{in}_v\\)</span><span class=\"math inline\">\\(\\text{out}_v\\)</span>  <span class=\"math inline\">\\(\\text{in}_u\\)</span>  <span class=\"math inline\">\\(\\infty\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(u,v\\)</span> <span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(\\text{in}_v\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(n^2\\cdot flow)\\)</span></p>\r\n<p><del></del> <span class=\"math inline\">\\(\\frac n2\\)</span> <span class=\"math inline\">\\(u\\)</span> <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\(\\text{out}_u\\)</span>  <span class=\"math inline\">\\(\\text{in}_v\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(O(nk\\cdot flow)\\)</span></p>\r\n<h3 id=\"abc215h\">ABC215H</h3>\r\n<p></p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(B_i\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(c_{i,j}=1\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(\\infty\\)</span> </li>\r\n<li><span class=\"math inline\">\\(\\max flow=\\sum_{i=1}^mB_i\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(mask\\)</span> <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(sum\\)</span> <span class=\"math inline\">\\(\\sum_{i\\in mask}A_i-sum+1\\)</span> <span class=\"math inline\">\\(sum&gt;0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(mask\\)</span> <span class=\"math inline\">\\(sum\\)</span> <span class=\"math inline\">\\(B_i\\)</span>  <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(i\\)</span> <code>FMT</code> <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(\\sum_{i\\in mask}A_i-sum+1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(mask\\subseteq S\\)</span> <code>FMT</code>  <span class=\"math inline\">\\(ans\\)</span> <span class=\"math inline\">\\(mask\\)</span> <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(ans\\)</span>  <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math inline\">\\(O(3^n)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(f_S\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(ans\\)</span>  <span class=\"math inline\">\\(mask\\)</span>  <span class=\"math display\">\\[\r\n\\sum_{T\\subseteq S}f_T=\\binom{\\sum_{i\\in S}A_i}{ans}\r\n\\]</span>  <code>IFMT</code>  <span class=\"math inline\">\\(f\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n2^n+nm)\\)</span></p>\r\n<h3 id=\"agc020e\">AGC020E</h3>\r\n<p> <span class=\"math inline\">\\(S\\)</span>  <code>DP</code>  <span class=\"math inline\">\\(f_{l,r}\\)</span>  <span class=\"math inline\">\\([l,r]\\)</span> </p>\r\n<ul>\r\n<li><span class=\"math inline\">\\(s_l\\)</span>  <span class=\"math inline\">\\(f_{l+1,r}\\)</span></li>\r\n<li><span class=\"math inline\">\\(s_l\\)</span>  <span class=\"math inline\">\\(s_l\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(i&gt;1\\)</span> <span class=\"math inline\">\\(f_{l,l+T-1}\\cdot f_{l+Ti,r}\\)</span></li>\r\n</ul>\r\n<p> <code>DP</code>  <span class=\"math inline\">\\(s_l\\)</span>  <span class=\"math inline\">\\(f_{l,l+T-1}\\)</span>  <code>DP</code>  <span class=\"math inline\">\\(f(s)\\)</span>  <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(suf(i)\\)</span>  <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(s_i\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\((s_0+1)f(suf(1))\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\(s_l\\)</span>  <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(i&gt;1\\)</span> <span class=\"math inline\">\\(s[l,r]\\)</span>  <span class=\"math inline\">\\(s\\)</span>  <span class=\"math inline\">\\(l\\)</span>  <span class=\"math inline\">\\(r\\)</span>  <span class=\"math display\">\\[\r\nt=s[0,T-1]\\&amp;s[T,2T-1]\\&amp;\\cdots\\&amp;s[T(i-1),Ti-1](\\&amp;\\ is\\ \\text{bitand})\r\n\\]</span>  <span class=\"math inline\">\\(f(t)\\cdot f(suf(Ti))\\)</span></p></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(O(2^{n+1})\\)</span> <span class=\"math inline\">\\(O()\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n^3+2^{\\frac n8})\\)</span> <span class=\"math inline\">\\(\\frac n8\\)</span>  <span class=\"math inline\">\\(2^{\\frac n8}\\)</span>  <span class=\"math inline\">\\(\\frac n8\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(2\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(2\\)</span>  <span class=\"math inline\">\\(3\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(3\\)</span>  <span class=\"math inline\">\\(2\\)</span> </li>\r\n</ul>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(s[a,a+k-1]\\&amp;s[a+k,a+2k-1]\\&amp;s[b,b+k-1]\\&amp;s[b+k,b+2k-1]\\)</span></p>\r\n<p> <span class=\"math inline\">\\(a,b,k\\)</span>  <span class=\"math inline\">\\(O(n^3)\\)</span> <span class=\"math inline\">\\(O(n^3)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(12\\)</span>  <span class=\"math inline\">\\(41703\\)</span></p>\r\n<h3 id=\"cf1562e\">CF1562E</h3>\r\n<p> <span class=\"math display\">\\[\r\ns[l_1,r_1],s[l_2,r_2],\\cdots,s[l_k,r_k]\r\n\\]</span>  <span class=\"math inline\">\\(l\\)</span> <span class=\"math inline\">\\(r\\)</span>  <span class=\"math inline\">\\(l\\)</span> <span class=\"math inline\">\\(r\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(l\\)</span> <span class=\"math inline\">\\(r\\in[r_1,r_2]\\)</span> <span class=\"math inline\">\\(r_2&lt;n\\)</span><span class=\"math inline\">\\(s[l,r_2]\\)</span>  <span class=\"math inline\">\\(s[l&#39;,r&#39;]\\)</span> <span class=\"math inline\">\\(s[l,r_2+1]&lt;s[l&#39;,r&#39;]\\)</span> <span class=\"math inline\">\\(s[l,r_2]\\)</span>  <span class=\"math inline\">\\(s[l,r_2+1]\\)</span> <span class=\"math inline\">\\(s[l,r_2]&lt;s[l&#39;,r&#39;]\\le s[l,r_2+1]\\)</span> <span class=\"math display\">\\[\r\ns[l&#39;,l&#39;+r_1-l]=s[l,r_1]\\\\\r\ns[l&#39;,l&#39;+r_1+1-l]=s[l,r_1+1]\\\\\r\ns[l&#39;,l&#39;+r_1+2-l]=s[l,r_1+2]\\\\\r\n\\cdots\\\\\r\ns[l&#39;,l&#39;+r_2-l]=s[l,r_2]\r\n\\]</span>  <span class=\"math inline\">\\(l\\)</span> </p>\r\n<p> <code>DP</code>  <span class=\"math inline\">\\(f_i\\)</span>  <span class=\"math inline\">\\(s[i,n]\\)</span>  <span class=\"math display\">\\[\r\nf_i=\\max_{j&lt;i\\land s[j,n]&lt;s[i,n]}f_j+n-\\text{lcp}(s[i,n],s[j,n])+1\r\n\\]</span>  <span class=\"math inline\">\\(\\text{lcp}(s[i,n],s[j,n])\\leftarrow \\text{lcp}(s[i+1,n],s[j+1,n])\\)</span> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<h4 id=\"\"></h4>\r\n<p> <span class=\"math inline\">\\(O(n\\sqrt n)\\)</span></p>\r\n<p> <code>LCP</code>  <code>height</code> </p>\r\n<p> <span class=\"math inline\">\\(SA\\)</span>  <code>height</code>  <span class=\"math display\">\\[\r\nf_{SA_i}=\\max_{j&lt;i \\land SA_j&lt;SA_i}f_{SA_j}+\\max_{k=j+1}^in-height_k+1\r\n\\]</span>  <code>height</code>  <span class=\"math inline\">\\(\\max\\)</span> <span class=\"math inline\">\\((v,S)\\)</span> <span class=\"math inline\">\\((n-height_{i+1}+1,\\{i\\})\\)</span>  <span class=\"math inline\">\\((v_1,S_1)\\)</span> <span class=\"math inline\">\\((v_2,S_2)\\)</span> <span class=\"math inline\">\\(v_1\\ge v_2\\)</span> <span class=\"math inline\">\\((v_1,S_1\\cup S_2)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(f_{i+1}\\)</span> <span class=\"math inline\">\\((v,S)\\)</span> <span class=\"math inline\">\\(\\max_{j \\in S\\land SA_j\\le SA_i}+v\\rightarrow f_{SA_{i+1}}\\)</span> <span class=\"math inline\">\\(|S|\\le \\sqrt n\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(|S|&gt;\\sqrt n\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(\\sqrt n\\)</span>  <span class=\"math inline\">\\(|S|&gt;\\sqrt n\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(\\max\\)</span><span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(\\sqrt n\\)</span>  <span class=\"math inline\">\\(\\max\\)</span></p>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(|S_1|+|S_2|\\le \\sqrt n\\)</span>  <span class=\"math inline\">\\(S_2\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(|S_2|\\)</span>  <span class=\"math inline\">\\(n\\sqrt n\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(|S_1|&gt;\\sqrt n\\land |S_2|\\le \\sqrt n\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(|S_2|\\)</span>  <span class=\"math inline\">\\(n\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(|S_1|,|S_2|&gt;\\sqrt n\\)</span>  <span class=\"math inline\">\\(|S_1|,|S_2|\\le \\sqrt n\\land |S_1|+|S_2|&gt;\\sqrt n\\)</span>  <span class=\"math inline\">\\(|S_1|+|S_2|\\)</span>  <span class=\"math inline\">\\(B\\)</span> <span class=\"math inline\">\\(\\sqrt n\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(O(1)\\)</span> <span class=\"math inline\">\\(O(\\sqrt n)\\)</span> <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(O(\\sqrt n)\\)</span> <span class=\"math inline\">\\(O(1)\\)</span>  <span class=\"math inline\">\\(O(n\\sqrt n)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\max\\)</span><span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(B\\)</span> </p>\r\n<h3 id=\"cf1562f\">CF1562F</h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span> <span class=\"math inline\">\\(\\text{lcm}\\)</span> <span class=\"math inline\">\\(n+5000\\)</span>  <span class=\"math inline\">\\(A\\)</span></p>\r\n<p><span class=\"math inline\">\\(n\\le 10^5,A_i\\le 2\\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(\\gcd(a,b)=1\\)</span> <span class=\"math inline\">\\(\\text{lcm}(a,b)=ab\\)</span> <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(p\\)</span> <span class=\"math inline\">\\(n-1\\)</span>  <span class=\"math inline\">\\(A\\)</span></p>\r\n<p> <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(\\text{lcm}(A_1,A_2),\\text{lcm}(A_2,A_3),\\text{lcm}(A_3,A_4),\\cdots,\\text{lcm}(A_{n-1},n)\\)</span> <span class=\"math inline\">\\(p\\)</span> <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(n-1\\)</span>  <span class=\"math inline\">\\(A\\)</span> <span class=\"math inline\">\\(2n-2\\)</span> <span class=\"math inline\">\\(100&lt;n\\le7500\\)</span></p>\r\n<p> <span class=\"math inline\">\\(n\\le 100\\)</span>  <span class=\"math inline\">\\(n&gt;7500\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n\\le 100\\)</span>  <span class=\"math inline\">\\(\\text{lcm}\\)</span> <span class=\"math inline\">\\(n&gt;3\\)</span>  <span class=\"math inline\">\\(\\text{lcm}\\)</span>  <span class=\"math inline\">\\(\\text{lcm}\\)</span>  <span class=\"math inline\">\\(\\max A_i(\\max A_i-1)\\)</span> <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(n=3\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(n&gt;7500\\)</span>  <span class=\"math inline\">\\(5000\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(p\\)</span> <span class=\"math inline\">\\(450\\)</span>  <span class=\"math inline\">\\(p&#39;\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(\\text{lcm}(A_i,A_j)\\)</span> <span class=\"math inline\">\\(450\\)</span>  <span class=\"math inline\">\\(p,q\\)</span>  <span class=\"math inline\">\\(A_i,A_j\\)</span>  <span class=\"math inline\">\\(p,q\\)</span> <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(k\\)</span> <span class=\"math inline\">\\(p\\not|\\text{lcm}(A_i,A_k)\\)</span>  <span class=\"math inline\">\\(A_i=p\\)</span> <span class=\"math inline\">\\(q\\not|\\text{lcm}(A_j,A_k)\\)</span>  <span class=\"math inline\">\\(A_i=q\\)</span> <span class=\"math inline\">\\(O(\\ln^2n)\\)</span></p>\r\n<p> <span class=\"math display\">\\[\r\n\\text{lcm}(p&#39;,x)=\r\n\\begin{cases}\r\nx&amp;(x|p&#39;)\\\\\r\nxp&#39;&amp;(x\\not|p&#39;)\r\n\\end{cases}\r\n\\]</span>  <span class=\"math inline\">\\(\\text{lcm}(p&#39;,x)&gt;2\\cdot 10^5\\)</span>  <span class=\"math inline\">\\(x\\not|p&#39;\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(n-900\\)</span>  <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(p\\)</span> </p>\r\n<h3 id=\"auoj1760\">AUOJ1760</h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span> </p>\r\n<p><strong></strong></p>\r\n<p><span class=\"math inline\">\\(n \\le 10^6\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(m\\)</span> <span class=\"math inline\">\\(A\\)</span> <span class=\"math display\">\\[\r\nA_{i,j}=\r\n\\begin{cases}\r\n-1 &amp;( j  i )\\\\\r\n0 &amp;( j  i )\\\\\r\n1 &amp;( j  i )\r\n\\end{cases}\r\n\\]</span> </p>\r\n<p><span class=\"math inline\">\\(A_i\\ne \\{0,0,\\cdots, 0\\}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(B\\)</span> <span class=\"math display\">\\[\r\nB_i=\r\n\\begin{cases}\r\n-1 &amp;( i )\\\\\r\n0 &amp;( i )\\\\\r\n1 &amp;( i )\r\n\\end{cases}\r\n\\]</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(A_?\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(B\\)</span> <span class=\"math inline\">\\(C\\)</span> <span class=\"math inline\">\\(C=-B\\)</span> <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(C\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> </p>\r\n<p><span class=\"math inline\">\\(\\forall i \\ne j, A_i\\ne A_j \\land A_i \\ne -A_j\\)</span></p>\r\n<p></p>\r\n<p><span class=\"math inline\">\\(\\forall j\\in[1,m],\\sum_{i=1}^nA_{i,j}=0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(m\\)</span> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(\\frac{3^m-1}2\\)</span><span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(\\frac{3^m-1}2\\)</span></p>\r\n<p><span class=\"math inline\">\\(\\forall j\\in[1,m],\\sum_{i=1}^n|A_{i,j}|=3^{m-1}\\)</span></p>\r\n<blockquote>\r\n<p><span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(n\\le \\frac{3^m-3}2\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(m\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(3|n\\)</span>  <span class=\"math inline\">\\(\\text{next}(A)\\)</span>  <span class=\"math inline\">\\(A\\)</span> <span class=\"math inline\">\\(-1\\rightarrow 0,0\\rightarrow 1,1\\rightarrow -1\\)</span><span class=\"math inline\">\\(A,\\text{next}(A),\\text{next}(\\text{next}(A))\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p></p>\r\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1 0 -1 1</span><br><span class=\"line\">-1 1 0 -1</span><br><span class=\"line\">0 -1 1 0</span><br></pre></td></tr></table></figure>\r\n<p> <span class=\"math inline\">\\(\\{-1,-1,\\cdots,-1\\}\\)</span>  <span class=\"math inline\">\\(\\{1,1,\\cdots,1\\}\\)</span> <span class=\"math inline\">\\(\\frac {3^m-3}3\\)</span>   <span class=\"math inline\">\\(A\\)</span></p>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(3\\not|n\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(\\sum_{j=1}^m|\\sum_{i=1}^nA_{i,j}|\\)</span> </li>\r\n<li></li>\r\n<li>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(-A_i\\)</span></li>\r\n<li> <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(-B\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(A_i=B\\)</span></li>\r\n</ul></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(n\\)</span> <span class=\"math inline\">\\(n\\le 10^4\\)</span> </p>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> lf = <span class=\"keyword\">double</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">gen</span><span class=\"params\">(ll x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> ll k = <span class=\"number\">0x9ddfea08eb382d69</span>ull;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">3</span>) x *= k, x ^= x &gt;&gt; <span class=\"number\">47</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * k;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">rnd</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> ll s = <span class=\"built_in\">time</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (s += <span class=\"built_in\">gen</span>(s)) &amp; INT_MAX;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">wrt</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> ed)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* out = cout.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> pc out -&gt; sputc</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> c[<span class=\"number\">11</span>]; <span class=\"keyword\">int</span> sz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> c[++sz] = x % <span class=\"number\">10</span>, x /= <span class=\"number\">10</span>; <span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(sz) <span class=\"built_in\">pc</span>(c[sz--] + <span class=\"number\">48</span>);</span><br><span class=\"line\">    <span class=\"built_in\">pc</span>(ed);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m = <span class=\"number\">2</span>, t = <span class=\"number\">9</span>, nw[<span class=\"number\">15</span>], idx, A[<span class=\"number\">2500000</span>][<span class=\"number\">15</span>], c[<span class=\"number\">15</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i &gt; m) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">2</span>, <span class=\"number\">4</span>) &#123;</span><br><span class=\"line\">            idx++;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(k, <span class=\"number\">1</span>, m) A[idx][k] = (nw[k] + j) % <span class=\"number\">3</span> - <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(idx == t) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(j, <span class=\"number\">-1</span>, <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        nw[i] = j, <span class=\"built_in\">dfs</span>(i + <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(idx == t) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>), cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>), cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(t - <span class=\"number\">3</span> &gt;&gt; <span class=\"number\">1</span> &lt; n) m++, t *= <span class=\"number\">3</span>;</span><br><span class=\"line\">    <span class=\"built_in\">wrt</span>(m, <span class=\"number\">10</span>);</span><br><span class=\"line\">    t = t - <span class=\"number\">1</span> &gt;&gt; <span class=\"number\">1</span>, <span class=\"built_in\">dfs</span>(<span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) c[j] += A[i][j];</span><br><span class=\"line\">    <span class=\"keyword\">int</span> su = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) su += <span class=\"built_in\">abs</span>(c[i]);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(su) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> i = <span class=\"built_in\">rnd</span>() % n + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"built_in\">rnd</span>() % t &lt; n) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> d = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) d += <span class=\"built_in\">abs</span>(c[j] - <span class=\"number\">2</span> * A[i][j]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(d &lt; su || <span class=\"built_in\">rnd</span>() % n &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">                su = d;</span><br><span class=\"line\">                <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) c[j] -= <span class=\"number\">2</span> * A[i][j], A[i][j] *= <span class=\"number\">-1</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> k = <span class=\"built_in\">rnd</span>() % (t - n) + n + <span class=\"number\">1</span>, d = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) d += <span class=\"built_in\">abs</span>(c[j] - A[i][j] + A[k][j]);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(d &lt; su || <span class=\"built_in\">rnd</span>() % n &lt; <span class=\"number\">10</span>) &#123;</span><br><span class=\"line\">                su = d;</span><br><span class=\"line\">                <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) c[j] -= A[i][j] - A[k][j], <span class=\"built_in\">swap</span>(A[i][j], A[k][j]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> v = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(j, m, <span class=\"number\">1</span>) v = v * <span class=\"number\">3</span> + A[i][j] + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">wrt</span>(v, <span class=\"number\">32</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n</details>\r\n<h3 id=\"\"></h3>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(\\forall j\\in[1,m],|\\sum_{i=1}^nA_{i,j}|\\le 1\\)</span></li>\r\n<li> <span class=\"math inline\">\\(j\\)</span> <span class=\"math inline\">\\(\\sum_{i=1}^nA_{i,j}=-1\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(A_{i,j}&lt;1\\)</span>  <span class=\"math inline\">\\(A_{i,j}\\)</span>  <span class=\"math inline\">\\(A_{i,j}\\)</span> </li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(n\\)</span> <span class=\"math inline\">\\(10^6\\)</span>  <span class=\"math inline\">\\(10\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(10^6\\)</span>  <span class=\"math inline\">\\(n\\)</span></p>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">wrt</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> ed)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* out = cout.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> pc out -&gt; sputc</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> c[<span class=\"number\">11</span>]; <span class=\"keyword\">int</span> sz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> c[++sz] = x % <span class=\"number\">10</span>, x /= <span class=\"number\">10</span>; <span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(sz) <span class=\"built_in\">pc</span>(c[sz--] + <span class=\"number\">48</span>);</span><br><span class=\"line\">    <span class=\"built_in\">pc</span>(ed);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m = <span class=\"number\">2</span>, t = <span class=\"number\">9</span>, nw[<span class=\"number\">15</span>], idx, A[<span class=\"number\">1000005</span>], c[<span class=\"number\">15</span>], as;</span><br><span class=\"line\"><span class=\"keyword\">bool</span> vs[<span class=\"number\">1600000</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i) <span class=\"built_in\">rep</span>(j, <span class=\"number\">-1</span>, <span class=\"number\">1</span>) &#123; nw[i] = j, <span class=\"built_in\">dfs</span>(i - <span class=\"number\">1</span>); <span class=\"keyword\">if</span>(idx == n) <span class=\"keyword\">break</span>; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> x = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(k, m, <span class=\"number\">1</span>) x = x * <span class=\"number\">3</span> + (j + nw[k]) % <span class=\"number\">3</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!x || vs[x] || idx == n) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        A[++idx] = x, vs[x] = vs[t - x] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(k, <span class=\"number\">1</span>, m) c[k] += (j + nw[k]) % <span class=\"number\">3</span> - <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>), cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>), cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(t - <span class=\"number\">3</span> &gt;&gt; <span class=\"number\">1</span> &lt; n) m++, t *= <span class=\"number\">3</span>;</span><br><span class=\"line\">    t--, vs[t / <span class=\"number\">2</span>] = <span class=\"number\">1</span>, <span class=\"built_in\">wrt</span>(m, <span class=\"number\">10</span>), nw[m] = <span class=\"number\">-1</span>, <span class=\"built_in\">dfs</span>(m - <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(n % <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) as += <span class=\"built_in\">abs</span>(c[i]);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> th = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(!c[j]) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">int</span> v = A[i] / th % <span class=\"number\">3</span>;</span><br><span class=\"line\">                <span class=\"keyword\">auto</span> Try = [&amp;](<span class=\"keyword\">int</span> x) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> nw = A[i] + x * th;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(vs[nw]) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                    vs[A[i]] = vs[t - A[i]] = <span class=\"number\">0</span>, vs[nw] = vs[t - nw] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                    as -= <span class=\"built_in\">abs</span>(c[j]), c[j] += x, v += x, as += <span class=\"built_in\">abs</span>(c[j]), A[i] = nw;</span><br><span class=\"line\">                &#125;;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(v &lt; <span class=\"number\">2</span> &amp;&amp; c[j] &lt; <span class=\"number\">0</span>) <span class=\"built_in\">Try</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(v &gt; <span class=\"number\">0</span> &amp;&amp; c[j] &gt; <span class=\"number\">0</span>) <span class=\"built_in\">Try</span>(<span class=\"number\">-1</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            th *= <span class=\"number\">3</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">wrt</span>(A[i], <span class=\"number\">32</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n</details>\r\n<h3 id=\"\"></h3>\r\n<p> <span class=\"math inline\">\\(n\\)</span> </p>\r\n<ul>\r\n<li><p> <span class=\"math inline\">\\(\\sum_{j=1}^m|\\sum_{i=1}^nA_{i,j}|\\)</span> </p></li>\r\n<li><p><span class=\"math inline\">\\(A\\)</span> <strong></strong> <span class=\"math inline\">\\(m\\)</span> <span class=\"math inline\">\\(\\{-1,0,1\\}\\)</span>  <span class=\"math inline\">\\(B\\)</span> <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(-B\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(B,\\text{next}(B),\\text{next}(\\text{next}(B))\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(\\forall j\\in[1,m],|\\sum_{i=1}^nA_{i,j}|\\le 1\\)</span></p></li>\r\n<li><p> <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(i\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(\\sum_{i=1}^nA_{i,j}=-1\\land A_{i,j}&lt;1\\)</span> <span class=\"math inline\">\\(A_{i,j}\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(\\sum_{i=1}^nA_{i,j}=1\\)</span> <span class=\"math inline\">\\(A_{i,j}=0\\)</span></li>\r\n</ul></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(10^6\\)</span>  <span class=\"math inline\">\\(n\\)</span></p>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">wrt</span><span class=\"params\">(<span class=\"keyword\">int</span> x, <span class=\"keyword\">int</span> ed)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> streambuf* out = cout.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">    <span class=\"meta\">#<span class=\"meta-keyword\">define</span> pc out -&gt; sputc</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">char</span> c[<span class=\"number\">11</span>]; <span class=\"keyword\">int</span> sz = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> c[++sz] = x % <span class=\"number\">10</span>, x /= <span class=\"number\">10</span>; <span class=\"keyword\">while</span>(x);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(sz) <span class=\"built_in\">pc</span>(c[sz--] + <span class=\"number\">48</span>);</span><br><span class=\"line\">    <span class=\"built_in\">pc</span>(ed);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n, m = <span class=\"number\">2</span>, t = <span class=\"number\">9</span>, nw[<span class=\"number\">15</span>], idx, A[<span class=\"number\">797170</span>], c[<span class=\"number\">15</span>], as;</span><br><span class=\"line\"><span class=\"keyword\">bool</span> vs[<span class=\"number\">1600000</span>];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(i) <span class=\"built_in\">per</span>(j, <span class=\"number\">1</span>, <span class=\"number\">-1</span>) &#123; nw[i] = j, <span class=\"built_in\">dfs</span>(i - <span class=\"number\">1</span>); <span class=\"keyword\">if</span>(idx == n) <span class=\"keyword\">break</span>; &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> x = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">per</span>(k, m, <span class=\"number\">1</span>) x = x * <span class=\"number\">3</span> + (j + nw[k]) % <span class=\"number\">3</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(x == t || vs[x] || idx == n) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        A[++idx] = x, vs[x] = vs[t - x] = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(k, <span class=\"number\">1</span>, m) c[k] += (j + nw[k]) % <span class=\"number\">3</span> - <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    ios::<span class=\"built_in\">sync_with_stdio</span>(<span class=\"number\">0</span>), cin.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>), cout.<span class=\"built_in\">tie</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(t - <span class=\"number\">3</span> &gt;&gt; <span class=\"number\">1</span> &lt; n) m++, t *= <span class=\"number\">3</span>;</span><br><span class=\"line\">    t--, vs[t / <span class=\"number\">2</span>] = <span class=\"number\">1</span>, <span class=\"built_in\">wrt</span>(m, <span class=\"number\">10</span>), nw[m] = <span class=\"number\">1</span>, <span class=\"built_in\">dfs</span>(m - <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, m) as += <span class=\"built_in\">abs</span>(c[i]);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(as) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> th = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">1</span>, m) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(!c[j]) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">int</span> v = A[i] / th % <span class=\"number\">3</span>;</span><br><span class=\"line\">                <span class=\"keyword\">auto</span> Try = [&amp;](<span class=\"keyword\">int</span> x) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> nw = A[i] + x * th;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(vs[nw]) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                    vs[A[i]] = vs[t - A[i]] = <span class=\"number\">0</span>, vs[nw] = vs[t - nw] = <span class=\"number\">1</span>;</span><br><span class=\"line\">                    as -= <span class=\"built_in\">abs</span>(c[j]), c[j] += x, v += x, as += <span class=\"built_in\">abs</span>(c[j]), A[i] = nw;</span><br><span class=\"line\">                &#125;;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(v &lt; <span class=\"number\">2</span> &amp;&amp; c[j] &lt; <span class=\"number\">0</span>) <span class=\"built_in\">Try</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(v &gt; <span class=\"number\">0</span> &amp;&amp; c[j] &gt; <span class=\"number\">0</span>) <span class=\"built_in\">Try</span>(-v);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            th *= <span class=\"number\">3</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">wrt</span>(A[i], <span class=\"number\">32</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n</details>\r\n<h3 id=\"auoj1761\">AUOJ1761</h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(B\\)</span> <span class=\"math inline\">\\(0\\)</span> </p>\r\n<p><span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(i\\)</span> <span class=\"math inline\">\\(j\\)</span>  <span class=\"math inline\">\\(A_i&gt;B_{j\\bmod m}\\)</span> <span class=\"math inline\">\\(A_i=B_{j\\bmod m}\\)</span></p>\r\n<p><span class=\"math inline\">\\(q\\)</span>  <span class=\"math inline\">\\(d_i\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n,m,q\\le 3\\cdot 10^5,d_i\\le 3\\cdot 10^{12},t_i\\le 10^{18}\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(d_i\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(m\\)</span></p>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(p+m\\)</span> </p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(p-m\\)</span>  <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(A_i=B_{p \\bmod m}\\)</span> <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(p\\)</span>  <span class=\"math inline\">\\(p+m\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(p_i,p_i+m,p_i+2m,pi+3m,\\cdots\\)</span>  <span class=\"math inline\">\\(m\\)</span></p>\r\n<p> <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(A\\)</span>  <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(p_i\\)</span>  <span class=\"math inline\">\\(p_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(pos\\)</span>  <span class=\"math inline\">\\(B\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(B_{pos}\\)</span>  <span class=\"math inline\">\\(T_i\\)</span> <span class=\"math inline\">\\(p_i\\in[T_i-m+1,T_i]\\)</span> <span class=\"math inline\">\\(p_i=T_i-m+k_i\\)</span><span class=\"math inline\">\\(k_i\\)</span>  <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(ix+(T_i-m)i&gt;B_{pos+x}\\)</span> <span class=\"math inline\">\\([l,r]\\)</span>  <span class=\"math inline\">\\(\\min_{j=l}^rB_{pos+j}-ij\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(\\min_{j=1}^x\\{B_{pos+j}-ij\\}&lt;(T_i-m)i\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(O(n\\log n)\\)</span> <span class=\"math inline\">\\(p_i\\)</span></p>\r\n<p> <span class=\"math inline\">\\(d\\)</span> <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(m\\)</span> <span class=\"math inline\">\\(A_i\\)</span>  <span class=\"math inline\">\\(p_i\\bmod m\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(d\\bmod m\\)</span>  <span class=\"math inline\">\\(d\\bmod m&lt;p_i\\bmod m\\)</span></p>\r\n<h3 id=\"codechef-btree\">CodeChef-btree</h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(S(u,k)\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(n\\)</span> <span class=\"math inline\">\\(q\\)</span>  <span class=\"math inline\">\\(|S(u_1,k_1)\\cup S(u_2,k_2)\\cup S(u_3,k_3)\\cup \\cdots \\cup S(u_{m_i},k_{m_i})|\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n,q\\le 5\\cdot 10^4,\\sum_{i=1}^qm_i\\le 5\\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(|S(u,k)|\\)</span> </p>\r\n<h4 id=\"sol-1-1\">Sol 1</h4>\r\n<p> <span class=\"math inline\">\\(u_1,u_2,u_3,\\cdots,u_{m_i}\\)</span>  <span class=\"math inline\">\\(0\\)</span></p>\r\n<p> <span class=\"math inline\">\\((u_1,k_1),(u_2,k_2)\\)</span>  <span class=\"math inline\">\\(k_1-\\text{dis}(u_1,u_2)&gt;k_2\\)</span> <span class=\"math inline\">\\(S(u_2,k_2)\\subsetneq S(u_1,k_1)\\)</span> <span class=\"math inline\">\\(S(u_2,k_2)\\)</span>  <span class=\"math inline\">\\(k_2=k_1-\\text{dis}(u_1,u_2)\\)</span></p>\r\n<p> <code>Dijkstra</code>  <code>DP</code></p>\r\n<p> <span class=\"math inline\">\\(V\\)</span> <span class=\"math inline\">\\(E\\)</span><span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(r_u\\)</span> <span class=\"math inline\">\\(\\sum_{u\\in V}|S(u,r_u)|-\\sum_{(u,v)\\in E}|S(u,r_u)\\cap S(v,r_v)|\\)</span> <span class=\"math inline\">\\(S(u,r_u)\\)</span>  <span class=\"math inline\">\\(|S(u,r_u)|-|S(u,r_u)\\cap S(fa_u,r_{fa_u})|\\)</span></p>\r\n<p><span class=\"math inline\">\\(|S(u,r_u)|\\)</span> <span class=\"math inline\">\\(|S(u,r_u)\\cap S(v,r_v)|\\)</span>  <span class=\"math inline\">\\(S(w,r)\\)</span> <span class=\"math inline\">\\(w\\)</span> <span class=\"math inline\">\\(w\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O((n+m)\\log n)\\)</span></p>\r\n<h4 id=\"sol-2-1\">Sol 2</h4>\r\n<p> <code>bitset</code> </p>\r\n<p> <span class=\"math inline\">\\(nq \\le 2.5\\cdot 10^9,n\\sum_{i=1}^qm_i\\le 2.5\\cdot 10^{10}\\)</span> <span class=\"math inline\">\\(O(\\frac{n\\sum_{i=1}^qm_i}\\omega)\\)</span> <span class=\"math inline\">\\(O(\\frac{nq}\\omega)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(S(u,k)\\)</span>  <code>bitset</code>  <span class=\"math inline\">\\(O(\\frac n\\omega)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(S(u,k)\\)</span>  <span class=\"math inline\">\\(O(\\log n)\\)</span>  <span class=\"math inline\">\\(d\\)</span>  <span class=\"math inline\">\\(d\\)</span>  <span class=\"math inline\">\\(S(u,k)\\)</span>  <span class=\"math inline\">\\(O(\\frac{n\\log n}\\omega)\\)</span>  <span class=\"math inline\">\\(O(\\log n)\\)</span>  <span class=\"math inline\">\\(n,\\frac n2,\\frac n4,\\frac n8,\\cdots\\)</span> <span class=\"math inline\">\\(2n\\)</span>  <span class=\"math inline\">\\([1,n]\\)</span> <code>DFS</code>  <span class=\"math inline\">\\(n,\\frac n2,\\frac n4,\\frac n8,\\cdots\\)</span> <span class=\"math inline\">\\(O(\\frac n\\omega)\\)</span></p>\r\n<p> <code>bitset</code> <code>bitset</code>  <code>bitset</code>  <code>popcount</code> <code>unsigned long long</code>  <code>bitset</code><code>popcount</code>  <span class=\"math inline\">\\([0,65536)\\)</span>  <code>popcount</code> <code>unsigned long long</code>  <span class=\"math inline\">\\([0,65536)\\)</span> </p>\r\n<p> Sol 1 </p>\r\n<h3 id=\"ural2118\">URAL2118</h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(01\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(s\\)</span> <span class=\"math inline\">\\(01\\)</span>  <span class=\"math inline\">\\(S\\)</span> <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(-1\\)</span></p>\r\n<p><span class=\"math inline\">\\(k \\le 52, n\\le 10^6\\)</span></p>\r\n</blockquote>\r\n<p></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(S\\)</span> </li>\r\n<li> <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(|S|\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(1\\)</span></p>\r\n<p> <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(0\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(T\\)</span> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(T\\)</span>  <strong></strong>  <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(y+1\\)</span> <span class=\"math inline\">\\(x\\)</span>  <span class=\"math inline\">\\(0\\)</span>  <span class=\"math inline\">\\(T\\)</span> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(T\\)</span>  <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(1\\)</span> <span class=\"math inline\">\\(y+1\\)</span> <span class=\"math inline\">\\(y\\)</span> <span class=\"math inline\">\\(T&#39;\\)</span>  <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(T&#39;\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(|T|\\ge |T&#39;|\\)</span> <span class=\"math inline\">\\(y\\)</span>  <span class=\"math inline\">\\(T&#39;\\)</span>  <span class=\"math inline\">\\(1\\)</span>  <span class=\"math inline\">\\(T=T&#39;0+T&#39;\\)</span><span class=\"math inline\">\\(y\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(T&#39;\\)</span> <span class=\"math inline\">\\(T&#39;\\)</span>  <span class=\"math inline\">\\(T&#39;\\)</span>  <span class=\"math inline\">\\(suffix(i)\\)</span>  <span class=\"math inline\">\\(S\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(suffix(1),suffix(2),suffix(3),\\cdots\\)</span> <code>AC</code> </p>\r\n<p> <span class=\"math inline\">\\(O(nk)\\)</span></p>\r\n<h3 id=\"graph-subpaths\">Graph Subpaths</h3>\r\n<blockquote>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(m\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(l_i\\)</span> <span class=\"math inline\">\\(k\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(i \\in [2,n]\\)</span> <span class=\"math inline\">\\(1\\rightarrow i\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n,m,\\sum_{i=1}^kl_i \\le 10^5\\)</span></p>\r\n</blockquote>\r\n<h3 id=\"sol-1-2\">Sol 1</h3>\r\n<p> <span class=\"math inline\">\\(i\\rightarrow 1\\)</span> </p>\r\n<p> <span class=\"math inline\">\\((u,v)\\)</span> <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\(T_i\\)</span>  <span class=\"math inline\">\\(i\\rightarrow 1\\)</span>  <code>trie</code> <span class=\"math inline\">\\(T_u\\)</span> <span class=\"math inline\">\\((u,v)\\)</span><span class=\"math inline\">\\(T_v\\)</span>  <span class=\"math inline\">\\(T_v\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(T_u\\)</span> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(T_u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(T_u\\)</span>  <code>trie</code> <span class=\"math inline\">\\((u,v)\\)</span> <span class=\"math inline\">\\(T_u\\)</span>  <span class=\"math inline\">\\(T_v\\)</span>  <span class=\"math inline\">\\(T_v\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n^2)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<h3 id=\"sol-2-2\">Sol 2</h3>\r\n<p> <code>AC</code>  <span class=\"math inline\">\\(O(n^2)\\)</span>  <code>DP</code> <span class=\"math inline\">\\(f_{i,u}\\)</span>  <span class=\"math inline\">\\(i\\)</span><code>AC</code>  <code>u</code> <code>AC</code> </p>\r\n<p> <code>AC</code>  <code>DP</code>  <span class=\"math inline\">\\(f_u\\)</span> </p>\r\n<p> <code>AC</code>  <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<h3 id=\"zoj3390\">ZOJ3390</h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(T_1,T_2\\)</span> <span class=\"math inline\">\\(T_1+T_2\\)</span> <span class=\"math inline\">\\(T_1\\cdot T_2\\)</span>  <span class=\"math inline\">\\(T_1\\)</span>  <span class=\"math inline\">\\(T_2\\)</span><span class=\"math inline\">\\(T_1=T_2\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(A,B,C\\)</span> <span class=\"math inline\">\\(X,Y\\)</span>  <span class=\"math inline\">\\(AX+BY=C\\)</span></p>\r\n<p><span class=\"math inline\">\\(|A|,|B|,|C| \\le 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(height(T)\\)</span>  <span class=\"math inline\">\\(T\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(height(T_1+T_2)=\\max(height(T_1),height(T_2)),height(T_1\\cdot T_2)=height(T_1)+height(T_2)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\max(height(A)+height(X),height(B)+height(Y))=height(C)\\)</span> <span class=\"math inline\">\\(height(A)+height(X)=height(C)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(height(X)\\)</span> <span class=\"math inline\">\\(X\\)</span> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(C\\)</span>  <span class=\"math inline\">\\(height(X)\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(X\\)</span> <span class=\"math inline\">\\(AX\\)</span> <span class=\"math inline\">\\(BY\\)</span> <span class=\"math inline\">\\(Y\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(BY\\)</span> </p>\r\n<p> <span class=\"math display\">\\[\r\nf_u=1+\\sum_{v\\in son(u)}f_v\\cdot \\text{prime}(size_v)\r\n\\]</span>  <span class=\"math inline\">\\(\\text{prime}(i)\\)</span>  <span class=\"math inline\">\\(i\\)</span> </p>\r\n<p><strong></strong> <span class=\"math inline\">\\(T_1,T_2\\)</span><span class=\"math inline\">\\(f_{T_1}=f_{T_2}\\)</span> </p>\r\n<p><code>Generator</code>  <span class=\"math inline\">\\(T,A,B,C,D\\)</span>  <span class=\"math inline\">\\(A,X,B,Y\\)</span> </p>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> eb emplace_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mp make_pair</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> fi first </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> se second</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> all(x) (x).begin(), (x).end()</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> SZ(x) int((x).size())</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) / 2)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lc o * 2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rc o * 2 + 1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, lc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, rc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> cmi(a, b) (a = min(a, b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> cma(a, b) (a = max(a, b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lb lower_bound</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ub upper_bound</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> bs binary_search</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pop __builtin_popcount</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llpop __builtin_popcountll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ctz __builtin_ctz</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llctz __builtin_ctzll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> clz __builtin_clz</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llclz __builtin_clzll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> par __builtin_parity</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llpar __builtin_parityll</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> lf = <span class=\"keyword\">double</span>;</span><br><span class=\"line\"><span class=\"comment\">// using P = pair&lt;int, int&gt;;</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> V = vector&lt;<span class=\"keyword\">int</span>&gt;;</span><br><span class=\"line\"><span class=\"comment\">// using cmp = complex&lt;lf&gt;;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">ll <span class=\"title\">gen</span><span class=\"params\">(ll x)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> ll k = <span class=\"number\">0x9ddfea08eb382d69</span>ull;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, <span class=\"number\">3</span>) x *= k, x ^= x &gt;&gt; <span class=\"number\">47</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * k;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">rnd</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> ll s = <span class=\"built_in\">time</span>(<span class=\"number\">0</span>) + (ll)<span class=\"keyword\">new</span> <span class=\"keyword\">char</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (s += <span class=\"built_in\">gen</span>(s)) &amp; INT_MAX;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">V <span class=\"title\">tmul</span><span class=\"params\">(V a, V b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = a.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>, m = b.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>, su = n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">2</span>, m) a.<span class=\"built_in\">pb</span>(b[j] == <span class=\"number\">1</span> ? i : b[j] + su - <span class=\"number\">1</span>);</span><br><span class=\"line\">        su += m - <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">V <span class=\"title\">tplus</span><span class=\"params\">(V a, V b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = a.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>, m = b.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(j, <span class=\"number\">2</span>, m) a.<span class=\"built_in\">pb</span>(b[j] == <span class=\"number\">1</span> ? <span class=\"number\">1</span> : b[j] + n - <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">5</span>, A = <span class=\"number\">5</span>, B = <span class=\"number\">5</span>, C = <span class=\"number\">5</span>, D = <span class=\"number\">5</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> <span class=\"keyword\">int</span> T = <span class=\"number\">100000</span>;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d\\n&quot;</span>, T);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(kase, <span class=\"number\">1</span>, T) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> a = <span class=\"built_in\">rnd</span>() % A + <span class=\"number\">1</span>, b = <span class=\"built_in\">rnd</span>() % B + <span class=\"number\">1</span>, c = <span class=\"built_in\">rnd</span>() % C + <span class=\"number\">1</span>, d = <span class=\"built_in\">rnd</span>() % D + <span class=\"number\">1</span>;</span><br><span class=\"line\">        V t1&#123;<span class=\"number\">0</span>&#125;, t2&#123;<span class=\"number\">0</span>&#125;, t3&#123;<span class=\"number\">0</span>&#125;, t4&#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> get = [](V&amp; t, <span class=\"keyword\">int</span> n) &#123; <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) t.<span class=\"built_in\">pb</span>(i &gt; <span class=\"number\">1</span> ? <span class=\"built_in\">rnd</span>() % (i - <span class=\"number\">1</span>) + <span class=\"number\">1</span> : <span class=\"number\">0</span>); &#125;;</span><br><span class=\"line\">        <span class=\"built_in\">get</span>(t1, a), <span class=\"built_in\">get</span>(t2, b), <span class=\"built_in\">get</span>(t3, c), <span class=\"built_in\">get</span>(t4, d);</span><br><span class=\"line\">        V t5 = <span class=\"built_in\">tplus</span>(<span class=\"built_in\">tmul</span>(t1, t2), <span class=\"built_in\">tmul</span>(t3, t4));</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d %d %llu\\n&quot;</span>, a, c, t5.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> prt = [](V&amp; v) &#123; <span class=\"built_in\">For</span>(i, <span class=\"number\">1</span>, v.<span class=\"built_in\">size</span>()) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, v[i]); <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;&quot;</span>); &#125;;</span><br><span class=\"line\">        <span class=\"built_in\">prt</span>(t1), <span class=\"built_in\">prt</span>(t3), <span class=\"built_in\">prt</span>(t5);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n</details>\r\n<p><code>Special judge</code> <code>checker.cpp</code><code>checker &lt;input-file&gt; &lt;output-file&gt;</code> <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(1\\)</span></p>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> eb emplace_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mp make_pair</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> fi first </span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> se second</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> all(x) (x).begin(), (x).end()</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> SZ(x) int((x).size())</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) / 2)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lc o * 2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rc o * 2 + 1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, lc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, rc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> cmi(a, b) (a = min(a, b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> cma(a, b) (a = max(a, b))</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lb lower_bound</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ub upper_bound</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> bs binary_search</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pop __builtin_popcount</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llpop __builtin_popcountll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ctz __builtin_ctz</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llctz __builtin_ctzll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> clz __builtin_clz</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llclz __builtin_clzll</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> par __builtin_parity</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> llpar __builtin_parityll</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> lf = <span class=\"keyword\">double</span>;</span><br><span class=\"line\"><span class=\"keyword\">using</span> P = pair&lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;;</span><br><span class=\"line\"><span class=\"keyword\">using</span> V = vector&lt;<span class=\"keyword\">int</span>&gt;;</span><br><span class=\"line\"><span class=\"comment\">// using cmp = complex&lt;lf&gt;;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">1e5</span> + <span class=\"number\">5</span>, M = <span class=\"number\">1299709</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> f[M + <span class=\"number\">5</span>], pid, prm[N];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">V <span class=\"title\">tmul</span><span class=\"params\">(V a, V b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = a.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>, m = b.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>, su = n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">rep</span>(j, <span class=\"number\">2</span>, m) a.<span class=\"built_in\">pb</span>(b[j] == <span class=\"number\">1</span> ? i : b[j] + su - <span class=\"number\">1</span>);</span><br><span class=\"line\">        su += m - <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\">V <span class=\"title\">tplus</span><span class=\"params\">(V a, V b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> n = a.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>, m = b.<span class=\"built_in\">size</span>() - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(j, <span class=\"number\">2</span>, m) a.<span class=\"built_in\">pb</span>(b[j] == <span class=\"number\">1</span> ? <span class=\"number\">1</span> : b[j] + n - <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">P <span class=\"title\">dfs</span><span class=\"params\">(<span class=\"keyword\">int</span> u, <span class=\"keyword\">const</span> V G[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\">P <span class=\"title\">re</span><span class=\"params\">(<span class=\"number\">1</span>, <span class=\"number\">1</span>)</span></span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> v : G[u]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> [h, sz] = <span class=\"built_in\">dfs</span>(v, G);</span><br><span class=\"line\">        re.fi = (re.fi + (ll)h * prm[sz]) % <span class=\"number\">999999937</span>;</span><br><span class=\"line\">        re.se += sz;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> re;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">Hash</span><span class=\"params\">(<span class=\"keyword\">const</span> V&amp; t)</span> </span>&#123;</span><br><span class=\"line\">    vector&lt;<span class=\"keyword\">int</span>&gt; G[N];</span><br><span class=\"line\">    <span class=\"built_in\">For</span>(i, <span class=\"number\">1</span>, t.<span class=\"built_in\">size</span>()) G[t[i]].<span class=\"built_in\">pb</span>(i);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">dfs</span>(<span class=\"number\">1</span>, G).fi;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">(FILE* f)</span> </span>&#123; <span class=\"keyword\">int</span> x; <span class=\"keyword\">return</span> <span class=\"built_in\">fscanf</span>(f, <span class=\"string\">&quot;%d&quot;</span>, &amp;x) == <span class=\"number\">1</span> ? x : <span class=\"number\">-1</span>; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, M) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!f[i]) prm[++pid] = i;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j = <span class=\"number\">1</span>; i * prm[j] &lt;= M; j++) &#123;</span><br><span class=\"line\">            f[i * prm[j]] = <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(i % prm[j] == <span class=\"number\">0</span>) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    FILE *in = <span class=\"built_in\">fopen</span>(argv[<span class=\"number\">1</span>], <span class=\"string\">&quot;r&quot;</span>), *out = <span class=\"built_in\">fopen</span>(argv[<span class=\"number\">2</span>], <span class=\"string\">&quot;r&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> T = <span class=\"built_in\">read</span>(in); T--;) &#123;</span><br><span class=\"line\">        V t1&#123;<span class=\"number\">0</span>&#125;, t2&#123;<span class=\"number\">0</span>&#125;, t3&#123;<span class=\"number\">0</span>&#125;, t4&#123;<span class=\"number\">0</span>&#125;, t5&#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> get = [](FILE* f, V&amp; t, <span class=\"keyword\">int</span> n) &#123; <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) t.<span class=\"built_in\">pb</span>(<span class=\"built_in\">read</span>(f)); &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> a = <span class=\"built_in\">read</span>(in), b = <span class=\"built_in\">read</span>(in), c = <span class=\"built_in\">read</span>(in);</span><br><span class=\"line\">        <span class=\"built_in\">get</span>(in, t1, a), <span class=\"built_in\">get</span>(in, t3, b), <span class=\"built_in\">get</span>(in, t5, c);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> d = <span class=\"built_in\">read</span>(out), e = <span class=\"built_in\">read</span>(out);</span><br><span class=\"line\">        <span class=\"keyword\">auto</span> err = [&amp;]() &#123;</span><br><span class=\"line\">            <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;1\\n%d %d %d\\n&quot;</span>, a, b, c);</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, a) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, t1[i]); <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, b) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, t3[i]); <span class=\"built_in\">puts</span>(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">            <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, c) <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%d &quot;</span>, t5[i]);</span><br><span class=\"line\">            <span class=\"built_in\">exit</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!~d) <span class=\"built_in\">err</span>();</span><br><span class=\"line\">        <span class=\"built_in\">get</span>(out, t2, d), <span class=\"built_in\">get</span>(out, t4, e);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((ll)a * d + (ll)b * e != c &amp;&amp; <span class=\"built_in\">Hash</span>(<span class=\"built_in\">tplus</span>(<span class=\"built_in\">tmul</span>(t1, t2), <span class=\"built_in\">tmul</span>(t3, t4))) != <span class=\"built_in\">Hash</span>(t5)) <span class=\"built_in\">err</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n</details>\r\n<h3 id=\"izho-2020-d1t3\">IZhO 2020 D1T3</h3>\r\n<blockquote>\r\n<p><a href=\"codeforces.com/group/Uo1lq8ZyWf/contest/265564\"></a></p>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(A\\)</span> <span class=\"math inline\">\\((i,j,k)\\)</span>  <span class=\"math inline\">\\(i\\le j&lt;k\\)</span>  <span class=\"math inline\">\\([i,j]\\)</span>  <span class=\"math inline\">\\([j+1,k]\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 2\\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(prev_i\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> <span class=\"math inline\">\\(next_i\\)</span>  <span class=\"math inline\">\\(A_i\\)</span> </p>\r\n<p> <span class=\"math inline\">\\((i,j,k)\\)</span> </p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\([j+1,k]\\)</span>  <span class=\"math inline\">\\([i,j]\\)</span>  <span class=\"math inline\">\\(i \\le \\min prev_{j+1\\cdots i}\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(R_{j,k}=\\min prev_{j+1\\cdots k}\\)</span></li>\r\n<li> <span class=\"math inline\">\\([i,j]\\)</span>  <span class=\"math inline\">\\([j+1,k]\\)</span>  <span class=\"math inline\">\\(\\max next_{i\\cdots j}\\le k\\)</span> <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(L_{j,k}\\)</span> <span class=\"math inline\">\\(L_{j,k}\\)</span>  <span class=\"math inline\">\\(i\\)</span>  <span class=\"math inline\">\\(\\max next_{i\\cdots j}\\le k\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\((j,k)\\)</span>  <span class=\"math inline\">\\(\\max(R_{j,k}-L_{j,k}+1,0)\\)</span> <span class=\"math inline\">\\(k\\)</span> <span class=\"math inline\">\\(\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(L_{j,k}\\)</span>  <span class=\"math inline\">\\(R_{j,k}\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(R_{j,k}=\\min prev_{j+1\\cdots k}\\)</span> <span class=\"math inline\">\\(prev\\)</span>  <span class=\"math inline\">\\(\\min\\)</span> <span class=\"math inline\">\\(k\\rightarrow k+1\\)</span> <span class=\"math inline\">\\(R_{j,k}\\)</span>  <span class=\"math inline\">\\(prev_{k+1}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(L_{j,k}\\)</span> <span class=\"math inline\">\\(k\\rightarrow k+1\\)</span>  <span class=\"math inline\">\\(j\\)</span><span class=\"math inline\">\\(L_{j,k}\\)</span>  <span class=\"math inline\">\\(k\\)</span> <span class=\"math inline\">\\(\\max next_{i\\cdots j}\\)</span>  <span class=\"math inline\">\\(next\\)</span>  <span class=\"math inline\">\\(\\max\\)</span> <span class=\"math inline\">\\(next_{1\\cdots j}\\)</span>  <span class=\"math inline\">\\(next_{i_1},next_{i_2},next_{i_3},\\cdots,next_{i_k}\\)</span></p>\r\n<ul>\r\n<li> <span class=\"math inline\">\\(k\\in[j+1,next_{i_k}-1]\\)</span> <span class=\"math inline\">\\(L_{j,k}=\\infty\\)</span></li>\r\n<li> <span class=\"math inline\">\\(k\\in [next_{i_k},next_{i_{k-1}-1}]\\)</span><span class=\"math inline\">\\(L_{j,k}=i_{k-1}+1\\)</span></li>\r\n<li><span class=\"math inline\">\\(\\cdots\\)</span></li>\r\n<li> <span class=\"math inline\">\\(k\\in [next_{i_1},n]\\)</span><span class=\"math inline\">\\(L_{j,k}=1\\)</span></li>\r\n</ul>\r\n<p> <span class=\"math inline\">\\(i_x\\)</span>  <span class=\"math inline\">\\(k\\in [next_{i_x},next_{i_{x-1}}-1]\\)</span><span class=\"math inline\">\\(L_{j,k}=i_{x-1}+1\\)</span> <span class=\"math inline\">\\(next_y\\)</span>  <span class=\"math inline\">\\(next_{i_x}\\)</span>  <span class=\"math inline\">\\(j\\in [i_x,y-1],k\\in [next_{i_x},next_{i_{x-1}}-1]\\)</span> <span class=\"math inline\">\\(L_{j,k}=i_{x-1}+1\\)</span> <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(next_{i_x}-1\\rightarrow next_{i_x}\\)</span>  <span class=\"math inline\">\\(L_{i_x\\cdots y-1,k}\\)</span>  <span class=\"math inline\">\\(i_x+1\\)</span> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(L_{j,k}\\)</span></p>\r\n<p> <span class=\"math inline\">\\(\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)\\)</span> <span class=\"math inline\">\\(L_{j,k}\\)</span>  <span class=\"math inline\">\\(R_{j,k}\\)</span>  <span class=\"math inline\">\\(k\\)</span>  <span class=\"math inline\">\\(R_{l\\cdots r,k}\\)</span>  <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\(v \\le \\min L_{l\\cdots r,k}\\)</span> <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\(v \\ge \\max L_{l\\cdots r,k}\\)</span> <span class=\"math inline\">\\(\\sum_{j=l}^rR_{j,k}-\\sum_{j=l}^rL_{j,k}+(r-l+1)\\)</span> <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(\\forall j \\in[l,x], v\\ge L_{j,k},\\forall j\\in[x+1,r],v\\le L_{j,k}\\)</span> <span class=\"math inline\">\\(L_{j,k},R_{j,k}\\)</span>  <span class=\"math inline\">\\(\\min,\\max\\)</span>  <span class=\"math inline\">\\(sum\\)</span>  <span class=\"math inline\">\\(\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(x\\)</span> <span class=\"math inline\">\\(L_{ql\\cdots qr,k}\\)</span>  <span class=\"math inline\">\\(v\\)</span> <span class=\"math inline\">\\([l,r]\\)</span> <span class=\"math inline\">\\(ql\\le l\\land r \\le qr\\)</span>  <span class=\"math inline\">\\(ql\\le l\\land r \\le qr \\land (v \\le \\min L_{l\\cdots r,k}\\lor v \\ge \\max L_{l\\cdots r,k})\\)</span>  <span class=\"math inline\">\\(\\sum_{j=1}^{k-1}\\max(R_{j,k}-L_{j,k}+1,0)\\)</span></p>\r\n<p> <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n<details>\r\n<summary>\r\n<span style=\"font-size: large; font-weight: bold; color: rgb(33,150,243);\"></span>\r\n</summary>\r\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rep(i, l, r) for(int i = (l); i &lt;= (r); i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> per(i, r, l) for(int i = (r); i &gt;= (l); i--)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mem(a, b) memset(a, b, sizeof a)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> For(i, l, r) for(int i = (l), i##e = (r); i &lt; i##e; i++)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> pb push_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> eb emplace_back</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> mid ((l + r) / 2)</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lc o * 2</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rc o * 2 + 1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> lch l, mid, lc</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> rch mid + 1, r, rc</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> std;</span><br><span class=\"line\"><span class=\"keyword\">using</span> ll = <span class=\"keyword\">long</span> <span class=\"keyword\">long</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N = <span class=\"number\">2e5</span> + <span class=\"number\">5</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n, a[N], pre[N], nxt[N], L[N];</span><br><span class=\"line\">vector&lt;tuple&lt;<span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>, <span class=\"keyword\">int</span>&gt;&gt; vl[N], vr[N];</span><br><span class=\"line\"><span class=\"keyword\">int</span> tagL[N * <span class=\"number\">4</span>], minL[N * <span class=\"number\">4</span>], maxL[N * <span class=\"number\">4</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> tagR[N * <span class=\"number\">4</span>], minR[N * <span class=\"number\">4</span>], maxR[N * <span class=\"number\">4</span>];</span><br><span class=\"line\">ll sum[N * <span class=\"number\">4</span>], sumL[N * <span class=\"number\">4</span>], sumR[N * <span class=\"number\">4</span>], as;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pushUp</span><span class=\"params\">(<span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    sum[o] = sum[lc] + sum[rc];</span><br><span class=\"line\">    sumL[o] = sumL[lc] + sumL[rc];</span><br><span class=\"line\">    sumR[o] = sumR[lc] + sumR[rc];</span><br><span class=\"line\">    minL[o] = <span class=\"built_in\">min</span>(minL[lc], minL[rc]);</span><br><span class=\"line\">    minR[o] = <span class=\"built_in\">min</span>(minR[lc], minR[rc]);</span><br><span class=\"line\">    maxL[o] = <span class=\"built_in\">max</span>(maxL[lc], maxL[rc]);</span><br><span class=\"line\">    maxR[o] = <span class=\"built_in\">max</span>(maxR[lc], maxR[rc]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pushL</span><span class=\"params\">(<span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    tagL[o] = minL[o] = maxL[o] = v, sumL[o] = v * (r - l + <span class=\"number\">1ll</span>);</span><br><span class=\"line\">    sum[o] = <span class=\"built_in\">max</span>(sumR[o] - sumL[o], <span class=\"number\">0ll</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pushR</span><span class=\"params\">(<span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    tagR[o] = minR[o] = maxR[o] = v, sumR[o] = v * (r - l + <span class=\"number\">1ll</span>);</span><br><span class=\"line\">    sum[o] = <span class=\"built_in\">max</span>(sumR[o] - sumL[o], <span class=\"number\">0ll</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">pushDown</span><span class=\"params\">(<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(~tagL[o]) <span class=\"built_in\">pushL</span>(tagL[o], lch), <span class=\"built_in\">pushL</span>(tagL[o], rch), tagL[o] = <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(~tagR[o]) <span class=\"built_in\">pushR</span>(tagR[o], lch), <span class=\"built_in\">pushR</span>(tagR[o], rch), tagR[o] = <span class=\"number\">-1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">updL</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L &lt;= l &amp;&amp; r &lt;= R &amp;&amp; (v &lt;= minR[o] || v &gt;= maxR[o])) <span class=\"keyword\">return</span> <span class=\"built_in\">pushL</span>(v, l, r, o);</span><br><span class=\"line\">    <span class=\"built_in\">pushDown</span>(l, r, o);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L &lt;= mid) <span class=\"built_in\">updL</span>(L, R, v, lch);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(R &gt; mid) <span class=\"built_in\">updL</span>(L, R, v, rch);</span><br><span class=\"line\">    <span class=\"built_in\">pushUp</span>(o);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">updR</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> v, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> o)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L &lt;= l &amp;&amp; r &lt;= R &amp;&amp; (v &gt;= maxL[o] || v &lt;= minL[o])) <span class=\"keyword\">return</span> <span class=\"built_in\">pushR</span>(v, l, r, o);</span><br><span class=\"line\">    <span class=\"built_in\">pushDown</span>(l, r, o);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(L &lt;= mid) <span class=\"built_in\">updR</span>(L, R, v, lch);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(R &gt; mid) <span class=\"built_in\">updR</span>(L, R, v, rch);</span><br><span class=\"line\">    <span class=\"built_in\">pushUp</span>(o);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    cin &gt;&gt; n;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) L[i] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) pre[i] = L[a[i]], L[a[i]] = i;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) L[i] = n + <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">per</span>(i, n, <span class=\"number\">1</span>) nxt[i] = L[a[i]], L[a[i]] = i;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>&amp; j = L[i] = i - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; j &amp;&amp; pre[j] &gt;= pre[i]; j = L[j]);</span><br><span class=\"line\">        vr[i].<span class=\"built_in\">eb</span>(<span class=\"built_in\">max</span>(j, <span class=\"number\">1</span>), i - <span class=\"number\">1</span>, pre[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">2</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>&amp; j = L[i] = i - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(; j &amp;&amp; nxt[j] &lt;= nxt[i]; j = L[j])</span><br><span class=\"line\">            vl[nxt[j]].<span class=\"built_in\">eb</span>(<span class=\"built_in\">max</span>(j, <span class=\"number\">1</span>), i - <span class=\"number\">1</span>, L[j]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">mem</span>(tagL, <span class=\"number\">63</span>), <span class=\"built_in\">mem</span>(tagR, <span class=\"number\">-1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">rep</span>(i, <span class=\"number\">1</span>, n) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [l, r, v] : vl[i]) <span class=\"built_in\">updL</span>(l, r, v, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">auto</span> [l, r, v] : vr[i]) <span class=\"built_in\">updR</span>(l, r, v, <span class=\"number\">1</span>, n, <span class=\"number\">1</span>);</span><br><span class=\"line\">        as += sum[<span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    cout &lt;&lt; as;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\r\n</details>\r\n<h3 id=\"cf566c\">CF566C</h3>\r\n<blockquote>\r\n<p> <span class=\"math inline\">\\(n\\)</span>  <span class=\"math inline\">\\(w_i\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(1.5\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(f(u)\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(f(u)\\)</span> </p>\r\n<p><span class=\"math inline\">\\(n \\le 2\\cdot 10^5\\)</span></p>\r\n</blockquote>\r\n<p> <span class=\"math inline\">\\(f(u)\\)</span>  <span class=\"math inline\">\\(f(u)\\)</span>  <span class=\"math inline\">\\(f(u)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(w_v\\text{dis}^{1.5}_v(u)\\)</span> </p>\r\n<p> <span class=\"math inline\">\\([l,r]\\)</span>  <span class=\"math inline\">\\(\\frac {l+r}2\\)</span>  <span class=\"math inline\">\\(\\frac {l+r}2\\)</span> </p>\r\n<p></p>\r\n<p> <span class=\"math inline\">\\(f(u)\\)</span> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(f(u)\\)</span>  <span class=\"math inline\">\\(0\\)</span> <span class=\"math inline\">\\((u,v)\\)</span> <span class=\"math inline\">\\(f(u)\\)</span>  <span class=\"math inline\">\\((u,v)\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math inline\">\\(u\\)</span> </p>\r\n<p> <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(v\\)</span>  <span class=\"math display\">\\[\r\n\\frac 32\\left(\\sum_{i=1}^nw_i\\sqrt{\\text{dis}(i,u)}-2\\sum_{i\\in \\text{subree}(v)}w_i\\sqrt{\\text{dis}(i,u)}\\right)\r\n\\]</span>  <span class=\"math inline\">\\(O(n)\\)</span>  <span class=\"math inline\">\\(u\\)</span>  <span class=\"math inline\">\\(O(n\\log n)\\)</span></p>\r\n"},{"title":"","date":"2021-03-13T13:29:55.000Z","updated":"2021-03-13T13:29:55.000Z","_content":" ```Ctrl + F``` \n\n- ****  \n- ****  \n- ****  ef-a tale of memories\n- ****  ARIA\n- ****  \n- ****  \n- ** **  sweet   pool\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  555\n- ****  \n- ****  \n- ****  SEED\n- ****  \n- ****  \n- ****  \n- **-**  \n- ****  \n- ****  5\n- ****  \n- ** **  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  Angel Beats!\n- ****  \n- ****  AIR\n- ****  \n- ****  \n- ****  \n- ****  \n- **45**  EF\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  Steins;Gate\n- **(??)(??)**  \n- ****  XXXHolic\n- ****  \n- ****  \n- ** **  School Day\n- ****  \n- ****  seed\n- ****  \n- ****  \n- ****  \n- ** **  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  kabuto\n- ****  \n- ****  \n- ****  \n- ** **  \n- ****  \n- ****  \n- ****  \n- ****  SOLA\n- ****  \n- ****  \n- **...**  \n- ****  \n- ****  \n- ****  \n- ****  AIR\n- ****  \n- ****  \n- ****  \n- **.**  EVA\n- ****  School Days\n- ****  \n- ****  \n- ****  fate zero\n- ****  secret base \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **??**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  5\n- ****  AIR\n- ****  \n- ****  EVOL\n- ****  angel beats\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **~**  \n- ****  eva\n- ****  AIR\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  OP\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  EVA\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  EVA\n- ****  \n- ****  \n- ****  School Days\n- ****  TOUCH\n- ****  \n- ****  \n- ****  clannad\n- ****  \n- ****  \n- ****  \n- ****  \n- **29200.000049**  \n- ****  Little Busters!\n- ****  H2O\n- ****  W\n- **All for oneone for all.**  \n- ****  \n- ****  kabuto\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **~**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **(?_?)**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  XXXHolic\n- ****  \n- ****  \n- ****  \n- **2%**  \n- ** **  CLANNAD\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  Clannad\n- ****  AIR\n- ****  \n- ****  CLANNAD\n- ****  \n- ****  \n- **BOSS**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  CLANNAD\n- ****  \n- ****  \n- ****  AIR\n- ****  \n- **Master**  \n- **... **  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  XXXHolic\n- ****  \n- ****  \n- ****  \n- ****  CLANNAD\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **2415**  \n- ****  -\n- ****  CLANNAD\n- ****  kabuto\n- ****  \n- ****  kabuto\n- ****  AIR\n- ****  \n- ****  R2\n- ****  \n- ****  \n- ****  AngleBeats!\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  Angel Beats!\n- ****  AIR\n- ****  CLANNAD\n- **~**  \n- ****  \n- ****  \n- ****  \n- ****  AngelBeats\n- ****  CLANNAD\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  EVA\n- **Time waits for no one.**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  angel beats\n- ****  angel beats\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **,**  \n- ****  \n- ****  Re\n- **~**  Re\n- ****  \n- **,**  Re\n- ****  \n- ****  Re\n- ****  \n- ****  \n- ****  fate/zero\n- ****  fate/zero\n- ****  fate/zero\n- ****  fate/zero\n- ** **  fate/zero\n- ****  Re\n- ****  fate/zero\n- ** **  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  JOJO\n- **JOJO**  JOJO\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  project\n- ****  \n- ****  \n- ****  Re\n- ****  \n- ****  \n- **Eloim Essaim Eloim Essaim **  \n- **All Hail Lelouch**  \n- ****  LE\n- **A**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ** **  \n- ** **  \n- ****  \n- ****  \n- ****  \n- **!**  \n- ****  \n- **Angel**  \n- **H**  \n- **...\\\"**  \n- ****  \n- **FFF**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ** --  ~**  \n- ****  \n- **............**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ** **  \n- ****  \n- ****  \n- ****  \n- **,**  \n- ****  \n- **Fight**  \n- **~**  \n- **~**  \n- ****  \n- ****  \n- ****  \n- **     **  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  Printemps\n- ****  LoveLive! The School idol Movie\n- **450 Shoot **  \n- ****  \n- **,,**  CLANNAD\n- ****  \n- ** **  \n- ** **  \n- ** **  \n- ****  \n- ****  \n- ****  NANA\n- **...**  \n- ****  \n- ****  \n- ****  \n- ****  EVA\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **  **  Collection\n- ****  \n- ****  \n- ****  \n- **,,,.**  \n- ****  CLANNAD\n- ****  \n- ****  \n- ****  \n- ****  \n- **?**  \n- ****  \n- ****  CLANNAD\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ** **  \n- ****  \n- ****  \n- **   **  \n- ****  ef-a tale of memories\n- **All for one, one for all.**  \n- **,,!**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **El Psy Congroo..**  \n- ****  \n- ****  SWEET POOL\n- **Oh,please don't let me die. Waiting for your touch.**  Re\n- **You Are (Not) Alone;You Can (Not) Advance;You Can (Not) Redo**  EVA\n- ****  \n- **MAKE OUR DREAMS ALIVE**  \n- ** **  \n- ****  \n- **       **  \n- ****  \n- ****  \n- **.......**  \n- ****  Clannad\n- ****  \n- ****  \n- **......**  \n- ****  \n- ****  \n- ****  \n- ****  Fate/Stay Night\n- ****  Clannad\n- ****  AIR\n- ****  EVA\n- ****  CLANNAD\n- ****  \n- **,...**  \n- ****  ()\n- ****  \n- ****  \n- **......**  \n- ****  \n- ****  100%\n- ****  Clannad\n- ****  Xss\n- ** **  PROJECT\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  PSYCHO-PASS\n- ****  \n- **? **  Fantastic Children\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **..**  \n- ****  \n- ****  \n- ****  \n- **,**  Fate/Zero\n- ****  \n- ****  \n- ****  \n- ****  \n- **......**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **,**  \n- **  **  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****   \n- ****  \n- ****  A\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **...**  \n- ****  \n- **starsnow**  \n- ****  \n- ****  \n- **, **  Canvas2 \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  RIDER Fate/Zero\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ** **  \n- **,**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  gosick\n- ****  \n- ** **  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  Eden*/b\n- ****  \n- ****  \n- ****  \n- ****  \n- ** **  \n- ****  \n- ****  \n- ****  \n- **,,**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **......**   \n- ****  \n- ****  \n- ****  \n- ****  \n- **5**  \n- ****  \n- ** **  \n- ****  \n- ** **  \n- ****  \n- ****  \n- ****  Angle Beats\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  LoveLive!\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ** ...**  \n\n- ** **  GAMERS\n\n- **This is your dream! Anything you can do in your dreams, you can do now!**  My Little Pony: Friendship is Magic\n\n- **What about super-ultra-extreme-awesomazing?**  My Little Pony: Friendship is Magic\n\n- **We've learned that friendship isn't always easy, but there's no doubt it's worth fighting for!**  My Little Pony: Friendship is Magic\n\n- ****  \n\n- ****  \n\n- **  Snow halation**  Snow Halation\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **!**  \n\n- **,!**  \n\n- ****  \n\n- **,**  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  Myself\n\n- ** **  \n\n- ****  \n\n- ** **  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **??**  ef-a tale of memories\n\n- ****  5\n\n- ** **  \n\n- ****  -\n\n- ****  \n\n- ****  \n\n- ****  \n\n- **????**  \n\n- **(??)(??)**  \n\n- ****  Steins;Gate\n\n- ****  \n\n- ****  \n\n- ****  kabuto\n\n- ****  angel beats\n\n- **??**  \n\n- **??**  EVA\n\n- ****  \n\n- **,**  \n\n- ****  \n\n- ****  \n\n- **,...**  Rozen Maiden\n\n- ****  Fate/Zero\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  0079\n\n- ****   \n\n- **What, so everyone's supposed to sleep every single night now? You realize that nighttime makes up half of all time?**  Rick\n\n- ****  Internet\n\n- ****  \n\n- **,,,.**  \n\n- ****  Gosick\n\n- ****  Stellaris\n\n- ** **   \n\n- ****  \n\n- ****  AIR\n\n- ****  \n\n- ****  KANON\n\n- **,,**  \n\n- ****  \n\n- **? .... **  \n\n- ****  \n\n- ****  \n\n- ** **  \n\n- ** **  \n\n- **   **  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **  **  \n\n- ****  \n\n- **   **  \n\n- **5**  \n\n- ****  \n\n- ****  DARLING in the FRANXX\n\n- ****  \n\n- ****  GAMER\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  Fate\n\n- ****  ???\n\n- **......**  \n\n- ****  \n\n- **...**  \n\n- ****  \n\n- ****  \n\n- ** **  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  AIR\n\n- ****  \n\n- **,**  \n\n- ****  \n\n- ****  \n\n- ** **  \n\n- ****  \n\n- ****  \n\n- **...**  JOJO\n\n- ****  JOJO\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **  **  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  S\n\n- ****  \n\n- ****  BLEACH\n\n- **......**  XIV\n\n- **'Cause rainbow won't light up the sky unless you let it rain.**  My Little Pony: Friendship is Magic\n\n- ****  \n\n- **  **  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **  **  \n\n- ****  \n\n- **,**  JOJO\n\n- ****  Darling in the FRANXX\n\n- ****  FLCL Progressive\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **4**  \n\n- ****  A\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ** -**  \n\n- ** **  \n\n- ****  \n\n- **NO**  JOJO\n\n- ****  JOJO\n\n- ****  \n\n- ****  \n\n- ****  JOJO\n\n- ****  \n\n- ****  \n\n- ****  Angel Beats!\n\n- ****  Angel Beats!\n\n- ****  Angel Beats!\n\n- ****  \n\n- ****  \n\n- ** **  \n\n- ****  \n\n- ****  JOJO\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****   \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  JOJO\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  JOJO\n\n- ****  \n\n- ** ...**  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **I met the girl under full-bloomed cherry blossoms, and my fate has begun to change.**  \n\n- ****  \n\n- ****  Fairy gone\n\n- ****  Azchx\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  Build\n\n- ****  00\n\n- ****  2\n\n- ****  2\n\n- ****  \n\n- **?...**  LoveLive!Sunshine!\n\n- ****  \n\n- ****  -\n\n- ****  \n\n- ****  Clannad\n\n- ****  2\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **A**  \n\n- ****  Fate / Grand Order\n\n- **...**  \n\n- ****  \n\n- ****  \n\n- **,**  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  00:\n\n- ****  TARI TARI\n\n- **...**  TARI TARI\n\n- ****  xxxholic\n\n- ****  \n\n- ****  \n\n- **Gundam Meister**  00\n\n- ****  Aqours\n\n- ****  Aqours\n\n- ****  Darling in the FRANXX\n\n- **Darling**  Darling in the FRANXX\n\n- ****  WHITE FIRST LOVE\n\n- ****  Other\n\n- **..................**  <A-RCV>\n\n- ****  \n\n- ****  \n\n- ****  x\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  JOJO\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  Aqours\n\n- **Games**  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **Ex - ploooosion !**  \n\n- ****  2\n\n- ****  \n\n- ****  \n\n- ****  Charlotte\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ** **  \n\n- ****  \n\n- **   **  Angel Beats!\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **~**  BanG Dream! 2nd Season\n\n- **.**  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **Star Burst Stream!**  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **,**  \n\n- ****  \n\n- ****  22/7\n\n- ****  \n\n- ****  \n\n- ****  Kabuto\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **()**  No Game No Life\n\n- ****  \n\n- ****  CLANNAD\n\n- ****  \n\n- ****  Fate/stay night\n\n- **Steel is my body, and fire is my blood.**  Fate/stay night\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  Angel Beats!\n\n- ****  5\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **.**  \n\n- ****  \n\n- ****  \n\n- **~**  \n\n- ****  JOJO\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  Comic Girls\n\n- **Don't forget. Always,somewhere,someone is fighting for you. As long as you remember her,you are not alone.**  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  Angelbeats\n\n- **  **  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **Ko no Dio da!**  JOJO\n\n- ****  \n\n- ****  00\n\n- **Exia**  00\n\n- ****  \n\n- ****  Comic Girls\n\n- **~~**  Fate/Zero\n\n- ****  \n\n- ****  Clannad\n\n- ****  Clannad\n\n- ****  Clannad\n\n- ****  Clannad\n\n- ****  Clannad\n\n- ****  Clannad\n\n- ****  ","source":"_posts/yi-yan.md","raw":"---\ntitle: \ndate: 2021-03-13 21:29:55\nupdated: 2021-03-13 21:29:55\ntags: [,]\n---\n ```Ctrl + F``` \n\n- ****  \n- ****  \n- ****  ef-a tale of memories\n- ****  ARIA\n- ****  \n- ****  \n- ** **  sweet   pool\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  555\n- ****  \n- ****  \n- ****  SEED\n- ****  \n- ****  \n- ****  \n- **-**  \n- ****  \n- ****  5\n- ****  \n- ** **  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  Angel Beats!\n- ****  \n- ****  AIR\n- ****  \n- ****  \n- ****  \n- ****  \n- **45**  EF\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  Steins;Gate\n- **(??)(??)**  \n- ****  XXXHolic\n- ****  \n- ****  \n- ** **  School Day\n- ****  \n- ****  seed\n- ****  \n- ****  \n- ****  \n- ** **  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  kabuto\n- ****  \n- ****  \n- ****  \n- ** **  \n- ****  \n- ****  \n- ****  \n- ****  SOLA\n- ****  \n- ****  \n- **...**  \n- ****  \n- ****  \n- ****  \n- ****  AIR\n- ****  \n- ****  \n- ****  \n- **.**  EVA\n- ****  School Days\n- ****  \n- ****  \n- ****  fate zero\n- ****  secret base \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **??**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  5\n- ****  AIR\n- ****  \n- ****  EVOL\n- ****  angel beats\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **~**  \n- ****  eva\n- ****  AIR\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  OP\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  EVA\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  EVA\n- ****  \n- ****  \n- ****  School Days\n- ****  TOUCH\n- ****  \n- ****  \n- ****  clannad\n- ****  \n- ****  \n- ****  \n- ****  \n- **29200.000049**  \n- ****  Little Busters!\n- ****  H2O\n- ****  W\n- **All for oneone for all.**  \n- ****  \n- ****  kabuto\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **~**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **(?_?)**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  XXXHolic\n- ****  \n- ****  \n- ****  \n- **2%**  \n- ** **  CLANNAD\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  Clannad\n- ****  AIR\n- ****  \n- ****  CLANNAD\n- ****  \n- ****  \n- **BOSS**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  CLANNAD\n- ****  \n- ****  \n- ****  AIR\n- ****  \n- **Master**  \n- **... **  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  XXXHolic\n- ****  \n- ****  \n- ****  \n- ****  CLANNAD\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **2415**  \n- ****  -\n- ****  CLANNAD\n- ****  kabuto\n- ****  \n- ****  kabuto\n- ****  AIR\n- ****  \n- ****  R2\n- ****  \n- ****  \n- ****  AngleBeats!\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  Angel Beats!\n- ****  AIR\n- ****  CLANNAD\n- **~**  \n- ****  \n- ****  \n- ****  \n- ****  AngelBeats\n- ****  CLANNAD\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  EVA\n- **Time waits for no one.**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  angel beats\n- ****  angel beats\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **,**  \n- ****  \n- ****  Re\n- **~**  Re\n- ****  \n- **,**  Re\n- ****  \n- ****  Re\n- ****  \n- ****  \n- ****  fate/zero\n- ****  fate/zero\n- ****  fate/zero\n- ****  fate/zero\n- ** **  fate/zero\n- ****  Re\n- ****  fate/zero\n- ** **  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  JOJO\n- **JOJO**  JOJO\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  project\n- ****  \n- ****  \n- ****  Re\n- ****  \n- ****  \n- **Eloim Essaim Eloim Essaim **  \n- **All Hail Lelouch**  \n- ****  LE\n- **A**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ** **  \n- ** **  \n- ****  \n- ****  \n- ****  \n- **!**  \n- ****  \n- **Angel**  \n- **H**  \n- **...\\\"**  \n- ****  \n- **FFF**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ** --  ~**  \n- ****  \n- **............**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ** **  \n- ****  \n- ****  \n- ****  \n- **,**  \n- ****  \n- **Fight**  \n- **~**  \n- **~**  \n- ****  \n- ****  \n- ****  \n- **     **  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  Printemps\n- ****  LoveLive! The School idol Movie\n- **450 Shoot **  \n- ****  \n- **,,**  CLANNAD\n- ****  \n- ** **  \n- ** **  \n- ** **  \n- ****  \n- ****  \n- ****  NANA\n- **...**  \n- ****  \n- ****  \n- ****  \n- ****  EVA\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **  **  Collection\n- ****  \n- ****  \n- ****  \n- **,,,.**  \n- ****  CLANNAD\n- ****  \n- ****  \n- ****  \n- ****  \n- **?**  \n- ****  \n- ****  CLANNAD\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ** **  \n- ****  \n- ****  \n- **   **  \n- ****  ef-a tale of memories\n- **All for one, one for all.**  \n- **,,!**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **El Psy Congroo..**  \n- ****  \n- ****  SWEET POOL\n- **Oh,please don't let me die. Waiting for your touch.**  Re\n- **You Are (Not) Alone;You Can (Not) Advance;You Can (Not) Redo**  EVA\n- ****  \n- **MAKE OUR DREAMS ALIVE**  \n- ** **  \n- ****  \n- **       **  \n- ****  \n- ****  \n- **.......**  \n- ****  Clannad\n- ****  \n- ****  \n- **......**  \n- ****  \n- ****  \n- ****  \n- ****  Fate/Stay Night\n- ****  Clannad\n- ****  AIR\n- ****  EVA\n- ****  CLANNAD\n- ****  \n- **,...**  \n- ****  ()\n- ****  \n- ****  \n- **......**  \n- ****  \n- ****  100%\n- ****  Clannad\n- ****  Xss\n- ** **  PROJECT\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  PSYCHO-PASS\n- ****  \n- **? **  Fantastic Children\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **..**  \n- ****  \n- ****  \n- ****  \n- **,**  Fate/Zero\n- ****  \n- ****  \n- ****  \n- ****  \n- **......**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **,**  \n- **  **  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****   \n- ****  \n- ****  A\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **...**  \n- ****  \n- **starsnow**  \n- ****  \n- ****  \n- **, **  Canvas2 \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  RIDER Fate/Zero\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ** **  \n- **,**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  gosick\n- ****  \n- ** **  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  Eden*/b\n- ****  \n- ****  \n- ****  \n- ****  \n- ** **  \n- ****  \n- ****  \n- ****  \n- **,,**  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- ****  \n- **......**   \n- ****  \n- ****  \n- ****  \n- ****  \n- **5**  \n- ****  \n- ** **  \n- ****  \n- ** **  \n- ****  \n- ****  \n- ****  Angle Beats\n- ****  \n- ****  \n- ****  \n- ****  \n- ****  LoveLive!\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ** ...**  \n\n- ** **  GAMERS\n\n- **This is your dream! Anything you can do in your dreams, you can do now!**  My Little Pony: Friendship is Magic\n\n- **What about super-ultra-extreme-awesomazing?**  My Little Pony: Friendship is Magic\n\n- **We've learned that friendship isn't always easy, but there's no doubt it's worth fighting for!**  My Little Pony: Friendship is Magic\n\n- ****  \n\n- ****  \n\n- **  Snow halation**  Snow Halation\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **!**  \n\n- **,!**  \n\n- ****  \n\n- **,**  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  Myself\n\n- ** **  \n\n- ****  \n\n- ** **  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **??**  ef-a tale of memories\n\n- ****  5\n\n- ** **  \n\n- ****  -\n\n- ****  \n\n- ****  \n\n- ****  \n\n- **????**  \n\n- **(??)(??)**  \n\n- ****  Steins;Gate\n\n- ****  \n\n- ****  \n\n- ****  kabuto\n\n- ****  angel beats\n\n- **??**  \n\n- **??**  EVA\n\n- ****  \n\n- **,**  \n\n- ****  \n\n- ****  \n\n- **,...**  Rozen Maiden\n\n- ****  Fate/Zero\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  0079\n\n- ****   \n\n- **What, so everyone's supposed to sleep every single night now? You realize that nighttime makes up half of all time?**  Rick\n\n- ****  Internet\n\n- ****  \n\n- **,,,.**  \n\n- ****  Gosick\n\n- ****  Stellaris\n\n- ** **   \n\n- ****  \n\n- ****  AIR\n\n- ****  \n\n- ****  KANON\n\n- **,,**  \n\n- ****  \n\n- **? .... **  \n\n- ****  \n\n- ****  \n\n- ** **  \n\n- ** **  \n\n- **   **  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **  **  \n\n- ****  \n\n- **   **  \n\n- **5**  \n\n- ****  \n\n- ****  DARLING in the FRANXX\n\n- ****  \n\n- ****  GAMER\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  Fate\n\n- ****  ???\n\n- **......**  \n\n- ****  \n\n- **...**  \n\n- ****  \n\n- ****  \n\n- ** **  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  AIR\n\n- ****  \n\n- **,**  \n\n- ****  \n\n- ****  \n\n- ** **  \n\n- ****  \n\n- ****  \n\n- **...**  JOJO\n\n- ****  JOJO\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **  **  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  S\n\n- ****  \n\n- ****  BLEACH\n\n- **......**  XIV\n\n- **'Cause rainbow won't light up the sky unless you let it rain.**  My Little Pony: Friendship is Magic\n\n- ****  \n\n- **  **  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **  **  \n\n- ****  \n\n- **,**  JOJO\n\n- ****  Darling in the FRANXX\n\n- ****  FLCL Progressive\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **4**  \n\n- ****  A\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ** -**  \n\n- ** **  \n\n- ****  \n\n- **NO**  JOJO\n\n- ****  JOJO\n\n- ****  \n\n- ****  \n\n- ****  JOJO\n\n- ****  \n\n- ****  \n\n- ****  Angel Beats!\n\n- ****  Angel Beats!\n\n- ****  Angel Beats!\n\n- ****  \n\n- ****  \n\n- ** **  \n\n- ****  \n\n- ****  JOJO\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****   \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  JOJO\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  JOJO\n\n- ****  \n\n- ** ...**  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **I met the girl under full-bloomed cherry blossoms, and my fate has begun to change.**  \n\n- ****  \n\n- ****  Fairy gone\n\n- ****  Azchx\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  Build\n\n- ****  00\n\n- ****  2\n\n- ****  2\n\n- ****  \n\n- **?...**  LoveLive!Sunshine!\n\n- ****  \n\n- ****  -\n\n- ****  \n\n- ****  Clannad\n\n- ****  2\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **A**  \n\n- ****  Fate / Grand Order\n\n- **...**  \n\n- ****  \n\n- ****  \n\n- **,**  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  00:\n\n- ****  TARI TARI\n\n- **...**  TARI TARI\n\n- ****  xxxholic\n\n- ****  \n\n- ****  \n\n- **Gundam Meister**  00\n\n- ****  Aqours\n\n- ****  Aqours\n\n- ****  Darling in the FRANXX\n\n- **Darling**  Darling in the FRANXX\n\n- ****  WHITE FIRST LOVE\n\n- ****  Other\n\n- **..................**  <A-RCV>\n\n- ****  \n\n- ****  \n\n- ****  x\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  JOJO\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  Aqours\n\n- **Games**  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **Ex - ploooosion !**  \n\n- ****  2\n\n- ****  \n\n- ****  \n\n- ****  Charlotte\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ** **  \n\n- ****  \n\n- **   **  Angel Beats!\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **~**  BanG Dream! 2nd Season\n\n- **.**  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **Star Burst Stream!**  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **,**  \n\n- ****  \n\n- ****  22/7\n\n- ****  \n\n- ****  \n\n- ****  Kabuto\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **()**  No Game No Life\n\n- ****  \n\n- ****  CLANNAD\n\n- ****  \n\n- ****  Fate/stay night\n\n- **Steel is my body, and fire is my blood.**  Fate/stay night\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  Angel Beats!\n\n- ****  5\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **.**  \n\n- ****  \n\n- ****  \n\n- **~**  \n\n- ****  JOJO\n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  Comic Girls\n\n- **Don't forget. Always,somewhere,someone is fighting for you. As long as you remember her,you are not alone.**  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  Angelbeats\n\n- **  **  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- ****  \n\n- **Ko no Dio da!**  JOJO\n\n- ****  \n\n- ****  00\n\n- **Exia**  00\n\n- ****  \n\n- ****  Comic Girls\n\n- **~~**  Fate/Zero\n\n- ****  \n\n- ****  Clannad\n\n- ****  Clannad\n\n- ****  Clannad\n\n- ****  Clannad\n\n- ****  Clannad\n\n- ****  Clannad\n\n- ****  ","slug":"yi-yan","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"cktfuxh47007rootn51ys72sz","content":"<p> <code>Ctrl + F</code> </p>\r\n<ul>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  ef-a tale of memories</p></li>\r\n<li><p><strong></strong>  ARIA</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  sweet pool</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  555</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  SEED</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>-</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  5</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Angel Beats!</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>45</strong>  EF</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Steins;Gate</p></li>\r\n<li><p><strong>(??)(??)</strong>  </p></li>\r\n<li><p><strong></strong>  XXXHolic</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  School Day</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  seed</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  kabuto</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  SOLA</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>...</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>.</strong>  EVA</p></li>\r\n<li><p><strong></strong>  School Days</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  fate zero</p></li>\r\n<li><p><strong></strong>  secret base </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>??</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  5</p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  EVOL</p></li>\r\n<li><p><strong></strong>  angel beats</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>~</strong>  </p></li>\r\n<li><p><strong></strong>  eva</p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  OP</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  EVA</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  EVA</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  School Days</p></li>\r\n<li><p><strong></strong>  TOUCH</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  clannad</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>29200.000049</strong>  </p></li>\r\n<li><p><strong></strong>  Little Busters!</p></li>\r\n<li><p><strong></strong>  H2O</p></li>\r\n<li><p><strong></strong>  W</p></li>\r\n<li><p><strong>All for oneone for all.</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  kabuto</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>~</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p>**(?_?)**  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  XXXHolic</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>2%</strong>  </p></li>\r\n<li><p><strong> </strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>BOSS</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Master</strong>  </p></li>\r\n<li><p><strong>... </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  XXXHolic</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>2415</strong>  </p></li>\r\n<li><p><strong></strong>  -</p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  kabuto</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  kabuto</p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  R2</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  AngleBeats!</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Angel Beats!</p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong>~</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  AngelBeats</p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  EVA</p></li>\r\n<li><p><strong>Time waits for no one.</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  angel beats</p></li>\r\n<li><p><strong></strong>  angel beats</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Re</p></li>\r\n<li><p><strong>~</strong>  Re</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  Re</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Re</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  fate/zero</p></li>\r\n<li><p><strong></strong>  fate/zero</p></li>\r\n<li><p><strong></strong>  fate/zero</p></li>\r\n<li><p><strong></strong>  fate/zero</p></li>\r\n<li><p><strong> </strong>  fate/zero</p></li>\r\n<li><p><strong></strong>  Re</p></li>\r\n<li><p><strong></strong>  fate/zero</p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong>JOJO</strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  project</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Re</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Eloim Essaim Eloim Essaim </strong>  </p></li>\r\n<li><p><strong>All Hail Lelouch</strong>  </p></li>\r\n<li><p><strong></strong>  LE</p></li>\r\n<li><p><strong>A</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>!</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Angel</strong>  </p></li>\r\n<li><p><strong>H</strong>  </p></li>\r\n<li><p><strong>...\"</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>FFF</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> --  ~</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>............</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Fight</strong>  </p></li>\r\n<li><p><strong>~</strong>  </p></li>\r\n<li><p><strong>~</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>     </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Printemps</p></li>\r\n<li><p><strong></strong>  LoveLive! The School idol Movie</p></li>\r\n<li><p><strong>450 Shoot </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,,</strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  NANA</p></li>\r\n<li><p><strong>...</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  EVA</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>  </strong>  Collection</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,,,.</strong>  </p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>?</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>   </strong>  </p></li>\r\n<li><p><strong></strong>  ef-a tale of memories</p></li>\r\n<li><p><strong>All for one, one for all.</strong>  </p></li>\r\n<li><p><strong>,,!</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>El Psy Congroo..</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  SWEET POOL</p></li>\r\n<li><p><strong>Oh,please don't let me die. Waiting for your touch.</strong>  Re</p></li>\r\n<li><p><strong>You Are (Not) Alone;You Can (Not) Advance;You Can (Not) Redo</strong>  EVA</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>MAKE OUR DREAMS ALIVE</strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>     </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>.......</strong>  </p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>......</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Fate/Stay Night</p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  EVA</p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,...</strong>  </p></li>\r\n<li><p><strong></strong>  ()</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>......</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  100%</p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  Xss</p></li>\r\n<li><p><strong> </strong>  PROJECT</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  PSYCHO-PASS</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>? </strong>  Fantastic Children</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>..</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  Fate/Zero</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>......</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong>  </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  A</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>...</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>starsnow</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>, </strong>  Canvas2 </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  RIDER Fate/Zero</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  gosick</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Eden*/b</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>......</strong>   </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>5</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Angle Beats</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  LoveLive!</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> ...</strong>  </p></li>\r\n<li><p><strong> </strong>  GAMERS</p></li>\r\n<li><p><strong>This is your dream! Anything you can do in your dreams, you can do now!</strong>  My Little Pony: Friendship is Magic</p></li>\r\n<li><p><strong>What about super-ultra-extreme-awesomazing?</strong>  My Little Pony: Friendship is Magic</p></li>\r\n<li><p><strong>We've learned that friendship isn't always easy, but there's no doubt it's worth fighting for!</strong>  My Little Pony: Friendship is Magic</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>  Snow halation</strong>  Snow Halation</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>!</strong>  </p></li>\r\n<li><p><strong>,!</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Myself</p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>??</strong>  ef-a tale of memories</p></li>\r\n<li><p><strong></strong>  5</p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  -</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>????</strong>  </p></li>\r\n<li><p><strong>(??)(??)</strong>  </p></li>\r\n<li><p><strong></strong>  Steins;Gate</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  kabuto</p></li>\r\n<li><p><strong></strong>  angel beats</p></li>\r\n<li><p><strong>??</strong>  </p></li>\r\n<li><p><strong>??</strong>  EVA</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,...</strong>  Rozen Maiden</p></li>\r\n<li><p><strong></strong>  Fate/Zero</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  0079</p></li>\r\n<li><p><strong></strong>   </p></li>\r\n<li><p><strong>What, so everyone's supposed to sleep every single night now? You realize that nighttime makes up half of all time?</strong>  Rick</p></li>\r\n<li><p><strong></strong>  Internet</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,,,.</strong>  </p></li>\r\n<li><p><strong></strong>  Gosick</p></li>\r\n<li><p><strong></strong>  Stellaris</p></li>\r\n<li><p><strong> </strong>   </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  KANON</p></li>\r\n<li><p><strong>,,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>? .... </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong>   </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>  </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>   </strong>  </p></li>\r\n<li><p><strong>5</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  DARLING in the FRANXX</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  GAMER</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Fate</p></li>\r\n<li><p><strong></strong>  ???</p></li>\r\n<li><p><strong>......</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>...</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>...</strong>  JOJO</p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  S</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  BLEACH</p></li>\r\n<li><p><strong>......</strong>  XIV</p></li>\r\n<li><p><strong>'Cause rainbow won't light up the sky unless you let it rain.</strong>  My Little Pony: Friendship is Magic</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>  </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>  </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  JOJO</p></li>\r\n<li><p><strong></strong>  Darling in the FRANXX</p></li>\r\n<li><p><strong></strong>  FLCL Progressive</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>4</strong>  </p></li>\r\n<li><p><strong></strong>  A</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> -</strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>NO</strong>  JOJO</p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Angel Beats!</p></li>\r\n<li><p><strong></strong>  Angel Beats!</p></li>\r\n<li><p><strong></strong>  Angel Beats!</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>   </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> ...</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>I met the girl under full-bloomed cherry blossoms, and my fate has begun to change.</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Fairy gone</p></li>\r\n<li><p><strong></strong>  Azchx</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Build</p></li>\r\n<li><p><strong></strong>  00</p></li>\r\n<li><p><strong></strong>  2</p></li>\r\n<li><p><strong></strong>  2</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>?...</strong>  LoveLive!Sunshine!</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  -</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  2</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>A</strong>  </p></li>\r\n<li><p><strong></strong>  Fate / Grand Order</p></li>\r\n<li><p><strong>...</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  00:</p></li>\r\n<li><p><strong></strong>  TARI TARI</p></li>\r\n<li><p><strong>...</strong>  TARI TARI</p></li>\r\n<li><p><strong></strong>  xxxholic</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Gundam Meister</strong>  00</p></li>\r\n<li><p><strong></strong>  Aqours</p></li>\r\n<li><p><strong></strong>  Aqours</p></li>\r\n<li><p><strong></strong>  Darling in the FRANXX</p></li>\r\n<li><p><strong>Darling</strong>  Darling in the FRANXX</p></li>\r\n<li><p><strong></strong>  WHITE FIRST LOVE</p></li>\r\n<li><p><strong></strong>  Other</p></li>\r\n<li><p><strong>..................</strong>  <A-RCV></p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  x</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Aqours</p></li>\r\n<li><p><strong>Games</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Ex - ploooosion !</strong>  </p></li>\r\n<li><p><strong></strong>  2</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Charlotte</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>   </strong>  Angel Beats!</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>~</strong>  BanG Dream! 2nd Season</p></li>\r\n<li><p><strong>.</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Star Burst Stream!</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  22/7</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Kabuto</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>()</strong>  No Game No Life</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Fate/stay night</p></li>\r\n<li><p><strong>Steel is my body, and fire is my blood.</strong>  Fate/stay night</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Angel Beats!</p></li>\r\n<li><p><strong></strong>  5</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>.</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>~</strong>  </p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Comic Girls</p></li>\r\n<li><p><strong>Don't forget. Always,somewhere,someone is fighting for you. As long as you remember her,you are not alone.</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Angelbeats</p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Ko no Dio da!</strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  00</p></li>\r\n<li><p><strong>Exia</strong>  00</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Comic Girls</p></li>\r\n<li><p><strong>~~</strong>  Fate/Zero</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n</ul>\r\n","site":{"data":{}},"length":35643,"excerpt":"","more":"<p> <code>Ctrl + F</code> </p>\r\n<ul>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  ef-a tale of memories</p></li>\r\n<li><p><strong></strong>  ARIA</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  sweet pool</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  555</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  SEED</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>-</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  5</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Angel Beats!</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>45</strong>  EF</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Steins;Gate</p></li>\r\n<li><p><strong>(??)(??)</strong>  </p></li>\r\n<li><p><strong></strong>  XXXHolic</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  School Day</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  seed</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  kabuto</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  SOLA</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>...</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>.</strong>  EVA</p></li>\r\n<li><p><strong></strong>  School Days</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  fate zero</p></li>\r\n<li><p><strong></strong>  secret base </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>??</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  5</p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  EVOL</p></li>\r\n<li><p><strong></strong>  angel beats</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>~</strong>  </p></li>\r\n<li><p><strong></strong>  eva</p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  OP</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  EVA</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  EVA</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  School Days</p></li>\r\n<li><p><strong></strong>  TOUCH</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  clannad</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>29200.000049</strong>  </p></li>\r\n<li><p><strong></strong>  Little Busters!</p></li>\r\n<li><p><strong></strong>  H2O</p></li>\r\n<li><p><strong></strong>  W</p></li>\r\n<li><p><strong>All for oneone for all.</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  kabuto</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>~</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p>**(?_?)**  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  XXXHolic</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>2%</strong>  </p></li>\r\n<li><p><strong> </strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>BOSS</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Master</strong>  </p></li>\r\n<li><p><strong>... </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  XXXHolic</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>2415</strong>  </p></li>\r\n<li><p><strong></strong>  -</p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  kabuto</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  kabuto</p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  R2</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  AngleBeats!</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Angel Beats!</p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong>~</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  AngelBeats</p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  EVA</p></li>\r\n<li><p><strong>Time waits for no one.</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  angel beats</p></li>\r\n<li><p><strong></strong>  angel beats</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Re</p></li>\r\n<li><p><strong>~</strong>  Re</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  Re</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Re</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  fate/zero</p></li>\r\n<li><p><strong></strong>  fate/zero</p></li>\r\n<li><p><strong></strong>  fate/zero</p></li>\r\n<li><p><strong></strong>  fate/zero</p></li>\r\n<li><p><strong> </strong>  fate/zero</p></li>\r\n<li><p><strong></strong>  Re</p></li>\r\n<li><p><strong></strong>  fate/zero</p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong>JOJO</strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  project</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Re</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Eloim Essaim Eloim Essaim </strong>  </p></li>\r\n<li><p><strong>All Hail Lelouch</strong>  </p></li>\r\n<li><p><strong></strong>  LE</p></li>\r\n<li><p><strong>A</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>!</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Angel</strong>  </p></li>\r\n<li><p><strong>H</strong>  </p></li>\r\n<li><p><strong>...\"</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>FFF</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> --  ~</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>............</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Fight</strong>  </p></li>\r\n<li><p><strong>~</strong>  </p></li>\r\n<li><p><strong>~</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>     </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Printemps</p></li>\r\n<li><p><strong></strong>  LoveLive! The School idol Movie</p></li>\r\n<li><p><strong>450 Shoot </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,,</strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  NANA</p></li>\r\n<li><p><strong>...</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  EVA</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>  </strong>  Collection</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,,,.</strong>  </p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>?</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>   </strong>  </p></li>\r\n<li><p><strong></strong>  ef-a tale of memories</p></li>\r\n<li><p><strong>All for one, one for all.</strong>  </p></li>\r\n<li><p><strong>,,!</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>El Psy Congroo..</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  SWEET POOL</p></li>\r\n<li><p><strong>Oh,please don't let me die. Waiting for your touch.</strong>  Re</p></li>\r\n<li><p><strong>You Are (Not) Alone;You Can (Not) Advance;You Can (Not) Redo</strong>  EVA</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>MAKE OUR DREAMS ALIVE</strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>     </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>.......</strong>  </p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>......</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Fate/Stay Night</p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  EVA</p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,...</strong>  </p></li>\r\n<li><p><strong></strong>  ()</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>......</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  100%</p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  Xss</p></li>\r\n<li><p><strong> </strong>  PROJECT</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  PSYCHO-PASS</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>? </strong>  Fantastic Children</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>..</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  Fate/Zero</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>......</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong>  </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  A</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>...</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>starsnow</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>, </strong>  Canvas2 </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  RIDER Fate/Zero</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  gosick</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Eden*/b</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>......</strong>   </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>5</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Angle Beats</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  LoveLive!</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> ...</strong>  </p></li>\r\n<li><p><strong> </strong>  GAMERS</p></li>\r\n<li><p><strong>This is your dream! Anything you can do in your dreams, you can do now!</strong>  My Little Pony: Friendship is Magic</p></li>\r\n<li><p><strong>What about super-ultra-extreme-awesomazing?</strong>  My Little Pony: Friendship is Magic</p></li>\r\n<li><p><strong>We've learned that friendship isn't always easy, but there's no doubt it's worth fighting for!</strong>  My Little Pony: Friendship is Magic</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>  Snow halation</strong>  Snow Halation</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>!</strong>  </p></li>\r\n<li><p><strong>,!</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Myself</p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>??</strong>  ef-a tale of memories</p></li>\r\n<li><p><strong></strong>  5</p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  -</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>????</strong>  </p></li>\r\n<li><p><strong>(??)(??)</strong>  </p></li>\r\n<li><p><strong></strong>  Steins;Gate</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  kabuto</p></li>\r\n<li><p><strong></strong>  angel beats</p></li>\r\n<li><p><strong>??</strong>  </p></li>\r\n<li><p><strong>??</strong>  EVA</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,...</strong>  Rozen Maiden</p></li>\r\n<li><p><strong></strong>  Fate/Zero</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  0079</p></li>\r\n<li><p><strong></strong>   </p></li>\r\n<li><p><strong>What, so everyone's supposed to sleep every single night now? You realize that nighttime makes up half of all time?</strong>  Rick</p></li>\r\n<li><p><strong></strong>  Internet</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,,,.</strong>  </p></li>\r\n<li><p><strong></strong>  Gosick</p></li>\r\n<li><p><strong></strong>  Stellaris</p></li>\r\n<li><p><strong> </strong>   </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  KANON</p></li>\r\n<li><p><strong>,,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>? .... </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong>   </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>  </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>   </strong>  </p></li>\r\n<li><p><strong>5</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  DARLING in the FRANXX</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  GAMER</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Fate</p></li>\r\n<li><p><strong></strong>  ???</p></li>\r\n<li><p><strong>......</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>...</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  AIR</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>...</strong>  JOJO</p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  S</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  BLEACH</p></li>\r\n<li><p><strong>......</strong>  XIV</p></li>\r\n<li><p><strong>'Cause rainbow won't light up the sky unless you let it rain.</strong>  My Little Pony: Friendship is Magic</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>  </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>  </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  JOJO</p></li>\r\n<li><p><strong></strong>  Darling in the FRANXX</p></li>\r\n<li><p><strong></strong>  FLCL Progressive</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>4</strong>  </p></li>\r\n<li><p><strong></strong>  A</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> -</strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>NO</strong>  JOJO</p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Angel Beats!</p></li>\r\n<li><p><strong></strong>  Angel Beats!</p></li>\r\n<li><p><strong></strong>  Angel Beats!</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>   </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> ...</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>I met the girl under full-bloomed cherry blossoms, and my fate has begun to change.</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Fairy gone</p></li>\r\n<li><p><strong></strong>  Azchx</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Build</p></li>\r\n<li><p><strong></strong>  00</p></li>\r\n<li><p><strong></strong>  2</p></li>\r\n<li><p><strong></strong>  2</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>?...</strong>  LoveLive!Sunshine!</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  -</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  2</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>A</strong>  </p></li>\r\n<li><p><strong></strong>  Fate / Grand Order</p></li>\r\n<li><p><strong>...</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  00:</p></li>\r\n<li><p><strong></strong>  TARI TARI</p></li>\r\n<li><p><strong>...</strong>  TARI TARI</p></li>\r\n<li><p><strong></strong>  xxxholic</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Gundam Meister</strong>  00</p></li>\r\n<li><p><strong></strong>  Aqours</p></li>\r\n<li><p><strong></strong>  Aqours</p></li>\r\n<li><p><strong></strong>  Darling in the FRANXX</p></li>\r\n<li><p><strong>Darling</strong>  Darling in the FRANXX</p></li>\r\n<li><p><strong></strong>  WHITE FIRST LOVE</p></li>\r\n<li><p><strong></strong>  Other</p></li>\r\n<li><p><strong>..................</strong>  <A-RCV></p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  x</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Aqours</p></li>\r\n<li><p><strong>Games</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Ex - ploooosion !</strong>  </p></li>\r\n<li><p><strong></strong>  2</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Charlotte</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>   </strong>  Angel Beats!</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>~</strong>  BanG Dream! 2nd Season</p></li>\r\n<li><p><strong>.</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Star Burst Stream!</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>,</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  22/7</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Kabuto</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>()</strong>  No Game No Life</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  CLANNAD</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Fate/stay night</p></li>\r\n<li><p><strong>Steel is my body, and fire is my blood.</strong>  Fate/stay night</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Angel Beats!</p></li>\r\n<li><p><strong></strong>  5</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>.</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>~</strong>  </p></li>\r\n<li><p><strong></strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Comic Girls</p></li>\r\n<li><p><strong>Don't forget. Always,somewhere,someone is fighting for you. As long as you remember her,you are not alone.</strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Angelbeats</p></li>\r\n<li><p><strong> </strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong>Ko no Dio da!</strong>  JOJO</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  00</p></li>\r\n<li><p><strong>Exia</strong>  00</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Comic Girls</p></li>\r\n<li><p><strong>~~</strong>  Fate/Zero</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  Clannad</p></li>\r\n<li><p><strong></strong>  </p></li>\r\n</ul>\r\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cktfuxgz80001ootnd14262cw","category_id":"cktfuxgzd0004ootnbvejgzkw","_id":"cktfuxgzk000eootn66he43pc"},{"post_id":"cktfuxgzj000cootnhd6igolb","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxgzo000jootn2gfca2q2"},{"post_id":"cktfuxgzc0003ootnay514bwf","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxgzp000nootn2podfitm"},{"post_id":"cktfuxgzk000dootnaq1fdrze","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxgzq000pootncxij6rzj"},{"post_id":"cktfuxgzm000hootn4b9l05sa","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxgzr000tootnfqrlemh4"},{"post_id":"cktfuxgzf0007ootn8uajb5sj","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxgzt000wootng8yq3rmf"},{"post_id":"cktfuxgzn000iootn8fks0s6f","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxgzu000zootnhili3pye"},{"post_id":"cktfuxgzp000mootnaem74fd7","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxgzv0013ootnds3rhjo4"},{"post_id":"cktfuxgzg0008ootn1ii8gnvn","category_id":"cktfuxgzo000kootnhijj3257","_id":"cktfuxgzw0016ootneg1a4l64"},{"post_id":"cktfuxgzp000oootnh031bevk","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxgzx001aootnbg3xa2e2"},{"post_id":"cktfuxgzr000sootn1ui68khy","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxgzy001cootnarhv3f95"},{"post_id":"cktfuxgzh0009ootnbl32fj1d","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxgzz001footn7temeohg"},{"post_id":"cktfuxgzs000vootn7ij97f6n","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxgzz001iootn7z3d82wa"},{"post_id":"cktfuxgzt000yootn2z3oc7bs","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxh00001mootn2urn5kxw"},{"post_id":"cktfuxgzu0012ootncu3t3xus","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxh01001pootn8hk636ud"},{"post_id":"cktfuxgzv0015ootn4pqv90ir","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxh02001tootncrr21qu1"},{"post_id":"cktfuxgzw0019ootn9cet8kv2","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxh03001vootnaxa7fo1x"},{"post_id":"cktfuxgzx001bootn9hy4h0le","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxh04001xootn7ag995n0"},{"post_id":"cktfuxgzy001eootnctq0fpr7","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxh050022ootn8sqlewkj"},{"post_id":"cktfuxgzz001hootnfqcqgs66","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxh080025ootn2roz9gf4"},{"post_id":"cktfuxh00001lootn0ruo852i","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxh0b002aootnbj5ccvtm"},{"post_id":"cktfuxh02001sootn8y17gs97","category_id":"cktfuxgzi000aootn0hdt5hpc","_id":"cktfuxh0c002cootng3y4f2vr"},{"post_id":"cktfuxh03001uootncgxbc09w","category_id":"cktfuxh04001zootnfod93aor","_id":"cktfuxh0e002hootn3pfz0sjn"},{"post_id":"cktfuxh03001wootnaf27hcj4","category_id":"cktfuxh04001zootnfod93aor","_id":"cktfuxh0j002oootnd7dze8es"},{"post_id":"cktfuxh050021ootnbviu7tnp","category_id":"cktfuxh04001zootnfod93aor","_id":"cktfuxh0l002sootnbdyf64fq"},{"post_id":"cktfuxh060024ootnhn3b2p5l","category_id":"cktfuxh0i002nootnfeus43na","_id":"cktfuxh0n002yootndknm3euw"},{"post_id":"cktfuxh0a0028ootn116ffzdj","category_id":"cktfuxh0l002tootn5ze3g1yp","_id":"cktfuxh0r0034ootn2way59wi"},{"post_id":"cktfuxh0b002bootngpls904j","category_id":"cktfuxh0n002zootnbvqq5e9h","_id":"cktfuxh0t003aootn29122ncq"},{"post_id":"cktfuxh0e002footncyti6e54","category_id":"cktfuxh0r0035ootngti891de","_id":"cktfuxh0w003hootn0ffc92vj"},{"post_id":"cktfuxh0i002mootn52vu9bia","category_id":"cktfuxh0u003cootn49unguzf","_id":"cktfuxh0y003mootndgdy5ys2"},{"post_id":"cktfuxh0n002wootn3lvc0avc","category_id":"cktfuxh0w003iootnh8t6aqd0","_id":"cktfuxh10003rootnhbn062pa"},{"post_id":"cktfuxh0y003lootn0n0l6xd2","category_id":"cktfuxh0u003cootn49unguzf","_id":"cktfuxh10003vootnay474fjw"},{"post_id":"cktfuxh0z003pootn0ff13dh1","category_id":"cktfuxh0u003cootn49unguzf","_id":"cktfuxh10003xootncneo1la9"},{"post_id":"cktfuxh0o0030ootn4omf2cgf","category_id":"cktfuxh0y003nootnc698djm6","_id":"cktfuxh110040ootnfgng85xy"},{"post_id":"cktfuxh0q0033ootn0g78bh46","category_id":"cktfuxh0y003nootnc698djm6","_id":"cktfuxh110042ootn7ivl0ish"},{"post_id":"cktfuxh0r0036ootn68hf2kpr","category_id":"cktfuxh0u003cootn49unguzf","_id":"cktfuxh120044ootn6a9chxsc"},{"post_id":"cktfuxh0s0038ootndocp07zz","category_id":"cktfuxh110041ootn77mkbnvr","_id":"cktfuxh130049ootn6dyl30xx"},{"post_id":"cktfuxh0u003bootn3v3ddjli","category_id":"cktfuxh110041ootn77mkbnvr","_id":"cktfuxh14004eootn2ttj599n"},{"post_id":"cktfuxh0v003footnhuc2hs9o","category_id":"cktfuxh110041ootn77mkbnvr","_id":"cktfuxh15004jootn151qac3o"},{"post_id":"cktfuxh0w003gootnfcnb8kol","category_id":"cktfuxh110041ootn77mkbnvr","_id":"cktfuxh15004mootn0yfs29zd"},{"post_id":"cktfuxh0x003kootn9r6d62kn","category_id":"cktfuxh110041ootn77mkbnvr","_id":"cktfuxh16004pootngzr5gj4j"},{"post_id":"cktfuxh1x007hootnfi8gcpa4","category_id":"cktfuxh0u003cootn49unguzf","_id":"cktfuxh1y007kootn3mtqh1h7"}],"PostTag":[{"post_id":"cktfuxgz80001ootnd14262cw","tag_id":"cktfuxgzf0005ootnehug0joz","_id":"cktfuxgzs000uootn3uawg5tu"},{"post_id":"cktfuxgz80001ootnd14262cw","tag_id":"cktfuxgzi000bootnd9xf34rk","_id":"cktfuxgzt000xootn7keyhgv6"},{"post_id":"cktfuxgz80001ootnd14262cw","tag_id":"cktfuxgzk000gootn7tks6aro","_id":"cktfuxgzu0011ootnawq88ai5"},{"post_id":"cktfuxgz80001ootnd14262cw","tag_id":"cktfuxgzo000lootn5sz96wop","_id":"cktfuxgzv0014ootn34bz9o2a"},{"post_id":"cktfuxgzc0003ootnay514bwf","tag_id":"cktfuxgzr000rootncpl4hu8q","_id":"cktfuxgzw0018ootn5rcg7ymx"},{"post_id":"cktfuxgzf0007ootn8uajb5sj","tag_id":"cktfuxgzr000rootncpl4hu8q","_id":"cktfuxgzz001gootnfxafc7wq"},{"post_id":"cktfuxgzf0007ootn8uajb5sj","tag_id":"cktfuxgzw0017ootn5vm06lue","_id":"cktfuxh00001jootn8n4c8uxj"},{"post_id":"cktfuxgzy001eootnctq0fpr7","tag_id":"cktfuxgzr000rootncpl4hu8q","_id":"cktfuxh01001nootndptegzi4"},{"post_id":"cktfuxgzy001eootnctq0fpr7","tag_id":"cktfuxgzw0017ootn5vm06lue","_id":"cktfuxh01001qootn74s25w4v"},{"post_id":"cktfuxgzg0008ootn1ii8gnvn","tag_id":"cktfuxgzy001dootn56mtdl54","_id":"cktfuxh050020ootngrdh94ln"},{"post_id":"cktfuxgzg0008ootn1ii8gnvn","tag_id":"cktfuxh00001kootngafrgocb","_id":"cktfuxh050023ootncsm4204x"},{"post_id":"cktfuxgzg0008ootn1ii8gnvn","tag_id":"cktfuxh02001rootncjeo6p89","_id":"cktfuxh090027ootnaz0hazjf"},{"post_id":"cktfuxgzh0009ootnbl32fj1d","tag_id":"cktfuxgzy001dootn56mtdl54","_id":"cktfuxh0d002eootnfhmmh5zs"},{"post_id":"cktfuxgzh0009ootnbl32fj1d","tag_id":"cktfuxh00001kootngafrgocb","_id":"cktfuxh0f002iootn1omf1kik"},{"post_id":"cktfuxgzj000cootnhd6igolb","tag_id":"cktfuxgzr000rootncpl4hu8q","_id":"cktfuxh0h002lootnewld836t"},{"post_id":"cktfuxgzk000dootnaq1fdrze","tag_id":"cktfuxgzy001dootn56mtdl54","_id":"cktfuxh0n002xootn0npoeyvj"},{"post_id":"cktfuxgzk000dootnaq1fdrze","tag_id":"cktfuxh0k002qootnctpthtsm","_id":"cktfuxh0p0031ootneo874ssr"},{"post_id":"cktfuxgzm000hootn4b9l05sa","tag_id":"cktfuxgzy001dootn56mtdl54","_id":"cktfuxh0t0039ootnegcg5ua5"},{"post_id":"cktfuxgzm000hootn4b9l05sa","tag_id":"cktfuxh00001kootngafrgocb","_id":"cktfuxh0u003dootnc60oavyb"},{"post_id":"cktfuxgzn000iootn8fks0s6f","tag_id":"cktfuxh0s0037ootnepw3gjv6","_id":"cktfuxh0z003qootn5lpm6ovu"},{"post_id":"cktfuxgzn000iootn8fks0s6f","tag_id":"cktfuxh0v003eootndciv26ox","_id":"cktfuxh10003sootn96nzct5n"},{"post_id":"cktfuxgzn000iootn8fks0s6f","tag_id":"cktfuxgzr000rootncpl4hu8q","_id":"cktfuxh10003wootnaf0h6bfk"},{"post_id":"cktfuxgzp000mootnaem74fd7","tag_id":"cktfuxh0y003oootn8azkdf2a","_id":"cktfuxh130047ootnhnlqf4oi"},{"post_id":"cktfuxgzp000mootnaem74fd7","tag_id":"cktfuxh10003uootn89p7aexk","_id":"cktfuxh13004aootn8fwqcdqh"},{"post_id":"cktfuxgzp000mootnaem74fd7","tag_id":"cktfuxh11003zootnazwy92xp","_id":"cktfuxh13004cootn2e1x8g67"},{"post_id":"cktfuxgzp000mootnaem74fd7","tag_id":"cktfuxgzr000rootncpl4hu8q","_id":"cktfuxh14004footndf183a81"},{"post_id":"cktfuxgzp000oootnh031bevk","tag_id":"cktfuxgzy001dootn56mtdl54","_id":"cktfuxh14004hootnegb39sqr"},{"post_id":"cktfuxgzp000oootnh031bevk","tag_id":"cktfuxh13004bootn2k64ab0a","_id":"cktfuxh15004kootn9bbuao2f"},{"post_id":"cktfuxgzr000sootn1ui68khy","tag_id":"cktfuxgzy001dootn56mtdl54","_id":"cktfuxh16004oootn10ew43mz"},{"post_id":"cktfuxgzr000sootn1ui68khy","tag_id":"cktfuxgzf0005ootnehug0joz","_id":"cktfuxh16004qootn11oe05q9"},{"post_id":"cktfuxgzr000sootn1ui68khy","tag_id":"cktfuxh0k002qootnctpthtsm","_id":"cktfuxh17004sootnfeji6pl2"},{"post_id":"cktfuxgzs000vootn7ij97f6n","tag_id":"cktfuxgzy001dootn56mtdl54","_id":"cktfuxh17004uootncrlr53bf"},{"post_id":"cktfuxgzs000vootn7ij97f6n","tag_id":"cktfuxh13004bootn2k64ab0a","_id":"cktfuxh17004vootn73s6hkcy"},{"post_id":"cktfuxgzt000yootn2z3oc7bs","tag_id":"cktfuxgzf0005ootnehug0joz","_id":"cktfuxh18004xootnek0c9tse"},{"post_id":"cktfuxgzt000yootn2z3oc7bs","tag_id":"cktfuxh13004bootn2k64ab0a","_id":"cktfuxh18004yootn9ntkfagv"},{"post_id":"cktfuxgzu0012ootncu3t3xus","tag_id":"cktfuxgzy001dootn56mtdl54","_id":"cktfuxh180051ootnd99fhjma"},{"post_id":"cktfuxgzu0012ootncu3t3xus","tag_id":"cktfuxh13004bootn2k64ab0a","_id":"cktfuxh180052ootn5faz93o0"},{"post_id":"cktfuxgzv0015ootn4pqv90ir","tag_id":"cktfuxgzr000rootncpl4hu8q","_id":"cktfuxh190054ootnadwe80hb"},{"post_id":"cktfuxgzv0015ootn4pqv90ir","tag_id":"cktfuxh180050ootn1ezb6ab9","_id":"cktfuxh190055ootnf0gt3u95"},{"post_id":"cktfuxgzw0019ootn9cet8kv2","tag_id":"cktfuxh190053ootn46mafpfq","_id":"cktfuxh190057ootncnf95s32"},{"post_id":"cktfuxgzx001bootn9hy4h0le","tag_id":"cktfuxgzy001dootn56mtdl54","_id":"cktfuxh1a005bootn6u8f44a3"},{"post_id":"cktfuxgzx001bootn9hy4h0le","tag_id":"cktfuxh190058ootncyq3foua","_id":"cktfuxh1a005cootnb5uq2cm7"},{"post_id":"cktfuxgzx001bootn9hy4h0le","tag_id":"cktfuxh1a0059ootn0ion5bw2","_id":"cktfuxh1b005eootng6q169vj"},{"post_id":"cktfuxgzz001hootnfqcqgs66","tag_id":"cktfuxgzr000rootncpl4hu8q","_id":"cktfuxh1b005gootn6ubx54v2"},{"post_id":"cktfuxgzz001hootnfqcqgs66","tag_id":"cktfuxh0y003oootn8azkdf2a","_id":"cktfuxh1b005hootnd31ug0uj"},{"post_id":"cktfuxgzz001hootnfqcqgs66","tag_id":"cktfuxh1a005dootnfzb5aovs","_id":"cktfuxh1c005jootn0dz4hggj"},{"post_id":"cktfuxh00001lootn0ruo852i","tag_id":"cktfuxgzr000rootncpl4hu8q","_id":"cktfuxh1d005kootna7lsh13p"},{"post_id":"cktfuxh00001lootn0ruo852i","tag_id":"cktfuxh1b005footnf0f76ki0","_id":"cktfuxh1d005mootn8ff2csnq"},{"post_id":"cktfuxh02001sootn8y17gs97","tag_id":"cktfuxgzr000rootncpl4hu8q","_id":"cktfuxh1e005nootn7kqxdkrz"},{"post_id":"cktfuxh02001sootn8y17gs97","tag_id":"cktfuxh1b005iootnbp9yfxvf","_id":"cktfuxh1e005pootnd0ez6vn6"},{"post_id":"cktfuxh03001uootncgxbc09w","tag_id":"cktfuxh1b005iootnbp9yfxvf","_id":"cktfuxh1e005qootn0ph3gpj8"},{"post_id":"cktfuxh03001wootnaf27hcj4","tag_id":"cktfuxh1b005iootnbp9yfxvf","_id":"cktfuxh1f005sootndk9f5jze"},{"post_id":"cktfuxh050021ootnbviu7tnp","tag_id":"cktfuxh1b005iootnbp9yfxvf","_id":"cktfuxh1g005wootney5b7mjd"},{"post_id":"cktfuxh050021ootnbviu7tnp","tag_id":"cktfuxh1f005tootnfkz2863v","_id":"cktfuxh1g005xootn0hihg1vn"},{"post_id":"cktfuxh050021ootnbviu7tnp","tag_id":"cktfuxh1f005uootn7cac2d9c","_id":"cktfuxh1g005zootn2ulc2g9h"},{"post_id":"cktfuxh060024ootnhn3b2p5l","tag_id":"cktfuxgzr000rootncpl4hu8q","_id":"cktfuxh1g0060ootn1nz1djgb"},{"post_id":"cktfuxh060024ootnhn3b2p5l","tag_id":"cktfuxh1a005dootnfzb5aovs","_id":"cktfuxh1i0062ootn3xzp6zjx"},{"post_id":"cktfuxh0a0028ootn116ffzdj","tag_id":"cktfuxgzf0005ootnehug0joz","_id":"cktfuxh1i0063ootnfmnp529q"},{"post_id":"cktfuxh0a0028ootn116ffzdj","tag_id":"cktfuxgzr000rootncpl4hu8q","_id":"cktfuxh1j0065ootn7pxses6f"},{"post_id":"cktfuxh0a0028ootn116ffzdj","tag_id":"cktfuxh11003zootnazwy92xp","_id":"cktfuxh1j0066ootng49t4ouf"},{"post_id":"cktfuxh0b002bootngpls904j","tag_id":"cktfuxh13004bootn2k64ab0a","_id":"cktfuxh1j0068ootn8vd626zv"},{"post_id":"cktfuxh0b002bootngpls904j","tag_id":"cktfuxgzw0017ootn5vm06lue","_id":"cktfuxh1j0069ootn8iz66kwb"},{"post_id":"cktfuxh0i002mootn52vu9bia","tag_id":"cktfuxh1i0064ootnccukb1ch","_id":"cktfuxh1j006bootn822zh18f"},{"post_id":"cktfuxh0i002mootn52vu9bia","tag_id":"cktfuxgzf0005ootnehug0joz","_id":"cktfuxh1k006cootngv3zfosz"},{"post_id":"cktfuxh0i002mootn52vu9bia","tag_id":"cktfuxgzo000lootn5sz96wop","_id":"cktfuxh1k006eootn9ekqhn57"},{"post_id":"cktfuxh0i002mootn52vu9bia","tag_id":"cktfuxgzk000gootn7tks6aro","_id":"cktfuxh1k006footn5gy6b8ur"},{"post_id":"cktfuxh0i002mootn52vu9bia","tag_id":"cktfuxh1j0067ootndp5ah100","_id":"cktfuxh1k006hootn3g9pcpvg"},{"post_id":"cktfuxh0m002uootncaw3crja","tag_id":"cktfuxh1j006aootn7cc1ff4n","_id":"cktfuxh1k006iootnazpfhhsl"},{"post_id":"cktfuxh0o0030ootn4omf2cgf","tag_id":"cktfuxgzf0005ootnehug0joz","_id":"cktfuxh1l006kootnhcbe4pcf"},{"post_id":"cktfuxh0o0030ootn4omf2cgf","tag_id":"cktfuxh1k006dootn7brqeusa","_id":"cktfuxh1l006lootnbe6na7iz"},{"post_id":"cktfuxh0o0030ootn4omf2cgf","tag_id":"cktfuxh1k006gootn2gen00np","_id":"cktfuxh1l006nootnhqus1q14"},{"post_id":"cktfuxh0q0033ootn0g78bh46","tag_id":"cktfuxh190053ootn46mafpfq","_id":"cktfuxh1m006pootn4sc4czsz"},{"post_id":"cktfuxh0q0033ootn0g78bh46","tag_id":"cktfuxh1l006mootnai15fhnk","_id":"cktfuxh1m006qootn8vucdnfu"},{"post_id":"cktfuxh0r0036ootn68hf2kpr","tag_id":"cktfuxh1i0064ootnccukb1ch","_id":"cktfuxh1n006uootn9cbx0i9f"},{"post_id":"cktfuxh0r0036ootn68hf2kpr","tag_id":"cktfuxh0s0037ootnepw3gjv6","_id":"cktfuxh1n006vootngpsi74d9"},{"post_id":"cktfuxh0r0036ootn68hf2kpr","tag_id":"cktfuxh0v003eootndciv26ox","_id":"cktfuxh1n006xootn8yaqd9li"},{"post_id":"cktfuxh0s0038ootndocp07zz","tag_id":"cktfuxh1b005iootnbp9yfxvf","_id":"cktfuxh1n006yootnazcpft5z"},{"post_id":"cktfuxh0u003bootn3v3ddjli","tag_id":"cktfuxh1b005iootnbp9yfxvf","_id":"cktfuxh1o0072ootn322q7lbz"},{"post_id":"cktfuxh0u003bootn3v3ddjli","tag_id":"cktfuxh1n006zootn8qu5d4n2","_id":"cktfuxh1o0073ootn2qhi0re7"},{"post_id":"cktfuxh0u003bootn3v3ddjli","tag_id":"cktfuxh1o0070ootn0y1md9bi","_id":"cktfuxh1p0075ootn261fgewo"},{"post_id":"cktfuxh0v003footnhuc2hs9o","tag_id":"cktfuxgzf0005ootnehug0joz","_id":"cktfuxh1p0076ootndb9ge1pt"},{"post_id":"cktfuxh0v003footnhuc2hs9o","tag_id":"cktfuxh1o0071ootn4sstcl5h","_id":"cktfuxh1q0078ootn1xk1fz8f"},{"post_id":"cktfuxh0w003gootnfcnb8kol","tag_id":"cktfuxgzr000rootncpl4hu8q","_id":"cktfuxh1s0079ootnd3gf16lc"},{"post_id":"cktfuxh0w003gootnfcnb8kol","tag_id":"cktfuxh1o0074ootn2l3x39eg","_id":"cktfuxh1t007bootn5x793vum"},{"post_id":"cktfuxh0w003gootnfcnb8kol","tag_id":"cktfuxgzf0005ootnehug0joz","_id":"cktfuxh1v007cootn13kzbg4n"},{"post_id":"cktfuxh0y003lootn0n0l6xd2","tag_id":"cktfuxh1i0064ootnccukb1ch","_id":"cktfuxh1v007eootngzb948rx"},{"post_id":"cktfuxh0y003lootn0n0l6xd2","tag_id":"cktfuxh1s007aootncx7o2wik","_id":"cktfuxh1v007footn37n32y7m"},{"post_id":"cktfuxh0y003lootn0n0l6xd2","tag_id":"cktfuxh1j006aootn7cc1ff4n","_id":"cktfuxh1v007gootn8pwbaa1t"},{"post_id":"cktfuxh1x007hootnfi8gcpa4","tag_id":"cktfuxh1i0064ootnccukb1ch","_id":"cktfuxh1y007iootn31i31rog"},{"post_id":"cktfuxh1x007hootnfi8gcpa4","tag_id":"cktfuxgzf0005ootnehug0joz","_id":"cktfuxh1y007jootnczha0xg8"},{"post_id":"cktfuxh1x007hootnfi8gcpa4","tag_id":"cktfuxgzi000bootnd9xf34rk","_id":"cktfuxh1y007lootnc00ugv6x"},{"post_id":"cktfuxh2o007mootn92qa0hgs","tag_id":"cktfuxh1j006aootn7cc1ff4n","_id":"cktfuxh2p007oootnap8bbt55"},{"post_id":"cktfuxh2o007mootn92qa0hgs","tag_id":"cktfuxh2o007nootn1db7huk1","_id":"cktfuxh2p007pootn8yx77gkh"},{"post_id":"cktfuxh47007rootn51ys72sz","tag_id":"cktfuxh48007sootnd6jb0i2c","_id":"cktfuxh49007tootnd98wdsfk"},{"post_id":"cktfuxh47007rootn51ys72sz","tag_id":"cktfuxh2o007nootn1db7huk1","_id":"cktfuxh49007uootn20lrhes4"}],"Tag":[{"name":"","_id":"cktfuxgzf0005ootnehug0joz"},{"name":"","_id":"cktfuxgzi000bootnd9xf34rk"},{"name":"Min-25 ","_id":"cktfuxgzk000gootn7tks6aro"},{"name":"","_id":"cktfuxgzo000lootn5sz96wop"},{"name":"","_id":"cktfuxgzr000rootncpl4hu8q"},{"name":"","_id":"cktfuxgzw0017ootn5vm06lue"},{"name":"","_id":"cktfuxgzy001dootn56mtdl54"},{"name":"","_id":"cktfuxh00001kootngafrgocb"},{"name":"","_id":"cktfuxh02001rootncjeo6p89"},{"name":"","_id":"cktfuxh0k002qootnctpthtsm"},{"name":"","_id":"cktfuxh0s0037ootnepw3gjv6"},{"name":" NIM ","_id":"cktfuxh0v003eootndciv26ox"},{"name":"","_id":"cktfuxh0y003oootn8azkdf2a"},{"name":"","_id":"cktfuxh10003uootn89p7aexk"},{"name":"","_id":"cktfuxh11003zootnazwy92xp"},{"name":"","_id":"cktfuxh13004bootn2k64ab0a"},{"name":"","_id":"cktfuxh180050ootn1ezb6ab9"},{"name":"","_id":"cktfuxh190053ootn46mafpfq"},{"name":"","_id":"cktfuxh190058ootncyq3foua"},{"name":"","_id":"cktfuxh1a0059ootn0ion5bw2"},{"name":"","_id":"cktfuxh1a005dootnfzb5aovs"},{"name":"","_id":"cktfuxh1b005footnf0f76ki0"},{"name":"","_id":"cktfuxh1b005iootnbp9yfxvf"},{"name":"","_id":"cktfuxh1f005tootnfkz2863v"},{"name":"","_id":"cktfuxh1f005uootn7cac2d9c"},{"name":"","_id":"cktfuxh1i0064ootnccukb1ch"},{"name":"Powerful Number ","_id":"cktfuxh1j0067ootndp5ah100"},{"name":"","_id":"cktfuxh1j006aootn7cc1ff4n"},{"name":"","_id":"cktfuxh1k006dootn7brqeusa"},{"name":"","_id":"cktfuxh1k006gootn2gen00np"},{"name":"","_id":"cktfuxh1l006mootnai15fhnk"},{"name":"","_id":"cktfuxh1n006zootn8qu5d4n2"},{"name":"","_id":"cktfuxh1o0070ootn0y1md9bi"},{"name":"","_id":"cktfuxh1o0071ootn4sstcl5h"},{"name":"","_id":"cktfuxh1o0074ootn2l3x39eg"},{"name":"","_id":"cktfuxh1s007aootncx7o2wik"},{"name":"","_id":"cktfuxh2o007nootn1db7huk1"},{"name":"","_id":"cktfuxh48007sootnd6jb0i2c"}]}}